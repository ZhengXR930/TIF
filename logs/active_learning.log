x_data shape: (41562, 5814), y_data shape: (41562,), env_data shape: (41562,), t_data shape: (41562,)
distribution of y_data: Counter({np.float64(0.0): 37228, np.float64(1.0): 4334}), distribution of env_data: Counter({np.int64(2): 14375, np.int64(1): 12018, np.int64(0): 7754, np.int64(3): 7415})
x_data shape: (10391, 5814), y_data shape: (10391,), env_data shape: (10391,), t_data shape: (10391,)
distribution of y_data: Counter({np.float64(0.0): 9308, np.float64(1.0): 1083}), distribution of env_data: Counter({np.int64(2): 3595, np.int64(1): 3041, np.int64(0): 1964, np.int64(3): 1791})
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1809, 5814), y shape: (1809,), y distribution: Counter({np.float64(0.0): 1375, np.float64(1.0): 434}), env shape: (1809,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9663, Precision: 0.9758, Recall: 0.9321, F1: 0.9516
month: 2015-01, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1441, 5814), y shape: (1441,), y distribution: Counter({np.float64(0.0): 1130, np.float64(1.0): 311}), env shape: (1441,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9535, Precision: 0.9640, Recall: 0.8981, F1: 0.9262
month: 2015-02, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (2234, 5814), y shape: (2234,), y distribution: Counter({np.float64(0.0): 1716, np.float64(1.0): 518}), env shape: (2234,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9709, Precision: 0.9777, Recall: 0.9406, F1: 0.9576
month: 2015-03, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (2129, 5814), y shape: (2129,), y distribution: Counter({np.float64(0.0): 1665, np.float64(1.0): 464}), env shape: (2129,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9493, Precision: 0.9629, Recall: 0.8883, F1: 0.9193
month: 2015-04, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (2341, 5814), y shape: (2341,), y distribution: Counter({np.float64(0.0): 1779, np.float64(1.0): 562}), env shape: (2341,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9496, Precision: 0.9646, Recall: 0.8981, F1: 0.9258
month: 2015-05, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (2467, 5814), y shape: (2467,), y distribution: Counter({np.float64(0.0): 1895, np.float64(1.0): 572}), env shape: (2467,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9384, Precision: 0.9494, Recall: 0.8763, F1: 0.9062
month: 2015-06, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (3702, 5814), y shape: (3702,), y distribution: Counter({np.float64(0.0): 2296, np.float64(1.0): 1406}), env shape: (3702,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9246, Precision: 0.9425, Recall: 0.9024, F1: 0.9167
month: 2015-07, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (3857, 5814), y shape: (3857,), y distribution: Counter({np.float64(0.0): 2431, np.float64(1.0): 1426}), env shape: (3857,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9295, Precision: 0.9412, Recall: 0.9094, F1: 0.9218
month: 2015-08, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (3954, 5814), y shape: (3954,), y distribution: Counter({np.float64(0.0): 2718, np.float64(1.0): 1236}), env shape: (3954,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9282, Precision: 0.9417, Recall: 0.8920, F1: 0.9118
month: 2015-09, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (3632, 5814), y shape: (3632,), y distribution: Counter({np.float64(0.0): 2626, np.float64(1.0): 1006}), env shape: (3632,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9273, Precision: 0.9362, Recall: 0.8807, F1: 0.9034
month: 2015-10, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (3814, 5814), y shape: (3814,), y distribution: Counter({np.float64(0.0): 2648, np.float64(1.0): 1166}), env shape: (3814,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9224, Precision: 0.9339, Recall: 0.8829, F1: 0.9033
month: 2015-11, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (4388, 5814), y shape: (4388,), y distribution: Counter({np.float64(0.0): 2968, np.float64(1.0): 1420}), env shape: (4388,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9369, Precision: 0.9475, Recall: 0.9089, F1: 0.9249
month: 2015-12, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (3413, 5814), y shape: (3413,), y distribution: Counter({np.float64(0.0): 3086, np.float64(1.0): 327}), env shape: (3413,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9742, Precision: 0.9275, Recall: 0.9229, F1: 0.9252
month: 2016-01, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (4079, 5814), y shape: (4079,), y distribution: Counter({np.float64(0.0): 3629, np.float64(1.0): 450}), env shape: (4079,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch59_lr0.0001_bs256.pt
Accuracy: 0.9586, Precision: 0.9126, Recall: 0.8677, F1: 0.8884
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7515]))
original train data shape: torch.Size([41662]), new train data shape: torch.Size([100])
original test data shape: torch.Size([4079, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([41662]), new train data shape: torch.Size([41662])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7515]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.5853
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.7164
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3137
Epoch 1/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.2829
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1713
Epoch 1/30, Step 100/1,Classification Loss: 0.3160, Contrastive Loss: 0.1545
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1436
Accuracy: 0.9995, Precision: 0.9995, Recall: 0.9980, F1: 0.9987
Accuracy: 0.9993, Precision: 0.9986, Recall: 0.9976, F1: 0.9981
Epoch 1/30
Training - Loss: 92.2595
Training Metrics: {'accuracy': 0.9995192307692308, 'precision': 0.9994785630576417, 'recall': 0.9979681298508656, 'f1': 0.9987218576201813}
Validation Metrics: {'accuracy': 0.9992799711988479, 'precision': 0.9985889744473815, 'recall': 0.9975853781179499, 'f1': 0.9980865179540783}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1367
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1286
Epoch 2/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1907
Epoch 2/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.1230
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1177
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1131
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1108
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9993, Precision: 0.9986, Recall: 0.9976, F1: 0.9981
Epoch 2/30
Training - Loss: 57.4646
Training Metrics: {'accuracy': 0.9997896634615384, 'precision': 0.9997533716858595, 'recall': 0.9991075950829942, 'f1': 0.9994302135213926}
Validation Metrics: {'accuracy': 0.9992799711988479, 'precision': 0.9985889744473815, 'recall': 0.9975853781179499, 'f1': 0.9980865179540783}
Epoch 3/30, Step 0/1,Classification Loss: 0.3268, Contrastive Loss: 0.1194
Epoch 3/30, Step 20/1,Classification Loss: 0.3220, Contrastive Loss: 0.1133
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1036
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1008
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0984
Epoch 3/30, Step 100/1,Classification Loss: 0.3177, Contrastive Loss: 0.1044
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0944
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9971, F1: 0.9981
Epoch 3/30
Training - Loss: 54.4676
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9998489679476422, 'recall': 0.998712077847739, 'f1': 0.9992796810493485}
Validation Metrics: {'accuracy': 0.9992799711988479, 'precision': 0.9990921416704286, 'recall': 0.9970823127761927, 'f1': 0.9980845879783933}
Epoch 4/30, Step 0/1,Classification Loss: 0.3148, Contrastive Loss: 0.1022
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0917
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0908
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0886
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0870
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0855
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0838
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9988, F1: 0.9994
Accuracy: 0.9992, Precision: 0.9985, Recall: 0.9970, F1: 0.9978
Epoch 4/30
Training - Loss: 52.9794
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.9998658213411157, 'recall': 0.998849582973828, 'f1': 0.9993570306624986}
Validation Metrics: {'accuracy': 0.9991599663986559, 'precision': 0.9985206696684821, 'recall': 0.9970152526903558, 'f1': 0.9977664791136065}
Epoch 5/30, Step 0/1,Classification Loss: 0.3155, Contrastive Loss: 0.0837
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0820
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0806
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0802
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0782
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0769
Epoch 5/30, Step 120/1,Classification Loss: 0.3194, Contrastive Loss: 0.0837
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9985, F1: 0.9991
Accuracy: 0.9993, Precision: 0.9986, Recall: 0.9976, F1: 0.9981
Epoch 5/30
Training - Loss: 51.5678
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.9996876376062487, 'recall': 0.9985398124664222, 'f1': 0.9991128690000468}
Validation Metrics: {'accuracy': 0.9992799711988479, 'precision': 0.9985889744473815, 'recall': 0.9975853781179499, 'f1': 0.9980865179540783}
Epoch 6/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0777
Epoch 6/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0752
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0731
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0716
Epoch 6/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.2619
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0697
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0688
Accuracy: 0.9995, Precision: 0.9986, Recall: 0.9988, F1: 0.9987
Accuracy: 0.9993, Precision: 0.9981, Recall: 0.9981, F1: 0.9981
Epoch 6/30
Training - Loss: 50.5742
Training Metrics: {'accuracy': 0.9995192307692308, 'precision': 0.998570793715907, 'recall': 0.9988282528306507, 'f1': 0.99869948028743}
Validation Metrics: {'accuracy': 0.9992799711988479, 'precision': 0.998088443459707, 'recall': 0.998088443459707, 'f1': 0.998088443459707}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0680
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0681
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0662
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0655
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0646
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0634
Epoch 7/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0648
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9994, Precision: 0.9987, Recall: 0.9982, F1: 0.9984
Epoch 7/30
Training - Loss: 49.6612
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9991507415384849, 'recall': 0.9988919940521279, 'f1': 0.9990213244616815}
Validation Metrics: {'accuracy': 0.99939997599904, 'precision': 0.998657294209786, 'recall': 0.998155503545544, 'f1': 0.998406234387246}
Epoch 8/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0625
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0618
Epoch 8/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0609
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0599
Epoch 8/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0598
Epoch 8/30, Step 100/1,Classification Loss: 0.3151, Contrastive Loss: 0.0587
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0581
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9988, F1: 0.9992
Accuracy: 0.9993, Precision: 0.9986, Recall: 0.9976, F1: 0.9981
Epoch 8/30
Training - Loss: 48.9632
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.9995764487246517, 'recall': 0.9988107289982122, 'f1': 0.999193208021731}
Validation Metrics: {'accuracy': 0.9992799711988479, 'precision': 0.9985889744473815, 'recall': 0.9975853781179499, 'f1': 0.9980865179540783}
Epoch 9/30, Step 0/1,Classification Loss: 0.3227, Contrastive Loss: 0.0593
Epoch 9/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0804
Epoch 9/30, Step 40/1,Classification Loss: 0.3414, Contrastive Loss: 0.0797
Epoch 9/30, Step 60/1,Classification Loss: 0.3285, Contrastive Loss: 0.0660
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0544
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0533
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0526
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9990, Precision: 0.9970, Recall: 0.9980, F1: 0.9975
Epoch 9/30
Training - Loss: 48.5563
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.999739318599816, 'recall': 0.9989826395804173, 'f1': 0.9993606060409568}
Validation Metrics: {'accuracy': 0.999039961598464, 'precision': 0.9969546246939515, 'recall': 0.9979543232880332, 'f1': 0.9974538193473674}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0523
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0517
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0511
Epoch 10/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1263
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0497
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0500
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0490
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9990, Precision: 0.9985, Recall: 0.9964, F1: 0.9974
Epoch 10/30
Training - Loss: 47.8361
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.9998657177386867, 'recall': 0.9988571428571429, 'f1': 0.999360767472407}
Validation Metrics: {'accuracy': 0.999039961598464, 'precision': 0.9984523798556025, 'recall': 0.9964451272627618, 'f1': 0.9974461173045244}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0481
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0475
Epoch 11/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0470
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Epoch 11/30, Step 80/1,Classification Loss: 0.3215, Contrastive Loss: 0.0553
Epoch 11/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0480
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0448
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9989, Precision: 0.9974, Recall: 0.9969, F1: 0.9971
Epoch 11/30
Training - Loss: 47.2301
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.9993195552496712, 'recall': 0.999063637912378, 'f1': 0.999191554072109}
Validation Metrics: {'accuracy': 0.998919956798272, 'precision': 0.9973816395125048, 'recall': 0.9968811325186819, 'f1': 0.9971312218970427}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0443
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0438
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0433
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0457
Epoch 12/30, Step 80/1,Classification Loss: 0.3149, Contrastive Loss: 0.0426
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Epoch 12/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0416
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9986, F1: 0.9992
Accuracy: 0.9992, Precision: 0.9985, Recall: 0.9970, F1: 0.9978
Epoch 12/30
Training - Loss: 46.7728
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.999832327297116, 'recall': 0.9985590778097982, 'f1': 0.9991946488676322}
Validation Metrics: {'accuracy': 0.9991599663986559, 'precision': 0.9985206696684821, 'recall': 0.9970152526903558, 'f1': 0.9977664791136065}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0408
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0406
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0396
Epoch 13/30, Step 80/1,Classification Loss: 0.3167, Contrastive Loss: 0.0399
Epoch 13/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1315
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0379
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9988, Precision: 0.9963, Recall: 0.9973, F1: 0.9968
Epoch 13/30
Training - Loss: 46.3830
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9991569987130475, 'recall': 0.9989008244920027, 'f1': 0.9990288690086304}
Validation Metrics: {'accuracy': 0.9987999519980799, 'precision': 0.9963187184011884, 'recall': 0.9973171377746022, 'f1': 0.9968172741842092}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0378
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0374
Epoch 14/30, Step 40/1,Classification Loss: 0.3215, Contrastive Loss: 0.0409
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 14/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0359
Epoch 14/30, Step 120/1,Classification Loss: 0.3170, Contrastive Loss: 0.0407
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9988, Precision: 0.9968, Recall: 0.9968, F1: 0.9968
Epoch 14/30
Training - Loss: 45.9177
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9992850495047683, 'recall': 0.9987725307859433, 'f1': 0.9990286196723488}
Validation Metrics: {'accuracy': 0.9987999519980799, 'precision': 0.9968140724328451, 'recall': 0.9968140724328451, 'f1': 0.9968140724328451}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Epoch 15/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0343
Epoch 15/30, Step 80/1,Classification Loss: 0.3287, Contrastive Loss: 0.0468
Epoch 15/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.2181
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9990, Precision: 0.9985, Recall: 0.9964, F1: 0.9974
Epoch 15/30
Training - Loss: 45.6669
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.9994352141828113, 'recall': 0.9988031889191077, 'f1': 0.9991189413550899}
Validation Metrics: {'accuracy': 0.999039961598464, 'precision': 0.9984523798556025, 'recall': 0.9964451272627618, 'f1': 0.9974461173045244}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0329
Epoch 16/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0356
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 16/30, Step 80/1,Classification Loss: 0.3155, Contrastive Loss: 0.0404
Epoch 16/30, Step 100/1,Classification Loss: 0.3138, Contrastive Loss: 0.0311
Epoch 16/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0397
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9988, Precision: 0.9983, Recall: 0.9953, F1: 0.9968
Epoch 16/30
Training - Loss: 45.3458
Training Metrics: {'accuracy': 0.9998197115384615, 'precision': 0.9998994570681681, 'recall': 0.9991299303944315, 'f1': 0.9995143098361745}
Validation Metrics: {'accuracy': 0.9987999519980799, 'precision': 0.9983158450577454, 'recall': 0.9953048764075736, 'f1': 0.996804422528894}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 17/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0426
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0292
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0314
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9987, Precision: 0.9962, Recall: 0.9967, F1: 0.9965
Epoch 17/30
Training - Loss: 45.1572
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.9994295381013025, 'recall': 0.9987876134846941, 'f1': 0.9991083085511288}
Validation Metrics: {'accuracy': 0.9986799471978879, 'precision': 0.9962477981022047, 'recall': 0.9967470123470081, 'f1': 0.9964972416585319}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0280
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 18/30, Step 40/1,Classification Loss: 0.3145, Contrastive Loss: 0.0285
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0273
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0265
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Accuracy: 0.9998, Precision: 0.9996, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9988, Precision: 0.9963, Recall: 0.9973, F1: 0.9968
Epoch 18/30
Training - Loss: 44.6048
Training Metrics: {'accuracy': 0.9997896634615384, 'precision': 0.9996275493005327, 'recall': 0.9992455798745572, 'f1': 0.999436469796195}
Validation Metrics: {'accuracy': 0.9987999519980799, 'precision': 0.9963187184011884, 'recall': 0.9973171377746022, 'f1': 0.9968172741842092}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 19/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0264
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 19/30, Step 60/1,Classification Loss: 0.3432, Contrastive Loss: 0.0620
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9983, Precision: 0.9931, Recall: 0.9981, F1: 0.9956
Epoch 19/30
Training - Loss: 44.5843
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9998491097475103, 'recall': 0.9987016733987305, 'f1': 0.9992745362658005}
Validation Metrics: {'accuracy': 0.9983199327973119, 'precision': 0.9931013254091616, 'recall': 0.9980550281147689, 'f1': 0.9955620104257872}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 20/30, Step 20/1,Classification Loss: 0.3177, Contrastive Loss: 0.0330
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Epoch 20/30, Step 60/1,Classification Loss: 0.3139, Contrastive Loss: 0.0246
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9981, F1: 0.9986
Accuracy: 0.9987, Precision: 0.9962, Recall: 0.9967, F1: 0.9965
Epoch 20/30
Training - Loss: 44.5294
Training Metrics: {'accuracy': 0.9994891826923077, 'precision': 0.9992073243310859, 'recall': 0.9980703991935911, 'f1': 0.9986380189691246}
Validation Metrics: {'accuracy': 0.9986799471978879, 'precision': 0.9962477981022047, 'recall': 0.9967470123470081, 'f1': 0.9964972416585319}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 21/30, Step 60/1,Classification Loss: 0.3278, Contrastive Loss: 0.0343
Epoch 21/30, Step 80/1,Classification Loss: 0.3160, Contrastive Loss: 0.0263
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9986, F1: 0.9989
Accuracy: 0.9984, Precision: 0.9966, Recall: 0.9951, F1: 0.9959
Epoch 21/30
Training - Loss: 44.1372
Training Metrics: {'accuracy': 0.9995793269230769, 'precision': 0.999129392137859, 'recall': 0.9986222659740216, 'f1': 0.9988756616105932}
Validation Metrics: {'accuracy': 0.9984399375975039, 'precision': 0.9966033231858185, 'recall': 0.9951036961500629, 'f1': 0.9958520326395548}
Epoch 22/30, Step 0/1,Classification Loss: 0.3336, Contrastive Loss: 0.0304
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 22/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0242
Epoch 22/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0214
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9987, Precision: 0.9967, Recall: 0.9962, F1: 0.9965
Epoch 22/30
Training - Loss: 43.8835
Training Metrics: {'accuracy': 0.9997896634615384, 'precision': 0.9998827274250293, 'recall': 0.9989831493317838, 'f1': 0.9994324139822914}
Validation Metrics: {'accuracy': 0.9986799471978879, 'precision': 0.9967438121638643, 'recall': 0.9962439470052511, 'f1': 0.9964937156519412}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9990, Precision: 0.9970, Recall: 0.9980, F1: 0.9975
Epoch 23/30
Training - Loss: 43.7781
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9998491249245625, 'recall': 0.9987005486572336, 'f1': 0.9992739800221031}
Validation Metrics: {'accuracy': 0.999039961598464, 'precision': 0.9969546246939515, 'recall': 0.9979543232880332, 'f1': 0.9974538193473674}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 24/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1676
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9989, F1: 0.9989
Accuracy: 0.9988, Precision: 0.9958, Recall: 0.9978, F1: 0.9968
Epoch 24/30
Training - Loss: 43.8971
Training Metrics: {'accuracy': 0.999609375, 'precision': 0.9990078603579464, 'recall': 0.9988790893241719, 'f1': 0.9989434640930261}
Validation Metrics: {'accuracy': 0.9987999519980799, 'precision': 0.9958259535259486, 'recall': 0.9978202031163594, 'f1': 0.9968204685361839}
Epoch 25/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0193
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9988, F1: 0.9992
Accuracy: 0.9989, Precision: 0.9974, Recall: 0.9969, F1: 0.9971
Epoch 25/30
Training - Loss: 43.6020
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.9995734817453048, 'recall': 0.9987982815958971, 'f1': 0.9991854926769281}
Validation Metrics: {'accuracy': 0.998919956798272, 'precision': 0.9973816395125048, 'recall': 0.9968811325186819, 'f1': 0.9971312218970427}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 26/30, Step 80/1,Classification Loss: 0.3142, Contrastive Loss: 0.0188
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Accuracy: 0.9992, Precision: 0.9978, Recall: 0.9979, F1: 0.9978
Accuracy: 0.9981, Precision: 0.9944, Recall: 0.9954, F1: 0.9949
Epoch 26/30
Training - Loss: 43.5688
Training Metrics: {'accuracy': 0.999188701923077, 'precision': 0.9977686713550898, 'recall': 0.9978951667194601, 'f1': 0.997831908594274}
Validation Metrics: {'accuracy': 0.9980799231969278, 'precision': 0.9944109995228986, 'recall': 0.9954055812343093, 'f1': 0.9949076386947349}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0201
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Accuracy: 0.9995, Precision: 0.9995, Recall: 0.9978, F1: 0.9986
Accuracy: 0.9988, Precision: 0.9983, Recall: 0.9953, F1: 0.9968
Epoch 27/30
Training - Loss: 43.6858
Training Metrics: {'accuracy': 0.9994891826923077, 'precision': 0.9994571219227167, 'recall': 0.9977875199717834, 'f1': 0.9986205118078213}
Validation Metrics: {'accuracy': 0.9987999519980799, 'precision': 0.9983158450577454, 'recall': 0.9953048764075736, 'f1': 0.996804422528894}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0177
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9989, Precision: 0.9989, Recall: 0.9954, F1: 0.9971
Epoch 28/30
Training - Loss: 43.4471
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.9998660818909237, 'recall': 0.9988300672711319, 'f1': 0.9993473804398956}
Validation Metrics: {'accuracy': 0.998919956798272, 'precision': 0.9988893098673763, 'recall': 0.9953719364934106, 'f1': 0.9971225268999824}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 40/1,Classification Loss: 0.3231, Contrastive Loss: 0.0195
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 120/1,Classification Loss: 0.3156, Contrastive Loss: 0.0212
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9989, Precision: 0.9974, Recall: 0.9969, F1: 0.9971
Epoch 29/30
Training - Loss: 43.3277
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.9993070304702387, 'recall': 0.9989265649356289, 'f1': 0.9991167035013708}
Validation Metrics: {'accuracy': 0.998919956798272, 'precision': 0.9973816395125048, 'recall': 0.9968811325186819, 'f1': 0.9971312218970427}
Epoch 30/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1110
Epoch 30/30, Step 20/1,Classification Loss: 0.3161, Contrastive Loss: 0.0177
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9981, Precision: 0.9939, Recall: 0.9959, F1: 0.9949
Epoch 30/30
Training - Loss: 43.3078
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9994696153743373, 'recall': 0.999091026002658, 'f1': 0.9992802273080226}
Validation Metrics: {'accuracy': 0.9980799231969278, 'precision': 0.9939220546114885, 'recall': 0.9959086465760665, 'f1': 0.9949127496578942}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5921, 5814), y shape: (5921,), y distribution: Counter({np.float64(0.0): 5312, np.float64(1.0): 609}), env shape: (5921,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9730, Precision: 0.9577, Recall: 0.8912, F1: 0.9211
month: 2016-03, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (6479, 5814), y shape: (6479,), y distribution: Counter({np.float64(0.0): 5893, np.float64(1.0): 586}), env shape: (6479,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9625, Precision: 0.9453, Recall: 0.8157, F1: 0.8670
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7615]))
original train data shape: torch.Size([41762]), new train data shape: torch.Size([100])
original test data shape: torch.Size([6479, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([41762]), new train data shape: torch.Size([41762])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7615]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 1.5819
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.8606
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3807
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2482
Epoch 1/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.2466
Epoch 1/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.1684
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1524
Accuracy: 0.9991, Precision: 0.9980, Recall: 0.9974, F1: 0.9977
Accuracy: 0.9986, Precision: 0.9962, Recall: 0.9962, F1: 0.9962
Epoch 1/30
Training - Loss: 98.3189
Training Metrics: {'accuracy': 0.9991286057692308, 'precision': 0.99799643713629, 'recall': 0.9973678879458567, 'f1': 0.9976819041764105}
Validation Metrics: {'accuracy': 0.9985633903986592, 'precision': 0.9962346804279112, 'recall': 0.9962346804279112, 'f1': 0.9962346804279112}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1473
Epoch 2/30, Step 20/1,Classification Loss: 0.3281, Contrastive Loss: 0.1529
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1341
Epoch 2/30, Step 60/1,Classification Loss: 0.3241, Contrastive Loss: 0.1409
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1248
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1215
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1185
Accuracy: 0.9994, Precision: 0.9980, Recall: 0.9987, F1: 0.9984
Accuracy: 0.9988, Precision: 0.9964, Recall: 0.9974, F1: 0.9969
Epoch 2/30
Training - Loss: 58.6746
Training Metrics: {'accuracy': 0.9993689903846154, 'precision': 0.9980441312862427, 'recall': 0.9986589281637965, 'f1': 0.9983512812323341}
Validation Metrics: {'accuracy': 0.998802825332216, 'precision': 0.9963761628445795, 'recall': 0.9973557566610951, 'f1': 0.9968653272848998}
Epoch 3/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1358
Epoch 3/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1940
Epoch 3/30, Step 40/1,Classification Loss: 0.3138, Contrastive Loss: 0.1128
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1096
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1068
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1044
Epoch 3/30, Step 120/1,Classification Loss: 0.3270, Contrastive Loss: 0.1093
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9984, F1: 0.9988
Accuracy: 0.9984, Precision: 0.9962, Recall: 0.9957, F1: 0.9959
Epoch 3/30
Training - Loss: 55.8113
Training Metrics: {'accuracy': 0.9995492788461539, 'precision': 0.9992479359296048, 'recall': 0.9983760156925252, 'f1': 0.9988114782601267}
Validation Metrics: {'accuracy': 0.9984436729318807, 'precision': 0.9961639534810267, 'recall': 0.9956741423113193, 'f1': 0.9959188895218299}
Epoch 4/30, Step 0/1,Classification Loss: 0.3139, Contrastive Loss: 0.1031
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0990
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0977
Epoch 4/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.1011
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0956
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0919
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0902
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9984, Precision: 0.9957, Recall: 0.9962, F1: 0.9959
Epoch 4/30
Training - Loss: 53.7410
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.9994331796358052, 'recall': 0.9987976042060895, 'f1': 0.9991151292095903}
Validation Metrics: {'accuracy': 0.9984436729318807, 'precision': 0.9956784823275461, 'recall': 0.9961676652824883, 'f1': 0.9959229157784688}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0896
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0881
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0868
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0851
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0841
Epoch 5/30, Step 100/1,Classification Loss: 0.3170, Contrastive Loss: 0.0845
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0812
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9987, F1: 0.9991
Accuracy: 0.9984, Precision: 0.9976, Recall: 0.9942, F1: 0.9959
Epoch 5/30
Training - Loss: 52.4148
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.9995651523433733, 'recall': 0.9986926780981732, 'f1': 0.9991284173907596}
Validation Metrics: {'accuracy': 0.9984436729318807, 'precision': 0.9976355614463519, 'recall': 0.9941935733978121, 'f1': 0.9959067554912799}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0807
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0792
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0801
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0771
Epoch 6/30, Step 80/1,Classification Loss: 0.3141, Contrastive Loss: 0.0765
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0750
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0739
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9984, Precision: 0.9957, Recall: 0.9962, F1: 0.9959
Epoch 6/30
Training - Loss: 51.3801
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9997228970874092, 'recall': 0.9988432792276953, 'f1': 0.9992825834566375}
Validation Metrics: {'accuracy': 0.9984436729318807, 'precision': 0.9956784823275461, 'recall': 0.9961676652824883, 'f1': 0.9959229157784688}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0734
Epoch 7/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0725
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0712
Epoch 7/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0722
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0697
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0683
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0674
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9982, F1: 0.9987
Accuracy: 0.9983, Precision: 0.9961, Recall: 0.9951, F1: 0.9956
Epoch 7/30
Training - Loss: 50.2329
Training Metrics: {'accuracy': 0.9994891826923077, 'precision': 0.9990904914989194, 'recall': 0.9982205467777815, 'f1': 0.9986550233855502}
Validation Metrics: {'accuracy': 0.9983239554651023, 'precision': 0.9960932359942006, 'recall': 0.9951136041947274, 'f1': 0.9956027862531928}
Epoch 8/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1494
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0660
Epoch 8/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0675
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0662
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0636
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0632
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0620
Accuracy: 0.9996, Precision: 0.9997, Recall: 0.9984, F1: 0.9991
Accuracy: 0.9983, Precision: 0.9961, Recall: 0.9951, F1: 0.9956
Epoch 8/30
Training - Loss: 49.6867
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9996741566113803, 'recall': 0.9984382324920229, 'f1': 0.9990551929962774}
Validation Metrics: {'accuracy': 0.9983239554651023, 'precision': 0.9960932359942006, 'recall': 0.9951136041947274, 'f1': 0.9956027862531928}
Epoch 9/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0617
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0607
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0599
Epoch 9/30, Step 60/1,Classification Loss: 0.3141, Contrastive Loss: 0.0614
Epoch 9/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1333
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0579
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0570
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9982, Precision: 0.9975, Recall: 0.9931, F1: 0.9953
Epoch 9/30
Training - Loss: 48.8681
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.9998657312611191, 'recall': 0.9988561624249357, 'f1': 0.9993602828964356}
Validation Metrics: {'accuracy': 0.9982042379983239, 'precision': 0.9974980329017088, 'recall': 0.9930724971646283, 'f1': 0.9952723372584311}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0567
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0561
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0571
Epoch 10/30, Step 60/1,Classification Loss: 0.3141, Contrastive Loss: 0.0583
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0540
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0537
Epoch 10/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0533
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9986, F1: 0.9992
Accuracy: 0.9981, Precision: 0.9969, Recall: 0.9930, F1: 0.9950
Epoch 10/30
Training - Loss: 48.4844
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.999832141538255, 'recall': 0.9985726520125606, 'f1': 0.9992013625676102}
Validation Metrics: {'accuracy': 0.9980845205315455, 'precision': 0.9969342361701368, 'recall': 0.9930054820192054, 'f1': 0.9949596616040018}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0527
Epoch 11/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0553
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0511
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0517
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0498
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0493
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0489
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9978, Precision: 0.9948, Recall: 0.9939, F1: 0.9943
Epoch 11/30
Training - Loss: 47.7792
Training Metrics: {'accuracy': 0.9998197115384615, 'precision': 0.9998991494940666, 'recall': 0.9991523029104267, 'f1': 0.9995253615163118}
Validation Metrics: {'accuracy': 0.9978450855979888, 'precision': 0.9948356461163462, 'recall': 0.9938584976706978, 'f1': 0.9943464394683907}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0487
Epoch 12/30, Step 20/1,Classification Loss: 0.3144, Contrastive Loss: 0.0593
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0474
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0470
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0462
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0456
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0450
Accuracy: 0.9996, Precision: 0.9997, Recall: 0.9984, F1: 0.9991
Accuracy: 0.9983, Precision: 0.9961, Recall: 0.9951, F1: 0.9956
Epoch 12/30
Training - Loss: 47.2192
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9996742902376312, 'recall': 0.9984399641711079, 'f1': 0.9990561278615484}
Validation Metrics: {'accuracy': 0.9983239554651023, 'precision': 0.9960932359942006, 'recall': 0.9951136041947274, 'f1': 0.9956027862531928}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0449
Epoch 13/30, Step 20/1,Classification Loss: 0.3144, Contrastive Loss: 0.0494
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0438
Epoch 13/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1914
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0429
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0422
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0417
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9983, Precision: 0.9966, Recall: 0.9946, F1: 0.9956
Epoch 13/30
Training - Loss: 46.9760
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9998488969477184, 'recall': 0.9987172177879133, 'f1': 0.9992822221281386}
Validation Metrics: {'accuracy': 0.9983239554651023, 'precision': 0.9965818715567543, 'recall': 0.9946200812235584, 'f1': 0.9955984354275098}
Epoch 14/30, Step 0/1,Classification Loss: 0.3315, Contrastive Loss: 0.0460
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0417
Epoch 14/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0550
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0400
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0406
Epoch 14/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0486
Epoch 14/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0400
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9984, Precision: 0.9981, Recall: 0.9937, F1: 0.9959
Epoch 14/30
Training - Loss: 46.5988
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9998487242410999, 'recall': 0.998729531338227, 'f1': 0.9992883082738143}
Validation Metrics: {'accuracy': 0.9984436729318807, 'precision': 0.9981312187216211, 'recall': 0.9937000504266431, 'f1': 0.9959026922906402}
Epoch 15/30, Step 0/1,Classification Loss: 0.3147, Contrastive Loss: 0.0389
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0380
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0376
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0374
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0369
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0358
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9982, Precision: 0.9975, Recall: 0.9931, F1: 0.9953
Epoch 15/30
Training - Loss: 45.9149
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.9998653787904284, 'recall': 0.9988811188811189, 'f1': 0.9993726131244942}
Validation Metrics: {'accuracy': 0.9982042379983239, 'precision': 0.9974980329017088, 'recall': 0.9930724971646283, 'f1': 0.9952723372584311}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0353
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0350
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0353
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0341
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0338
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Accuracy: 0.9992, Precision: 0.9973, Recall: 0.9986, F1: 0.9979
Accuracy: 0.9975, Precision: 0.9917, Recall: 0.9951, F1: 0.9934
Epoch 16/30
Training - Loss: 45.6882
Training Metrics: {'accuracy': 0.99921875, 'precision': 0.9973316629331161, 'recall': 0.9985680514399442, 'f1': 0.9979488531474907}
Validation Metrics: {'accuracy': 0.9974859331976536, 'precision': 0.9917440240818511, 'recall': 0.9951380211479364, 'f1': 0.9934333641612915}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0317
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0319
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0310
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9981, Precision: 0.9950, Recall: 0.9950, F1: 0.9950
Epoch 17/30
Training - Loss: 45.2490
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.99984876491346, 'recall': 0.9987266553480476, 'f1': 0.999286886956076}
Validation Metrics: {'accuracy': 0.9980845205315455, 'precision': 0.9949795739038816, 'recall': 0.9949795739038816, 'f1': 0.9949795739038816}
Epoch 18/30, Step 0/1,Classification Loss: 0.3257, Contrastive Loss: 0.0335
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 18/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0398
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0292
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9983, Precision: 0.9981, Recall: 0.9931, F1: 0.9956
Epoch 18/30
Training - Loss: 45.4915
Training Metrics: {'accuracy': 0.9997896634615384, 'precision': 0.9998823094253337, 'recall': 0.9990135287485907, 'f1': 0.9994474251173924}
Validation Metrics: {'accuracy': 0.9983239554651023, 'precision': 0.9980631078112769, 'recall': 0.993139512310051, 'f1': 0.9955853231379472}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0288
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Epoch 19/30, Step 40/1,Classification Loss: 0.3233, Contrastive Loss: 0.0312
Epoch 19/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0281
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0299
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9982, Precision: 0.9970, Recall: 0.9936, F1: 0.9953
Epoch 19/30
Training - Loss: 44.8058
Training Metrics: {'accuracy': 0.9997896634615384, 'precision': 0.9998824201296739, 'recall': 0.9990056818181818, 'f1': 0.9994435492342638}
Validation Metrics: {'accuracy': 0.9982042379983239, 'precision': 0.9970036373649984, 'recall': 0.9935660201357973, 'f1': 0.9952770255668615}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0273
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9978, Precision: 0.9944, Recall: 0.9944, F1: 0.9944
Epoch 20/30
Training - Loss: 44.4568
Training Metrics: {'accuracy': 0.9998197115384615, 'precision': 0.9998994098712446, 'recall': 0.9991334488734835, 'f1': 0.9995160485316072}
Validation Metrics: {'accuracy': 0.9978450855979888, 'precision': 0.9943520206418669, 'recall': 0.9943520206418669, 'f1': 0.9943520206418669}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0247
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9975, Precision: 0.9941, Recall: 0.9927, F1: 0.9934
Epoch 21/30
Training - Loss: 44.5155
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9992985056218131, 'recall': 0.9987999472867102, 'f1': 0.9990490638751053}
Validation Metrics: {'accuracy': 0.9974859331976536, 'precision': 0.994134274212508, 'recall': 0.992670406292091, 'f1': 0.9934009181223354}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Epoch 22/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.0237
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9976, Precision: 0.9952, Recall: 0.9922, F1: 0.9937
Epoch 22/30
Training - Loss: 44.2287
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.9998654874398897, 'recall': 0.998873556744579, 'f1': 0.9993688778915355}
Validation Metrics: {'accuracy': 0.997605650664432, 'precision': 0.9951791645467294, 'recall': 0.9922438984663449, 'f1': 0.99370582093637}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 23/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1262
Epoch 23/30, Step 80/1,Classification Loss: 0.3284, Contrastive Loss: 0.0248
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9988, F1: 0.9989
Accuracy: 0.9976, Precision: 0.9932, Recall: 0.9942, F1: 0.9937
Epoch 23/30
Training - Loss: 44.0339
Training Metrics: {'accuracy': 0.9995793269230769, 'precision': 0.9990145049821771, 'recall': 0.9987650615242702, 'f1': 0.9988897425518101}
Validation Metrics: {'accuracy': 0.997605650664432, 'precision': 0.9932445766911315, 'recall': 0.9942179903510211, 'f1': 0.9937306545697997}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 24/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0944
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9978, Precision: 0.9973, Recall: 0.9914, F1: 0.9943
Epoch 24/30
Training - Loss: 43.7449
Training Metrics: {'accuracy': 0.9997896634615384, 'precision': 0.9998825542767021, 'recall': 0.998995983935743, 'f1': 0.999438757677978}
Validation Metrics: {'accuracy': 0.9978450855979888, 'precision': 0.99729184153863, 'recall': 0.9913908828148525, 'f1': 0.9943183415606547}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 120/1,Classification Loss: 0.3277, Contrastive Loss: 0.0210
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9988, F1: 0.9992
Accuracy: 0.9981, Precision: 0.9955, Recall: 0.9945, F1: 0.9950
Epoch 25/30
Training - Loss: 43.7526
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.9995835409536379, 'recall': 0.9988405513723055, 'f1': 0.9992116845032523}
Validation Metrics: {'accuracy': 0.9980845205315455, 'precision': 0.9954644410552734, 'recall': 0.9944860509327126, 'f1': 0.9949746128607917}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 26/30, Step 100/1,Classification Loss: 0.3223, Contrastive Loss: 0.0237
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9971, Precision: 0.9910, Recall: 0.9939, F1: 0.9925
Epoch 26/30
Training - Loss: 43.8777
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.9993325874259051, 'recall': 0.9990833914660422, 'f1': 0.999207948835094}
Validation Metrics: {'accuracy': 0.9971267807973183, 'precision': 0.9910444851738494, 'recall': 0.9939499297693297, 'f1': 0.9924915841561909}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 27/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0195
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9987, F1: 0.9991
Accuracy: 0.9974, Precision: 0.9941, Recall: 0.9921, F1: 0.9931
Epoch 27/30
Training - Loss: 43.5070
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.9995629477008852, 'recall': 0.9986821693300847, 'f1': 0.9991220525377547}
Validation Metrics: {'accuracy': 0.9973662157308751, 'precision': 0.9940617023587552, 'recall': 0.9921098681754992, 'f1': 0.9930832556718011}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9995
Accuracy: 0.9978, Precision: 0.9953, Recall: 0.9934, F1: 0.9943
Epoch 28/30
Training - Loss: 43.5200
Training Metrics: {'accuracy': 0.9997896634615384, 'precision': 0.9998821429774052, 'recall': 0.9990250696378831, 'f1': 0.9994531236532985}
Validation Metrics: {'accuracy': 0.9978450855979888, 'precision': 0.9953217869577549, 'recall': 0.9933649746995288, 'f1': 0.9943408455496554}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Accuracy: 0.9996, Precision: 0.9998, Recall: 0.9983, F1: 0.9990
Accuracy: 0.9975, Precision: 0.9971, Recall: 0.9897, F1: 0.9934
Epoch 29/30
Training - Loss: 43.5106
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.999798630688683, 'recall': 0.9982837528604118, 'f1': 0.99903969621159}
Validation Metrics: {'accuracy': 0.9974859331976536, 'precision': 0.99708577138977, 'recall': 0.9897092684650768, 'f1': 0.9933614907881616}
Epoch 30/30, Step 0/1,Classification Loss: 0.3249, Contrastive Loss: 0.0198
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9987, F1: 0.9992
Accuracy: 0.9977, Precision: 0.9938, Recall: 0.9943, F1: 0.9940
Epoch 30/30
Training - Loss: 43.4005
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.9997055680755862, 'recall': 0.9986956593786227, 'f1': 0.9991999492198539}
Validation Metrics: {'accuracy': 0.9977253681312104, 'precision': 0.9937976786984859, 'recall': 0.994285005496444, 'f1': 0.9940411845993005}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (4186, 5814), y shape: (4186,), y distribution: Counter({np.float64(0.0): 3768, np.float64(1.0): 418}), env shape: (4186,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9759, Precision: 0.9721, Recall: 0.8909, F1: 0.9267
month: 2016-05, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (2835, 5814), y shape: (2835,), y distribution: Counter({np.float64(0.0): 2571, np.float64(1.0): 264}), env shape: (2835,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9799, Precision: 0.9785, Recall: 0.9005, F1: 0.9353
month: 2016-06, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (3136, 5814), y shape: (3136,), y distribution: Counter({np.float64(0.0): 2814, np.float64(1.0): 322}), env shape: (3136,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9710, Precision: 0.9660, Recall: 0.8724, F1: 0.9126
month: 2016-07, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5000, 5814), y shape: (5000,), y distribution: Counter({np.float64(0.0): 4475, np.float64(1.0): 525}), env shape: (5000,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9706, Precision: 0.9478, Recall: 0.8903, F1: 0.9165
month: 2016-08, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1578, 5814), y shape: (1578,), y distribution: Counter({np.float64(0.0): 1258, np.float64(1.0): 320}), env shape: (1578,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9195, Precision: 0.9250, Recall: 0.8190, F1: 0.8588
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7715]))
original train data shape: torch.Size([41862]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1578, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([41862]), new train data shape: torch.Size([41862])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7715]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.6066
Epoch 1/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.9222
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3394
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2176
Epoch 1/30, Step 80/1,Classification Loss: 0.3444, Contrastive Loss: 0.1991
Epoch 1/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.1591
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1438
Accuracy: 0.9993, Precision: 0.9979, Recall: 0.9985, F1: 0.9982
Accuracy: 0.9983, Precision: 0.9952, Recall: 0.9962, F1: 0.9957
Epoch 1/30
Training - Loss: 95.4479
Training Metrics: {'accuracy': 0.9993088942307692, 'precision': 0.9979129903549943, 'recall': 0.9985182083719855, 'f1': 0.9982153573790098}
Validation Metrics: {'accuracy': 0.9983279589155619, 'precision': 0.9952024124876866, 'recall': 0.9961602013507971, 'f1': 0.995680697490971}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1400
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1310
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1265
Epoch 2/30, Step 60/1,Classification Loss: 0.3296, Contrastive Loss: 0.1549
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1192
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1167
Epoch 2/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.1163
Accuracy: 0.9995, Precision: 0.9989, Recall: 0.9985, F1: 0.9987
Accuracy: 0.9987, Precision: 0.9973, Recall: 0.9959, F1: 0.9966
Epoch 2/30
Training - Loss: 58.0519
Training Metrics: {'accuracy': 0.9994891826923077, 'precision': 0.9988608977772924, 'recall': 0.9984966143764911, 'f1': 0.9986786685581865}
Validation Metrics: {'accuracy': 0.9986862534336558, 'precision': 0.9973213889390312, 'recall': 0.9958774575035925, 'f1': 0.9965980423165373}
Epoch 3/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.1183
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1103
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1080
Epoch 3/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.1064
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1031
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1023
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1020
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9988, F1: 0.9989
Accuracy: 0.9981, Precision: 0.9941, Recall: 0.9960, F1: 0.9951
Epoch 3/30
Training - Loss: 55.1429
Training Metrics: {'accuracy': 0.9995793269230769, 'precision': 0.9990332551048067, 'recall': 0.9987902471306387, 'f1': 0.9989117121939182}
Validation Metrics: {'accuracy': 0.9980890959034994, 'precision': 0.9941154529871119, 'recall': 0.9960262428779236, 'f1': 0.9950684181154501}
Epoch 4/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1710
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0966
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0964
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0947
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0951
Epoch 4/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0945
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0885
Accuracy: 0.9994, Precision: 0.9988, Recall: 0.9981, F1: 0.9984
Accuracy: 0.9983, Precision: 0.9957, Recall: 0.9957, F1: 0.9957
Epoch 4/30
Training - Loss: 53.5567
Training Metrics: {'accuracy': 0.9993990384615384, 'precision': 0.9988018940777237, 'recall': 0.9980665124240543, 'f1': 0.9984338474332666}
Validation Metrics: {'accuracy': 0.9983279589155619, 'precision': 0.9956765197942823, 'recall': 0.9956765197942823, 'f1': 0.9956765197942823}
Epoch 5/30, Step 0/1,Classification Loss: 0.3149, Contrastive Loss: 0.0884
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0869
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0852
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0837
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0827
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0811
Epoch 5/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0910
Accuracy: 0.9994, Precision: 0.9987, Recall: 0.9982, F1: 0.9984
Accuracy: 0.9981, Precision: 0.9951, Recall: 0.9951, F1: 0.9951
Epoch 5/30
Training - Loss: 52.2334
Training Metrics: {'accuracy': 0.9993990384615384, 'precision': 0.9986698678002658, 'recall': 0.9981748432187368, 'f1': 0.998422194728839}
Validation Metrics: {'accuracy': 0.9980890959034994, 'precision': 0.995058879764894, 'recall': 0.995058879764894, 'f1': 0.995058879764894}
Epoch 6/30, Step 0/1,Classification Loss: 0.3150, Contrastive Loss: 0.0856
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0781
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0777
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0760
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0750
Epoch 6/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0866
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0727
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9985, F1: 0.9989
Accuracy: 0.9981, Precision: 0.9941, Recall: 0.9960, F1: 0.9951
Epoch 6/30
Training - Loss: 51.0831
Training Metrics: {'accuracy': 0.9995793269230769, 'precision': 0.9992705732486771, 'recall': 0.9985321223743621, 'f1': 0.9989009897329061}
Validation Metrics: {'accuracy': 0.9980890959034994, 'precision': 0.9941154529871119, 'recall': 0.9960262428779236, 'f1': 0.9950684181154501}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0727
Epoch 7/30, Step 20/1,Classification Loss: 0.3274, Contrastive Loss: 0.0802
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0705
Epoch 7/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0696
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0684
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0675
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0666
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9979, Precision: 0.9944, Recall: 0.9944, F1: 0.9944
Epoch 7/30
Training - Loss: 50.2083
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9997269157654322, 'recall': 0.9988793872460133, 'f1': 0.9993026778532392}
Validation Metrics: {'accuracy': 0.9978502328914367, 'precision': 0.9944412397355058, 'recall': 0.9944412397355058, 'f1': 0.9944412397355058}
Epoch 8/30, Step 0/1,Classification Loss: 0.3202, Contrastive Loss: 0.0684
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0659
Epoch 8/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0825
Epoch 8/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0642
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0627
Epoch 8/30, Step 100/1,Classification Loss: 0.3164, Contrastive Loss: 0.0709
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0611
Accuracy: 0.9995, Precision: 0.9994, Recall: 0.9983, F1: 0.9988
Accuracy: 0.9980, Precision: 0.9945, Recall: 0.9950, F1: 0.9948
Epoch 8/30
Training - Loss: 49.9393
Training Metrics: {'accuracy': 0.9995492788461539, 'precision': 0.9993823713179772, 'recall': 0.9982919682739557, 'f1': 0.9988363853327593}
Validation Metrics: {'accuracy': 0.997969664397468, 'precision': 0.9945135992698948, 'recall': 0.9949919005284573, 'f1': 0.9947525976284075}
Epoch 9/30, Step 0/1,Classification Loss: 0.3217, Contrastive Loss: 0.0685
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0600
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0592
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0596
Epoch 9/30, Step 80/1,Classification Loss: 0.3140, Contrastive Loss: 0.0627
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0572
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0564
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9983, Precision: 0.9962, Recall: 0.9952, F1: 0.9957
Epoch 9/30
Training - Loss: 48.9425
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9997261697522644, 'recall': 0.9988726583336324, 'f1': 0.9992989346805491}
Validation Metrics: {'accuracy': 0.9983279589155619, 'precision': 0.9961530513508887, 'recall': 0.9951928382377675, 'f1': 0.9956723327301333}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0560
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0555
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0547
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0544
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0532
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0526
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0520
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9986, F1: 0.9990
Accuracy: 0.9983, Precision: 0.9966, Recall: 0.9947, F1: 0.9957
Epoch 10/30
Training - Loss: 48.1195
Training Metrics: {'accuracy': 0.999609375, 'precision': 0.999415309463553, 'recall': 0.9985647841892284, 'f1': 0.9989895700739074}
Validation Metrics: {'accuracy': 0.9983279589155619, 'precision': 0.9966320229811243, 'recall': 0.9947091566812526, 'f1': 0.9956681362675684}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0516
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0513
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0504
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0498
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0492
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0487
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0480
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9976, Precision: 0.9924, Recall: 0.9953, F1: 0.9938
Epoch 11/30
Training - Loss: 47.5723
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.999446325451912, 'recall': 0.9988337263339535, 'f1': 0.9991397792359302}
Validation Metrics: {'accuracy': 0.9976113698793742, 'precision': 0.9924191708253112, 'recall': 0.995274644375662, 'f1': 0.9938414641501574}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0472
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0466
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Epoch 12/30, Step 80/1,Classification Loss: 0.3142, Contrastive Loss: 0.0466
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0449
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0444
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9981, Precision: 0.9955, Recall: 0.9946, F1: 0.9951
Epoch 12/30
Training - Loss: 47.2236
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.9995873786914462, 'recall': 0.9988567315590651, 'f1': 0.9992217036614989}
Validation Metrics: {'accuracy': 0.9980890959034994, 'precision': 0.9955342136748271, 'recall': 0.9945751982083793, 'f1': 0.9950540945487238}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0441
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0437
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0436
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0426
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0424
Epoch 13/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0468
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0413
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9986, F1: 0.9990
Accuracy: 0.9981, Precision: 0.9960, Recall: 0.9941, F1: 0.9950
Epoch 13/30
Training - Loss: 46.7400
Training Metrics: {'accuracy': 0.999609375, 'precision': 0.9994181427954232, 'recall': 0.9985746384171252, 'f1': 0.9989959205349548}
Validation Metrics: {'accuracy': 0.9980890959034994, 'precision': 0.9960119822700793, 'recall': 0.9940915166518643, 'f1': 0.9950492985915068}
Epoch 14/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0443
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0404
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0400
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0395
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0391
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0386
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0381
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9987, F1: 0.9991
Accuracy: 0.9975, Precision: 0.9933, Recall: 0.9938, F1: 0.9935
Epoch 14/30
Training - Loss: 46.2653
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9994311621117702, 'recall': 0.9986998063393837, 'f1': 0.9990651320899815}
Validation Metrics: {'accuracy': 0.9974919383733429, 'precision': 0.9932795128387437, 'recall': 0.9937566204696808, 'f1': 0.9935179147174447}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0379
Epoch 15/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.2189
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0371
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0365
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0358
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0353
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9987, F1: 0.9991
Accuracy: 0.9976, Precision: 0.9929, Recall: 0.9948, F1: 0.9938
Epoch 15/30
Training - Loss: 45.8972
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9994359821055109, 'recall': 0.9987148162728838, 'f1': 0.9990750553660519}
Validation Metrics: {'accuracy': 0.9976113698793742, 'precision': 0.992884931468196, 'recall': 0.9947909628191473, 'f1': 0.9938355226443127}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 16/30, Step 20/1,Classification Loss: 0.3141, Contrastive Loss: 0.0352
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0344
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 16/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0388
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Epoch 16/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0473
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9987, F1: 0.9991
Accuracy: 0.9975, Precision: 0.9919, Recall: 0.9952, F1: 0.9935
Epoch 16/30
Training - Loss: 45.4782
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.9995722508123075, 'recall': 0.9987266037656961, 'f1': 0.999148955304394}
Validation Metrics: {'accuracy': 0.9974919383733429, 'precision': 0.9918804320588739, 'recall': 0.9952076651392253, 'f1': 0.993536651427961}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0326
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Epoch 17/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0327
Epoch 17/30, Step 60/1,Classification Loss: 0.3285, Contrastive Loss: 0.0377
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0312
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9984, Precision: 0.9962, Recall: 0.9957, F1: 0.9960
Epoch 17/30
Training - Loss: 45.2236
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9997276181861472, 'recall': 0.9988857343680532, 'f1': 0.9993062079785986}
Validation Metrics: {'accuracy': 0.9984473904215933, 'precision': 0.9962236006463405, 'recall': 0.995743499030719, 'f1': 0.9959833969039953}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0303
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0300
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0294
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9986, F1: 0.9992
Accuracy: 0.9982, Precision: 0.9951, Recall: 0.9956, F1: 0.9954
Epoch 18/30
Training - Loss: 44.9716
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.9998317234880356, 'recall': 0.9986021805982668, 'f1': 0.9992159595652255}
Validation Metrics: {'accuracy': 0.9982085274095306, 'precision': 0.9951306424854705, 'recall': 0.9956095405578456, 'f1': 0.995369939083889}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Epoch 19/30, Step 40/1,Classification Loss: 0.3249, Contrastive Loss: 0.0366
Epoch 19/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0349
Epoch 19/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.0278
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0268
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9982, Precision: 0.9956, Recall: 0.9951, F1: 0.9954
Epoch 19/30
Training - Loss: 44.7734
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9998483980729711, 'recall': 0.9987520798668885, 'f1': 0.9992994478513759}
Validation Metrics: {'accuracy': 0.9982085274095306, 'precision': 0.995605362464931, 'recall': 0.9951258590013308, 'f1': 0.9953654579661484}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 20/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1308
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 20/30, Step 120/1,Classification Loss: 0.3139, Contrastive Loss: 0.0268
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9975, Precision: 0.9914, Recall: 0.9957, F1: 0.9935
Epoch 20/30
Training - Loss: 44.3857
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.9997432903063795, 'recall': 0.9990133508009641, 'f1': 0.9993779697598354}
Validation Metrics: {'accuracy': 0.9974919383733429, 'precision': 0.9914187954282718, 'recall': 0.9956913466957402, 'f1': 0.9935428691565533}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 21/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0243
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9974, Precision: 0.9923, Recall: 0.9942, F1: 0.9932
Epoch 21/30
Training - Loss: 44.2942
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.9998651609640992, 'recall': 0.9988959425890147, 'f1': 0.9993799325395296}
Validation Metrics: {'accuracy': 0.9973725068673116, 'precision': 0.9922696707087382, 'recall': 0.9941733227897589, 'f1': 0.993219074908744}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9975, Precision: 0.9928, Recall: 0.9942, F1: 0.9935
Epoch 22/30
Training - Loss: 44.0508
Training Metrics: {'accuracy': 0.9997896634615384, 'precision': 0.9998824517212426, 'recall': 0.9990034168564921, 'f1': 0.9994424302948893}
Validation Metrics: {'accuracy': 0.9974919383733429, 'precision': 0.9928107754738902, 'recall': 0.9942403020261956, 'f1': 0.9935241742542311}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 23/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0233
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Accuracy: 0.9996, Precision: 0.9996, Recall: 0.9986, F1: 0.9991
Accuracy: 0.9977, Precision: 0.9944, Recall: 0.9939, F1: 0.9941
Epoch 23/30
Training - Loss: 43.8142
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9995558838422551, 'recall': 0.9985918825564324, 'f1': 0.9990732693109456}
Validation Metrics: {'accuracy': 0.9977308013854055, 'precision': 0.994368886102112, 'recall': 0.9938905789425543, 'f1': 0.9941295800904546}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 24/30, Step 40/1,Classification Loss: 0.3274, Contrastive Loss: 0.0319
Epoch 24/30, Step 60/1,Classification Loss: 0.3277, Contrastive Loss: 0.0334
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0213
Epoch 24/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0972
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9987, F1: 0.9992
Accuracy: 0.9980, Precision: 0.9945, Recall: 0.9950, F1: 0.9948
Epoch 24/30
Training - Loss: 44.0294
Training Metrics: {'accuracy': 0.9996694711538462, 'precision': 0.9995727472486633, 'recall': 0.9987289817474264, 'f1': 0.9991503942988078}
Validation Metrics: {'accuracy': 0.997969664397468, 'precision': 0.9945135992698948, 'recall': 0.9949919005284573, 'f1': 0.9947525976284075}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 25/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0227
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 25/30, Step 100/1,Classification Loss: 0.3262, Contrastive Loss: 0.0298
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9979, Precision: 0.9964, Recall: 0.9925, F1: 0.9944
Epoch 25/30
Training - Loss: 43.7675
Training Metrics: {'accuracy': 0.9997295673076924, 'precision': 0.9998483572030328, 'recall': 0.9987548422800221, 'f1': 0.9993008120666802}
Validation Metrics: {'accuracy': 0.9978502328914367, 'precision': 0.9963524242829742, 'recall': 0.9925065135094464, 'f1': 0.9944196336005933}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9995
Accuracy: 0.9977, Precision: 0.9948, Recall: 0.9934, F1: 0.9941
Epoch 26/30
Training - Loss: 43.6906
Training Metrics: {'accuracy': 0.9997896634615384, 'precision': 0.9998819720779659, 'recall': 0.9990366088631984, 'f1': 0.9994588189957199}
Validation Metrics: {'accuracy': 0.9977308013854055, 'precision': 0.9948436348678856, 'recall': 0.9934068973860394, 'f1': 0.9941238912740189}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9976, Precision: 0.9934, Recall: 0.9943, F1: 0.9938
Epoch 27/30
Training - Loss: 43.4479
Training Metrics: {'accuracy': 0.9997596153846153, 'precision': 0.9998652381914965, 'recall': 0.9988907376594565, 'f1': 0.9993773629291991}
Validation Metrics: {'accuracy': 0.9976113698793742, 'precision': 0.9933530692809803, 'recall': 0.9943072812626323, 'f1': 0.9938295678442443}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0203
Accuracy: 0.9996, Precision: 0.9996, Recall: 0.9986, F1: 0.9991
Accuracy: 0.9979, Precision: 0.9940, Recall: 0.9949, F1: 0.9944
Epoch 28/30
Training - Loss: 43.2925
Training Metrics: {'accuracy': 0.9996394230769231, 'precision': 0.9995534006465197, 'recall': 0.9985785714265005, 'f1': 0.9990653603592349}
Validation Metrics: {'accuracy': 0.9978502328914367, 'precision': 0.993969517016549, 'recall': 0.9949249212920206, 'f1': 0.9944466110598198}
Epoch 29/30, Step 0/1,Classification Loss: 0.3269, Contrastive Loss: 0.0233
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0201
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9976, Precision: 0.9929, Recall: 0.9948, F1: 0.9938
Epoch 29/30
Training - Loss: 43.3358
Training Metrics: {'accuracy': 0.9996995192307693, 'precision': 0.999587741466514, 'recall': 0.9988582626808094, 'f1': 0.9992226515670845}
Validation Metrics: {'accuracy': 0.9976113698793742, 'precision': 0.992884931468196, 'recall': 0.9947909628191473, 'f1': 0.9938355226443127}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 120/1,Classification Loss: 0.3213, Contrastive Loss: 0.0240
Accuracy: 0.9992, Precision: 0.9980, Recall: 0.9980, F1: 0.9980
Accuracy: 0.9975, Precision: 0.9938, Recall: 0.9933, F1: 0.9935
Epoch 30/30
Training - Loss: 43.2278
Training Metrics: {'accuracy': 0.99921875, 'precision': 0.9979949874686718, 'recall': 0.9979949874686718, 'f1': 0.9979949874686718}
Validation Metrics: {'accuracy': 0.9974919383733429, 'precision': 0.9937506479207026, 'recall': 0.993272938913166, 'f1': 0.9935116411526078}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (937, 5814), y shape: (937,), y distribution: Counter({np.float64(0.0): 688, np.float64(1.0): 249}), env shape: (937,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9114, Precision: 0.9390, Recall: 0.8372, F1: 0.8729
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7815]))
original train data shape: torch.Size([41962]), new train data shape: torch.Size([100])
original test data shape: torch.Size([937, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([41962]), new train data shape: torch.Size([41962])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7815]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3259, Contrastive Loss: 1.5033
Epoch 1/30, Step 20/1,Classification Loss: 0.3219, Contrastive Loss: 0.7225
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3463
Epoch 1/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.2587
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1914
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1671
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1505
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9984, F1: 0.9987
Accuracy: 0.9983, Precision: 0.9958, Recall: 0.9958, F1: 0.9958
Epoch 1/30
Training - Loss: 93.1531
Training Metrics: {'accuracy': 0.9994930820610687, 'precision': 0.9990103451759156, 'recall': 0.9984252101268807, 'f1': 0.9987175498550998}
Validation Metrics: {'accuracy': 0.9983319432860718, 'precision': 0.9957555878631097, 'recall': 0.9957555878631097, 'f1': 0.9957555878631097}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1448
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1361
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1289
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1239
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1197
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1169
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1136
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9986, F1: 0.9989
Accuracy: 0.9983, Precision: 0.9962, Recall: 0.9953, F1: 0.9958
Epoch 2/30
Training - Loss: 57.9796
Training Metrics: {'accuracy': 0.999582538167939, 'precision': 0.9992908913992615, 'recall': 0.9985812524521016, 'f1': 0.9989357380778292}
Validation Metrics: {'accuracy': 0.9983319432860718, 'precision': 0.9962211381172281, 'recall': 0.9952831838025298, 'f1': 0.995751573301215}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1124
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1101
Epoch 3/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1195
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1055
Epoch 3/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.1064
Epoch 3/30, Step 100/1,Classification Loss: 0.3141, Contrastive Loss: 0.1039
Epoch 3/30, Step 120/1,Classification Loss: 0.3251, Contrastive Loss: 0.1056
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9981, Precision: 0.9947, Recall: 0.9956, F1: 0.9952
Epoch 3/30
Training - Loss: 55.3022
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.999730541756825, 'recall': 0.9989018689389243, 'f1': 0.9993157505189992}
Validation Metrics: {'accuracy': 0.9980936494697963, 'precision': 0.994687164337871, 'recall': 0.9956216473327051, 'f1': 0.9951538212809201}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0985
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0970
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0951
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0936
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0921
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0908
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0901
Accuracy: 0.9996, Precision: 0.9996, Recall: 0.9986, F1: 0.9991
Accuracy: 0.9981, Precision: 0.9951, Recall: 0.9951, F1: 0.9951
Epoch 4/30
Training - Loss: 53.8449
Training Metrics: {'accuracy': 0.9996421755725191, 'precision': 0.9995634209405166, 'recall': 0.9986248915069624, 'f1': 0.9990935709840871}
Validation Metrics: {'accuracy': 0.9980936494697963, 'precision': 0.9951492432721253, 'recall': 0.9951492432721253, 'f1': 0.9951492432721253}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0892
Epoch 5/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0986
Epoch 5/30, Step 40/1,Classification Loss: 0.3185, Contrastive Loss: 0.0902
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0855
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0837
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0821
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0809
Accuracy: 0.9996, Precision: 0.9996, Recall: 0.9986, F1: 0.9991
Accuracy: 0.9976, Precision: 0.9930, Recall: 0.9949, F1: 0.9939
Epoch 5/30
Training - Loss: 52.5993
Training Metrics: {'accuracy': 0.9996421755725191, 'precision': 0.9995630201671322, 'recall': 0.9986227350304933, 'f1': 0.9990922905024424}
Validation Metrics: {'accuracy': 0.9976170618372453, 'precision': 0.9930192675470504, 'recall': 0.9948813622113163, 'f1': 0.9939479865752454}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0803
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0795
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0787
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0769
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0759
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0753
Epoch 6/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0750
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9988, F1: 0.9992
Accuracy: 0.9982, Precision: 0.9952, Recall: 0.9957, F1: 0.9955
Epoch 6/30
Training - Loss: 51.7430
Training Metrics: {'accuracy': 0.9996719942748091, 'precision': 0.9995787010703724, 'recall': 0.9987515761410044, 'f1': 0.9991646851045737}
Validation Metrics: {'accuracy': 0.998212796377934, 'precision': 0.9952208005173568, 'recall': 0.9956886175979074, 'f1': 0.995454562686471}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0735
Epoch 7/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0732
Epoch 7/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0798
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0708
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0696
Epoch 7/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0722
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0684
Accuracy: 0.9996, Precision: 0.9996, Recall: 0.9982, F1: 0.9989
Accuracy: 0.9981, Precision: 0.9951, Recall: 0.9951, F1: 0.9951
Epoch 7/30
Training - Loss: 50.7120
Training Metrics: {'accuracy': 0.999582538167939, 'precision': 0.9996470948157453, 'recall': 0.9982335697657305, 'f1': 0.9989390060736967}
Validation Metrics: {'accuracy': 0.9980936494697963, 'precision': 0.9951492432721253, 'recall': 0.9951492432721253, 'f1': 0.9951492432721253}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0674
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0666
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0658
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0651
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0642
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0634
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0626
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9979, Precision: 0.9945, Recall: 0.9945, F1: 0.9945
Epoch 8/30
Training - Loss: 50.0172
Training Metrics: {'accuracy': 0.9998807251908397, 'precision': 0.9999329039184112, 'recall': 0.9994640943193998, 'f1': 0.9996983531933672}
Validation Metrics: {'accuracy': 0.9978553556535208, 'precision': 0.9945428986811409, 'recall': 0.9945428986811409, 'f1': 0.9945428986811409}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0621
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0614
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0606
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0599
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0592
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0586
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0578
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9985, F1: 0.9992
Accuracy: 0.9980, Precision: 0.9955, Recall: 0.9941, F1: 0.9948
Epoch 9/30
Training - Loss: 49.1688
Training Metrics: {'accuracy': 0.9996719942748091, 'precision': 0.9998154362416107, 'recall': 0.9985321590605818, 'f1': 0.999172701753952}
Validation Metrics: {'accuracy': 0.9979745025616585, 'precision': 0.9955426875529969, 'recall': 0.9941374648857633, 'f1': 0.9948387547190355}
Epoch 10/30, Step 0/1,Classification Loss: 0.3209, Contrastive Loss: 0.0591
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0567
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0561
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0555
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0548
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0546
Epoch 10/30, Step 120/1,Classification Loss: 0.3250, Contrastive Loss: 0.0589
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9983, Precision: 0.9962, Recall: 0.9953, F1: 0.9958
Epoch 10/30
Training - Loss: 48.8669
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998825897349883, 'recall': 0.9990624162871685, 'f1': 0.9994720561735901}
Validation Metrics: {'accuracy': 0.9983319432860718, 'precision': 0.9962211381172281, 'recall': 0.9952831838025298, 'f1': 0.995751573301215}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0531
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0527
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0519
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0513
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0507
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0501
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0496
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9981, Precision: 0.9951, Recall: 0.9951, F1: 0.9951
Epoch 11/30
Training - Loss: 48.1127
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998657402745612, 'recall': 0.9989336177019461, 'f1': 0.9993991007816267}
Validation Metrics: {'accuracy': 0.9980936494697963, 'precision': 0.9951492432721253, 'recall': 0.9951492432721253, 'f1': 0.9951492432721253}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0493
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0487
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0481
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0475
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0484
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0465
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0460
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9980, Precision: 0.9955, Recall: 0.9941, F1: 0.9948
Epoch 12/30
Training - Loss: 47.5242
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.9998490490087552, 'recall': 0.9987948580610605, 'f1': 0.9993212150803302}
Validation Metrics: {'accuracy': 0.9979745025616585, 'precision': 0.9955426875529969, 'recall': 0.9941374648857633, 'f1': 0.9948387547190355}
Epoch 13/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0474
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0451
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0446
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0441
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0436
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0430
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0426
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9979, Precision: 0.9941, Recall: 0.9950, F1: 0.9945
Epoch 13/30
Training - Loss: 47.2573
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.999882570038584, 'recall': 0.9990636704119851, 'f1': 0.9994726745621973}
Validation Metrics: {'accuracy': 0.9978553556535208, 'precision': 0.9940819629953955, 'recall': 0.9950153027417208, 'f1': 0.9945480489410352}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0424
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0418
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0434
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0409
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0416
Epoch 14/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0401
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0395
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9977, Precision: 0.9936, Recall: 0.9949, F1: 0.9942
Epoch 14/30
Training - Loss: 46.8935
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998657808200793, 'recall': 0.9989310529128808, 'f1': 0.9993978359225706}
Validation Metrics: {'accuracy': 0.997736208745383, 'precision': 0.9935500440164309, 'recall': 0.9949483324765185, 'f1': 0.9942478764951447}
Epoch 15/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1481
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0388
Epoch 15/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0386
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0379
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0375
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0372
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0375
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9976, Precision: 0.9939, Recall: 0.9939, F1: 0.9939
Epoch 15/30
Training - Loss: 46.3757
Training Metrics: {'accuracy': 0.9996421755725191, 'precision': 0.9993275083277282, 'recall': 0.9988573662250908, 'f1': 0.9990922905024424}
Validation Metrics: {'accuracy': 0.9976170618372453, 'precision': 0.9939365540901566, 'recall': 0.9939365540901566, 'f1': 0.9939365540901566}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0356
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 16/30, Step 100/1,Classification Loss: 0.3141, Contrastive Loss: 0.0423
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9979, Precision: 0.9936, Recall: 0.9955, F1: 0.9946
Epoch 16/30
Training - Loss: 45.9434
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.9997318447932206, 'recall': 0.9989137005074793, 'f1': 0.9993223275733445}
Validation Metrics: {'accuracy': 0.9978553556535208, 'precision': 0.9936233306396519, 'recall': 0.9954877068023007, 'f1': 0.9945531879177208}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0327
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0318
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9980, Precision: 0.9946, Recall: 0.9951, F1: 0.9948
Epoch 17/30
Training - Loss: 45.6316
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998826802534106, 'recall': 0.9990566037735849, 'f1': 0.9994691897123027}
Validation Metrics: {'accuracy': 0.9979745025616585, 'precision': 0.9946150281774719, 'recall': 0.9950822730069231, 'f1': 0.9948485043780004}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Epoch 18/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0306
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9980, Precision: 0.9946, Recall: 0.9951, F1: 0.9948
Epoch 18/30
Training - Loss: 45.3068
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998658978141344, 'recall': 0.9989235737351991, 'f1': 0.9993941468107148}
Validation Metrics: {'accuracy': 0.9979745025616585, 'precision': 0.9946150281774719, 'recall': 0.9950822730069231, 'f1': 0.9948485043780004}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 19/30, Step 20/1,Classification Loss: 0.3144, Contrastive Loss: 0.0343
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0288
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9982, Precision: 0.9957, Recall: 0.9952, F1: 0.9955
Epoch 19/30
Training - Loss: 45.0845
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998656906856491, 'recall': 0.998936735778841, 'f1': 0.9994006383444693}
Validation Metrics: {'accuracy': 0.998212796377934, 'precision': 0.9956846120048444, 'recall': 0.9952162135373275, 'f1': 0.9954502660904984}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 20/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0270
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 20/30, Step 80/1,Classification Loss: 0.3213, Contrastive Loss: 0.0271
Epoch 20/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0265
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9974, Precision: 0.9943, Recall: 0.9924, F1: 0.9933
Epoch 20/30
Training - Loss: 44.8212
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.999865604945738, 'recall': 0.9989420788151282, 'f1': 0.9994032726569491}
Validation Metrics: {'accuracy': 0.9973787680209698, 'precision': 0.9942544464604537, 'recall': 0.9923854013780126, 'f1': 0.9933175784247021}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0265
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0247
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9976, Precision: 0.9939, Recall: 0.9939, F1: 0.9939
Epoch 21/30
Training - Loss: 44.6014
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.9998492007640495, 'recall': 0.9987850971922246, 'f1': 0.9993163987141191}
Validation Metrics: {'accuracy': 0.9976170618372453, 'precision': 0.9939365540901566, 'recall': 0.9939365540901566, 'f1': 0.9939365540901566}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Epoch 22/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0247
Epoch 22/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0238
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9974, Precision: 0.9947, Recall: 0.9919, F1: 0.9933
Epoch 22/30
Training - Loss: 44.4119
Training Metrics: {'accuracy': 0.9997018129770993, 'precision': 0.999832040041654, 'recall': 0.9986761980407731, 'f1': 0.9992532275462696}
Validation Metrics: {'accuracy': 0.9973787680209698, 'precision': 0.9947200638445782, 'recall': 0.9919129973174328, 'f1': 0.9933112420225823}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9976, Precision: 0.9963, Recall: 0.9916, F1: 0.9939
Epoch 23/30
Training - Loss: 44.1746
Training Metrics: {'accuracy': 0.9997018129770993, 'precision': 0.999832118994057, 'recall': 0.9986712729205421, 'f1': 0.9992507979305867}
Validation Metrics: {'accuracy': 0.9976170618372453, 'precision': 0.9962705083748913, 'recall': 0.9915745337872574, 'f1': 0.9939077520570501}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 24/30, Step 120/1,Classification Loss: 0.3210, Contrastive Loss: 0.0217
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9980, Precision: 0.9965, Recall: 0.9932, F1: 0.9948
Epoch 24/30
Training - Loss: 44.3031
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998826566533677, 'recall': 0.9990581270182992, 'f1': 0.9994699409697649}
Validation Metrics: {'accuracy': 0.9979745025616585, 'precision': 0.9964797182901926, 'recall': 0.9931926567646037, 'f1': 0.9948289620888527}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9976, Precision: 0.9939, Recall: 0.9939, F1: 0.9939
Epoch 25/30
Training - Loss: 43.9532
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9999161214561315, 'recall': 0.999330835117773, 'f1': 0.9996232507281122}
Validation Metrics: {'accuracy': 0.9976170618372453, 'precision': 0.9939365540901566, 'recall': 0.9939365540901566, 'f1': 0.9939365540901566}
Epoch 26/30, Step 0/1,Classification Loss: 0.3224, Contrastive Loss: 0.0217
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 26/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0215
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Accuracy: 0.9996, Precision: 0.9997, Recall: 0.9984, F1: 0.9990
Accuracy: 0.9977, Precision: 0.9945, Recall: 0.9940, F1: 0.9942
Epoch 26/30
Training - Loss: 43.8632
Training Metrics: {'accuracy': 0.999612356870229, 'precision': 0.9996635565461596, 'recall': 0.9983633690640228, 'f1': 0.9990123420431261}
Validation Metrics: {'accuracy': 0.997736208745383, 'precision': 0.9944707758051915, 'recall': 0.9940035243553589, 'f1': 0.9942370037146312}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 27/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0214
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9976, Precision: 0.9944, Recall: 0.9935, F1: 0.9939
Epoch 27/30
Training - Loss: 43.8315
Training Metrics: {'accuracy': 0.9996719942748091, 'precision': 0.9994607383980663, 'recall': 0.99887067371148, 'f1': 0.9991654751672703}
Validation Metrics: {'accuracy': 0.9976170618372453, 'precision': 0.9943986595057832, 'recall': 0.9934641500295767, 'f1': 0.9939308190017357}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9977, Precision: 0.9940, Recall: 0.9945, F1: 0.9942
Epoch 28/30
Training - Loss: 43.7777
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.999731876160197, 'recall': 0.9989139858354015, 'f1': 0.9993224861546364}
Validation Metrics: {'accuracy': 0.997736208745383, 'precision': 0.9940092558375868, 'recall': 0.9944759284159387, 'f1': 0.9942424460695298}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 29/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0317
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9986, F1: 0.9992
Accuracy: 0.9975, Precision: 0.9948, Recall: 0.9925, F1: 0.9936
Epoch 29/30
Training - Loss: 43.8921
Training Metrics: {'accuracy': 0.9996719942748091, 'precision': 0.999698260863436, 'recall': 0.9986466776290395, 'f1': 0.9991717337007544}
Validation Metrics: {'accuracy': 0.9974979149291076, 'precision': 0.994791574420369, 'recall': 0.9924523716432148, 'f1': 0.9936183023322074}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 30/30, Step 80/1,Classification Loss: 0.3273, Contrastive Loss: 0.0290
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9976, Precision: 0.9944, Recall: 0.9935, F1: 0.9939
Epoch 30/30
Training - Loss: 43.6791
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998658978141344, 'recall': 0.9989235737351991, 'f1': 0.9993941468107148}
Validation Metrics: {'accuracy': 0.9976170618372453, 'precision': 0.9943986595057832, 'recall': 0.9934641500295767, 'f1': 0.9939308190017357}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (387, 5814), y shape: (387,), y distribution: Counter({np.float64(1.0): 211, np.float64(0.0): 176}), env shape: (387,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8786, Precision: 0.8929, Recall: 0.8882, F1: 0.8785
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7915]))
original train data shape: torch.Size([42062]), new train data shape: torch.Size([100])
original test data shape: torch.Size([387, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42062]), new train data shape: torch.Size([42062])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7915]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 1.4024
Epoch 1/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.5847
Epoch 1/30, Step 40/1,Classification Loss: 0.3190, Contrastive Loss: 0.3085
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2105
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1760
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1565
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1450
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9975, Precision: 0.9931, Recall: 0.9944, F1: 0.9938
Epoch 1/30
Training - Loss: 85.7275
Training Metrics: {'accuracy': 0.9997018129770993, 'precision': 0.999831746138574, 'recall': 0.9986941760250718, 'f1': 0.9992620932218474}
Validation Metrics: {'accuracy': 0.9975038630690598, 'precision': 0.9930812358512522, 'recall': 0.9944445088767071, 'f1': 0.9937616155584157}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1403
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1338
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1293
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1245
Epoch 2/30, Step 80/1,Classification Loss: 0.3147, Contrastive Loss: 0.1223
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1176
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1146
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9980, Precision: 0.9956, Recall: 0.9943, F1: 0.9949
Epoch 2/30
Training - Loss: 57.9561
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998991867733047, 'recall': 0.9992071881606766, 'f1': 0.9995528678601597}
Validation Metrics: {'accuracy': 0.9979793177225722, 'precision': 0.9956229392222316, 'recall': 0.9942513770981778, 'f1': 0.9949358908876593}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1141
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1102
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1079
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1055
Epoch 3/30, Step 80/1,Classification Loss: 0.3281, Contrastive Loss: 0.1100
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1009
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0986
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9976, Precision: 0.9927, Recall: 0.9954, F1: 0.9941
Epoch 3/30
Training - Loss: 55.3421
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9999158702382556, 'recall': 0.9993464052287582, 'f1': 0.9996309204615436}
Validation Metrics: {'accuracy': 0.9976227267324379, 'precision': 0.9927102644675063, 'recall': 0.9954335048205862, 'f1': 0.9940668702440814}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0977
Epoch 4/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0993
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0940
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0922
Epoch 4/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0937
Epoch 4/30, Step 100/1,Classification Loss: 0.3181, Contrastive Loss: 0.0899
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0875
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9993
Accuracy: 0.9986, Precision: 0.9969, Recall: 0.9960, F1: 0.9964
Epoch 4/30
Training - Loss: 53.3405
Training Metrics: {'accuracy': 0.9997018129770993, 'precision': 0.9998319158234443, 'recall': 0.9986838641747828, 'f1': 0.999257008622422}
Validation Metrics: {'accuracy': 0.9985736360394627, 'precision': 0.9968858310449098, 'recall': 0.9959692669422042, 'f1': 0.996426984864482}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0860
Epoch 5/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.0992
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0831
Epoch 5/30, Step 60/1,Classification Loss: 0.3141, Contrastive Loss: 0.0823
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0805
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0802
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0779
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9982, Precision: 0.9953, Recall: 0.9958, F1: 0.9955
Epoch 5/30
Training - Loss: 52.1152
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998823094253337, 'recall': 0.9990799158780231, 'f1': 0.9994806820581223}
Validation Metrics: {'accuracy': 0.9982170450493284, 'precision': 0.9953117360622427, 'recall': 0.9957683561465974, 'f1': 0.9955399057299461}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0771
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0759
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0746
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0736
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0725
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0713
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0702
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9981, Precision: 0.9966, Recall: 0.9939, F1: 0.9952
Epoch 6/30
Training - Loss: 50.8771
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998990306946689, 'recall': 0.9992167101827676, 'f1': 0.999557558328855}
Validation Metrics: {'accuracy': 0.9980981813859503, 'precision': 0.996607170489274, 'recall': 0.9938573345240416, 'f1': 0.9952271649371073}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0699
Epoch 7/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0688
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0676
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0667
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0660
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0649
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0649
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9985, Precision: 0.9973, Recall: 0.9950, F1: 0.9961
Epoch 7/30
Training - Loss: 50.2137
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998822935934084, 'recall': 0.9990808823529411, 'f1': 0.9994811582677536}
Validation Metrics: {'accuracy': 0.9984547723760846, 'precision': 0.9972745287439813, 'recall': 0.9949802709983251, 'f1': 0.9961238649300771}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0635
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0630
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0618
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0609
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0602
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0612
Epoch 8/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0587
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9982, Precision: 0.9967, Recall: 0.9944, F1: 0.9955
Epoch 8/30
Training - Loss: 49.3178
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.9998486988097639, 'recall': 0.9988167236392322, 'f1': 0.9993319988759086}
Validation Metrics: {'accuracy': 0.9982170450493284, 'precision': 0.9966768177362944, 'recall': 0.9943853176285822, 'f1': 0.9955275364577811}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0581
Epoch 9/30, Step 20/1,Classification Loss: 0.3146, Contrastive Loss: 0.0577
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0579
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0560
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0576
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0544
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0537
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9977, Precision: 0.9932, Recall: 0.9955, F1: 0.9944
Epoch 9/30
Training - Loss: 48.8055
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.999848438920885, 'recall': 0.9988323819408407, 'f1': 0.9993397164809197}
Validation Metrics: {'accuracy': 0.997741590395816, 'precision': 0.9932283729736366, 'recall': 0.9955004750857884, 'f1': 0.9943609364062203}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0533
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0527
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0520
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0514
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0507
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0508
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0494
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9977, Precision: 0.9937, Recall: 0.9950, F1: 0.9944
Epoch 10/30
Training - Loss: 47.9982
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998822539949537, 'recall': 0.9990832896804609, 'f1': 0.9994823443403894}
Validation Metrics: {'accuracy': 0.997741590395816, 'precision': 0.993674548826844, 'recall': 0.99503946224645, 'f1': 0.9943557474099951}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0493
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0486
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0479
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0477
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0467
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0462
Epoch 11/30, Step 120/1,Classification Loss: 0.3280, Contrastive Loss: 0.0509
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9982, Precision: 0.9962, Recall: 0.9948, F1: 0.9955
Epoch 11/30
Training - Loss: 47.4705
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998821985123355, 'recall': 0.9990866388308977, 'f1': 0.999483994236567}
Validation Metrics: {'accuracy': 0.9982170450493284, 'precision': 0.9962195436050931, 'recall': 0.9948463304679206, 'f1': 0.9955316684302877}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0453
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0447
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0441
Epoch 12/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0456
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0431
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0426
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9981, Precision: 0.9957, Recall: 0.9948, F1: 0.9952
Epoch 12/30
Training - Loss: 47.1063
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998823133826497, 'recall': 0.999079673941625, 'f1': 0.9994805628461083}
Validation Metrics: {'accuracy': 0.9980981813859503, 'precision': 0.9956937253268265, 'recall': 0.9947793602027184, 'f1': 0.9952359798193093}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0418
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0412
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0408
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0404
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0394
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0389
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9979, Precision: 0.9942, Recall: 0.9951, F1: 0.9947
Epoch 13/30
Training - Loss: 46.7359
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998655868812796, 'recall': 0.9989431968295905, 'f1': 0.9994038238135463}
Validation Metrics: {'accuracy': 0.9978604540591941, 'precision': 0.9941953904205589, 'recall': 0.9951064325116523, 'f1': 0.9946503514290317}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0387
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0389
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0378
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0374
Epoch 14/30, Step 80/1,Classification Loss: 0.3273, Contrastive Loss: 0.0480
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9977, Precision: 0.9937, Recall: 0.9950, F1: 0.9944
Epoch 14/30
Training - Loss: 46.1465
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9997516002530609, 'recall': 0.999070518874623, 'f1': 0.9994107483327495}
Validation Metrics: {'accuracy': 0.997741590395816, 'precision': 0.993674548826844, 'recall': 0.99503946224645, 'f1': 0.9943557474099951}
Epoch 15/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0430
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9979, Precision: 0.9942, Recall: 0.9951, F1: 0.9947
Epoch 15/30
Training - Loss: 45.8740
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998655416988806, 'recall': 0.9989459815546773, 'f1': 0.9994051965225031}
Validation Metrics: {'accuracy': 0.9978604540591941, 'precision': 0.9941953904205589, 'recall': 0.9951064325116523, 'f1': 0.9946503514290317}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0317
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0311
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9981, Precision: 0.9952, Recall: 0.9952, F1: 0.9952
Epoch 16/30
Training - Loss: 45.5693
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998822539949537, 'recall': 0.9990832896804609, 'f1': 0.9994823443403894}
Validation Metrics: {'accuracy': 0.9980981813859503, 'precision': 0.9952403730420567, 'recall': 0.9952403730420567, 'f1': 0.9952403730420567}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Epoch 17/30, Step 60/1,Classification Loss: 0.3148, Contrastive Loss: 0.0322
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0295
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0292
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0288
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9982, Precision: 0.9962, Recall: 0.9948, F1: 0.9955
Epoch 17/30
Training - Loss: 45.1700
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9999159268227065, 'recall': 0.9993429697766097, 'f1': 0.9996292287789446}
Validation Metrics: {'accuracy': 0.9982170450493284, 'precision': 0.9962195436050931, 'recall': 0.9948463304679206, 'f1': 0.9955316684302877}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0294
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 18/30, Step 80/1,Classification Loss: 0.3141, Contrastive Loss: 0.0291
Epoch 18/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0274
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9981, Precision: 0.9961, Recall: 0.9943, F1: 0.9952
Epoch 18/30
Training - Loss: 44.8492
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.999848515451424, 'recall': 0.9988278197447251, 'f1': 0.9993374683130398}
Validation Metrics: {'accuracy': 0.9980981813859503, 'precision': 0.9961493197959743, 'recall': 0.99431834736338, 'f1': 0.9952315771276671}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 19/30, Step 20/1,Classification Loss: 0.3147, Contrastive Loss: 0.0270
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9980, Precision: 0.9956, Recall: 0.9943, F1: 0.9949
Epoch 19/30
Training - Loss: 44.6050
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998824359275805, 'recall': 0.9990721102863203, 'f1': 0.999476835306004}
Validation Metrics: {'accuracy': 0.9979793177225722, 'precision': 0.9956229392222316, 'recall': 0.9942513770981778, 'f1': 0.9949358908876593}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0237
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9980, Precision: 0.9956, Recall: 0.9943, F1: 0.9949
Epoch 20/30
Training - Loss: 44.4201
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.9998488360374886, 'recall': 0.9988082627118644, 'f1': 0.9993278269815105}
Validation Metrics: {'accuracy': 0.9979793177225722, 'precision': 0.9956229392222316, 'recall': 0.9942513770981778, 'f1': 0.9949358908876593}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 21/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0226
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9990, F1: 0.9993
Accuracy: 0.9979, Precision: 0.9942, Recall: 0.9951, F1: 0.9947
Epoch 21/30
Training - Loss: 44.3723
Training Metrics: {'accuracy': 0.9997018129770993, 'precision': 0.9994883583142622, 'recall': 0.9990313825282844, 'f1': 0.999259730560996}
Validation Metrics: {'accuracy': 0.9978604540591941, 'precision': 0.9941953904205589, 'recall': 0.9951064325116523, 'f1': 0.9946503514290317}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9981, Precision: 0.9961, Recall: 0.9943, F1: 0.9952
Epoch 22/30
Training - Loss: 44.1484
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998822500336428, 'recall': 0.999083529719822, 'f1': 0.9994824625992687}
Validation Metrics: {'accuracy': 0.9980981813859503, 'precision': 0.9961493197959743, 'recall': 0.99431834736338, 'f1': 0.9952315771276671}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 23/30, Step 20/1,Classification Loss: 0.3187, Contrastive Loss: 0.0226
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 23/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1251
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9982, Precision: 0.9962, Recall: 0.9948, F1: 0.9955
Epoch 23/30
Training - Loss: 43.9702
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998652971880788, 'recall': 0.9989607690309171, 'f1': 0.9994124834735794}
Validation Metrics: {'accuracy': 0.9982170450493284, 'precision': 0.9962195436050931, 'recall': 0.9948463304679206, 'f1': 0.9955316684302877}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 24/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0222
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0201
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9982, Precision: 0.9967, Recall: 0.9944, F1: 0.9955
Epoch 24/30
Training - Loss: 43.8191
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998655281382371, 'recall': 0.9989468141126909, 'f1': 0.9994056068979376}
Validation Metrics: {'accuracy': 0.9982170450493284, 'precision': 0.9966768177362944, 'recall': 0.9943853176285822, 'f1': 0.9955275364577811}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 25/30, Step 40/1,Classification Loss: 0.3225, Contrastive Loss: 0.0213
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9976, Precision: 0.9950, Recall: 0.9931, F1: 0.9940
Epoch 25/30
Training - Loss: 43.8455
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.9998486275565124, 'recall': 0.9988210636625623, 'f1': 0.9993341383852872}
Validation Metrics: {'accuracy': 0.9976227267324379, 'precision': 0.9949550056003441, 'recall': 0.9931284406238942, 'f1': 0.9940394714095839}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9996, F1: 0.9998
Accuracy: 0.9977, Precision: 0.9950, Recall: 0.9937, F1: 0.9943
Epoch 26/30
Training - Loss: 43.7305
Training Metrics: {'accuracy': 0.9999105438931297, 'precision': 0.9999494830431415, 'recall': 0.999609984399376, 'f1': 0.9997796563594538}
Validation Metrics: {'accuracy': 0.997741590395816, 'precision': 0.99502633483937, 'recall': 0.9936564237284349, 'f1': 0.9943401133450309}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 40/1,Classification Loss: 0.3312, Contrastive Loss: 0.0282
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9981, Precision: 0.9952, Recall: 0.9952, F1: 0.9952
Epoch 27/30
Training - Loss: 43.6149
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998653470679324, 'recall': 0.9989577905158937, 'f1': 0.9994110160580669}
Validation Metrics: {'accuracy': 0.9980981813859503, 'precision': 0.9952403730420567, 'recall': 0.9952403730420567, 'f1': 0.9952403730420567}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 60/1,Classification Loss: 0.3149, Contrastive Loss: 0.0182
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9980, Precision: 0.9952, Recall: 0.9947, F1: 0.9949
Epoch 28/30
Training - Loss: 43.5705
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998991935483871, 'recall': 0.9992067689053411, 'f1': 0.999552661287842}
Validation Metrics: {'accuracy': 0.9979793177225722, 'precision': 0.9951690185229385, 'recall': 0.9947123899375161, 'f1': 0.9949405637131998}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9979, Precision: 0.9956, Recall: 0.9937, F1: 0.9946
Epoch 29/30
Training - Loss: 43.8115
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.999882257955998, 'recall': 0.9990830495153262, 'f1': 0.9994822260183168}
Validation Metrics: {'accuracy': 0.9978604540591941, 'precision': 0.9955521626981592, 'recall': 0.9937233939936371, 'f1': 0.9946355242686256}
Epoch 30/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0174
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9975, Precision: 0.9935, Recall: 0.9940, F1: 0.9938
Epoch 30/30
Training - Loss: 43.5573
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998990918264379, 'recall': 0.9992130115424973, 'f1': 0.999555736673405}
Validation Metrics: {'accuracy': 0.9975038630690598, 'precision': 0.9935285198719199, 'recall': 0.9939834960373688, 'f1': 0.9937558680219246}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (261, 5814), y shape: (261,), y distribution: Counter({np.float64(1.0): 200, np.float64(0.0): 61}), env shape: (261,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8161, Precision: 0.7798, Recall: 0.8800, F1: 0.7906
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8015]))
original train data shape: torch.Size([42162]), new train data shape: torch.Size([100])
original test data shape: torch.Size([261, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42162]), new train data shape: torch.Size([42162])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8015]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.6065
Epoch 1/30, Step 20/1,Classification Loss: 0.3214, Contrastive Loss: 0.7580
Epoch 1/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.3066
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2050
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1678
Epoch 1/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.1497
Epoch 1/30, Step 120/1,Classification Loss: 0.3327, Contrastive Loss: 0.1407
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9973, Precision: 0.9939, Recall: 0.9926, F1: 0.9933
Epoch 1/30
Training - Loss: 92.3279
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998651927743327, 'recall': 0.9989669421487604, 'f1': 0.9994155242177513}
Validation Metrics: {'accuracy': 0.9972726194711253, 'precision': 0.993943014251437, 'recall': 0.9926084772859299, 'f1': 0.9932745331617399}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1296
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1225
Epoch 2/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.1181
Epoch 2/30, Step 60/1,Classification Loss: 0.3145, Contrastive Loss: 0.1151
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1098
Epoch 2/30, Step 100/1,Classification Loss: 0.3272, Contrastive Loss: 0.1165
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1043
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9977, Precision: 0.9951, Recall: 0.9938, F1: 0.9944
Epoch 2/30
Training - Loss: 56.2089
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9999156402901974, 'recall': 0.9993599590373784, 'f1': 0.9996375911478093}
Validation Metrics: {'accuracy': 0.9977469465196253, 'precision': 0.9951142453816022, 'recall': 0.9937765439797264, 'f1': 0.9944441795683938}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1031
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1010
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0989
Epoch 3/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0983
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0953
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0939
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0920
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9975, Precision: 0.9945, Recall: 0.9932, F1: 0.9939
Epoch 3/30
Training - Loss: 53.8472
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998988024962051, 'recall': 0.9992301770592764, 'f1': 0.9995641881147903}
Validation Metrics: {'accuracy': 0.9975097829953753, 'precision': 0.9945286298165197, 'recall': 0.9931925106328281, 'f1': 0.9938593563650668}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0911
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0895
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0881
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0866
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0851
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0838
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0827
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9977, Precision: 0.9951, Recall: 0.9938, F1: 0.9944
Epoch 4/30
Training - Loss: 52.4730
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998649697869899, 'recall': 0.9989798520785513, 'f1': 0.9994218809326925}
Validation Metrics: {'accuracy': 0.9977469465196253, 'precision': 0.9951142453816022, 'recall': 0.9937765439797264, 'f1': 0.9944441795683938}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0816
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0804
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0802
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0780
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0773
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0758
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0747
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9981, Precision: 0.9967, Recall: 0.9940, F1: 0.9953
Epoch 5/30
Training - Loss: 51.3981
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998818924208679, 'recall': 0.9991046303402404, 'f1': 0.9994928532023917}
Validation Metrics: {'accuracy': 0.9981026918060002, 'precision': 0.9966624618137334, 'recall': 0.9939774547753331, 'f1': 0.9953150754793395}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0740
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0731
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0722
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0709
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0700
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0690
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0680
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9972, Precision: 0.9939, Recall: 0.9921, F1: 0.9930
Epoch 6/30
Training - Loss: 50.3861
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998820675247658, 'recall': 0.9990944372574386, 'f1': 0.9994878350426701}
Validation Metrics: {'accuracy': 0.9971540377090004, 'precision': 0.9938708103441805, 'recall': 0.992091414204234, 'f1': 0.992978955460396}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0676
Epoch 7/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0679
Epoch 7/30, Step 40/1,Classification Loss: 0.3146, Contrastive Loss: 0.0663
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0649
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0640
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0632
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0624
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9977, Precision: 0.9956, Recall: 0.9933, F1: 0.9944
Epoch 7/30
Training - Loss: 49.6215
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998987410132649, 'recall': 0.9992337164750957, 'f1': 0.9995659297966}
Validation Metrics: {'accuracy': 0.9977469465196253, 'precision': 0.9955586410210958, 'recall': 0.9933264511632327, 'f1': 0.9944391639286246}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0619
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0612
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0603
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0596
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0588
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0581
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0573
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9975, Precision: 0.9945, Recall: 0.9932, F1: 0.9939
Epoch 8/30
Training - Loss: 48.9798
Training Metrics: {'accuracy': 0.9998807251908397, 'precision': 0.9999326122847805, 'recall': 0.9994819994819995, 'f1': 0.9997071693808844}
Validation Metrics: {'accuracy': 0.9975097829953753, 'precision': 0.9945286298165197, 'recall': 0.9931925106328281, 'f1': 0.9938593563650668}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0570
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0563
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0556
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0548
Epoch 9/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0553
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0537
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0528
Accuracy: 0.9999, Precision: 1.0000, Recall: 0.9997, F1: 0.9999
Accuracy: 0.9974, Precision: 0.9949, Recall: 0.9922, F1: 0.9936
Epoch 9/30
Training - Loss: 48.3598
Training Metrics: {'accuracy': 0.9999403625954199, 'precision': 0.9999662606700631, 'recall': 0.9997435239805078, 'f1': 0.9998548588576831}
Validation Metrics: {'accuracy': 0.9973912012332503, 'precision': 0.9949008382595752, 'recall': 0.9922253547346385, 'f1': 0.9935582287840918}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0521
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0512
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0508
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0499
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0494
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0487
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9977, Precision: 0.9960, Recall: 0.9929, F1: 0.9944
Epoch 10/30
Training - Loss: 47.7278
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9999156886550654, 'recall': 0.999357161223965, 'f1': 0.9996362146312587}
Validation Metrics: {'accuracy': 0.9977469465196253, 'precision': 0.996005202060752, 'recall': 0.9928763583467389, 'f1': 0.9944341376779668}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0485
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0472
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0467
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0461
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0455
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0456
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9977, Precision: 0.9956, Recall: 0.9933, F1: 0.9944
Epoch 11/30
Training - Loss: 47.2369
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998986657659179, 'recall': 0.9992379984759969, 'f1': 0.9995680364415669}
Validation Metrics: {'accuracy': 0.9977469465196253, 'precision': 0.9955586410210958, 'recall': 0.9933264511632327, 'f1': 0.9944391639286246}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0447
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0441
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0436
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0433
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0426
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0415
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9979, Precision: 0.9956, Recall: 0.9938, F1: 0.9947
Epoch 12/30
Training - Loss: 46.8433
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998987444309437, 'recall': 0.9992335206949412, 'f1': 0.9995658334654933}
Validation Metrics: {'accuracy': 0.9978655282817502, 'precision': 0.9956292459557858, 'recall': 0.9938435142449287, 'f1': 0.994734216595297}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0416
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0408
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 13/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0396
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0402
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9980, Precision: 0.9961, Recall: 0.9939, F1: 0.9950
Epoch 13/30
Training - Loss: 46.2927
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9999156630570455, 'recall': 0.9993586454592098, 'f1': 0.9996369449016536}
Validation Metrics: {'accuracy': 0.9979841100438752, 'precision': 0.9961453169859006, 'recall': 0.9939104845101309, 'f1': 0.9950245150940326}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0382
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0379
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0369
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0356
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9981, Precision: 0.9967, Recall: 0.9940, F1: 0.9953
Epoch 14/30
Training - Loss: 45.9619
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998988570850612, 'recall': 0.9992270033496522, 'f1': 0.9995626261088634}
Validation Metrics: {'accuracy': 0.9981026918060002, 'precision': 0.9966624618137334, 'recall': 0.9939774547753331, 'f1': 0.9953150754793395}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0350
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 15/30, Step 80/1,Classification Loss: 0.3143, Contrastive Loss: 0.0349
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9979, Precision: 0.9961, Recall: 0.9934, F1: 0.9947
Epoch 15/30
Training - Loss: 45.7477
Training Metrics: {'accuracy': 0.9997316316793893, 'precision': 0.9997357642343305, 'recall': 0.9989495539574009, 'f1': 0.9993422429115295}
Validation Metrics: {'accuracy': 0.9978655282817502, 'precision': 0.9960752539623474, 'recall': 0.9933934214284349, 'f1': 0.9947294599142569}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0325
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0322
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0314
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0309
Accuracy: 0.9999, Precision: 0.9997, Recall: 0.9996, F1: 0.9996
Accuracy: 0.9977, Precision: 0.9951, Recall: 0.9938, F1: 0.9944
Epoch 16/30
Training - Loss: 45.2997
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9996941228605275, 'recall': 0.9995834849062182, 'f1': 0.9996387956052187}
Validation Metrics: {'accuracy': 0.9977469465196253, 'precision': 0.9951142453816022, 'recall': 0.9937765439797264, 'f1': 0.9944441795683938}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0303
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0299
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 17/30, Step 100/1,Classification Loss: 0.3141, Contrastive Loss: 0.0294
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9976, Precision: 0.9950, Recall: 0.9933, F1: 0.9941
Epoch 17/30
Training - Loss: 44.9893
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998650153545035, 'recall': 0.9989772436716953, 'f1': 0.9994205968507237}
Validation Metrics: {'accuracy': 0.9976283647575003, 'precision': 0.9950431007519174, 'recall': 0.9932594808980304, 'f1': 0.9941491295503301}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0270
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9980, Precision: 0.9966, Recall: 0.9935, F1: 0.9950
Epoch 18/30
Training - Loss: 44.7933
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9999156232069932, 'recall': 0.9993609406952966, 'f1': 0.9996380740621471}
Validation Metrics: {'accuracy': 0.9979841100438752, 'precision': 0.9965929429278737, 'recall': 0.9934603916936371, 'f1': 0.9950200179223914}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9979, Precision: 0.9956, Recall: 0.9938, F1: 0.9947
Epoch 19/30
Training - Loss: 44.5697
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998651154948575, 'recall': 0.998971457958344, 'f1': 0.9994177481344861}
Validation Metrics: {'accuracy': 0.9978655282817502, 'precision': 0.9956292459557858, 'recall': 0.9938435142449287, 'f1': 0.994734216595297}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 20/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0251
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0238
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Accuracy: 0.9996, Precision: 0.9998, Recall: 0.9983, F1: 0.9991
Accuracy: 0.9981, Precision: 0.9967, Recall: 0.9940, F1: 0.9953
Epoch 20/30
Training - Loss: 44.5224
Training Metrics: {'accuracy': 0.999612356870229, 'precision': 0.9997809234917425, 'recall': 0.9983243103892756, 'f1': 0.9990511866135935}
Validation Metrics: {'accuracy': 0.9981026918060002, 'precision': 0.9966624618137334, 'recall': 0.9939774547753331, 'f1': 0.9953150754793395}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0328
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9976, Precision: 0.9950, Recall: 0.9933, F1: 0.9941
Epoch 21/30
Training - Loss: 44.2993
Training Metrics: {'accuracy': 0.9998807251908397, 'precision': 0.9999324643749579, 'recall': 0.999490575649516, 'f1': 0.9997113879088333}
Validation Metrics: {'accuracy': 0.9976283647575003, 'precision': 0.9950431007519174, 'recall': 0.9932594808980304, 'f1': 0.9941491295503301}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9977, Precision: 0.9960, Recall: 0.9929, F1: 0.9944
Epoch 22/30
Training - Loss: 44.1125
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998649834604739, 'recall': 0.9989790709545687, 'f1': 0.9994214964109007}
Validation Metrics: {'accuracy': 0.9977469465196253, 'precision': 0.996005202060752, 'recall': 0.9928763583467389, 'f1': 0.9944341376779668}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0333
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9974, Precision: 0.9936, Recall: 0.9936, F1: 0.9936
Epoch 23/30
Training - Loss: 44.0304
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998818166469694, 'recall': 0.9991089613034623, 'f1': 0.9994949846617232}
Validation Metrics: {'accuracy': 0.9973912012332503, 'precision': 0.9935756331841197, 'recall': 0.9935756331841197, 'f1': 0.9935756331841197}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 24/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0259
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 80/1,Classification Loss: 0.3152, Contrastive Loss: 0.0205
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0198
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9975, Precision: 0.9954, Recall: 0.9923, F1: 0.9938
Epoch 24/30
Training - Loss: 43.7510
Training Metrics: {'accuracy': 0.9998807251908397, 'precision': 0.9999325031217305, 'recall': 0.9994883601944231, 'f1': 0.9997102984253619}
Validation Metrics: {'accuracy': 0.9975097829953753, 'precision': 0.9954174611936304, 'recall': 0.9922923249998408, 'f1': 0.9938482574335423}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 25/30, Step 80/1,Classification Loss: 0.3202, Contrastive Loss: 0.0200
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9976, Precision: 0.9955, Recall: 0.9928, F1: 0.9941
Epoch 25/30
Training - Loss: 43.6615
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9999156545209177, 'recall': 0.9993591386823891, 'f1': 0.999637187560973}
Validation Metrics: {'accuracy': 0.9976283647575003, 'precision': 0.9954880461109613, 'recall': 0.9928093880815367, 'f1': 0.9941438443491744}
Epoch 26/30, Step 0/1,Classification Loss: 0.3147, Contrastive Loss: 0.0202
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9977, Precision: 0.9965, Recall: 0.9924, F1: 0.9944
Epoch 26/30
Training - Loss: 43.5603
Training Metrics: {'accuracy': 0.9997614503816794, 'precision': 0.9998650836481382, 'recall': 0.9989733059548255, 'f1': 0.999418658107036}
Validation Metrics: {'accuracy': 0.9977469465196253, 'precision': 0.9964539418102094, 'recall': 0.9924262655302452, 'f1': 0.9944291007834278}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9977, Precision: 0.9960, Recall: 0.9929, F1: 0.9944
Epoch 27/30
Training - Loss: 43.4781
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998987341772152, 'recall': 0.9992341077355118, 'f1': 0.9995661223081755}
Validation Metrics: {'accuracy': 0.9977469465196253, 'precision': 0.996005202060752, 'recall': 0.9928763583467389, 'f1': 0.9944341376779668}
Epoch 28/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0287
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9975, Precision: 0.9950, Recall: 0.9927, F1: 0.9939
Epoch 28/30
Training - Loss: 43.5402
Training Metrics: {'accuracy': 0.9998210877862596, 'precision': 0.9998986794555709, 'recall': 0.9992372234935164, 'f1': 0.999567655205026}
Validation Metrics: {'accuracy': 0.9975097829953753, 'precision': 0.9949719650562912, 'recall': 0.9927424178163344, 'f1': 0.9938538127632167}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9973, Precision: 0.9944, Recall: 0.9922, F1: 0.9933
Epoch 29/30
Training - Loss: 43.3664
Training Metrics: {'accuracy': 0.9998509064885496, 'precision': 0.9999156345965646, 'recall': 0.9993602865916069, 'f1': 0.9996377522874227}
Validation Metrics: {'accuracy': 0.9972726194711253, 'precision': 0.9943852890914864, 'recall': 0.9921583844694362, 'f1': 0.9932684615978088}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 100/1,Classification Loss: 0.3278, Contrastive Loss: 0.0214
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9974, Precision: 0.9962, Recall: 0.9909, F1: 0.9935
Epoch 30/30
Training - Loss: 43.4459
Training Metrics: {'accuracy': 0.9997912690839694, 'precision': 0.9998820039107275, 'recall': 0.9990981705745942, 'f1': 0.9994896732650862}
Validation Metrics: {'accuracy': 0.9973912012332503, 'precision': 0.996245531394709, 'recall': 0.9908750762851573, 'f1': 0.9935407136347533}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5764, 5814), y shape: (5764,), y distribution: Counter({np.float64(0.0): 4772, np.float64(1.0): 992}), env shape: (5764,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9264, Precision: 0.9423, Recall: 0.7955, F1: 0.8466
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8115]))
original train data shape: torch.Size([42262]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5764, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42262]), new train data shape: torch.Size([42262])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8115]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.6375
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 1.1410
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.5218
Epoch 1/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.2855
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2039
Epoch 1/30, Step 100/1,Classification Loss: 0.3138, Contrastive Loss: 0.1755
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1561
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9993, F1: 0.9992
Accuracy: 0.9972, Precision: 0.9927, Recall: 0.9935, F1: 0.9931
Epoch 1/30
Training - Loss: 108.9309
Training Metrics: {'accuracy': 0.9996448863636364, 'precision': 0.9990428088223231, 'recall': 0.9992584312277975, 'f1': 0.9991505883672853}
Validation Metrics: {'accuracy': 0.9971607713237903, 'precision': 0.9926645395990745, 'recall': 0.9935347357555009, 'f1': 0.993099118633441}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1488
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1409
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1351
Epoch 2/30, Step 60/1,Classification Loss: 0.3286, Contrastive Loss: 0.1446
Epoch 2/30, Step 80/1,Classification Loss: 0.3153, Contrastive Loss: 0.1314
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1224
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1191
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9968, Precision: 0.9916, Recall: 0.9929, F1: 0.9922
Epoch 2/30
Training - Loss: 59.0367
Training Metrics: {'accuracy': 0.9997336647727273, 'precision': 0.9994163290962776, 'recall': 0.9993083295219344, 'f1': 0.9993623213742976}
Validation Metrics: {'accuracy': 0.9968058677392642, 'precision': 0.9915899735713407, 'recall': 0.9928922199479504, 'f1': 0.9922399318376389}
Epoch 3/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.1190
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1143
Epoch 3/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.1124
Epoch 3/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1423
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1063
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1046
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1019
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9974, Precision: 0.9958, Recall: 0.9915, F1: 0.9936
Epoch 3/30
Training - Loss: 56.1499
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9997565532485758, 'recall': 0.9991018432139095, 'f1': 0.9994289076560986}
Validation Metrics: {'accuracy': 0.9973973737134745, 'precision': 0.9958472335958581, 'recall': 0.9914600415905739, 'f1': 0.9936404921654322}
Epoch 4/30, Step 0/1,Classification Loss: 0.3232, Contrastive Loss: 0.1096
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0984
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0967
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0948
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0928
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0910
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0897
Accuracy: 0.9998, Precision: 0.9996, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9974, Precision: 0.9941, Recall: 0.9932, F1: 0.9937
Epoch 4/30
Training - Loss: 54.1649
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9996497737804005, 'recall': 0.9992186636865763, 'f1': 0.9994340922256175}
Validation Metrics: {'accuracy': 0.9973973737134745, 'precision': 0.9941001621821024, 'recall': 0.9932268919693694, 'f1': 0.9936630054404525}
Epoch 5/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0907
Epoch 5/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0876
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0865
Epoch 5/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.1001
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0826
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0812
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0801
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9973, Precision: 0.9953, Recall: 0.9914, F1: 0.9934
Epoch 5/30
Training - Loss: 52.6976
Training Metrics: {'accuracy': 0.999704071969697, 'precision': 0.9997223799289154, 'recall': 0.9988437166575646, 'f1': 0.9992825259265855}
Validation Metrics: {'accuracy': 0.9972790725186325, 'precision': 0.9953369091224079, 'recall': 0.99139310718629, 'f1': 0.9933543764349804}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0792
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0780
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0769
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0758
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0746
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0734
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0723
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9996, F1: 0.9998
Accuracy: 0.9967, Precision: 0.9915, Recall: 0.9924, F1: 0.9919
Epoch 6/30
Training - Loss: 51.4831
Training Metrics: {'accuracy': 0.9999112215909091, 'precision': 0.9999496610510772, 'recall': 0.9996247185389042, 'f1': 0.999787118083398}
Validation Metrics: {'accuracy': 0.9966875665444221, 'precision': 0.9915154065127963, 'recall': 0.9923835729489678, 'f1': 0.9919489717390144}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0721
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0706
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0698
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0689
Epoch 7/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0691
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0668
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0660
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9973, Precision: 0.9953, Recall: 0.9914, F1: 0.9934
Epoch 7/30
Training - Loss: 50.6324
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.9999161552134688, 'recall': 0.9993718592964824, 'f1': 0.9996438063353374}
Validation Metrics: {'accuracy': 0.9972790725186325, 'precision': 0.9953369091224079, 'recall': 0.99139310718629, 'f1': 0.9933543764349804}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0655
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0645
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0637
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0628
Epoch 8/30, Step 80/1,Classification Loss: 0.3199, Contrastive Loss: 0.0638
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0612
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0604
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9970, Precision: 0.9939, Recall: 0.9917, F1: 0.9928
Epoch 8/30
Training - Loss: 49.7842
Training Metrics: {'accuracy': 0.9998816287878788, 'precision': 0.9999328859060403, 'recall': 0.9994994994994995, 'f1': 0.9997160651373731}
Validation Metrics: {'accuracy': 0.9970424701289483, 'precision': 0.9938841810807668, 'recall': 0.9917009509724214, 'f1': 0.992789301039047}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0616
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0592
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0584
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0577
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0570
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0563
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0556
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9969, Precision: 0.9934, Recall: 0.9916, F1: 0.9925
Epoch 9/30
Training - Loss: 49.2141
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998993119650947, 'recall': 0.9992505620784411, 'f1': 0.9995746509129968}
Validation Metrics: {'accuracy': 0.9969241689341062, 'precision': 0.993378543745659, 'recall': 0.9916340165681377, 'f1': 0.9925041937061121}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0552
Epoch 10/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0551
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0539
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0532
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0518
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0513
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9968, Precision: 0.9933, Recall: 0.9911, F1: 0.9922
Epoch 10/30
Training - Loss: 48.6777
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9997753222616856, 'recall': 0.9992409864490082, 'f1': 0.999507959479919}
Validation Metrics: {'accuracy': 0.9968058677392642, 'precision': 0.9933060440048971, 'recall': 0.9911253695691549, 'f1': 0.9922124451221708}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0509
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0503
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0496
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0490
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0485
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0491
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0473
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9969, Precision: 0.9934, Recall: 0.9916, F1: 0.9925
Epoch 11/30
Training - Loss: 47.9520
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.9999161130125496, 'recall': 0.9993742177722152, 'f1': 0.9996449659492697}
Validation Metrics: {'accuracy': 0.9969241689341062, 'precision': 0.993378543745659, 'recall': 0.9916340165681377, 'f1': 0.9925041937061121}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0470
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0459
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0453
Epoch 12/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0575
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0443
Epoch 12/30, Step 120/1,Classification Loss: 0.3175, Contrastive Loss: 0.0445
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9970, Precision: 0.9935, Recall: 0.9921, F1: 0.9928
Epoch 12/30
Training - Loss: 47.4797
Training Metrics: {'accuracy': 0.9998816287878788, 'precision': 0.9999328904100395, 'recall': 0.99949924887331, 'f1': 0.9997159419510161}
Validation Metrics: {'accuracy': 0.9970424701289483, 'precision': 0.9934510496290045, 'recall': 0.9921426635671202, 'f1': 0.9927956835397163}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0434
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0429
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0424
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0419
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0414
Epoch 13/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0412
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0405
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9970, Precision: 0.9930, Recall: 0.9926, F1: 0.9928
Epoch 13/30
Training - Loss: 47.0019
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.999899372756851, 'recall': 0.9992471769134254, 'f1': 0.9995729861869186}
Validation Metrics: {'accuracy': 0.9970424701289483, 'precision': 0.993019989580894, 'recall': 0.9925843761618192, 'f1': 0.9928020527901689}
Epoch 14/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0431
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 14/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0399
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0389
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0384
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0379
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0375
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9973, Precision: 0.9953, Recall: 0.9914, F1: 0.9934
Epoch 14/30
Training - Loss: 46.6624
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.9999161552134688, 'recall': 0.9993718592964824, 'f1': 0.9996438063353374}
Validation Metrics: {'accuracy': 0.9972790725186325, 'precision': 0.9953369091224079, 'recall': 0.99139310718629, 'f1': 0.9933543764349804}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0368
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0362
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0359
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9974, Precision: 0.9950, Recall: 0.9923, F1: 0.9937
Epoch 15/30
Training - Loss: 46.2642
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998992274101444, 'recall': 0.9992552135054618, 'f1': 0.9995769378195496}
Validation Metrics: {'accuracy': 0.9973973737134745, 'precision': 0.9949695045982696, 'recall': 0.9923434667799718, 'f1': 0.9936517722303695}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0343
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0338
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Epoch 16/30, Step 80/1,Classification Loss: 0.3181, Contrastive Loss: 0.0399
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9978, Precision: 0.9952, Recall: 0.9939, F1: 0.9945
Epoch 16/30
Training - Loss: 45.8604
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9997750211210281, 'recall': 0.9992389672888179, 'f1': 0.9995067982861766}
Validation Metrics: {'accuracy': 0.9977522772980008, 'precision': 0.9951823844752674, 'recall': 0.9938694077769199, 'f1': 0.9945247194901843}
Epoch 17/30, Step 0/1,Classification Loss: 0.3146, Contrastive Loss: 0.0332
Epoch 17/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0463
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0314
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0311
Epoch 17/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0344
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0304
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9972, Precision: 0.9944, Recall: 0.9918, F1: 0.9931
Epoch 17/30
Training - Loss: 45.6282
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9997909994838804, 'recall': 0.9993583726185871, 'f1': 0.9995745588295171}
Validation Metrics: {'accuracy': 0.9971607713237903, 'precision': 0.994390853186697, 'recall': 0.9917678853767051, 'f1': 0.9930746606149485}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0304
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9972, Precision: 0.9953, Recall: 0.9909, F1: 0.9931
Epoch 18/30
Training - Loss: 45.3548
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998826802534106, 'recall': 0.9991174987392839, 'f1': 0.9994996928653874}
Validation Metrics: {'accuracy': 0.9971607713237903, 'precision': 0.995266514061478, 'recall': 0.9908844601873075, 'f1': 0.9930623550895623}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0280
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0263
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9973, Precision: 0.9953, Recall: 0.9914, F1: 0.9934
Epoch 19/30
Training - Loss: 45.0656
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998993997518527, 'recall': 0.9992456625597184, 'f1': 0.9995722413678041}
Validation Metrics: {'accuracy': 0.9972790725186325, 'precision': 0.9953369091224079, 'recall': 0.99139310718629, 'f1': 0.9933543764349804}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Accuracy: 0.9998, Precision: 0.9996, Recall: 0.9995, F1: 0.9995
Accuracy: 0.9967, Precision: 0.9924, Recall: 0.9915, F1: 0.9919
Epoch 20/30
Training - Loss: 44.8577
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9995609518168089, 'recall': 0.9994539287435165, 'f1': 0.9995074324662214}
Validation Metrics: {'accuracy': 0.9966875665444221, 'precision': 0.9923703607296667, 'recall': 0.99150014775957, 'f1': 0.9919347341969396}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0238
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9968, Precision: 0.9937, Recall: 0.9907, F1: 0.9922
Epoch 21/30
Training - Loss: 44.7809
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998993693814571, 'recall': 0.9992473657802308, 'f1': 0.9995730790746109}
Validation Metrics: {'accuracy': 0.9968058677392642, 'precision': 0.9937402296002824, 'recall': 0.9906836569744559, 'f1': 0.9922055376674972}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 22/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0225
Epoch 22/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0224
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9973, Precision: 0.9945, Recall: 0.9923, F1: 0.9934
Epoch 22/30
Training - Loss: 44.5610
Training Metrics: {'accuracy': 0.9998816287878788, 'precision': 0.9999328678839957, 'recall': 0.9995004995004995, 'f1': 0.9997165566260173}
Validation Metrics: {'accuracy': 0.9972790725186325, 'precision': 0.9944623181566367, 'recall': 0.9922765323756879, 'f1': 0.9933661569559231}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9974, Precision: 0.9950, Recall: 0.9923, F1: 0.9937
Epoch 23/30
Training - Loss: 44.2488
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.9999161101976444, 'recall': 0.9993743743743744, 'f1': 0.9996450429407391}
Validation Metrics: {'accuracy': 0.9973973737134745, 'precision': 0.9949695045982696, 'recall': 0.9923434667799718, 'f1': 0.9936517722303695}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9978, Precision: 0.9952, Recall: 0.9939, F1: 0.9945
Epoch 24/30
Training - Loss: 44.2259
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9997743018259936, 'recall': 0.9992341504834135, 'f1': 0.9995040277355647}
Validation Metrics: {'accuracy': 0.9977522772980008, 'precision': 0.9951823844752674, 'recall': 0.9938694077769199, 'f1': 0.9945247194901843}
Epoch 25/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0205
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 25/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0728
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9973, Precision: 0.9945, Recall: 0.9923, F1: 0.9934
Epoch 25/30
Training - Loss: 44.3256
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.9999160594970284, 'recall': 0.9993771798704534, 'f1': 0.9996464220871115}
Validation Metrics: {'accuracy': 0.9972790725186325, 'precision': 0.9944623181566367, 'recall': 0.9922765323756879, 'f1': 0.9933661569559231}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9975, Precision: 0.9950, Recall: 0.9929, F1: 0.9939
Epoch 26/30
Training - Loss: 44.1185
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998824793499429, 'recall': 0.9991287030121981, 'f1': 0.9995052043644722}
Validation Metrics: {'accuracy': 0.9975156749083166, 'precision': 0.9950404552325065, 'recall': 0.9928521137789544, 'f1': 0.9939430128727994}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 27/30, Step 20/1,Classification Loss: 0.3284, Contrastive Loss: 0.0229
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9976, Precision: 0.9955, Recall: 0.9929, F1: 0.9942
Epoch 27/30
Training - Loss: 43.9099
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.9999160454026462, 'recall': 0.9993779547151033, 'f1': 0.9996468029438013}
Validation Metrics: {'accuracy': 0.9976339761031586, 'precision': 0.9955481560098423, 'recall': 0.9929190481832382, 'f1': 0.9942288838457904}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 28/30, Step 100/1,Classification Loss: 0.3267, Contrastive Loss: 0.0227
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9996
Accuracy: 0.9978, Precision: 0.9952, Recall: 0.9939, F1: 0.9945
Epoch 28/30
Training - Loss: 43.8193
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998993761320185, 'recall': 0.9992469879518072, 'f1': 0.9995728932515996}
Validation Metrics: {'accuracy': 0.9977522772980008, 'precision': 0.9951823844752674, 'recall': 0.9938694077769199, 'f1': 0.9945247194901843}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 120/1,Classification Loss: 0.3229, Contrastive Loss: 0.0183
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9975, Precision: 0.9942, Recall: 0.9937, F1: 0.9940
Epoch 29/30
Training - Loss: 43.9426
Training Metrics: {'accuracy': 0.9998816287878788, 'precision': 0.9999328656305595, 'recall': 0.9995006242197253, 'f1': 0.9997166179210971}
Validation Metrics: {'accuracy': 0.9975156749083166, 'precision': 0.9941721704099027, 'recall': 0.9937355389683522, 'f1': 0.9939537243437419}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9972, Precision: 0.9931, Recall: 0.9931, F1: 0.9931
Epoch 30/30
Training - Loss: 43.6953
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.9999160876716007, 'recall': 0.9993756243756244, 'f1': 0.9996456574584367}
Validation Metrics: {'accuracy': 0.9971607713237903, 'precision': 0.993093023160802, 'recall': 0.993093023160802, 'f1': 0.993093023160802}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5398, 5814), y shape: (5398,), y distribution: Counter({np.float64(0.0): 4798, np.float64(1.0): 600}), env shape: (5398,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9598, Precision: 0.9518, Recall: 0.8374, F1: 0.8839
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8215]))
original train data shape: torch.Size([42362]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5398, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42362]), new train data shape: torch.Size([42362])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8215]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.5850
Epoch 1/30, Step 20/1,Classification Loss: 0.3183, Contrastive Loss: 0.8613
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3595
Epoch 1/30, Step 60/1,Classification Loss: 0.3281, Contrastive Loss: 0.2262
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1721
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1495
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1362
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9967, Precision: 0.9912, Recall: 0.9929, F1: 0.9921
Epoch 1/30
Training - Loss: 96.6821
Training Metrics: {'accuracy': 0.9996152935606061, 'precision': 0.9992476339217269, 'recall': 0.9989280483628056, 'f1': 0.9990877713093905}
Validation Metrics: {'accuracy': 0.9966953853416736, 'precision': 0.9912128627232217, 'recall': 0.9929177418381914, 'f1': 0.9920632945269637}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1307
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1239
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1191
Epoch 2/30, Step 60/1,Classification Loss: 0.3142, Contrastive Loss: 0.1180
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1125
Epoch 2/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.1219
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1073
Accuracy: 0.9998, Precision: 0.9995, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9969, Precision: 0.9926, Recall: 0.9926, F1: 0.9926
Epoch 2/30
Training - Loss: 57.1920
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9995473368530363, 'recall': 0.9993355800172931, 'f1': 0.9994414277293693}
Validation Metrics: {'accuracy': 0.9969314292458398, 'precision': 0.9926174087305045, 'recall': 0.9926174087305045, 'f1': 0.9926174087305045}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1054
Epoch 3/30, Step 20/1,Classification Loss: 0.3422, Contrastive Loss: 0.1201
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1011
Epoch 3/30, Step 60/1,Classification Loss: 0.3194, Contrastive Loss: 0.1058
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0978
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0955
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0938
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9970, Precision: 0.9931, Recall: 0.9927, F1: 0.9929
Epoch 3/30
Training - Loss: 55.0360
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998822896347616, 'recall': 0.9991389913899139, 'f1': 0.9995102625963205}
Validation Metrics: {'accuracy': 0.9970494511979228, 'precision': 0.9931124969343558, 'recall': 0.9926842983626115, 'f1': 0.9928982713623065}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0928
Epoch 4/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0929
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0897
Epoch 4/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1341
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0867
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0876
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0841
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9968, Precision: 0.9925, Recall: 0.9921, F1: 0.9923
Epoch 4/30
Training - Loss: 53.4086
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998823450315988, 'recall': 0.9991360157985683, 'f1': 0.9995087999358256}
Validation Metrics: {'accuracy': 0.9968134072937567, 'precision': 0.9925441117359569, 'recall': 0.9921164067264965, 'f1': 0.992330133071291}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0831
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0819
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0808
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0804
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0783
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0770
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0758
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9972, Precision: 0.9940, Recall: 0.9923, F1: 0.9932
Epoch 5/30
Training - Loss: 52.1067
Training Metrics: {'accuracy': 0.999704071969697, 'precision': 0.9998316838349155, 'recall': 0.998779296875, 'f1': 0.9993047302187414}
Validation Metrics: {'accuracy': 0.9971674731500059, 'precision': 0.9940338649089349, 'recall': 0.9923170756228175, 'f1': 0.9931734427344256}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0752
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0741
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0733
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0721
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0730
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0711
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0691
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9973, Precision: 0.9945, Recall: 0.9924, F1: 0.9935
Epoch 6/30
Training - Loss: 51.2123
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998990884321706, 'recall': 0.9992627181125584, 'f1': 0.9995806261874522}
Validation Metrics: {'accuracy': 0.997285495102089, 'precision': 0.994532449068614, 'recall': 0.9923839652549246, 'f1': 0.9934550344487338}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0687
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0676
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0667
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0658
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0653
Epoch 7/30, Step 100/1,Classification Loss: 0.3172, Contrastive Loss: 0.0678
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0632
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9972, Precision: 0.9940, Recall: 0.9923, F1: 0.9932
Epoch 7/30
Training - Loss: 50.2483
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9998654195545387, 'recall': 0.9990191270230505, 'f1': 0.9994417827034111}
Validation Metrics: {'accuracy': 0.9971674731500059, 'precision': 0.9940338649089349, 'recall': 0.9923170756228175, 'f1': 0.9931734427344256}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0633
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0619
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0615
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0617
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0596
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0588
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0580
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9970, Precision: 0.9935, Recall: 0.9923, F1: 0.9929
Epoch 8/30
Training - Loss: 49.5184
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998821628173187, 'recall': 0.9991457163778374, 'f1': 0.9995135674417106}
Validation Metrics: {'accuracy': 0.9970494511979228, 'precision': 0.993536282643493, 'recall': 0.9922501859907105, 'f1': 0.9928920955169482}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0578
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0569
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0562
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0554
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0566
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0540
Epoch 9/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0536
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9967, Precision: 0.9920, Recall: 0.9920, F1: 0.9920
Epoch 9/30
Training - Loss: 48.8907
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998821826505537, 'recall': 0.9991446725317693, 'f1': 0.9995130545442006}
Validation Metrics: {'accuracy': 0.9966953853416736, 'precision': 0.9920495170943895, 'recall': 0.9920495170943895, 'f1': 0.9920495170943895}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0552
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0524
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0516
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0511
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0504
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0497
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0492
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9969, Precision: 0.9930, Recall: 0.9922, F1: 0.9926
Epoch 10/30
Training - Loss: 48.2683
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998823766635301, 'recall': 0.9991343062082612, 'f1': 0.999507959479919}
Validation Metrics: {'accuracy': 0.9969314292458398, 'precision': 0.9930396992544204, 'recall': 0.9921832963586035, 'f1': 0.9926109924208151}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0488
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0481
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0476
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0470
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0460
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0453
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9969, Precision: 0.9935, Recall: 0.9917, F1: 0.9926
Epoch 11/30
Training - Loss: 47.8573
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998823173396993, 'recall': 0.9991375061606702, 'f1': 0.9995095325558745}
Validation Metrics: {'accuracy': 0.9969314292458398, 'precision': 0.9934639929428153, 'recall': 0.9917491839867025, 'f1': 0.9926045629622946}
Epoch 12/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0606
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0444
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0439
Epoch 12/30, Step 60/1,Classification Loss: 0.3294, Contrastive Loss: 0.0489
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0428
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0418
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9967, Precision: 0.9929, Recall: 0.9912, F1: 0.9920
Epoch 12/30
Training - Loss: 47.2699
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998991054012242, 'recall': 0.999261811023622, 'f1': 0.9995801804592904}
Validation Metrics: {'accuracy': 0.9966953853416736, 'precision': 0.9928941209766959, 'recall': 0.9911812923505874, 'f1': 0.9920356831901633}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0414
Epoch 13/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0412
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0404
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0394
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0415
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0385
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9967, Precision: 0.9929, Recall: 0.9912, F1: 0.9920
Epoch 13/30
Training - Loss: 46.7817
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998990986142877, 'recall': 0.9992621741269061, 'f1': 0.9995803588850491}
Validation Metrics: {'accuracy': 0.9966953853416736, 'precision': 0.9928941209766959, 'recall': 0.9911812923505874, 'f1': 0.9920356831901633}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0382
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0380
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0369
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0369
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9965, Precision: 0.9915, Recall: 0.9915, F1: 0.9915
Epoch 14/30
Training - Loss: 46.4532
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998990952204769, 'recall': 0.9992623555446275, 'f1': 0.9995804480306485}
Validation Metrics: {'accuracy': 0.9964593414375074, 'precision': 0.9914816254582745, 'recall': 0.9914816254582745, 'f1': 0.9914816254582745}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0353
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0341
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0337
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9972, Precision: 0.9936, Recall: 0.9928, F1: 0.9932
Epoch 15/30
Training - Loss: 45.9951
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9997583308974106, 'recall': 0.999116001423404, 'f1': 0.9994368846878503}
Validation Metrics: {'accuracy': 0.9971674731500059, 'precision': 0.9936085790265516, 'recall': 0.9927511879947186, 'f1': 0.9931793776192139}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0326
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0319
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0312
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0311
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9973, Precision: 0.9945, Recall: 0.9924, F1: 0.9935
Epoch 16/30
Training - Loss: 45.7067
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998820556023589, 'recall': 0.9991513094083414, 'f1': 0.9995163151053239}
Validation Metrics: {'accuracy': 0.997285495102089, 'precision': 0.994532449068614, 'recall': 0.9923839652549246, 'f1': 0.9934550344487338}
Epoch 17/30, Step 0/1,Classification Loss: 0.3275, Contrastive Loss: 0.0321
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0299
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0296
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0292
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 17/30, Step 100/1,Classification Loss: 0.3142, Contrastive Loss: 0.0292
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9969, Precision: 0.9930, Recall: 0.9922, F1: 0.9926
Epoch 17/30
Training - Loss: 45.3259
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998821469459223, 'recall': 0.9991465496220434, 'f1': 0.9995139768386367}
Validation Metrics: {'accuracy': 0.9969314292458398, 'precision': 0.9930396992544204, 'recall': 0.9921832963586035, 'f1': 0.9926109924208151}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0282
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0275
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0273
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9960, Precision: 0.9887, Recall: 0.9921, F1: 0.9904
Epoch 18/30
Training - Loss: 45.1258
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.999776214543054, 'recall': 0.999246978294839, 'f1': 0.9995114046227873}
Validation Metrics: {'accuracy': 0.9959872536291751, 'precision': 0.988692127401654, 'recall': 0.9920822916736483, 'f1': 0.9903792335019427}
Epoch 19/30, Step 0/1,Classification Loss: 0.3215, Contrastive Loss: 0.0279
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0260
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0255
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0247
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9966, Precision: 0.9911, Recall: 0.9924, F1: 0.9918
Epoch 19/30
Training - Loss: 44.9339
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998990476831443, 'recall': 0.9992648860573389, 'f1': 0.9995816913790165}
Validation Metrics: {'accuracy': 0.9965773633895905, 'precision': 0.991138077661097, 'recall': 0.9924167398341834, 'f1': 0.9917762788532822}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0238
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9968, Precision: 0.9934, Recall: 0.9912, F1: 0.9923
Epoch 20/30
Training - Loss: 44.7610
Training Metrics: {'accuracy': 0.9997336647727273, 'precision': 0.9998487852414395, 'recall': 0.9988866897575457, 'f1': 0.9993671056442435}
Validation Metrics: {'accuracy': 0.9968134072937567, 'precision': 0.9933917098836238, 'recall': 0.9912481819826945, 'f1': 0.9923167795702528}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 21/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0355
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9968, Precision: 0.9934, Recall: 0.9912, F1: 0.9923
Epoch 21/30
Training - Loss: 44.6741
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9998652881150439, 'recall': 0.9990260530801072, 'f1': 0.9994451867740257}
Validation Metrics: {'accuracy': 0.9968134072937567, 'precision': 0.9933917098836238, 'recall': 0.9912481819826945, 'f1': 0.9923167795702528}
Epoch 22/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0234
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9965, Precision: 0.9911, Recall: 0.9919, F1: 0.9915
Epoch 22/30
Training - Loss: 44.4641
Training Metrics: {'accuracy': 0.9998816287878788, 'precision': 0.9999327911822031, 'recall': 0.9995047052996533, 'f1': 0.9997186232630615}
Validation Metrics: {'accuracy': 0.9964593414375074, 'precision': 0.9910632945269637, 'recall': 0.9919157378301754, 'f1': 0.9914890137662415}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9967, Precision: 0.9929, Recall: 0.9912, F1: 0.9920
Epoch 23/30
Training - Loss: 44.4006
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998821905819786, 'recall': 0.9991442542787285, 'f1': 0.9995128490260368}
Validation Metrics: {'accuracy': 0.9966953853416736, 'precision': 0.9928941209766959, 'recall': 0.9911812923505874, 'f1': 0.9920356831901633}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 24/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0603
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9967, Precision: 0.9942, Recall: 0.9899, F1: 0.9920
Epoch 24/30
Training - Loss: 44.0724
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998825582175692, 'recall': 0.999124343257443, 'f1': 0.9995030601170347}
Validation Metrics: {'accuracy': 0.9966953853416736, 'precision': 0.9941761390527344, 'recall': 0.9898789552348846, 'f1': 0.9920148257050692}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9967, Precision: 0.9916, Recall: 0.9925, F1: 0.9921
Epoch 25/30
Training - Loss: 44.1975
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9998654964860957, 'recall': 0.9990150209308053, 'f1': 0.9994397640914762}
Validation Metrics: {'accuracy': 0.9966953853416736, 'precision': 0.991630202060752, 'recall': 0.9924836294662904, 'f1': 0.9920564128484921}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 26/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0214
Epoch 26/30, Step 60/1,Classification Loss: 0.3442, Contrastive Loss: 0.0286
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9963, Precision: 0.9902, Recall: 0.9923, F1: 0.9912
Epoch 26/30
Training - Loss: 44.0919
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998992646318122, 'recall': 0.9992531740104555, 'f1': 0.9995759351638598}
Validation Metrics: {'accuracy': 0.9963413194854243, 'precision': 0.9901567719865838, 'recall': 0.9922829605699695, 'f1': 0.9912167368975264}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 27/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0181
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9965, Precision: 0.9906, Recall: 0.9923, F1: 0.9915
Epoch 27/30
Training - Loss: 43.8116
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998823094253337, 'recall': 0.9991379310344828, 'f1': 0.9995097414015015}
Validation Metrics: {'accuracy': 0.9964593414375074, 'precision': 0.9906469352821595, 'recall': 0.9923498502020764, 'f1': 0.9914963869931754}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0229
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9997
Accuracy: 0.9966, Precision: 0.9920, Recall: 0.9915, F1: 0.9918
Epoch 28/30
Training - Loss: 43.8423
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.9999159098553649, 'recall': 0.9993852962871896, 'f1': 0.9996504104888688}
Validation Metrics: {'accuracy': 0.9965773633895905, 'precision': 0.9919757265375582, 'recall': 0.9915485150903814, 'f1': 0.9917619947802756}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 60/1,Classification Loss: 0.3140, Contrastive Loss: 0.0172
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9997
Accuracy: 0.9966, Precision: 0.9924, Recall: 0.9911, F1: 0.9918
Epoch 29/30
Training - Loss: 43.8386
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.9999159126837308, 'recall': 0.999385145105755, 'f1': 0.9996503362195434}
Validation Metrics: {'accuracy': 0.9965773633895905, 'precision': 0.9923975319227859, 'recall': 0.9911144027184804, 'f1': 0.99175483079966}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9969, Precision: 0.9939, Recall: 0.9913, F1: 0.9926
Epoch 30/30
Training - Loss: 43.7193
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9998654421906011, 'recall': 0.9990179229069482, 'f1': 0.9994411907828857}
Validation Metrics: {'accuracy': 0.9969314292458398, 'precision': 0.9938903016674501, 'recall': 0.9913150716148015, 'f1': 0.9925981203154042}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5384, 5814), y shape: (5384,), y distribution: Counter({np.float64(0.0): 4784, np.float64(1.0): 600}), env shape: (5384,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9473, Precision: 0.9298, Recall: 0.7888, F1: 0.8415
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8315]))
original train data shape: torch.Size([42462]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5384, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42462]), new train data shape: torch.Size([42462])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8315]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 1.5840
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.9149
Epoch 1/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.4169
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2560
Epoch 1/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.2016
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1713
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1561
Accuracy: 0.9995, Precision: 0.9989, Recall: 0.9986, F1: 0.9988
Accuracy: 0.9967, Precision: 0.9934, Recall: 0.9908, F1: 0.9921
Epoch 1/30
Training - Loss: 100.7105
Training Metrics: {'accuracy': 0.9994673295454546, 'precision': 0.9988576178434556, 'recall': 0.9986484016509749, 'f1': 0.9987529796163863}
Validation Metrics: {'accuracy': 0.9967031673142588, 'precision': 0.9933762830766182, 'recall': 0.9908326573782485, 'f1': 0.9920999968108177}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1510
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1402
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1336
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1282
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1239
Epoch 2/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.1231
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1176
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9974, Precision: 0.9951, Recall: 0.9925, F1: 0.9938
Epoch 2/30
Training - Loss: 58.8418
Training Metrics: {'accuracy': 0.9996448863636364, 'precision': 0.9994836803395162, 'recall': 0.9988569508148653, 'f1': 0.9991700452348925}
Validation Metrics: {'accuracy': 0.9974096314612033, 'precision': 0.995073529352988, 'recall': 0.992521153417947, 'f1': 0.993792854637071}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1154
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1124
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1098
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1071
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1050
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1027
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1007
Accuracy: 0.9996, Precision: 0.9997, Recall: 0.9984, F1: 0.9990
Accuracy: 0.9969, Precision: 0.9948, Recall: 0.9905, F1: 0.9927
Epoch 3/30
Training - Loss: 55.9884
Training Metrics: {'accuracy': 0.9995857007575758, 'precision': 0.9996599739681729, 'recall': 0.9984168669821314, 'f1': 0.9990373535975263}
Validation Metrics: {'accuracy': 0.9969386553632403, 'precision': 0.9947911834342467, 'recall': 0.99053702643382, 'f1': 0.992651617909955}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0995
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0977
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0958
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0940
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0927
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0908
Epoch 4/30, Step 120/1,Classification Loss: 0.3155, Contrastive Loss: 0.0898
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9969, Precision: 0.9939, Recall: 0.9914, F1: 0.9927
Epoch 4/30
Training - Loss: 54.0519
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9998651745988945, 'recall': 0.9990319457889643, 'f1': 0.9994480820852463}
Validation Metrics: {'accuracy': 0.9969386553632403, 'precision': 0.9939420318354081, 'recall': 0.9913954893914814, 'f1': 0.9926642827529022}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0884
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0869
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0854
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0840
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0828
Epoch 5/30, Step 100/1,Classification Loss: 0.3179, Contrastive Loss: 0.0842
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0802
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9971, Precision: 0.9944, Recall: 0.9915, F1: 0.9929
Epoch 5/30
Training - Loss: 52.6509
Training Metrics: {'accuracy': 0.9997336647727273, 'precision': 0.9998483469821049, 'recall': 0.9989098837209303, 'f1': 0.9993785090252749}
Validation Metrics: {'accuracy': 0.997056399387731, 'precision': 0.9944366898451256, 'recall': 0.9914622896586824, 'f1': 0.9929433859311007}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0794
Epoch 6/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0789
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0771
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0760
Epoch 6/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0832
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0738
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0728
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9972, Precision: 0.9962, Recall: 0.9902, F1: 0.9932
Epoch 6/30
Training - Loss: 51.6179
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998820436775411, 'recall': 0.9991519263387448, 'f1': 0.9995166181307694}
Validation Metrics: {'accuracy': 0.9971741434122219, 'precision': 0.9962180738786635, 'recall': 0.9902413954893914, 'f1': 0.9932051397614665}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0721
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0711
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0701
Epoch 7/30, Step 60/1,Classification Loss: 0.3199, Contrastive Loss: 0.0697
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0682
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0680
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0663
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9971, Precision: 0.9953, Recall: 0.9906, F1: 0.9929
Epoch 7/30
Training - Loss: 50.7097
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998819641170915, 'recall': 0.9991560163973957, 'f1': 0.9995186268351836}
Validation Metrics: {'accuracy': 0.997056399387731, 'precision': 0.9952888280637002, 'recall': 0.9906038267010211, 'f1': 0.9929311958072911}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0664
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0650
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0645
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0632
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0623
Epoch 8/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0798
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0608
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9960, Precision: 0.9896, Recall: 0.9913, F1: 0.9904
Epoch 8/30
Training - Loss: 49.8877
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998820873900887, 'recall': 0.9991496598639455, 'f1': 0.9995155048276391}
Validation Metrics: {'accuracy': 0.9959967031673143, 'precision': 0.989610108453933, 'recall': 0.9912903187327036, 'f1': 0.9904482503575762}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0603
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0597
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0587
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0581
Epoch 9/30, Step 80/1,Classification Loss: 0.3159, Contrastive Loss: 0.0577
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0564
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0557
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9956, Precision: 0.9874, Recall: 0.9919, F1: 0.9896
Epoch 9/30
Training - Loss: 49.1110
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9998653561330282, 'recall': 0.9990224828934506, 'f1': 0.9994434322102013}
Validation Metrics: {'accuracy': 0.995643471093842, 'precision': 0.9873540672105563, 'recall': 0.9919483808887617, 'f1': 0.9896364979587521}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0552
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0545
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0538
Epoch 10/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0626
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0517
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0511
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9967, Precision: 0.9934, Recall: 0.9908, F1: 0.9921
Epoch 10/30
Training - Loss: 48.5116
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998989218328841, 'recall': 0.9992714910150559, 'f1': 0.999584935758925}
Validation Metrics: {'accuracy': 0.9967031673142588, 'precision': 0.9933762830766182, 'recall': 0.9908326573782485, 'f1': 0.9920999968108177}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0507
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0500
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0494
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0488
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0481
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0475
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0469
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9965, Precision: 0.9924, Recall: 0.9907, F1: 0.9915
Epoch 11/30
Training - Loss: 47.8946
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9998651200431616, 'recall': 0.9990347490347491, 'f1': 0.9994494591366128}
Validation Metrics: {'accuracy': 0.9964676792652772, 'precision': 0.9923908984172802, 'recall': 0.9906990568438464, 'f1': 0.9915429952673435}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0466
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0459
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0455
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0449
Epoch 12/30, Step 80/1,Classification Loss: 0.3140, Contrastive Loss: 0.0446
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0437
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0431
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9965, Precision: 0.9937, Recall: 0.9894, F1: 0.9915
Epoch 12/30
Training - Loss: 47.4335
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9998651745988945, 'recall': 0.9990319457889643, 'f1': 0.9994480820852463}
Validation Metrics: {'accuracy': 0.9964676792652772, 'precision': 0.9936557571447098, 'recall': 0.9894113624073544, 'f1': 0.9915210975884097}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0428
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0417
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0412
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0407
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0402
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0397
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9969, Precision: 0.9939, Recall: 0.9914, F1: 0.9927
Epoch 13/30
Training - Loss: 46.9125
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.999865224569561, 'recall': 0.999029361805387, 'f1': 0.999446812577107}
Validation Metrics: {'accuracy': 0.9969386553632403, 'precision': 0.9939420318354081, 'recall': 0.9913954893914814, 'f1': 0.9926642827529022}
Epoch 14/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0435
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0391
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0384
Epoch 14/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0394
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0375
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0377
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9975, Precision: 0.9964, Recall: 0.9917, F1: 0.9941
Epoch 14/30
Training - Loss: 46.5411
Training Metrics: {'accuracy': 0.9997336647727273, 'precision': 0.9998483674225831, 'recall': 0.9989088263821533, 'f1': 0.9993779894241555}
Validation Metrics: {'accuracy': 0.9975273754856941, 'precision': 0.996425241573172, 'recall': 0.9917294907274867, 'f1': 0.9940622044781244}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0363
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0358
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0350
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0337
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9997
Accuracy: 0.9971, Precision: 0.9940, Recall: 0.9919, F1: 0.9929
Epoch 15/30
Training - Loss: 46.0271
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.999915864575621, 'recall': 0.9993877051187852, 'f1': 0.9996515937401631}
Validation Metrics: {'accuracy': 0.997056399387731, 'precision': 0.9940136200211116, 'recall': 0.9918915211375132, 'f1': 0.9929494624307544}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0331
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0327
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0325
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0319
Epoch 16/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0324
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0312
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9973, Precision: 0.9942, Recall: 0.9929, F1: 0.9935
Epoch 16/30
Training - Loss: 45.6952
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998989013951607, 'recall': 0.9992725509214355, 'f1': 0.9995854562636198}
Validation Metrics: {'accuracy': 0.9972918874367126, 'precision': 0.994156820066335, 'recall': 0.9928835846295767, 'f1': 0.99351908447625}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0309
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0300
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0296
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 17/30, Step 120/1,Classification Loss: 0.3143, Contrastive Loss: 0.0291
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9997
Accuracy: 0.9968, Precision: 0.9922, Recall: 0.9926, F1: 0.9924
Epoch 17/30
Training - Loss: 45.4169
Training Metrics: {'accuracy': 0.9998520359848485, 'precision': 0.999915850415699, 'recall': 0.9993884540117417, 'f1': 0.9996519615641726}
Validation Metrics: {'accuracy': 0.9968209113387495, 'precision': 0.9921939185491984, 'recall': 0.9926163835607724, 'f1': 0.9924050275709446}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9968, Precision: 0.9934, Recall: 0.9913, F1: 0.9924
Epoch 18/30
Training - Loss: 45.2211
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998820873900887, 'recall': 0.9991496598639455, 'f1': 0.9995155048276391}
Validation Metrics: {'accuracy': 0.9968209113387495, 'precision': 0.9934483598603389, 'recall': 0.9913286891242803, 'f1': 0.9923854194252147}
Epoch 19/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0276
Epoch 19/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0275
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9968, Precision: 0.9926, Recall: 0.9922, F1: 0.9924
Epoch 19/30
Training - Loss: 44.9829
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998821072487201, 'recall': 0.9991486256385308, 'f1': 0.9995149967654866}
Validation Metrics: {'accuracy': 0.9968209113387495, 'precision': 0.9926101049002163, 'recall': 0.9921871520819416, 'f1': 0.9923985047684415}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9972, Precision: 0.9945, Recall: 0.9920, F1: 0.9932
Epoch 20/30
Training - Loss: 44.6590
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998821628173187, 'recall': 0.9991457163778374, 'f1': 0.9995135674417106}
Validation Metrics: {'accuracy': 0.9971741434122219, 'precision': 0.9945077805941981, 'recall': 0.9919583214047143, 'f1': 0.9932285686949867}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 21/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0299
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9972, Precision: 0.9949, Recall: 0.9915, F1: 0.9932
Epoch 21/30
Training - Loss: 44.4321
Training Metrics: {'accuracy': 0.9998224431818182, 'precision': 0.9998989728910591, 'recall': 0.9992688276870583, 'f1': 0.999583627683239}
Validation Metrics: {'accuracy': 0.9971741434122219, 'precision': 0.9949323368477245, 'recall': 0.9915290899258835, 'f1': 0.9932227293257202}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 22/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0296
Epoch 22/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0221
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9968, Precision: 0.9930, Recall: 0.9918, F1: 0.9924
Epoch 22/30
Training - Loss: 44.3566
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.999882170751414, 'recall': 0.9991452991452991, 'f1': 0.9995133624364447}
Validation Metrics: {'accuracy': 0.9968209113387495, 'precision': 0.9930282481821661, 'recall': 0.9917579206031111, 'f1': 0.9923919687329892}
Epoch 23/30, Step 0/1,Classification Loss: 0.3144, Contrastive Loss: 0.0236
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9968, Precision: 0.9930, Recall: 0.9918, F1: 0.9924
Epoch 23/30
Training - Loss: 44.1562
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998820237974855, 'recall': 0.9991529525653436, 'f1': 0.9995171221725916}
Validation Metrics: {'accuracy': 0.9968209113387495, 'precision': 0.9930282481821661, 'recall': 0.9917579206031111, 'f1': 0.9923919687329892}
Epoch 24/30, Step 0/1,Classification Loss: 0.3140, Contrastive Loss: 0.0213
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 24/30, Step 80/1,Classification Loss: 0.3441, Contrastive Loss: 0.0370
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9972, Precision: 0.9945, Recall: 0.9920, F1: 0.9932
Epoch 24/30
Training - Loss: 44.1917
Training Metrics: {'accuracy': 0.9997928503787878, 'precision': 0.9998820953343439, 'recall': 0.9991492464754497, 'f1': 0.9995153017544003}
Validation Metrics: {'accuracy': 0.9971741434122219, 'precision': 0.9945077805941981, 'recall': 0.9919583214047143, 'f1': 0.9932285686949867}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Accuracy: 0.9996, Precision: 0.9998, Recall: 0.9985, F1: 0.9992
Accuracy: 0.9968, Precision: 0.9939, Recall: 0.9909, F1: 0.9924
Epoch 25/30
Training - Loss: 44.0463
Training Metrics: {'accuracy': 0.9996448863636364, 'precision': 0.9997978096040439, 'recall': 0.9985468636473722, 'f1': 0.9991712588420087}
Validation Metrics: {'accuracy': 0.9968209113387495, 'precision': 0.9938704514919143, 'recall': 0.9908994576454496, 'f1': 0.9923788568055887}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9965, Precision: 0.9911, Recall: 0.9920, F1: 0.9916
Epoch 26/30
Training - Loss: 43.9527
Training Metrics: {'accuracy': 0.9995857007575758, 'precision': 0.999133228230045, 'recall': 0.9989233529274535, 'f1': 0.9990282603038838}
Validation Metrics: {'accuracy': 0.9964676792652772, 'precision': 0.99114375422575, 'recall': 0.9919867512803384, 'f1': 0.9915647600245572}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0204
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9963, Precision: 0.9936, Recall: 0.9889, F1: 0.9912
Epoch 27/30
Training - Loss: 43.9865
Training Metrics: {'accuracy': 0.9997632575757576, 'precision': 0.9998652018602143, 'recall': 0.9990305380513815, 'f1': 0.9994473904850493}
Validation Metrics: {'accuracy': 0.9963499352407865, 'precision': 0.9935842077994923, 'recall': 0.9889153306613226, 'f1': 0.991234682801041}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 80/1,Classification Loss: 0.3140, Contrastive Loss: 0.0180
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9965, Precision: 0.9928, Recall: 0.9903, F1: 0.9915
Epoch 28/30
Training - Loss: 43.8443
Training Metrics: {'accuracy': 0.999704071969697, 'precision': 0.9998315250353798, 'recall': 0.9987875848690592, 'f1': 0.9993088048905197}
Validation Metrics: {'accuracy': 0.9964676792652772, 'precision': 0.9928105343178282, 'recall': 0.9902698253650157, 'f1': 0.9915357108687333}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9987, F1: 0.9992
Accuracy: 0.9969, Precision: 0.9931, Recall: 0.9923, F1: 0.9927
Epoch 29/30
Training - Loss: 43.8958
Training Metrics: {'accuracy': 0.9996744791666666, 'precision': 0.9998146150734799, 'recall': 0.9986698911729142, 'f1': 0.999241350163305}
Validation Metrics: {'accuracy': 0.9969386553632403, 'precision': 0.9931008313681422, 'recall': 0.9922539523491427, 'f1': 0.9926768962440581}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 20/1,Classification Loss: 0.3146, Contrastive Loss: 0.0174
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0307
Epoch 30/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0615
Epoch 30/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0183
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9969, Precision: 0.9939, Recall: 0.9914, F1: 0.9927
Epoch 30/30
Training - Loss: 44.0715
Training Metrics: {'accuracy': 0.9996744791666666, 'precision': 0.9996032278616371, 'recall': 0.9988642093800929, 'f1': 0.99923334414255}
Validation Metrics: {'accuracy': 0.9969386553632403, 'precision': 0.9939420318354081, 'recall': 0.9913954893914814, 'f1': 0.9926642827529022}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5339, 5814), y shape: (5339,), y distribution: Counter({np.float64(0.0): 4739, np.float64(1.0): 600}), env shape: (5339,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9567, Precision: 0.9473, Recall: 0.8272, F1: 0.8751
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8415]))
original train data shape: torch.Size([42562]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5339, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42562]), new train data shape: torch.Size([42562])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8415]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.5618
Epoch 1/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.8371
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3647
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2412
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1930
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1687
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1549
Accuracy: 0.9992, Precision: 0.9980, Recall: 0.9984, F1: 0.9982
Accuracy: 0.9964, Precision: 0.9928, Recall: 0.9899, F1: 0.9913
Epoch 1/30
Training - Loss: 97.1018
Training Metrics: {'accuracy': 0.9992363721804511, 'precision': 0.9980207514836511, 'recall': 0.9984312646897515, 'f1': 0.9982258915177298}
Validation Metrics: {'accuracy': 0.9963585105133326, 'precision': 0.9928103323461666, 'recall': 0.9898855271455973, 'f1': 0.9913419835306648}
Epoch 2/30, Step 0/1,Classification Loss: 0.3279, Contrastive Loss: 0.1566
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1412
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1358
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1304
Epoch 2/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1386
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1241
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1195
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9966, Precision: 0.9934, Recall: 0.9904, F1: 0.9919
Epoch 2/30
Training - Loss: 59.9449
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9994415945418469, 'recall': 0.9993398403346044, 'f1': 0.9993907102678259}
Validation Metrics: {'accuracy': 0.996593445318924, 'precision': 0.9933705824284305, 'recall': 0.9904424521710459, 'f1': 0.9919005652383639}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1176
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1147
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1122
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1095
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1073
Epoch 3/30, Step 100/1,Classification Loss: 0.3284, Contrastive Loss: 0.1152
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1029
Accuracy: 0.9998, Precision: 0.9996, Recall: 0.9994, F1: 0.9995
Accuracy: 0.9964, Precision: 0.9928, Recall: 0.9899, F1: 0.9913
Epoch 3/30
Training - Loss: 56.7967
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9995573636369601, 'recall': 0.9993518342704157, 'f1': 0.9994545698041077}
Validation Metrics: {'accuracy': 0.9963585105133326, 'precision': 0.9928103323461666, 'recall': 0.9898855271455973, 'f1': 0.9913419835306648}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1015
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0996
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0977
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0959
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0948
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0928
Epoch 4/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0915
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9965, Precision: 0.9929, Recall: 0.9904, F1: 0.9916
Epoch 4/30
Training - Loss: 54.7374
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9997456807164995, 'recall': 0.9990205781285784, 'f1': 0.9993827675732996}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.9928826802153503, 'recall': 0.9903757232240287, 'f1': 0.9916248351136339}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0899
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0884
Epoch 5/30, Step 40/1,Classification Loss: 0.3188, Contrastive Loss: 0.0884
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0856
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0841
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0828
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0816
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9962, Precision: 0.9936, Recall: 0.9885, F1: 0.9910
Epoch 5/30
Training - Loss: 53.4239
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9998830018385425, 'recall': 0.9991545893719807, 'f1': 0.9995184310982397}
Validation Metrics: {'accuracy': 0.9962410431105369, 'precision': 0.9935739929993761, 'recall': 0.9885483968043376, 'f1': 0.9910436447410609}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0811
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0796
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0784
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0772
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0761
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0750
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0739
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9989, F1: 0.9994
Accuracy: 0.9966, Precision: 0.9955, Recall: 0.9883, F1: 0.9919
Epoch 6/30
Training - Loss: 52.1656
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9998494580489763, 'recall': 0.9989195678271309, 'f1': 0.9993839173067733}
Validation Metrics: {'accuracy': 0.996593445318924, 'precision': 0.9954776814695727, 'recall': 0.9883251165139751, 'f1': 0.9918659537164902}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0732
Epoch 7/30, Step 20/1,Classification Loss: 0.3170, Contrastive Loss: 0.0755
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0712
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0702
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0698
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0683
Epoch 7/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0679
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9997
Accuracy: 0.9967, Precision: 0.9960, Recall: 0.9884, F1: 0.9921
Epoch 7/30
Training - Loss: 51.3219
Training Metrics: {'accuracy': 0.9998531484962406, 'precision': 0.9999162394880557, 'recall': 0.9994056110318592, 'f1': 0.9996607449975685}
Validation Metrics: {'accuracy': 0.9967109127217197, 'precision': 0.9959739022819758, 'recall': 0.9883918454609923, 'f1': 0.992143077704831}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0668
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0659
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0652
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0643
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0635
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0628
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0622
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9965, Precision: 0.9916, Recall: 0.9916, F1: 0.9916
Epoch 8/30
Training - Loss: 50.3767
Training Metrics: {'accuracy': 0.9998825187969925, 'precision': 0.9999330162770447, 'recall': 0.9995231282784931, 'f1': 0.9997279562766419}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.9916461246182712, 'recall': 0.9916461246182712, 'f1': 0.9916461246182712}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0613
Epoch 9/30, Step 20/1,Classification Loss: 0.3209, Contrastive Loss: 0.0654
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0599
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0590
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0583
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0577
Epoch 9/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0571
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9965, Precision: 0.9954, Recall: 0.9878, F1: 0.9916
Epoch 9/30
Training - Loss: 49.7168
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.999899631983941, 'recall': 0.9992795389048992, 'f1': 0.9995893206878328}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.9954083312538815, 'recall': 0.9878349204355438, 'f1': 0.9915818689694618}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0563
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0556
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0564
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0542
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0536
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0529
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0523
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9995
Accuracy: 0.9964, Precision: 0.9941, Recall: 0.9886, F1: 0.9913
Epoch 10/30
Training - Loss: 49.2644
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.999866014604408, 'recall': 0.9990480723465016, 'f1': 0.9994565809833669}
Validation Metrics: {'accuracy': 0.9963585105133326, 'precision': 0.994065786761521, 'recall': 0.9886151257513549, 'f1': 0.9913198291496033}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0519
Epoch 11/30, Step 20/1,Classification Loss: 0.3169, Contrastive Loss: 0.0518
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0516
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0500
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0494
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0488
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0482
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9965, Precision: 0.9946, Recall: 0.9887, F1: 0.9916
Epoch 11/30
Training - Loss: 48.4726
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.999899695743756, 'recall': 0.999276236429433, 'f1': 0.9995876989490617}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.9945585578046309, 'recall': 0.988681854698372, 'f1': 0.9915962487660415}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0473
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0467
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0462
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0456
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0450
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0457
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9997
Accuracy: 0.9965, Precision: 0.9933, Recall: 0.9900, F1: 0.9916
Epoch 12/30
Training - Loss: 48.0191
Training Metrics: {'accuracy': 0.9998531484962406, 'precision': 0.9999164187088363, 'recall': 0.9993964268469339, 'f1': 0.999656237024394}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.993298719591011, 'recall': 0.9899522560926145, 'f1': 0.9916177100761565}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0442
Epoch 13/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0440
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0431
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0426
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0421
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0416
Epoch 13/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0500
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9966, Precision: 0.9938, Recall: 0.9900, F1: 0.9919
Epoch 13/30
Training - Loss: 47.4441
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.9998996554838278, 'recall': 0.9992783257156603, 'f1': 0.9995887249697768}
Validation Metrics: {'accuracy': 0.996593445318924, 'precision': 0.9937880726036525, 'recall': 0.9900189850396317, 'f1': 0.9918936707771784}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0408
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0404
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0394
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0390
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0385
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0381
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9964, Precision: 0.9936, Recall: 0.9890, F1: 0.9913
Epoch 14/30
Training - Loss: 47.1129
Training Metrics: {'accuracy': 0.9997062969924813, 'precision': 0.9998324845885822, 'recall': 0.998812351543943, 'f1': 0.9993216979401873}
Validation Metrics: {'accuracy': 0.9963585105133326, 'precision': 0.9936453448811443, 'recall': 0.989038592882769, 'f1': 0.9913272288103094}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0378
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0375
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0372
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0365
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0357
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0353
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9965, Precision: 0.9925, Recall: 0.9908, F1: 0.9916
Epoch 15/30
Training - Loss: 46.7481
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.9998994705448696, 'recall': 0.9992877492877492, 'f1': 0.9995933510313857}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.9924685753566518, 'recall': 0.9907991903554428, 'f1': 0.9916319458551935}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0351
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0343
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0338
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0331
Epoch 16/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0390
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9959, Precision: 0.9909, Recall: 0.9896, F1: 0.9902
Epoch 16/30
Training - Loss: 46.3867
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9998827667057444, 'recall': 0.9991666666666666, 'f1': 0.9995243623017618}
Validation Metrics: {'accuracy': 0.9958886409021497, 'precision': 0.9908663840642902, 'recall': 0.9896186113575285, 'f1': 0.9902414118578137}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0326
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0322
Epoch 17/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0346
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0311
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9962, Precision: 0.9923, Recall: 0.9898, F1: 0.9911
Epoch 17/30
Training - Loss: 45.9634
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.9998996353417416, 'recall': 0.9992793658419409, 'f1': 0.9995892357107561}
Validation Metrics: {'accuracy': 0.9962410431105369, 'precision': 0.9923229080116666, 'recall': 0.9898187981985801, 'f1': 0.9910664907878761}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0304
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0299
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0290
Epoch 18/30, Step 100/1,Classification Loss: 0.3451, Contrastive Loss: 0.0382
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9961, Precision: 0.9918, Recall: 0.9898, F1: 0.9908
Epoch 18/30
Training - Loss: 45.7741
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.999882931397799, 'recall': 0.9991582491582491, 'f1': 0.999520228853993}
Validation Metrics: {'accuracy': 0.9961235757077411, 'precision': 0.9918364437413195, 'recall': 0.9897520692515629, 'f1': 0.9907912314956542}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0282
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9960, Precision: 0.9930, Recall: 0.9880, F1: 0.9905
Epoch 19/30
Training - Loss: 45.5045
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9998829666287701, 'recall': 0.9991564232345144, 'f1': 0.9995193319711488}
Validation Metrics: {'accuracy': 0.9960061083049454, 'precision': 0.9930113390015123, 'recall': 0.987991471778889, 'f1': 0.9904838725373771}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0260
Epoch 20/30, Step 60/1,Classification Loss: 0.3287, Contrastive Loss: 0.0354
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9997
Accuracy: 0.9965, Precision: 0.9937, Recall: 0.9895, F1: 0.9916
Epoch 20/30
Training - Loss: 45.2202
Training Metrics: {'accuracy': 0.9998531484962406, 'precision': 0.9999163291944175, 'recall': 0.9994010541447054, 'f1': 0.9996585086933016}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.993716704737247, 'recall': 0.9895287889612003, 'f1': 0.9916105707006269}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0237
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9965, Precision: 0.9921, Recall: 0.9912, F1: 0.9916
Epoch 21/30
Training - Loss: 45.0089
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.9998995614181927, 'recall': 0.9992831541218639, 'f1': 0.9995910956072466}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.9920563938499929, 'recall': 0.991222657486857, 'f1': 0.9916390423428045}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 22/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0369
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9997
Accuracy: 0.9967, Precision: 0.9930, Recall: 0.9914, F1: 0.9922
Epoch 22/30
Training - Loss: 44.9249
Training Metrics: {'accuracy': 0.9998531484962406, 'precision': 0.9999162787582465, 'recall': 0.9994036259541985, 'f1': 0.9996597709141876}
Validation Metrics: {'accuracy': 0.9967109127217197, 'precision': 0.9930273946849081, 'recall': 0.9913561153808914, 'f1': 0.9921898161315139}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 23/30, Step 80/1,Classification Loss: 0.3216, Contrastive Loss: 0.0227
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9964, Precision: 0.9928, Recall: 0.9899, F1: 0.9913
Epoch 23/30
Training - Loss: 44.8014
Training Metrics: {'accuracy': 0.9998825187969925, 'precision': 0.999933134967069, 'recall': 0.999517024873219, 'f1': 0.9997249609956838}
Validation Metrics: {'accuracy': 0.9963585105133326, 'precision': 0.9928103323461666, 'recall': 0.9898855271455973, 'f1': 0.9913419835306648}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 24/30, Step 80/1,Classification Loss: 0.3260, Contrastive Loss: 0.0220
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9995
Accuracy: 0.9966, Precision: 0.9934, Recall: 0.9904, F1: 0.9919
Epoch 24/30
Training - Loss: 44.5459
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9998661087866109, 'recall': 0.9990432910786893, 'f1': 0.999454232883788}
Validation Metrics: {'accuracy': 0.996593445318924, 'precision': 0.9933705824284305, 'recall': 0.9904424521710459, 'f1': 0.9919005652383639}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 25/30, Step 40/1,Classification Loss: 0.3330, Contrastive Loss: 0.0382
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Accuracy: 0.9999, Precision: 0.9999, Recall: 0.9994, F1: 0.9997
Accuracy: 0.9965, Precision: 0.9933, Recall: 0.9900, F1: 0.9916
Epoch 25/30
Training - Loss: 44.5243
Training Metrics: {'accuracy': 0.9998531484962406, 'precision': 0.9999162787582465, 'recall': 0.9994036259541985, 'f1': 0.9996597709141876}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.993298719591011, 'recall': 0.9899522560926145, 'f1': 0.9916177100761565}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 26/30, Step 20/1,Classification Loss: 0.3194, Contrastive Loss: 0.0214
Epoch 26/30, Step 40/1,Classification Loss: 0.3138, Contrastive Loss: 0.0271
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9964, Precision: 0.9916, Recall: 0.9912, F1: 0.9914
Epoch 26/30
Training - Loss: 44.4061
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.9998995244155671, 'recall': 0.9992850333651097, 'f1': 0.999592018070647}
Validation Metrics: {'accuracy': 0.9963585105133326, 'precision': 0.9915723223001037, 'recall': 0.9911559285398397, 'f1': 0.9913640047629313}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9962, Precision: 0.9927, Recall: 0.9894, F1: 0.9911
Epoch 27/30
Training - Loss: 44.4992
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.9998996420566688, 'recall': 0.9992790194664745, 'f1': 0.9995890656312203}
Validation Metrics: {'accuracy': 0.9962410431105369, 'precision': 0.9927379906658031, 'recall': 0.9893953310671659, 'f1': 0.9910588907479002}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9990, F1: 0.9995
Accuracy: 0.9960, Precision: 0.9930, Recall: 0.9880, F1: 0.9905
Epoch 28/30
Training - Loss: 44.4632
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9998661625455885, 'recall': 0.9990405372991125, 'f1': 0.9994528802385325}
Validation Metrics: {'accuracy': 0.9960061083049454, 'precision': 0.9930113390015123, 'recall': 0.987991471778889, 'f1': 0.9904838725373771}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 20/1,Classification Loss: 0.3439, Contrastive Loss: 0.0423
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9968, Precision: 0.9943, Recall: 0.9906, F1: 0.9925
Epoch 29/30
Training - Loss: 44.3106
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9998827627788571, 'recall': 0.9991668650321353, 'f1': 0.9995244596860836}
Validation Metrics: {'accuracy': 0.9968283801245155, 'precision': 0.9943492813390218, 'recall': 0.9905759100650804, 'f1': 0.9924527279649593}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0208
Accuracy: 0.9998, Precision: 0.9999, Recall: 0.9993, F1: 0.9996
Accuracy: 0.9965, Precision: 0.9929, Recall: 0.9904, F1: 0.9916
Epoch 30/30
Training - Loss: 44.1209
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.999899709156554, 'recall': 0.9992755373098285, 'f1': 0.999587355590212}
Validation Metrics: {'accuracy': 0.9964759779161283, 'precision': 0.9928826802153503, 'recall': 0.9903757232240287, 'f1': 0.9916248351136339}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5286, 5814), y shape: (5286,), y distribution: Counter({np.float64(0.0): 4686, np.float64(1.0): 600}), env shape: (5286,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9519, Precision: 0.9502, Recall: 0.8029, F1: 0.8579
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8515]))
original train data shape: torch.Size([42662]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5286, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42662]), new train data shape: torch.Size([42662])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8515]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.5595
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.8893
Epoch 1/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.4429
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2464
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1957
Epoch 1/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.1874
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1569
Accuracy: 0.9993, Precision: 0.9985, Recall: 0.9983, F1: 0.9984
Accuracy: 0.9964, Precision: 0.9921, Recall: 0.9908, F1: 0.9915
Epoch 1/30
Training - Loss: 99.8731
Training Metrics: {'accuracy': 0.9992951127819549, 'precision': 0.9984841703923496, 'recall': 0.9982824669077062, 'f1': 0.9983832903408127}
Validation Metrics: {'accuracy': 0.9963670455877183, 'precision': 0.9920710033138849, 'recall': 0.9908382058728622, 'f1': 0.9914535431902147}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1502
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1431
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1370
Epoch 2/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.1412
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1289
Epoch 2/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.1393
Epoch 2/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1340
Accuracy: 0.9996, Precision: 0.9988, Recall: 0.9993, F1: 0.9990
Accuracy: 0.9960, Precision: 0.9906, Recall: 0.9906, F1: 0.9906
Epoch 2/30
Training - Loss: 60.0251
Training Metrics: {'accuracy': 0.9995888157894737, 'precision': 0.9988432977543644, 'recall': 0.9992526279121334, 'f1': 0.9990478469682466}
Validation Metrics: {'accuracy': 0.9960154693542717, 'precision': 0.9906382058728622, 'recall': 0.9906382058728622, 'f1': 0.9906382058728622}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1202
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1175
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1151
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1126
Epoch 3/30, Step 80/1,Classification Loss: 0.3285, Contrastive Loss: 0.1188
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1084
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1063
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9967, Precision: 0.9927, Recall: 0.9919, F1: 0.9923
Epoch 3/30
Training - Loss: 57.0340
Training Metrics: {'accuracy': 0.9996475563909775, 'precision': 0.9991898410329527, 'recall': 0.9991898410329527, 'f1': 0.9991898410329527}
Validation Metrics: {'accuracy': 0.9967186218211649, 'precision': 0.9926957079146821, 'recall': 0.9918729267505647, 'f1': 0.9922838453580867}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1049
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1030
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1011
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0994
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0976
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0960
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0946
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9918, Recall: 0.9922, F1: 0.9920
Epoch 4/30
Training - Loss: 55.3757
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9990750303866092, 'recall': 0.9991758483772533, 'f1': 0.9991254323167502}
Validation Metrics: {'accuracy': 0.9966014297433493, 'precision': 0.9918131572926681, 'recall': 0.9922236205227493, 'f1': 0.992018271303557}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0934
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0929
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0905
Epoch 5/30, Step 60/1,Classification Loss: 0.3158, Contrastive Loss: 0.0920
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0875
Epoch 5/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0995
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0849
Accuracy: 0.9997, Precision: 0.9992, Recall: 0.9993, F1: 0.9993
Accuracy: 0.9965, Precision: 0.9909, Recall: 0.9926, F1: 0.9918
Epoch 5/30
Training - Loss: 53.8952
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9992105457910277, 'recall': 0.9993112218049893, 'f1': 0.9992608767506554}
Validation Metrics: {'accuracy': 0.9964842376655338, 'precision': 0.9909361495529856, 'recall': 0.9925743142949339, 'f1': 0.9917533564506091}
Epoch 6/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0925
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0828
Epoch 6/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0946
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0805
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0796
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0783
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0771
Accuracy: 0.9997, Precision: 0.9991, Recall: 0.9994, F1: 0.9993
Accuracy: 0.9964, Precision: 0.9917, Recall: 0.9913, F1: 0.9915
Epoch 6/30
Training - Loss: 52.9175
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9991133538511552, 'recall': 0.9994138678959669, 'f1': 0.9992635479685243}
Validation Metrics: {'accuracy': 0.9963670455877183, 'precision': 0.99166603367613, 'recall': 0.9912555663117135, 'f1': 0.9914606822821981}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0764
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0754
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0752
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0734
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0737
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0714
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0706
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9962, Precision: 0.9904, Recall: 0.9920, F1: 0.9912
Epoch 7/30
Training - Loss: 51.6619
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.999539048344589, 'recall': 0.9992291734377248, 'f1': 0.9993840447410673}
Validation Metrics: {'accuracy': 0.9962498535099027, 'precision': 0.9903872872346448, 'recall': 0.9920236205227493, 'f1': 0.9912035802139829}
Epoch 8/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0801
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0689
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0683
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0671
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0663
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0656
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0646
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9964, Precision: 0.9901, Recall: 0.9929, F1: 0.9915
Epoch 8/30
Training - Loss: 50.8572
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.999442142961185, 'recall': 0.9993405318454558, 'f1': 0.9993913302495154}
Validation Metrics: {'accuracy': 0.9963670455877183, 'precision': 0.990064637251178, 'recall': 0.9929250080671184, 'f1': 0.9914890978710148}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0641
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0633
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0626
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0617
Epoch 9/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0744
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0604
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0595
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9967, Precision: 0.9919, Recall: 0.9927, F1: 0.9923
Epoch 9/30
Training - Loss: 50.3749
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9994422524845449, 'recall': 0.9993406699473876, 'f1': 0.9993914540654731}
Validation Metrics: {'accuracy': 0.9967186218211649, 'precision': 0.991886725348982, 'recall': 0.9927076476282672, 'f1': 0.9922967162868653}
Epoch 10/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0592
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0582
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0575
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0569
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0561
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0554
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0549
Accuracy: 0.9998, Precision: 0.9996, Recall: 0.9994, F1: 0.9995
Accuracy: 0.9961, Precision: 0.9895, Recall: 0.9924, F1: 0.9909
Epoch 10/30
Training - Loss: 49.5521
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9995584403099254, 'recall': 0.9993536658247695, 'f1': 0.999456024094196}
Validation Metrics: {'accuracy': 0.9961326614320872, 'precision': 0.9895171390733916, 'recall': 0.9923743142949338, 'f1': 0.9909400074110803}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0544
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0537
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0530
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0524
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0517
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0511
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0505
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9965, Precision: 0.9917, Recall: 0.9917, F1: 0.9917
Epoch 11/30
Training - Loss: 48.7584
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9997646095556585, 'recall': 0.999158530043156, 'f1': 0.9994613147775091}
Validation Metrics: {'accuracy': 0.9964842376655338, 'precision': 0.9917395934172314, 'recall': 0.9917395934172314, 'f1': 0.9917395934172314}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0501
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0495
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0489
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0484
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 12/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1131
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0469
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9962, Precision: 0.9904, Recall: 0.9920, F1: 0.9912
Epoch 12/30
Training - Loss: 48.4250
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9997814557786193, 'recall': 0.9992766752638382, 'f1': 0.999528888605988}
Validation Metrics: {'accuracy': 0.9962498535099027, 'precision': 0.9903872872346448, 'recall': 0.9920236205227493, 'f1': 0.9912035802139829}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0463
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0466
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0452
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0448
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0443
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0437
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0431
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9964, Precision: 0.9917, Recall: 0.9913, F1: 0.9915
Epoch 13/30
Training - Loss: 47.8955
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9997635938184781, 'recall': 0.9991503106395154, 'f1': 0.9994566921983941}
Validation Metrics: {'accuracy': 0.9963670455877183, 'precision': 0.99166603367613, 'recall': 0.9912555663117135, 'f1': 0.9914606822821981}
Epoch 14/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0443
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0425
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0418
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0413
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0408
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0405
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9990, F1: 0.9994
Accuracy: 0.9964, Precision: 0.9913, Recall: 0.9917, F1: 0.9915
Epoch 14/30
Training - Loss: 47.3815
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9997475556419422, 'recall': 0.9990382736220553, 'f1': 0.9993925657129523}
Validation Metrics: {'accuracy': 0.9963670455877183, 'precision': 0.9912629227417298, 'recall': 0.9916729267505647, 'f1': 0.9914678072555264}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0396
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0391
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0386
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0382
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0379
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0369
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9965, Precision: 0.9917, Recall: 0.9917, F1: 0.9917
Epoch 15/30
Training - Loss: 46.9750
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9996454846698755, 'recall': 0.9991372859331821, 'f1': 0.9993912063734879}
Validation Metrics: {'accuracy': 0.9964842376655338, 'precision': 0.9917395934172314, 'recall': 0.9917395934172314, 'f1': 0.9917395934172314}
Epoch 16/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0397
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0362
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 16/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0503
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0348
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9965, Precision: 0.9913, Recall: 0.9922, F1: 0.9917
Epoch 16/30
Training - Loss: 46.6620
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9995428371639852, 'recall': 0.9992369718439302, 'f1': 0.9993898397603587}
Validation Metrics: {'accuracy': 0.9964842376655338, 'precision': 0.9913369491123558, 'recall': 0.9921569538560826, 'f1': 0.9917464817359272}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0336
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0322
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0318
Accuracy: 0.9998, Precision: 0.9995, Recall: 0.9996, F1: 0.9995
Accuracy: 0.9965, Precision: 0.9913, Recall: 0.9922, F1: 0.9917
Epoch 17/30
Training - Loss: 46.2767
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9994824280617145, 'recall': 0.9995823464700224, 'f1': 0.9995323803082502}
Validation Metrics: {'accuracy': 0.9964842376655338, 'precision': 0.9913369491123558, 'recall': 0.9921569538560826, 'f1': 0.9917464817359272}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0311
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0303
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0299
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0296
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9962, Precision: 0.9912, Recall: 0.9912, F1: 0.9912
Epoch 18/30
Training - Loss: 45.9922
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9996457459686958, 'recall': 0.9991382613667089, 'f1': 0.9993918251533517}
Validation Metrics: {'accuracy': 0.9962498535099027, 'precision': 0.9911888996450469, 'recall': 0.9911888996450469, 'f1': 0.9911888996450469}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 19/30, Step 40/1,Classification Loss: 0.3270, Contrastive Loss: 0.0319
Epoch 19/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0320
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0282
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9965, Precision: 0.9913, Recall: 0.9922, F1: 0.9917
Epoch 19/30
Training - Loss: 45.8588
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9997815533625658, 'recall': 0.9992773379974179, 'f1': 0.9995292690901065}
Validation Metrics: {'accuracy': 0.9964842376655338, 'precision': 0.9913369491123558, 'recall': 0.9921569538560826, 'f1': 0.9917464817359272}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0268
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9962, Precision: 0.9916, Recall: 0.9908, F1: 0.9912
Epoch 20/30
Training - Loss: 45.5175
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9997644179258027, 'recall': 0.999156977049884, 'f1': 0.9994604415234207}
Validation Metrics: {'accuracy': 0.9962498535099027, 'precision': 0.9915924780226728, 'recall': 0.9907715392061955, 'f1': 0.9911815375520989}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0255
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9962, Precision: 0.9912, Recall: 0.9912, F1: 0.9912
Epoch 21/30
Training - Loss: 45.2825
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9997639593393717, 'recall': 0.9991532649974351, 'f1': 0.9994583539438715}
Validation Metrics: {'accuracy': 0.9962498535099027, 'precision': 0.9911888996450469, 'recall': 0.9911888996450469, 'f1': 0.9911888996450469}
Epoch 22/30, Step 0/1,Classification Loss: 0.3141, Contrastive Loss: 0.0283
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Epoch 22/30, Step 60/1,Classification Loss: 0.3183, Contrastive Loss: 0.0245
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 22/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0247
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9965, Precision: 0.9913, Recall: 0.9922, F1: 0.9917
Epoch 22/30
Training - Loss: 45.0597
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9997813090024237, 'recall': 0.9992756788097915, 'f1': 0.9995283165011002}
Validation Metrics: {'accuracy': 0.9964842376655338, 'precision': 0.9913369491123558, 'recall': 0.9921569538560826, 'f1': 0.9917464817359272}
Epoch 23/30, Step 0/1,Classification Loss: 0.3278, Contrastive Loss: 0.0312
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9962, Precision: 0.9912, Recall: 0.9912, F1: 0.9912
Epoch 23/30
Training - Loss: 44.8308
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9996634545594132, 'recall': 0.9992594016816748, 'f1': 0.9994613147775091}
Validation Metrics: {'accuracy': 0.9962498535099027, 'precision': 0.9911888996450469, 'recall': 0.9911888996450469, 'f1': 0.9911888996450469}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9995, F1: 0.9996
Accuracy: 0.9959, Precision: 0.9902, Recall: 0.9906, F1: 0.9904
Epoch 24/30
Training - Loss: 44.7607
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.9996976403815587, 'recall': 0.9994961810320204, 'f1': 0.9995968825075423}
Validation Metrics: {'accuracy': 0.9958982772764561, 'precision': 0.9901624536398534, 'recall': 0.9905715392061956, 'f1': 0.9903668791594653}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9988, F1: 0.9993
Accuracy: 0.9968, Precision: 0.9948, Recall: 0.9903, F1: 0.9925
Epoch 25/30
Training - Loss: 44.6179
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.999713933741645, 'recall': 0.9988014773201696, 'f1': 0.9992571280803815}
Validation Metrics: {'accuracy': 0.9968358138989805, 'precision': 0.9948212940655076, 'recall': 0.9902701516618264, 'f1': 0.9925313164506613}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9966, Precision: 0.9930, Recall: 0.9910, F1: 0.9920
Epoch 26/30
Training - Loss: 44.6032
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9997637160021544, 'recall': 0.9991512977739312, 'f1': 0.9994572474616181}
Validation Metrics: {'accuracy': 0.9966014297433493, 'precision': 0.9930308458433678, 'recall': 0.9909715392061955, 'f1': 0.9919982357490088}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 27/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0547
Epoch 27/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0204
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9968, Precision: 0.9932, Recall: 0.9919, F1: 0.9926
Epoch 27/30
Training - Loss: 44.4604
Training Metrics: {'accuracy': 0.9998237781954887, 'precision': 0.999797474773229, 'recall': 0.9993901202259998, 'f1': 0.9995936826531205}
Validation Metrics: {'accuracy': 0.9968358138989805, 'precision': 0.9931751571216174, 'recall': 0.9919395934172314, 'f1': 0.9925563118108323}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9967, Precision: 0.9931, Recall: 0.9915, F1: 0.9923
Epoch 28/30
Training - Loss: 44.3858
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9997818932345096, 'recall': 0.9992796477351125, 'f1': 0.9995305950264426}
Validation Metrics: {'accuracy': 0.9967186218211649, 'precision': 0.993102998128889, 'recall': 0.9914555663117135, 'f1': 0.9922773907559342}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 29/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0183
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 29/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0179
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9991, F1: 0.9995
Accuracy: 0.9967, Precision: 0.9931, Recall: 0.9915, F1: 0.9923
Epoch 29/30
Training - Loss: 44.2710
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9997631510921028, 'recall': 0.9991467373572176, 'f1': 0.9994546820009913}
Validation Metrics: {'accuracy': 0.9967186218211649, 'precision': 0.993102998128889, 'recall': 0.9914555663117135, 'f1': 0.9922773907559342}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 100/1,Classification Loss: 0.3235, Contrastive Loss: 0.0183
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Accuracy: 0.9999, Precision: 0.9998, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9967, Precision: 0.9931, Recall: 0.9915, F1: 0.9923
Epoch 30/30
Training - Loss: 44.1644
Training Metrics: {'accuracy': 0.9998531484962406, 'precision': 0.999814800134335, 'recall': 0.9995110846986093, 'f1': 0.9996628784473844}
Validation Metrics: {'accuracy': 0.9967186218211649, 'precision': 0.993102998128889, 'recall': 0.9914555663117135, 'f1': 0.9922773907559342}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5199, 5814), y shape: (5199,), y distribution: Counter({np.float64(0.0): 4599, np.float64(1.0): 600}), env shape: (5199,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9388, Precision: 0.9436, Recall: 0.7466, F1: 0.8093
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8615]))
original train data shape: torch.Size([42762]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5199, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42762]), new train data shape: torch.Size([42762])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8615]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.5957
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.7678
Epoch 1/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.3762
Epoch 1/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.2835
Epoch 1/30, Step 80/1,Classification Loss: 0.3242, Contrastive Loss: 0.1995
Epoch 1/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.1932
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1556
Accuracy: 0.9991, Precision: 0.9985, Recall: 0.9975, F1: 0.9980
Accuracy: 0.9964, Precision: 0.9934, Recall: 0.9897, F1: 0.9915
Epoch 1/30
Training - Loss: 96.7745
Training Metrics: {'accuracy': 0.9991188909774437, 'precision': 0.9984953209136651, 'recall': 0.997499899695073, 'f1': 0.997996917169552}
Validation Metrics: {'accuracy': 0.9963755407459371, 'precision': 0.9933657442072791, 'recall': 0.9897071210273852, 'f1': 0.9915270580948546}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1494
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1418
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1362
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1323
Epoch 2/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.1330
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1247
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1214
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9963, Precision: 0.9921, Recall: 0.9905, F1: 0.9913
Epoch 2/30
Training - Loss: 60.3330
Training Metrics: {'accuracy': 0.9995594454887218, 'precision': 0.999251043851773, 'recall': 0.9987555732708555, 'f1': 0.9990031368222877}
Validation Metrics: {'accuracy': 0.9962586227054835, 'precision': 0.9920839071345392, 'recall': 0.9904633304645429, 'f1': 0.9912717765501322}
Epoch 3/30, Step 0/1,Classification Loss: 0.3153, Contrastive Loss: 0.1214
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1167
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1139
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1125
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1093
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1067
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1045
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9964, Precision: 0.9926, Recall: 0.9905, F1: 0.9915
Epoch 3/30
Training - Loss: 57.0577
Training Metrics: {'accuracy': 0.9995300751879699, 'precision': 0.9991266419113123, 'recall': 0.9987244897959184, 'f1': 0.9989254532904663}
Validation Metrics: {'accuracy': 0.9963755407459371, 'precision': 0.9925579207753665, 'recall': 0.9905299349670073, 'f1': 0.9915410452940729}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1032
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1011
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1001
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0974
Epoch 4/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0968
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0942
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0922
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9939, Recall: 0.9903, F1: 0.9921
Epoch 4/30
Training - Loss: 54.8438
Training Metrics: {'accuracy': 0.9995888157894737, 'precision': 0.9993634985205471, 'recall': 0.998762963003244, 'f1': 0.9990629794010764}
Validation Metrics: {'accuracy': 0.9966093768268444, 'precision': 0.9939144290316306, 'recall': 0.990251737002125, 'f1': 0.9920736995080899}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0911
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0897
Epoch 5/30, Step 40/1,Classification Loss: 0.3227, Contrastive Loss: 0.0925
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0865
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0851
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0838
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0844
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9984, F1: 0.9988
Accuracy: 0.9963, Precision: 0.9937, Recall: 0.9888, F1: 0.9912
Epoch 5/30
Training - Loss: 53.6934
Training Metrics: {'accuracy': 0.9994713345864662, 'precision': 0.9991976616770692, 'recall': 0.9984004870211308, 'f1': 0.9987986305347837}
Validation Metrics: {'accuracy': 0.9962586227054835, 'precision': 0.9937014495579606, 'recall': 0.9888177025852989, 'f1': 0.9912428713307191}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0816
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0804
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0791
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0795
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0768
Epoch 6/30, Step 100/1,Classification Loss: 0.3259, Contrastive Loss: 0.0801
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0745
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9966, Precision: 0.9927, Recall: 0.9915, F1: 0.9921
Epoch 6/30
Training - Loss: 52.3559
Training Metrics: {'accuracy': 0.9996475563909775, 'precision': 0.9994971298036293, 'recall': 0.9988957630729696, 'f1': 0.9991961945591616}
Validation Metrics: {'accuracy': 0.9966093768268444, 'precision': 0.9927027306512378, 'recall': 0.9914859579115579, 'f1': 0.9920933074954815}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0739
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0728
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0718
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0709
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0712
Epoch 7/30, Step 100/1,Classification Loss: 0.3277, Contrastive Loss: 0.0775
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0679
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9967, Precision: 0.9944, Recall: 0.9903, F1: 0.9923
Epoch 7/30
Training - Loss: 51.5482
Training Metrics: {'accuracy': 0.9997062969924813, 'precision': 0.9995286491969987, 'recall': 0.9991245920539179, 'f1': 0.9993265072565045}
Validation Metrics: {'accuracy': 0.996726294867298, 'precision': 0.994392568607681, 'recall': 0.9903183415045893, 'f1': 0.9923438540602088}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0675
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0664
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0656
Epoch 8/30, Step 60/1,Classification Loss: 0.3159, Contrastive Loss: 0.0696
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0640
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0634
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0624
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9966, Precision: 0.9927, Recall: 0.9915, F1: 0.9921
Epoch 8/30
Training - Loss: 50.5655
Training Metrics: {'accuracy': 0.9996475563909775, 'precision': 0.9992907887891793, 'recall': 0.9990879629293137, 'f1': 0.9991893473267426}
Validation Metrics: {'accuracy': 0.9966093768268444, 'precision': 0.9927027306512378, 'recall': 0.9914859579115579, 'f1': 0.9920933074954815}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0617
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0632
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0601
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0596
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0586
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0579
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0571
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9990, F1: 0.9993
Accuracy: 0.9963, Precision: 0.9933, Recall: 0.9892, F1: 0.9913
Epoch 9/30
Training - Loss: 49.7887
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9995151602297644, 'recall': 0.9990161129398326, 'f1': 0.9992654628826967}
Validation Metrics: {'accuracy': 0.9962586227054835, 'precision': 0.9932942858478311, 'recall': 0.9892291095551099, 'f1': 0.9912501189259528}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0566
Epoch 10/30, Step 20/1,Classification Loss: 0.3148, Contrastive Loss: 0.0566
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0552
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0545
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0538
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0532
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9967, Precision: 0.9932, Recall: 0.9916, F1: 0.9924
Epoch 10/30
Training - Loss: 49.2524
Training Metrics: {'accuracy': 0.9996475563909775, 'precision': 0.9994012484553534, 'recall': 0.9990050976733785, 'f1': 0.9992030632879039}
Validation Metrics: {'accuracy': 0.996726294867298, 'precision': 0.9931767380969843, 'recall': 0.9915525624140222, 'f1': 0.9923628044813657}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0521
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0514
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0508
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0502
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0496
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0490
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0483
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9966, Precision: 0.9927, Recall: 0.9915, F1: 0.9921
Epoch 11/30
Training - Loss: 48.7688
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9996137895734267, 'recall': 0.9989098445085527, 'f1': 0.9992614723541111}
Validation Metrics: {'accuracy': 0.9966093768268444, 'precision': 0.9927027306512378, 'recall': 0.9914859579115579, 'f1': 0.9920933074954815}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0480
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0474
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0468
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0471
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0477
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0456
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0447
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9964, Precision: 0.9926, Recall: 0.9905, F1: 0.9915
Epoch 12/30
Training - Loss: 48.2153
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9996656781372049, 'recall': 0.9992664467710755, 'f1': 0.999465951322517}
Validation Metrics: {'accuracy': 0.9963755407459371, 'precision': 0.9925579207753665, 'recall': 0.9905299349670073, 'f1': 0.9915410452940729}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0442
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0437
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0432
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0427
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0422
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0416
Epoch 13/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0479
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9961, Precision: 0.9924, Recall: 0.9896, F1: 0.9910
Epoch 13/30
Training - Loss: 47.6664
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9994784083814392, 'recall': 0.9987720889097436, 'f1': 0.9991249019732302}
Validation Metrics: {'accuracy': 0.9961417046650298, 'precision': 0.9924131355188633, 'recall': 0.9895739120224565, 'f1': 0.990987868782266}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0409
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0389
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0380
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9966, Precision: 0.9919, Recall: 0.9923, F1: 0.9921
Epoch 14/30
Training - Loss: 47.2085
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9996482206144333, 'recall': 0.9991475086424737, 'f1': 0.9993976900117039}
Validation Metrics: {'accuracy': 0.9966093768268444, 'precision': 0.9919040889542425, 'recall': 0.9923087718511798, 'f1': 0.992106315631724}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0377
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0365
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9965, Precision: 0.9926, Recall: 0.9910, F1: 0.9918
Epoch 15/30
Training - Loss: 47.0763
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9996145900930472, 'recall': 0.9989137809424646, 'f1': 0.9992638433476382}
Validation Metrics: {'accuracy': 0.9964924587863907, 'precision': 0.9926303226157618, 'recall': 0.9910079464392826, 'f1': 0.991817290515749}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 16/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0387
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0337
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0326
Accuracy: 0.9998, Precision: 0.9996, Recall: 0.9995, F1: 0.9995
Accuracy: 0.9968, Precision: 0.9932, Recall: 0.9920, F1: 0.9926
Epoch 16/30
Training - Loss: 46.5090
Training Metrics: {'accuracy': 0.9997944078947368, 'precision': 0.9995829029255674, 'recall': 0.9994831788637457, 'f1': 0.9995330339592028}
Validation Metrics: {'accuracy': 0.9968432129077517, 'precision': 0.993248694932803, 'recall': 0.9920305738862976, 'f1': 0.9926385966337241}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0348
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0312
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0309
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9931, Recall: 0.9911, F1: 0.9921
Epoch 17/30
Training - Loss: 46.1144
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9994823276058574, 'recall': 0.9987859790132899, 'f1': 0.999133814631662}
Validation Metrics: {'accuracy': 0.9966093768268444, 'precision': 0.9931047883424945, 'recall': 0.9910745509417469, 'f1': 0.9920867843073586}
Epoch 18/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0306
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0295
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0290
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 18/30, Step 100/1,Classification Loss: 0.3146, Contrastive Loss: 0.0311
Epoch 18/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0423
Accuracy: 0.9996, Precision: 0.9996, Recall: 0.9987, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9923, Recall: 0.9919, F1: 0.9921
Epoch 18/30
Training - Loss: 45.8161
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9995822197765954, 'recall': 0.9986879069067118, 'f1': 0.9991345045026838}
Validation Metrics: {'accuracy': 0.9966093768268444, 'precision': 0.9923025009367998, 'recall': 0.9918973648813689, 'f1': 0.992099817924782}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Epoch 19/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0411
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0268
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0265
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0263
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9965, Precision: 0.9922, Recall: 0.9914, F1: 0.9918
Epoch 19/30
Training - Loss: 45.5775
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.999479494391233, 'recall': 0.9987759352318197, 'f1': 0.9991273703624347}
Validation Metrics: {'accuracy': 0.9964924587863907, 'precision': 0.9922296309562624, 'recall': 0.9914193534090936, 'f1': 0.9918240320372782}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0255
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0263
Epoch 20/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0273
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9961, Precision: 0.9920, Recall: 0.9900, F1: 0.9910
Epoch 20/30
Training - Loss: 45.4848
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9996130329596637, 'recall': 0.9989061270043138, 'f1': 0.9992592329096571}
Validation Metrics: {'accuracy': 0.9961417046650298, 'precision': 0.9920110532082386, 'recall': 0.9899853189922676, 'f1': 0.9909953062807874}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9963, Precision: 0.9921, Recall: 0.9905, F1: 0.9913
Epoch 21/30
Training - Loss: 45.0402
Training Metrics: {'accuracy': 0.9997062969924813, 'precision': 0.9995325013933607, 'recall': 0.999133931007556, 'f1': 0.999333105347081}
Validation Metrics: {'accuracy': 0.9962586227054835, 'precision': 0.9920839071345392, 'recall': 0.9904633304645429, 'f1': 0.9912717765501322}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 22/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0356
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9963, Precision: 0.9921, Recall: 0.9905, F1: 0.9913
Epoch 22/30
Training - Loss: 44.8736
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9996638719122379, 'recall': 0.9992607232724072, 'f1': 0.9994621846658167}
Validation Metrics: {'accuracy': 0.9962586227054835, 'precision': 0.9920839071345392, 'recall': 0.9904633304645429, 'f1': 0.9912717765501322}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0321
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9961, Precision: 0.9912, Recall: 0.9908, F1: 0.9910
Epoch 23/30
Training - Loss: 44.7284
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9996483732719914, 'recall': 0.9991480796594584, 'f1': 0.9993980520882128}
Validation Metrics: {'accuracy': 0.9961417046650298, 'precision': 0.9912123718751036, 'recall': 0.9908081329318894, 'f1': 0.9910101376385452}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9963, Precision: 0.9925, Recall: 0.9901, F1: 0.9913
Epoch 24/30
Training - Loss: 44.4918
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9996131847598213, 'recall': 0.9989068726168491, 'f1': 0.9992596820951241}
Validation Metrics: {'accuracy': 0.9962586227054835, 'precision': 0.9924855250898443, 'recall': 0.9900519234947319, 'f1': 0.9912645714949578}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 25/30, Step 100/1,Classification Loss: 0.3184, Contrastive Loss: 0.0240
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Accuracy: 0.9998, Precision: 0.9996, Recall: 0.9994, F1: 0.9995
Accuracy: 0.9957, Precision: 0.9913, Recall: 0.9885, F1: 0.9899
Epoch 25/30
Training - Loss: 44.5136
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9995657869279471, 'recall': 0.9993661712828898, 'f1': 0.999465951322517}
Validation Metrics: {'accuracy': 0.9956740325032153, 'precision': 0.9913175867030886, 'recall': 0.9884846800729772, 'f1': 0.9898954892407225}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9959, Precision: 0.9923, Recall: 0.9886, F1: 0.9904
Epoch 26/30
Training - Loss: 44.6407
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9993811244221282, 'recall': 0.9988816552307715, 'f1': 0.9991312158471738}
Validation Metrics: {'accuracy': 0.9959078685841225, 'precision': 0.9922683745585759, 'recall': 0.9886178890779058, 'f1': 0.9904337752683843}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9958, Precision: 0.9910, Recall: 0.9894, F1: 0.9902
Epoch 27/30
Training - Loss: 44.3687
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9992842724867025, 'recall': 0.9989865814054404, 'f1': 0.999135364993661}
Validation Metrics: {'accuracy': 0.9957909505436688, 'precision': 0.9909910761720941, 'recall': 0.9893740985150634, 'f1': 0.9901807486188987}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9959, Precision: 0.9919, Recall: 0.9890, F1: 0.9904
Epoch 28/30
Training - Loss: 44.3395
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9992837494810995, 'recall': 0.9989857281787167, 'f1': 0.9991346767649378}
Validation Metrics: {'accuracy': 0.9959078685841225, 'precision': 0.991865361110976, 'recall': 0.9890292960477168, 'f1': 0.9904416790114943}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0319
Epoch 29/30, Step 120/1,Classification Loss: 0.3138, Contrastive Loss: 0.0208
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9958, Precision: 0.9902, Recall: 0.9902, F1: 0.9902
Epoch 29/30
Training - Loss: 44.2646
Training Metrics: {'accuracy': 0.9995594454887218, 'precision': 0.9991554259969202, 'recall': 0.9988600266718305, 'f1': 0.9990076651474848}
Validation Metrics: {'accuracy': 0.9957909505436688, 'precision': 0.9901969124546854, 'recall': 0.9901969124546854, 'f1': 0.9901969124546854}
Epoch 30/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0183
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9961, Precision: 0.9912, Recall: 0.9908, F1: 0.9910
Epoch 30/30
Training - Loss: 44.2518
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9992700625596211, 'recall': 0.9989634132230152, 'f1': 0.999116672846129}
Validation Metrics: {'accuracy': 0.9961417046650298, 'precision': 0.9912123718751036, 'recall': 0.9908081329318894, 'f1': 0.9910101376385452}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5189, 5814), y shape: (5189,), y distribution: Counter({np.float64(0.0): 4589, np.float64(1.0): 600}), env shape: (5189,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9389, Precision: 0.9535, Recall: 0.7424, F1: 0.8074
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8715]))
original train data shape: torch.Size([42862]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5189, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42862]), new train data shape: torch.Size([42862])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8715]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3146, Contrastive Loss: 1.5725
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.8733
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3991
Epoch 1/30, Step 60/1,Classification Loss: 0.3138, Contrastive Loss: 0.2389
Epoch 1/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.1842
Epoch 1/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1683
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1395
Accuracy: 0.9994, Precision: 0.9986, Recall: 0.9987, F1: 0.9986
Accuracy: 0.9962, Precision: 0.9921, Recall: 0.9901, F1: 0.9911
Epoch 1/30
Training - Loss: 98.3196
Training Metrics: {'accuracy': 0.9993832236842105, 'precision': 0.9985669856209096, 'recall': 0.9986648608129749, 'f1': 0.9986159164807897}
Validation Metrics: {'accuracy': 0.9961507057039543, 'precision': 0.9921135132467953, 'recall': 0.990122647486762, 'f1': 0.9911152846066321}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1322
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1242
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1186
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1138
Epoch 2/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.1147
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1073
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1059
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9992, F1: 0.9993
Accuracy: 0.9960, Precision: 0.9916, Recall: 0.9901, F1: 0.9908
Epoch 2/30
Training - Loss: 57.6438
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9993255545749187, 'recall': 0.9992278724396932, 'f1': 0.999276706799679}
Validation Metrics: {'accuracy': 0.996034060422256, 'precision': 0.9916470147292058, 'recall': 0.9900560784546758, 'f1': 0.9908497597874376}
Epoch 3/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.1061
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1024
Epoch 3/30, Step 40/1,Classification Loss: 0.3172, Contrastive Loss: 0.1089
Epoch 3/30, Step 60/1,Classification Loss: 0.3274, Contrastive Loss: 0.1053
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0975
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0948
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0934
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9958, Precision: 0.9911, Recall: 0.9895, F1: 0.9903
Epoch 3/30
Training - Loss: 55.1882
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9991906316150636, 'recall': 0.9990923830247663, 'f1': 0.999141500547318}
Validation Metrics: {'accuracy': 0.9958007698588592, 'precision': 0.9911078913376775, 'recall': 0.9895186996297458, 'f1': 0.9903115103631692}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0934
Epoch 4/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0932
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0898
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0882
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0868
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0856
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0842
Accuracy: 0.9997, Precision: 0.9992, Recall: 0.9993, F1: 0.9993
Accuracy: 0.9965, Precision: 0.9935, Recall: 0.9903, F1: 0.9919
Epoch 4/30
Training - Loss: 53.9037
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9992317225510473, 'recall': 0.9993287384769335, 'f1': 0.9992802238807226}
Validation Metrics: {'accuracy': 0.9965006415490494, 'precision': 0.9935183177947934, 'recall': 0.9903223545830209, 'f1': 0.9919131491270766}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0835
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0823
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0826
Epoch 5/30, Step 60/1,Classification Loss: 0.3454, Contrastive Loss: 0.1158
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0789
Epoch 5/30, Step 100/1,Classification Loss: 0.3194, Contrastive Loss: 0.0823
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0767
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9959, Precision: 0.9924, Recall: 0.9888, F1: 0.9906
Epoch 5/30
Training - Loss: 52.8294
Training Metrics: {'accuracy': 0.9995300751879699, 'precision': 0.9992400896999141, 'recall': 0.9986531759736663, 'f1': 0.9989463906868153}
Validation Metrics: {'accuracy': 0.9959174151405575, 'precision': 0.9923643945363803, 'recall': 0.9887767871403172, 'f1': 0.9905615077932713}
Epoch 6/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0927
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0760
Epoch 6/30, Step 40/1,Classification Loss: 0.3441, Contrastive Loss: 0.0944
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0730
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0720
Epoch 6/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0864
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0703
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9990, F1: 0.9990
Accuracy: 0.9964, Precision: 0.9927, Recall: 0.9907, F1: 0.9917
Epoch 6/30
Training - Loss: 51.8274
Training Metrics: {'accuracy': 0.9995594454887218, 'precision': 0.9990526907312471, 'recall': 0.9989535966524461, 'f1': 0.9990031368222877}
Validation Metrics: {'accuracy': 0.996383996267351, 'precision': 0.9926530748908793, 'recall': 0.990660026311692, 'f1': 0.9916537522062301}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0699
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0689
Epoch 7/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0745
Epoch 7/30, Step 60/1,Classification Loss: 0.3153, Contrastive Loss: 0.0714
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0661
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0658
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0643
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9993, F1: 0.9993
Accuracy: 0.9956, Precision: 0.9898, Recall: 0.9898, F1: 0.9898
Epoch 7/30
Training - Loss: 51.0610
Training Metrics: {'accuracy': 0.9997062969924813, 'precision': 0.9993375936056617, 'recall': 0.9993375936056617, 'f1': 0.9993375936056617}
Validation Metrics: {'accuracy': 0.9955674792954625, 'precision': 0.9897898023263307, 'recall': 0.9897898023263307, 'f1': 0.9897898023263307}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0638
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0630
Epoch 8/30, Step 40/1,Classification Loss: 0.3258, Contrastive Loss: 0.0689
Epoch 8/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0728
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0606
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0599
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0592
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9964, Precision: 0.9934, Recall: 0.9899, F1: 0.9916
Epoch 8/30
Training - Loss: 50.1969
Training Metrics: {'accuracy': 0.9995594454887218, 'precision': 0.9992538733798355, 'recall': 0.9987614052789382, 'f1': 0.9990074692891647}
Validation Metrics: {'accuracy': 0.996383996267351, 'precision': 0.9934470408761189, 'recall': 0.9898515447901772, 'f1': 0.9916401926168975}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0586
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0579
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0573
Epoch 9/30, Step 60/1,Classification Loss: 0.3376, Contrastive Loss: 0.1104
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0559
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0551
Epoch 9/30, Step 120/1,Classification Loss: 0.3138, Contrastive Loss: 0.0566
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9963, Precision: 0.9930, Recall: 0.9898, F1: 0.9914
Epoch 9/30
Training - Loss: 49.5082
Training Metrics: {'accuracy': 0.9995594454887218, 'precision': 0.9992489668592521, 'recall': 0.9987512938081998, 'f1': 0.9989999573427136}
Validation Metrics: {'accuracy': 0.9962673509856527, 'precision': 0.9929774362885371, 'recall': 0.989784975758091, 'f1': 0.9913740257355484}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0540
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0546
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0526
Epoch 10/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0655
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0514
Epoch 10/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0529
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0501
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9966, Precision: 0.9928, Recall: 0.9916, F1: 0.9922
Epoch 10/30
Training - Loss: 48.9568
Training Metrics: {'accuracy': 0.9996475563909775, 'precision': 0.9992076169496338, 'recall': 0.9992076169496338, 'f1': 0.9992076169496338}
Validation Metrics: {'accuracy': 0.9966172868307477, 'precision': 0.9927974548233918, 'recall': 0.9916016458973793, 'f1': 0.9921985438382204}
Epoch 11/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0501
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0492
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0484
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0479
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0473
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0467
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9992, F1: 0.9993
Accuracy: 0.9962, Precision: 0.9921, Recall: 0.9901, F1: 0.9911
Epoch 11/30
Training - Loss: 48.3883
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9993195968244972, 'recall': 0.9992206692089531, 'f1': 0.9992701261688746}
Validation Metrics: {'accuracy': 0.9961507057039543, 'precision': 0.9921135132467953, 'recall': 0.990122647486762, 'f1': 0.9911152846066321}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0465
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0452
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0448
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0441
Epoch 12/30, Step 80/1,Classification Loss: 0.3194, Contrastive Loss: 0.0476
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0431
Epoch 12/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0570
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9963, Precision: 0.9934, Recall: 0.9894, F1: 0.9914
Epoch 12/30
Training - Loss: 47.9538
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9996176779666468, 'recall': 0.9989289969008857, 'f1': 0.9992730049032124}
Validation Metrics: {'accuracy': 0.9962673509856527, 'precision': 0.9933757721725177, 'recall': 0.9893807349973335, 'f1': 0.9913670136946573}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0417
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0411
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0414
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0402
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0394
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9965, Precision: 0.9927, Recall: 0.9911, F1: 0.9919
Epoch 13/30
Training - Loss: 47.3263
Training Metrics: {'accuracy': 0.9997062969924813, 'precision': 0.999535120051467, 'recall': 0.9991402854759719, 'f1': 0.9993375936056617}
Validation Metrics: {'accuracy': 0.9965006415490494, 'precision': 0.9927252615122621, 'recall': 0.9911308361045357, 'f1': 0.9919262586359743}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0390
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0384
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0380
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0382
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0371
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0370
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0362
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9963, Precision: 0.9934, Recall: 0.9894, F1: 0.9914
Epoch 14/30
Training - Loss: 47.0528
Training Metrics: {'accuracy': 0.9997062969924813, 'precision': 0.9995381454696867, 'recall': 0.999147633263728, 'f1': 0.9993427821524741}
Validation Metrics: {'accuracy': 0.9962673509856527, 'precision': 0.9933757721725177, 'recall': 0.9893807349973335, 'f1': 0.9913670136946573}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0359
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0355
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0347
Epoch 15/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0367
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9962, Precision: 0.9925, Recall: 0.9897, F1: 0.9911
Epoch 15/30
Training - Loss: 46.6261
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9994198183264007, 'recall': 0.9991240176334637, 'f1': 0.9992718566823858}
Validation Metrics: {'accuracy': 0.9961507057039543, 'precision': 0.9925087215642963, 'recall': 0.9897184067260046, 'f1': 0.991108074381656}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0329
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0318
Epoch 16/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0485
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0310
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9959, Precision: 0.9928, Recall: 0.9884, F1: 0.9906
Epoch 16/30
Training - Loss: 46.2952
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9996164647177992, 'recall': 0.9989230123062085, 'f1': 0.9992694022069384}
Validation Metrics: {'accuracy': 0.9959174151405575, 'precision': 0.9927623025740416, 'recall': 0.9883725463795598, 'f1': 0.990553830948786}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 17/30, Step 100/1,Classification Loss: 0.3180, Contrastive Loss: 0.0360
Epoch 17/30, Step 120/1,Classification Loss: 0.3266, Contrastive Loss: 0.0331
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9958, Precision: 0.9919, Recall: 0.9887, F1: 0.9903
Epoch 17/30
Training - Loss: 45.9317
Training Metrics: {'accuracy': 0.9996475563909775, 'precision': 0.9994052369832427, 'recall': 0.9990133242400354, 'f1': 0.9992091727475745}
Validation Metrics: {'accuracy': 0.9958007698588592, 'precision': 0.9918956732760246, 'recall': 0.988710218108231, 'f1': 0.990295778952492}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0300
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0275
Epoch 18/30, Step 100/1,Classification Loss: 0.3174, Contrastive Loss: 0.0277
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9962, Precision: 0.9929, Recall: 0.9893, F1: 0.9911
Epoch 18/30
Training - Loss: 45.5978
Training Metrics: {'accuracy': 0.9997062969924813, 'precision': 0.9996360037133891, 'recall': 0.9990505563618771, 'f1': 0.9993430390210665}
Validation Metrics: {'accuracy': 0.9961507057039543, 'precision': 0.9929057177062496, 'recall': 0.9893141659652472, 'f1': 0.9911008502050844}
Epoch 19/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0319
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0265
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0280
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Accuracy: 0.9998, Precision: 0.9996, Recall: 0.9994, F1: 0.9995
Accuracy: 0.9958, Precision: 0.9911, Recall: 0.9895, F1: 0.9903
Epoch 19/30
Training - Loss: 45.3787
Training Metrics: {'accuracy': 0.9997650375939849, 'precision': 0.9995663386281035, 'recall': 0.9993671109679009, 'f1': 0.999466697103526}
Validation Metrics: {'accuracy': 0.9958007698588592, 'precision': 0.9911078913376775, 'recall': 0.9895186996297458, 'f1': 0.9903115103631692}
Epoch 20/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0401
Epoch 20/30, Step 20/1,Classification Loss: 0.3285, Contrastive Loss: 0.0386
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Epoch 20/30, Step 100/1,Classification Loss: 0.3205, Contrastive Loss: 0.0258
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0237
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9960, Precision: 0.9920, Recall: 0.9897, F1: 0.9908
Epoch 20/30
Training - Loss: 45.2624
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.999554836851131, 'recall': 0.999261713221957, 'f1': 0.9994082146542828}
Validation Metrics: {'accuracy': 0.996034060422256, 'precision': 0.992040894175223, 'recall': 0.9896518376939183, 'f1': 0.9908423382427716}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9964, Precision: 0.9923, Recall: 0.9911, F1: 0.9917
Epoch 21/30
Training - Loss: 44.9451
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9996517227322436, 'recall': 0.9991606254764629, 'f1': 0.9994060049408986}
Validation Metrics: {'accuracy': 0.996383996267351, 'precision': 0.9922587688376723, 'recall': 0.9910642670724494, 'f1': 0.9916605123787872}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 22/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0358
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Accuracy: 0.9995, Precision: 0.9994, Recall: 0.9984, F1: 0.9989
Accuracy: 0.9960, Precision: 0.9920, Recall: 0.9897, F1: 0.9908
Epoch 22/30
Training - Loss: 44.8708
Training Metrics: {'accuracy': 0.9995300751879699, 'precision': 0.9994341286927402, 'recall': 0.9984483708056656, 'f1': 0.998940568591031}
Validation Metrics: {'accuracy': 0.996034060422256, 'precision': 0.992040894175223, 'recall': 0.9896518376939183, 'f1': 0.9908423382427716}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 23/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0354
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9962, Precision: 0.9929, Recall: 0.9893, F1: 0.9911
Epoch 23/30
Training - Loss: 44.7498
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.99965083400657, 'recall': 0.9991572933999615, 'f1': 0.999403893162875}
Validation Metrics: {'accuracy': 0.9961507057039543, 'precision': 0.9929057177062496, 'recall': 0.9893141659652472, 'f1': 0.9911008502050844}
Epoch 24/30, Step 0/1,Classification Loss: 0.3141, Contrastive Loss: 0.0207
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9964, Precision: 0.9930, Recall: 0.9903, F1: 0.9916
Epoch 24/30
Training - Loss: 44.6499
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9996178225028458, 'recall': 0.998929710394975, 'f1': 0.9992734343669047}
Validation Metrics: {'accuracy': 0.996383996267351, 'precision': 0.9930491622633326, 'recall': 0.9902557855509346, 'f1': 0.991646978964586}
Epoch 25/30, Step 0/1,Classification Loss: 0.3167, Contrastive Loss: 0.0243
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9960, Precision: 0.9928, Recall: 0.9888, F1: 0.9908
Epoch 25/30
Training - Loss: 44.6832
Training Metrics: {'accuracy': 0.999735667293233, 'precision': 0.9995520167024177, 'recall': 0.999255892412388, 'f1': 0.999403893162875}
Validation Metrics: {'accuracy': 0.996034060422256, 'precision': 0.9928340064802077, 'recall': 0.9888433561724035, 'f1': 0.9908274520505734}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0220
Epoch 26/30, Step 60/1,Classification Loss: 0.3138, Contrastive Loss: 0.0215
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9962, Precision: 0.9929, Recall: 0.9893, F1: 0.9911
Epoch 26/30
Training - Loss: 44.3565
Training Metrics: {'accuracy': 0.9996769266917294, 'precision': 0.9994150291041753, 'recall': 0.9991154341870638, 'f1': 0.9992651690558217}
Validation Metrics: {'accuracy': 0.9961507057039543, 'precision': 0.9929057177062496, 'recall': 0.9893141659652472, 'f1': 0.9911008502050844}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0180
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0226
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9964, Precision: 0.9927, Recall: 0.9907, F1: 0.9917
Epoch 27/30
Training - Loss: 44.2563
Training Metrics: {'accuracy': 0.9997062969924813, 'precision': 0.9995374698909736, 'recall': 0.9991459919019225, 'f1': 0.9993416232495353}
Validation Metrics: {'accuracy': 0.996383996267351, 'precision': 0.9926530748908793, 'recall': 0.990660026311692, 'f1': 0.9916537522062301}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9959, Precision: 0.9904, Recall: 0.9908, F1: 0.9906
Epoch 28/30
Training - Loss: 44.3773
Training Metrics: {'accuracy': 0.9997062969924813, 'precision': 0.9995331214973793, 'recall': 0.9991354353131677, 'f1': 0.9993341679544283}
Validation Metrics: {'accuracy': 0.9959174151405575, 'precision': 0.990401571814564, 'recall': 0.9907979909441044, 'f1': 0.9905996702655497}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.0237
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Accuracy: 0.9996, Precision: 0.9996, Recall: 0.9987, F1: 0.9991
Accuracy: 0.9962, Precision: 0.9929, Recall: 0.9893, F1: 0.9911
Epoch 29/30
Training - Loss: 44.1695
Training Metrics: {'accuracy': 0.9996181860902256, 'precision': 0.9995836969935308, 'recall': 0.9986970185529357, 'f1': 0.9991398067172761}
Validation Metrics: {'accuracy': 0.9961507057039543, 'precision': 0.9929057177062496, 'recall': 0.9893141659652472, 'f1': 0.9911008502050844}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9960, Precision: 0.9909, Recall: 0.9909, F1: 0.9909
Epoch 30/30
Training - Loss: 44.1540
Training Metrics: {'accuracy': 0.9996475563909775, 'precision': 0.9995030525311107, 'recall': 0.9989145363478391, 'f1': 0.9992085513092853}
Validation Metrics: {'accuracy': 0.996034060422256, 'precision': 0.9908645599761906, 'recall': 0.9908645599761906, 'f1': 0.9908645599761906}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5197, 5814), y shape: (5197,), y distribution: Counter({np.float64(0.0): 4597, np.float64(1.0): 600}), env shape: (5197,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9584, Precision: 0.9728, Recall: 0.8229, F1: 0.8796
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8815]))
original train data shape: torch.Size([42962]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5197, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([42962]), new train data shape: torch.Size([42962])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8815]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 1.6400
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.8534
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3462
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2256
Epoch 1/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1916
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1554
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1416
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9990, F1: 0.9990
Accuracy: 0.9958, Precision: 0.9905, Recall: 0.9905, F1: 0.9905
Epoch 1/30
Training - Loss: 98.3017
Training Metrics: {'accuracy': 0.9995627332089553, 'precision': 0.999073944395978, 'recall': 0.998977702222251, 'f1': 0.9990258167774044}
Validation Metrics: {'accuracy': 0.9958105434656116, 'precision': 0.9904611792926297, 'recall': 0.9904611792926297, 'f1': 0.9904611792926297}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1352
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1278
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1226
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1184
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1153
Epoch 2/30, Step 100/1,Classification Loss: 0.3145, Contrastive Loss: 0.1165
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1099
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9957, Precision: 0.9892, Recall: 0.9912, F1: 0.9902
Epoch 2/30
Training - Loss: 58.3261
Training Metrics: {'accuracy': 0.9996210354477612, 'precision': 0.9991136869800281, 'recall': 0.9992090478751254, 'f1': 0.9991613609941057}
Validation Metrics: {'accuracy': 0.9956941696729896, 'precision': 0.9892482649357057, 'recall': 0.9911883359896867, 'f1': 0.9902156191451117}
Epoch 3/30, Step 0/1,Classification Loss: 0.3251, Contrastive Loss: 0.1103
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1058
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1036
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1018
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0997
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0981
Epoch 3/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1103
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9958, Precision: 0.9901, Recall: 0.9909, F1: 0.9905
Epoch 3/30
Training - Loss: 56.0285
Training Metrics: {'accuracy': 0.9996210354477612, 'precision': 0.9992995484863672, 'recall': 0.9990103549232576, 'f1': 0.9991548927764051}
Validation Metrics: {'accuracy': 0.9958105434656116, 'precision': 0.990080317991368, 'recall': 0.990858028868201, 'f1': 0.9904687430675718}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0952
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0935
Epoch 4/30, Step 40/1,Classification Loss: 0.3201, Contrastive Loss: 0.0941
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0905
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0893
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0878
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0864
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9963, Precision: 0.9923, Recall: 0.9907, F1: 0.9915
Epoch 4/30
Training - Loss: 54.6025
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.9994347755124957, 'recall': 0.9991496186313891, 'f1': 0.9992921394859118}
Validation Metrics: {'accuracy': 0.9962760386360991, 'precision': 0.9922912451975723, 'recall': 0.9907273491089725, 'f1': 0.99150756319048}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0857
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0843
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0831
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0819
Epoch 5/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0888
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0795
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0784
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9962, Precision: 0.9914, Recall: 0.9911, F1: 0.9913
Epoch 5/30
Training - Loss: 53.3129
Training Metrics: {'accuracy': 0.9997376399253731, 'precision': 0.9995595093593737, 'recall': 0.9992700080175738, 'f1': 0.9994146996816797}
Validation Metrics: {'accuracy': 0.9961596648434773, 'precision': 0.9914477785307554, 'recall': 0.9910576562304582, 'f1': 0.9912526093502492}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0777
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0766
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0756
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0746
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0736
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0729
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0720
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9965, Precision: 0.9928, Recall: 0.9913, F1: 0.9920
Epoch 6/30
Training - Loss: 52.2745
Training Metrics: {'accuracy': 0.9997084888059702, 'precision': 0.9996400447829598, 'recall': 0.999063388790692, 'f1': 0.9993514822909748}
Validation Metrics: {'accuracy': 0.996508786221343, 'precision': 0.9928228685263893, 'recall': 0.9912572835927153, 'f1': 0.9920383404910749}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0711
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0701
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0692
Epoch 7/30, Step 60/1,Classification Loss: 0.3446, Contrastive Loss: 0.0900
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0674
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0666
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0657
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9962, Precision: 0.9922, Recall: 0.9903, F1: 0.9912
Epoch 7/30
Training - Loss: 51.3572
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.9994288105370915, 'recall': 0.9991389125962075, 'f1': 0.9992838024162357}
Validation Metrics: {'accuracy': 0.9961596648434773, 'precision': 0.9922188432383461, 'recall': 0.9902639570793154, 'f1': 0.991238689652852}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0651
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0643
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0635
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0628
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0619
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0612
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0606
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9963, Precision: 0.9911, Recall: 0.9919, F1: 0.9915
Epoch 8/30
Training - Loss: 50.6888
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9996717277414933, 'recall': 0.9992831995379923, 'f1': 0.9994773576284031}
Validation Metrics: {'accuracy': 0.9962760386360991, 'precision': 0.9911385077123596, 'recall': 0.9919178978356866, 'f1': 0.9915277716156193}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0602
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0592
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0585
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0577
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0572
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0564
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0559
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9960, Precision: 0.9906, Recall: 0.9914, F1: 0.9910
Epoch 9/30
Training - Loss: 49.9523
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9996744140561215, 'recall': 0.9992917443058638, 'f1': 0.9994829757590629}
Validation Metrics: {'accuracy': 0.9960432910508553, 'precision': 0.9906094128518638, 'recall': 0.9913879633519438, 'f1': 0.9909982573415956}
Epoch 10/30, Step 0/1,Classification Loss: 0.3139, Contrastive Loss: 0.0619
Epoch 10/30, Step 20/1,Classification Loss: 0.3286, Contrastive Loss: 0.0573
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0539
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0533
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0535
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0520
Epoch 10/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0664
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9965, Precision: 0.9936, Recall: 0.9905, F1: 0.9920
Epoch 10/30
Training - Loss: 49.3484
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9997702108562525, 'recall': 0.9991962060606725, 'f1': 0.9994829757590629}
Validation Metrics: {'accuracy': 0.996508786221343, 'precision': 0.993601650533474, 'recall': 0.9904635844415726, 'f1': 0.9920256500677445}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0510
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0505
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0498
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0493
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0486
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0480
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0475
Accuracy: 0.9999, Precision: 0.9998, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9960, Precision: 0.9918, Recall: 0.9902, F1: 0.9910
Epoch 11/30
Training - Loss: 48.7753
Training Metrics: {'accuracy': 0.9998542444029851, 'precision': 0.9998209001162723, 'recall': 0.9995352152939933, 'f1': 0.9996779999803819}
Validation Metrics: {'accuracy': 0.9960432910508553, 'precision': 0.9917596218687553, 'recall': 0.9901974146252297, 'f1': 0.990976785889885}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0471
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0465
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0460
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0454
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0449
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0444
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0439
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9960, Precision: 0.9918, Recall: 0.9902, F1: 0.9910
Epoch 12/30
Training - Loss: 48.1956
Training Metrics: {'accuracy': 0.999825093283582, 'precision': 0.9998027627802908, 'recall': 0.9994156118335717, 'f1': 0.9996090819287273}
Validation Metrics: {'accuracy': 0.9960432910508553, 'precision': 0.9917596218687553, 'recall': 0.9901974146252297, 'f1': 0.990976785889885}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0435
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0430
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0425
Epoch 13/30, Step 60/1,Classification Loss: 0.3156, Contrastive Loss: 0.0431
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0415
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0411
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0412
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9963, Precision: 0.9927, Recall: 0.9903, F1: 0.9915
Epoch 13/30
Training - Loss: 47.7170
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9997700175381266, 'recall': 0.9991946150217554, 'f1': 0.9994820826591033}
Validation Metrics: {'accuracy': 0.9962760386360991, 'precision': 0.9926789202078087, 'recall': 0.990330499533401, 'f1': 0.9915008014052905}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0394
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0389
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0384
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0380
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0376
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9964, Precision: 0.9928, Recall: 0.9908, F1: 0.9918
Epoch 14/30
Training - Loss: 47.3264
Training Metrics: {'accuracy': 0.9997376399253731, 'precision': 0.9996570605867943, 'recall': 0.9991771666093592, 'f1': 0.999416951129517}
Validation Metrics: {'accuracy': 0.996392412428721, 'precision': 0.9927508907911256, 'recall': 0.9907938915630582, 'f1': 0.9917696781587397}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0369
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0365
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0362
Epoch 15/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0418
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0350
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9965, Precision: 0.9932, Recall: 0.9909, F1: 0.9920
Epoch 15/30
Training - Loss: 46.9934
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9997689481838261, 'recall': 0.9991858378110654, 'f1': 0.9994771542596428}
Validation Metrics: {'accuracy': 0.996508786221343, 'precision': 0.9932113927941147, 'recall': 0.9908604340171439, 'f1': 0.9920320013174599}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0370
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0338
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0336
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0327
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9962, Precision: 0.9930, Recall: 0.9895, F1: 0.9912
Epoch 16/30
Training - Loss: 46.8653
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.999719584203925, 'recall': 0.9988545948665357, 'f1': 0.9992865618616467}
Validation Metrics: {'accuracy': 0.9961596648434773, 'precision': 0.99299680357185, 'recall': 0.9894702579281727, 'f1': 0.9912247168942326}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0318
Epoch 17/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0316
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0312
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0304
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9994, F1: 0.9995
Accuracy: 0.9965, Precision: 0.9924, Recall: 0.9917, F1: 0.9920
Epoch 17/30
Training - Loss: 46.3799
Training Metrics: {'accuracy': 0.9997959421641791, 'precision': 0.999688930798154, 'recall': 0.9993982497960219, 'f1': 0.9995435309101086}
Validation Metrics: {'accuracy': 0.996508786221343, 'precision': 0.992436068297258, 'recall': 0.9916541331682867, 'f1': 0.9920446676220842}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0299
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0290
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0290
Epoch 18/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0414
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0282
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9959, Precision: 0.9905, Recall: 0.9909, F1: 0.9907
Epoch 18/30
Training - Loss: 46.2309
Training Metrics: {'accuracy': 0.999825093283582, 'precision': 0.9998026705615755, 'recall': 0.9994150980106036, 'f1': 0.999608778720847}
Validation Metrics: {'accuracy': 0.9959269172582335, 'precision': 0.9905352943786325, 'recall': 0.9909245713222867, 'f1': 0.9907298251136221}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0273
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0275
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0263
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9963, Precision: 0.9931, Recall: 0.9899, F1: 0.9915
Epoch 19/30
Training - Loss: 45.7843
Training Metrics: {'accuracy': 0.9997959421641791, 'precision': 0.9997865118885617, 'recall': 0.9993054523551674, 'f1': 0.9995458190437401}
Validation Metrics: {'accuracy': 0.9962760386360991, 'precision': 0.9930683254423811, 'recall': 0.9899336499578297, 'f1': 0.9914940267389274}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Epoch 20/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0258
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9960, Precision: 0.9914, Recall: 0.9906, F1: 0.9910
Epoch 20/30
Training - Loss: 45.7185
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9997700605797578, 'recall': 0.9991949691454112, 'f1': 0.999482281446997}
Validation Metrics: {'accuracy': 0.9960432910508553, 'precision': 0.991374513696068, 'recall': 0.9905942642008011, 'f1': 0.9909839566383621}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0237
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9990, F1: 0.9993
Accuracy: 0.9960, Precision: 0.9914, Recall: 0.9906, F1: 0.9910
Epoch 21/30
Training - Loss: 45.3604
Training Metrics: {'accuracy': 0.9997084888059702, 'precision': 0.9997358196581794, 'recall': 0.9989617106308606, 'f1': 0.9993483436329005}
Validation Metrics: {'accuracy': 0.9960432910508553, 'precision': 0.991374513696068, 'recall': 0.9905942642008011, 'f1': 0.9909839566383621}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 22/30, Step 40/1,Classification Loss: 0.3395, Contrastive Loss: 0.0317
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9963, Precision: 0.9919, Recall: 0.9911, F1: 0.9915
Epoch 22/30
Training - Loss: 45.2004
Training Metrics: {'accuracy': 0.999825093283582, 'precision': 0.9998032665859451, 'recall': 0.9994184211757728, 'f1': 0.9996107395222844}
Validation Metrics: {'accuracy': 0.9962760386360991, 'precision': 0.991905290996663, 'recall': 0.9911241986845438, 'f1': 0.9915143121302232}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 23/30, Step 100/1,Classification Loss: 0.3279, Contrastive Loss: 0.0330
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9962, Precision: 0.9922, Recall: 0.9903, F1: 0.9912
Epoch 23/30
Training - Loss: 45.0528
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.999769278588752, 'recall': 0.9991885455302112, 'f1': 0.9994786749063205}
Validation Metrics: {'accuracy': 0.9961596648434773, 'precision': 0.9922188432383461, 'recall': 0.9902639570793154, 'f1': 0.991238689652852}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 24/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0383
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9992, F1: 0.9995
Accuracy: 0.9965, Precision: 0.9936, Recall: 0.9905, F1: 0.9920
Epoch 24/30
Training - Loss: 44.9423
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9997699959996906, 'recall': 0.999194437839775, 'f1': 0.9994819831961654}
Validation Metrics: {'accuracy': 0.996508786221343, 'precision': 0.993601650533474, 'recall': 0.9904635844415726, 'f1': 0.9920256500677445}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 25/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0413
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 25/30, Step 80/1,Classification Loss: 0.3291, Contrastive Loss: 0.0367
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9960, Precision: 0.9914, Recall: 0.9906, F1: 0.9910
Epoch 25/30
Training - Loss: 44.8869
Training Metrics: {'accuracy': 0.9997959421641791, 'precision': 0.9997872170006609, 'recall': 0.9993102998262322, 'f1': 0.9995485976109175}
Validation Metrics: {'accuracy': 0.9960432910508553, 'precision': 0.991374513696068, 'recall': 0.9905942642008011, 'f1': 0.9909839566383621}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 26/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.0325
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0224
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Accuracy: 0.9999, Precision: 0.9998, Recall: 0.9995, F1: 0.9997
Accuracy: 0.9960, Precision: 0.9921, Recall: 0.9898, F1: 0.9910
Epoch 26/30
Training - Loss: 44.9582
Training Metrics: {'accuracy': 0.9998542444029851, 'precision': 0.9998204171221852, 'recall': 0.9995331094541027, 'f1': 0.9996767050301423}
Validation Metrics: {'accuracy': 0.9960432910508553, 'precision': 0.9921464476215027, 'recall': 0.9898005650496583, 'f1': 0.9909696014931211}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 27/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0203
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 60/1,Classification Loss: 0.3146, Contrastive Loss: 0.0211
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0223
Accuracy: 0.9998, Precision: 0.9996, Recall: 0.9994, F1: 0.9995
Accuracy: 0.9953, Precision: 0.9879, Recall: 0.9910, F1: 0.9894
Epoch 27/30
Training - Loss: 44.6355
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9995772723201426, 'recall': 0.9993849517333738, 'f1': 0.9994810859544041}
Validation Metrics: {'accuracy': 0.9953450482951239, 'precision': 0.9878946275668824, 'recall': 0.9909887086274296, 'f1': 0.9894348317355868}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0326
Accuracy: 0.9997, Precision: 0.9998, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9958, Precision: 0.9912, Recall: 0.9897, F1: 0.9904
Epoch 28/30
Training - Loss: 44.6834
Training Metrics: {'accuracy': 0.9997376399253731, 'precision': 0.9997528152002533, 'recall': 0.9990776782874085, 'f1': 0.9994149257682805}
Validation Metrics: {'accuracy': 0.9958105434656116, 'precision': 0.9912279985399383, 'recall': 0.9896674801414869, 'f1': 0.9904460085892899}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9959, Precision: 0.9917, Recall: 0.9897, F1: 0.9907
Epoch 29/30
Training - Loss: 44.6304
Training Metrics: {'accuracy': 0.9997959421641791, 'precision': 0.9997873478848311, 'recall': 0.9993112009570757, 'f1': 0.999549114039638}
Validation Metrics: {'accuracy': 0.9959269172582335, 'precision': 0.9916867956855668, 'recall': 0.9897340225955726, 'f1': 0.9907077011469643}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9959, Precision: 0.9913, Recall: 0.9901, F1: 0.9907
Epoch 30/30
Training - Loss: 44.4926
Training Metrics: {'accuracy': 0.999825093283582, 'precision': 0.9998015961639264, 'recall': 0.999409120851396, 'f1': 0.9996052507541477}
Validation Metrics: {'accuracy': 0.9959269172582335, 'precision': 0.9913012537133921, 'recall': 0.9901308721711439, 'f1': 0.9907150898197862}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5189, 5814), y shape: (5189,), y distribution: Counter({np.float64(0.0): 4589, np.float64(1.0): 600}), env shape: (5189,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9580, Precision: 0.9517, Recall: 0.8357, F1: 0.8825
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8915]))
original train data shape: torch.Size([43062]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5189, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43062]), new train data shape: torch.Size([43062])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  8915]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.6037
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 1.0082
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.5346
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2688
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2047
Epoch 1/30, Step 100/1,Classification Loss: 0.3169, Contrastive Loss: 0.1868
Epoch 1/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.1867
Accuracy: 0.9994, Precision: 0.9985, Recall: 0.9990, F1: 0.9988
Accuracy: 0.9959, Precision: 0.9918, Recall: 0.9898, F1: 0.9908
Epoch 1/30
Training - Loss: 106.8611
Training Metrics: {'accuracy': 0.9994461287313433, 'precision': 0.9985460088455926, 'recall': 0.99901823967893, 'f1': 0.9987819658261183}
Validation Metrics: {'accuracy': 0.9959363752467201, 'precision': 0.9917653721005852, 'recall': 0.9898370219126249, 'f1': 0.990798546826348}
Epoch 2/30, Step 0/1,Classification Loss: 0.3266, Contrastive Loss: 0.1612
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1445
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1383
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1337
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1291
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1257
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1223
Accuracy: 0.9994, Precision: 0.9984, Recall: 0.9991, F1: 0.9988
Accuracy: 0.9958, Precision: 0.9925, Recall: 0.9886, F1: 0.9905
Epoch 2/30
Training - Loss: 60.6473
Training Metrics: {'accuracy': 0.9994461287313433, 'precision': 0.998436559042869, 'recall': 0.9991060908454066, 'f1': 0.9987710079744853}
Validation Metrics: {'accuracy': 0.9958202716823407, 'precision': 0.9924602301226761, 'recall': 0.9885950798525365, 'f1': 0.9905170116861068}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1202
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1175
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1148
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1125
Epoch 3/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1235
Epoch 3/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.1111
Epoch 3/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1181
Accuracy: 0.9995, Precision: 0.9988, Recall: 0.9989, F1: 0.9989
Accuracy: 0.9956, Precision: 0.9912, Recall: 0.9889, F1: 0.9900
Epoch 3/30
Training - Loss: 57.7377
Training Metrics: {'accuracy': 0.9994752798507462, 'precision': 0.9987587838526983, 'recall': 0.9989462170384269, 'f1': 0.9988524754143928}
Validation Metrics: {'accuracy': 0.9955880645535818, 'precision': 0.9911655166334472, 'recall': 0.9888539599454189, 'f1': 0.9900059238811804}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1049
Epoch 4/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1151
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1011
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0988
Epoch 4/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1116
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0958
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0937
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9986, F1: 0.9990
Accuracy: 0.9961, Precision: 0.9934, Recall: 0.9887, F1: 0.9910
Epoch 4/30
Training - Loss: 55.6324
Training Metrics: {'accuracy': 0.9995335820895522, 'precision': 0.999349960399212, 'recall': 0.9985882918827444, 'f1': 0.9989687153438196}
Validation Metrics: {'accuracy': 0.9960524788110995, 'precision': 0.9933762740820544, 'recall': 0.9887280232186624, 'f1': 0.9910367806578941}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0935
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0911
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0899
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0882
Epoch 5/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0980
Epoch 5/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0944
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0857
Accuracy: 0.9993, Precision: 0.9984, Recall: 0.9987, F1: 0.9985
Accuracy: 0.9963, Precision: 0.9912, Recall: 0.9920, F1: 0.9916
Epoch 5/30
Training - Loss: 54.4804
Training Metrics: {'accuracy': 0.9993295242537313, 'precision': 0.9983673127193979, 'recall': 0.9986544932894883, 'f1': 0.9985108446834873}
Validation Metrics: {'accuracy': 0.9962846859398583, 'precision': 0.9912258983667828, 'recall': 0.9919955542568564, 'f1': 0.9916103043346761}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0840
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0821
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0809
Epoch 6/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0928
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0786
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0777
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0766
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9933, Recall: 0.9914, F1: 0.9924
Epoch 6/30
Training - Loss: 53.2142
Training Metrics: {'accuracy': 0.9995918843283582, 'precision': 0.9990996864229647, 'recall': 0.9990996864229647, 'f1': 0.9990996864229647}
Validation Metrics: {'accuracy': 0.9966329966329966, 'precision': 0.9933458701529008, 'recall': 0.9914113223880284, 'f1': 0.992375938798974}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0757
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0746
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0736
Epoch 7/30, Step 60/1,Classification Loss: 0.3302, Contrastive Loss: 0.1010
Epoch 7/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0796
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0707
Epoch 7/30, Step 120/1,Classification Loss: 0.3303, Contrastive Loss: 0.0747
Accuracy: 0.9994, Precision: 0.9988, Recall: 0.9985, F1: 0.9986
Accuracy: 0.9964, Precision: 0.9928, Recall: 0.9909, F1: 0.9919
Epoch 7/30
Training - Loss: 52.3278
Training Metrics: {'accuracy': 0.9993878264925373, 'precision': 0.9987895467707764, 'recall': 0.9985042209576451, 'f1': 0.9986468261655632}
Validation Metrics: {'accuracy': 0.9964007895042378, 'precision': 0.9928190374687955, 'recall': 0.9908865555628938, 'f1': 0.9918501414747654}
Epoch 8/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0797
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0682
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0674
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0666
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0664
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0648
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0640
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9963, Precision: 0.9939, Recall: 0.9893, F1: 0.9916
Epoch 8/30
Training - Loss: 51.3102
Training Metrics: {'accuracy': 0.9995627332089553, 'precision': 0.9993692496358584, 'recall': 0.9987074317250377, 'f1': 0.9990380297395343}
Validation Metrics: {'accuracy': 0.9962846859398583, 'precision': 0.9939060319200471, 'recall': 0.9892527900437971, 'f1': 0.9915640288544886}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0634
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0626
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0619
Epoch 9/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0627
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0606
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0597
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0591
Accuracy: 0.9997, Precision: 0.9992, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9962, Precision: 0.9934, Recall: 0.9892, F1: 0.9913
Epoch 9/30
Training - Loss: 50.6159
Training Metrics: {'accuracy': 0.9996501865671642, 'precision': 0.9992253536499354, 'recall': 0.9992253536499354, 'f1': 0.9992253536499354}
Validation Metrics: {'accuracy': 0.9961685823754789, 'precision': 0.9934471658037967, 'recall': 0.9891863183607339, 'f1': 0.9913038343515814}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0584
Epoch 10/30, Step 20/1,Classification Loss: 0.3266, Contrastive Loss: 0.0620
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0569
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0565
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0555
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0550
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0542
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9993, F1: 0.9993
Accuracy: 0.9965, Precision: 0.9937, Recall: 0.9906, F1: 0.9921
Epoch 10/30
Training - Loss: 49.9622
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.9992500327821952, 'recall': 0.999344146805239, 'f1': 0.9992970834972668}
Validation Metrics: {'accuracy': 0.9965168930686172, 'precision': 0.9936598941261731, 'recall': 0.9905612037869485, 'f1': 0.992103730679367}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0543
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0530
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0528
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0518
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0512
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0510
Epoch 11/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0609
Accuracy: 0.9997, Precision: 0.9992, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9965, Precision: 0.9944, Recall: 0.9898, F1: 0.9921
Epoch 11/30
Training - Loss: 49.2842
Training Metrics: {'accuracy': 0.9996501865671642, 'precision': 0.9992299130816922, 'recall': 0.9992299130816922, 'f1': 0.9992299130816922}
Validation Metrics: {'accuracy': 0.9965168930686172, 'precision': 0.9944357897580397, 'recall': 0.9897775568689315, 'f1': 0.992091277051083}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0499
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0490
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0483
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 12/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0618
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0469
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0461
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9961, Precision: 0.9926, Recall: 0.9895, F1: 0.9911
Epoch 12/30
Training - Loss: 48.8566
Training Metrics: {'accuracy': 0.9996210354477612, 'precision': 0.9993051890988667, 'recall': 0.9990195683195167, 'f1': 0.9991623209596343}
Validation Metrics: {'accuracy': 0.9960524788110995, 'precision': 0.9926037309671747, 'recall': 0.9895116701366794, 'f1': 0.9910508947699493}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0463
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0452
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0452
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0445
Epoch 13/30, Step 80/1,Classification Loss: 0.3153, Contrastive Loss: 0.0450
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0430
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0425
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9961, Precision: 0.9934, Recall: 0.9887, F1: 0.9910
Epoch 13/30
Training - Loss: 48.4023
Training Metrics: {'accuracy': 0.9995627332089553, 'precision': 0.9993656669705957, 'recall': 0.9986970522460243, 'f1': 0.9990310434702021}
Validation Metrics: {'accuracy': 0.9960524788110995, 'precision': 0.9933762740820544, 'recall': 0.9887280232186624, 'f1': 0.9910367806578941}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0430
Epoch 14/30, Step 20/1,Classification Loss: 0.3210, Contrastive Loss: 0.0422
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0412
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0410
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0394
Accuracy: 0.9997, Precision: 0.9991, Recall: 0.9993, F1: 0.9992
Accuracy: 0.9964, Precision: 0.9932, Recall: 0.9905, F1: 0.9918
Epoch 14/30
Training - Loss: 47.9639
Training Metrics: {'accuracy': 0.9996501865671642, 'precision': 0.9991330328292143, 'recall': 0.9993230362546135, 'f1': 0.9992280089676744}
Validation Metrics: {'accuracy': 0.9964007895042378, 'precision': 0.9932031568954287, 'recall': 0.9904947321038854, 'f1': 0.991843731313534}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0391
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0385
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0381
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0384
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0372
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0368
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9965, Precision: 0.9937, Recall: 0.9906, F1: 0.9921
Epoch 15/30
Training - Loss: 47.2773
Training Metrics: {'accuracy': 0.9996210354477612, 'precision': 0.9993005382501631, 'recall': 0.9990119712405369, 'f1': 0.999156196024614}
Validation Metrics: {'accuracy': 0.9965168930686172, 'precision': 0.9936598941261731, 'recall': 0.9905612037869485, 'f1': 0.992103730679367}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0353
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0348
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0341
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0337
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9995, F1: 0.9994
Accuracy: 0.9964, Precision: 0.9940, Recall: 0.9897, F1: 0.9918
Epoch 16/30
Training - Loss: 47.0291
Training Metrics: {'accuracy': 0.9997084888059702, 'precision': 0.9992637384322338, 'recall': 0.9994530775539081, 'f1': 0.999358382568643}
Validation Metrics: {'accuracy': 0.9964007895042378, 'precision': 0.9939765033851056, 'recall': 0.9897110851858685, 'f1': 0.9918308746939097}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0317
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0312
Accuracy: 0.9997, Precision: 0.9992, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9963, Precision: 0.9931, Recall: 0.9900, F1: 0.9916
Epoch 17/30
Training - Loss: 46.5703
Training Metrics: {'accuracy': 0.9996501865671642, 'precision': 0.9992291820737376, 'recall': 0.9992291820737376, 'f1': 0.9992291820737376}
Validation Metrics: {'accuracy': 0.9962846859398583, 'precision': 0.9931318125466739, 'recall': 0.990036436961814, 'f1': 0.9915773127246582}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0312
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0303
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0300
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0294
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9949, Recall: 0.9898, F1: 0.9924
Epoch 18/30
Training - Loss: 46.3613
Training Metrics: {'accuracy': 0.9995918843283582, 'precision': 0.9991906790446621, 'recall': 0.9989994411363441, 'f1': 0.9990950342408385}
Validation Metrics: {'accuracy': 0.9966329966329966, 'precision': 0.9948959278469185, 'recall': 0.9898440285519945, 'f1': 0.9923518844159828}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0282
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9965, Precision: 0.9948, Recall: 0.9894, F1: 0.9921
Epoch 19/30
Training - Loss: 46.0271
Training Metrics: {'accuracy': 0.9996501865671642, 'precision': 0.9994155120283523, 'recall': 0.9990327304115039, 'f1': 0.9992240177075853}
Validation Metrics: {'accuracy': 0.9965168930686172, 'precision': 0.9948263192756477, 'recall': 0.989385733409923, 'f1': 0.992085032584952}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 20/30, Step 80/1,Classification Loss: 0.3195, Contrastive Loss: 0.0328
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9963, Precision: 0.9947, Recall: 0.9885, F1: 0.9916
Epoch 20/30
Training - Loss: 45.8067
Training Metrics: {'accuracy': 0.9995627332089553, 'precision': 0.999178024442182, 'recall': 0.99889339725794, 'f1': 0.9990356534146694}
Validation Metrics: {'accuracy': 0.9962846859398583, 'precision': 0.9946871355673887, 'recall': 0.98846914312578, 'f1': 0.9915506947280132}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 21/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0242
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9988, F1: 0.9989
Accuracy: 0.9963, Precision: 0.9935, Recall: 0.9896, F1: 0.9916
Epoch 21/30
Training - Loss: 45.7258
Training Metrics: {'accuracy': 0.9995044309701493, 'precision': 0.9990512685111442, 'recall': 0.9987675532828251, 'f1': 0.9989093537483142}
Validation Metrics: {'accuracy': 0.9962846859398583, 'precision': 0.993518066364271, 'recall': 0.9896446135028054, 'f1': 0.9915706770543171}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 22/30, Step 120/1,Classification Loss: 0.3285, Contrastive Loss: 0.0342
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9964, Precision: 0.9948, Recall: 0.9889, F1: 0.9918
Epoch 22/30
Training - Loss: 45.5021
Training Metrics: {'accuracy': 0.9995044309701493, 'precision': 0.9991376638826968, 'recall': 0.9986574891968405, 'f1': 0.9988974137861812}
Validation Metrics: {'accuracy': 0.9964007895042378, 'precision': 0.994756721857424, 'recall': 0.9889274382678515, 'f1': 0.9918179694555055}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 23/30, Step 20/1,Classification Loss: 0.3167, Contrastive Loss: 0.0280
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9959, Precision: 0.9945, Recall: 0.9871, F1: 0.9907
Epoch 23/30
Training - Loss: 45.5124
Training Metrics: {'accuracy': 0.9995918843283582, 'precision': 0.9991965267907748, 'recall': 0.9990073357181448, 'f1': 0.9991019058522155}
Validation Metrics: {'accuracy': 0.9959363752467201, 'precision': 0.9944784432168821, 'recall': 0.9870942576995656, 'f1': 0.9907475979526764}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 24/30, Step 20/1,Classification Loss: 0.3210, Contrastive Loss: 0.0217
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9964, Precision: 0.9948, Recall: 0.9889, F1: 0.9918
Epoch 24/30
Training - Loss: 45.1157
Training Metrics: {'accuracy': 0.9995335820895522, 'precision': 0.9990707321094296, 'recall': 0.9988823477669682, 'f1': 0.9989765147061715}
Validation Metrics: {'accuracy': 0.9964007895042378, 'precision': 0.994756721857424, 'recall': 0.9889274382678515, 'f1': 0.9918179694555055}
Epoch 25/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0318
Epoch 25/30, Step 20/1,Classification Loss: 0.3280, Contrastive Loss: 0.0221
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 25/30, Step 60/1,Classification Loss: 0.3174, Contrastive Loss: 0.0210
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 25/30, Step 120/1,Classification Loss: 0.3218, Contrastive Loss: 0.0206
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9961, Precision: 0.9945, Recall: 0.9876, F1: 0.9910
Epoch 25/30
Training - Loss: 45.0677
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.9994298989310657, 'recall': 0.9991408653623167, 'f1': 0.999285323283192}
Validation Metrics: {'accuracy': 0.9960524788110995, 'precision': 0.9945479962721342, 'recall': 0.9875525528416371, 'f1': 0.9910155092776107}
Epoch 26/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0337
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9961, Precision: 0.9942, Recall: 0.9879, F1: 0.9910
Epoch 26/30
Training - Loss: 45.0701
Training Metrics: {'accuracy': 0.9996210354477612, 'precision': 0.9994030642373419, 'recall': 0.9989304692369112, 'f1': 0.9991666081968178}
Validation Metrics: {'accuracy': 0.9960524788110995, 'precision': 0.9941556886966502, 'recall': 0.9879443763006455, 'f1': 0.991022613148514}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 27/30, Step 20/1,Classification Loss: 0.3140, Contrastive Loss: 0.0221
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 27/30, Step 80/1,Classification Loss: 0.3319, Contrastive Loss: 0.0347
Epoch 27/30, Step 100/1,Classification Loss: 0.3284, Contrastive Loss: 0.0205
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9956, Precision: 0.9904, Recall: 0.9896, F1: 0.9900
Epoch 27/30
Training - Loss: 44.9974
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.9994337124930144, 'recall': 0.9991477100109067, 'f1': 0.9992906533885848}
Validation Metrics: {'accuracy': 0.9955880645535818, 'precision': 0.9904064569136339, 'recall': 0.9896376068634358, 'f1': 0.9900216095716257}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9957, Precision: 0.9928, Recall: 0.9877, F1: 0.9902
Epoch 28/30
Training - Loss: 44.8009
Training Metrics: {'accuracy': 0.9996501865671642, 'precision': 0.9994190702895589, 'recall': 0.999040082771306, 'f1': 0.9992294746780097}
Validation Metrics: {'accuracy': 0.9957041681179613, 'precision': 0.9927752122746909, 'recall': 0.9877449612514564, 'f1': 0.9902420594272883}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0341
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9965, Precision: 0.9921, Recall: 0.9921, F1: 0.9921
Epoch 29/30
Training - Loss: 44.8265
Training Metrics: {'accuracy': 0.9996210354477612, 'precision': 0.999307363408415, 'recall': 0.9990231212174463, 'f1': 0.9991651850147723}
Validation Metrics: {'accuracy': 0.9965168930686172, 'precision': 0.9921284976229824, 'recall': 0.9921284976229824, 'f1': 0.9921284976229824}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 30/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0187
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0178
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0327
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9961, Precision: 0.9938, Recall: 0.9883, F1: 0.9910
Epoch 30/30
Training - Loss: 44.5741
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.9994345826442022, 'recall': 0.9991492723192177, 'f1': 0.9992918698454059}
Validation Metrics: {'accuracy': 0.9960524788110995, 'precision': 0.9937651177782114, 'recall': 0.988336199759654, 'f1': 0.991029703596279}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5157, 5814), y shape: (5157,), y distribution: Counter({np.float64(0.0): 4557, np.float64(1.0): 600}), env shape: (5157,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9550, Precision: 0.9605, Recall: 0.8161, F1: 0.8709
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9015]))
original train data shape: torch.Size([43162]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5157, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43162]), new train data shape: torch.Size([43162])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9015]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.6157
Epoch 1/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.8251
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3533
Epoch 1/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.2447
Epoch 1/30, Step 80/1,Classification Loss: 0.3271, Contrastive Loss: 0.1948
Epoch 1/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.1744
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1539
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9989, F1: 0.9989
Accuracy: 0.9961, Precision: 0.9919, Recall: 0.9904, F1: 0.9912
Epoch 1/30
Training - Loss: 98.6226
Training Metrics: {'accuracy': 0.9995044309701493, 'precision': 0.9989599321573781, 'recall': 0.9988657898268689, 'f1': 0.9989128546888988}
Validation Metrics: {'accuracy': 0.9960616240009267, 'precision': 0.9919267257159643, 'recall': 0.9904064343795231, 'f1': 0.9911649262725466}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1466
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1393
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1335
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1285
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1244
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1212
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1182
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9961, Precision: 0.9916, Recall: 0.9908, F1: 0.9912
Epoch 2/30
Training - Loss: 59.9308
Training Metrics: {'accuracy': 0.9996210354477612, 'precision': 0.9991200363061719, 'recall': 0.9992144540396934, 'f1': 0.999167238842319}
Validation Metrics: {'accuracy': 0.9960616240009267, 'precision': 0.9915518343669745, 'recall': 0.990792504363799, 'f1': 0.9911717566472442}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1162
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1133
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1106
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1082
Epoch 3/30, Step 80/1,Classification Loss: 0.3147, Contrastive Loss: 0.1084
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1038
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1021
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9958, Precision: 0.9929, Recall: 0.9883, F1: 0.9906
Epoch 3/30
Training - Loss: 56.9511
Training Metrics: {'accuracy': 0.9995918843283582, 'precision': 0.9992001270575224, 'recall': 0.999012197305525, 'f1': 0.9991061370528704}
Validation Metrics: {'accuracy': 0.9958299548245106, 'precision': 0.9929190095641179, 'recall': 0.9883432470511297, 'f1': 0.9906161524836271}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1005
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0989
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0965
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0948
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0932
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0918
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0898
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9958, Precision: 0.9929, Recall: 0.9883, F1: 0.9906
Epoch 4/30
Training - Loss: 54.9719
Training Metrics: {'accuracy': 0.9995627332089553, 'precision': 0.9992814666534343, 'recall': 0.9988161209619157, 'f1': 0.9990486391499112}
Validation Metrics: {'accuracy': 0.9958299548245106, 'precision': 0.9929190095641179, 'recall': 0.9883432470511297, 'f1': 0.9906161524836271}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0892
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0873
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0859
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0845
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0847
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0818
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0806
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9958, Precision: 0.9910, Recall: 0.9903, F1: 0.9907
Epoch 5/30
Training - Loss: 53.6405
Training Metrics: {'accuracy': 0.9997084888059702, 'precision': 0.9994596127808468, 'recall': 0.9992737266617866, 'f1': 0.9993666450420555}
Validation Metrics: {'accuracy': 0.9958299548245106, 'precision': 0.9910321241477126, 'recall': 0.9902735969725092, 'f1': 0.9906524482147292}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0797
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0787
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0774
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0765
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0751
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0741
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0731
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9959, Precision: 0.9911, Recall: 0.9907, F1: 0.9909
Epoch 6/30
Training - Loss: 52.4125
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.9995355538779793, 'recall': 0.9990704657310827, 'f1': 0.9993028553446548}
Validation Metrics: {'accuracy': 0.9959457894127186, 'precision': 0.9911053467654538, 'recall': 0.990726085660292, 'f1': 0.9909156131703301}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0723
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0713
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0703
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0693
Epoch 7/30, Step 80/1,Classification Loss: 0.3272, Contrastive Loss: 0.0727
Epoch 7/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0686
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0666
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9957, Precision: 0.9910, Recall: 0.9898, F1: 0.9904
Epoch 7/30
Training - Loss: 51.4897
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.9995339101919277, 'recall': 0.9990658446521048, 'f1': 0.999299721362986}
Validation Metrics: {'accuracy': 0.9957141202363026, 'precision': 0.9909589064534468, 'recall': 0.9898211082847264, 'f1': 0.9903890791974164}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0659
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0651
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0642
Epoch 8/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0715
Epoch 8/30, Step 80/1,Classification Loss: 0.3255, Contrastive Loss: 0.0639
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0617
Epoch 8/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0618
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9986, F1: 0.9990
Accuracy: 0.9955, Precision: 0.9927, Recall: 0.9870, F1: 0.9898
Epoch 8/30
Training - Loss: 50.8326
Training Metrics: {'accuracy': 0.9995627332089553, 'precision': 0.9994635897563469, 'recall': 0.9986113104045902, 'f1': 0.9990369347339507}
Validation Metrics: {'accuracy': 0.9954824510598865, 'precision': 0.9927056740133327, 'recall': 0.9869857809877813, 'f1': 0.989822297465497}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0603
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0596
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0589
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0581
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0573
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0570
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0559
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9957, Precision: 0.9928, Recall: 0.9879, F1: 0.9904
Epoch 9/30
Training - Loss: 50.1000
Training Metrics: {'accuracy': 0.9997084888059702, 'precision': 0.99964202874054, 'recall': 0.9990720245659533, 'f1': 0.9993567965347413}
Validation Metrics: {'accuracy': 0.9957141202363026, 'precision': 0.9928478894133317, 'recall': 0.9878907583633469, 'f1': 0.9903517405128338}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0554
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0547
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0540
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0535
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0527
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0520
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0514
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9990, F1: 0.9993
Accuracy: 0.9954, Precision: 0.9911, Recall: 0.9881, F1: 0.9896
Epoch 10/30
Training - Loss: 49.4543
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.9996249554446497, 'recall': 0.9989588726128108, 'f1': 0.9992915999568401}
Validation Metrics: {'accuracy': 0.9953666164716785, 'precision': 0.9911150270860308, 'recall': 0.9880775722371021, 'f1': 0.9895896792516627}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0509
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0503
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0497
Epoch 11/30, Step 60/1,Classification Loss: 0.3439, Contrastive Loss: 0.0598
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0492
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0479
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0473
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9995, F1: 0.9996
Accuracy: 0.9956, Precision: 0.9909, Recall: 0.9894, F1: 0.9901
Epoch 11/30
Training - Loss: 48.8072
Training Metrics: {'accuracy': 0.999825093283582, 'precision': 0.9997119372253862, 'recall': 0.9995248161906134, 'f1': 0.9996183517733351}
Validation Metrics: {'accuracy': 0.9955982856480945, 'precision': 0.9908856936411305, 'recall': 0.9893686195969436, 'f1': 0.9901255058340226}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0469
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0463
Epoch 12/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0582
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0455
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0450
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0443
Epoch 12/30, Step 120/1,Classification Loss: 0.3242, Contrastive Loss: 0.0444
Accuracy: 0.9996, Precision: 0.9996, Recall: 0.9986, F1: 0.9991
Accuracy: 0.9956, Precision: 0.9913, Recall: 0.9890, F1: 0.9901
Epoch 12/30
Training - Loss: 48.3176
Training Metrics: {'accuracy': 0.9995918843283582, 'precision': 0.9995772262086045, 'recall': 0.9986413275662045, 'f1': 0.9991086527197217}
Validation Metrics: {'accuracy': 0.9955982856480945, 'precision': 0.9912606073576553, 'recall': 0.9889825496126677, 'f1': 0.9901178576824985}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0434
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0430
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0422
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0419
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0414
Epoch 13/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0423
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9957, Precision: 0.9913, Recall: 0.9894, F1: 0.9904
Epoch 13/30
Training - Loss: 47.8903
Training Metrics: {'accuracy': 0.9997376399253731, 'precision': 0.9996602074487371, 'recall': 0.9991890129526875, 'f1': 0.9994244524823581}
Validation Metrics: {'accuracy': 0.9957141202363026, 'precision': 0.9913334057420079, 'recall': 0.9894350383004505, 'f1': 0.9903816392325029}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Epoch 14/30, Step 20/1,Classification Loss: 0.3295, Contrastive Loss: 0.0476
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0393
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0388
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0382
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0388
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9958, Precision: 0.9903, Recall: 0.9910, F1: 0.9907
Epoch 14/30
Training - Loss: 47.4226
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9996789878978083, 'recall': 0.9993063307137192, 'f1': 0.9994925602286846}
Validation Metrics: {'accuracy': 0.9958299548245106, 'precision': 0.9902888294982692, 'recall': 0.991045736941061, 'f1': 0.9906668723157213}
Epoch 15/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0398
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0362
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0359
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0347
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9951, Precision: 0.9898, Recall: 0.9883, F1: 0.9891
Epoch 15/30
Training - Loss: 47.1679
Training Metrics: {'accuracy': 0.9997084888059702, 'precision': 0.9996454331029099, 'recall': 0.9990868858566235, 'f1': 0.9993659367952992}
Validation Metrics: {'accuracy': 0.9951349472952624, 'precision': 0.9898446615662968, 'recall': 0.9883308048143642, 'f1': 0.9890860853954987}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0343
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0336
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0325
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9957, Precision: 0.9913, Recall: 0.9894, F1: 0.9904
Epoch 16/30
Training - Loss: 46.7981
Training Metrics: {'accuracy': 0.9997376399253731, 'precision': 0.999659751241357, 'recall': 0.9991872935041188, 'f1': 0.9994233639693824}
Validation Metrics: {'accuracy': 0.9957141202363026, 'precision': 0.9913334057420079, 'recall': 0.9894350383004505, 'f1': 0.9903816392325029}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0319
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0309
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 17/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0465
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9953, Precision: 0.9892, Recall: 0.9896, F1: 0.9894
Epoch 17/30
Training - Loss: 46.5155
Training Metrics: {'accuracy': 0.9997376399253731, 'precision': 0.9995652293621612, 'recall': 0.9992818307281284, 'f1': 0.9994234730446824}
Validation Metrics: {'accuracy': 0.9952507818834704, 'precision': 0.9891777785625755, 'recall': 0.9895554334706989, 'f1': 0.9893665034328374}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0294
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0292
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0280
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9962, Precision: 0.9920, Recall: 0.9909, F1: 0.9914
Epoch 18/30
Training - Loss: 46.2106
Training Metrics: {'accuracy': 0.9997084888059702, 'precision': 0.9994576457456092, 'recall': 0.9992707195473485, 'f1': 0.9993641577440411}
Validation Metrics: {'accuracy': 0.9961774585891348, 'precision': 0.9919991319605521, 'recall': 0.9908589230673059, 'f1': 0.9914280976625605}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0275
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0270
Epoch 19/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0308
Epoch 19/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0345
Epoch 19/30, Step 120/1,Classification Loss: 0.3284, Contrastive Loss: 0.0344
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9959, Precision: 0.9915, Recall: 0.9903, F1: 0.9909
Epoch 19/30
Training - Loss: 45.9162
Training Metrics: {'accuracy': 0.9997084888059702, 'precision': 0.999452016294788, 'recall': 0.9992621171104398, 'f1': 0.999357041156181}
Validation Metrics: {'accuracy': 0.9959457894127186, 'precision': 0.9914790192069995, 'recall': 0.9903400156760161, 'f1': 0.9909085884299884}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Epoch 20/30, Step 100/1,Classification Loss: 0.3276, Contrastive Loss: 0.0323
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Accuracy: 0.9995, Precision: 0.9995, Recall: 0.9984, F1: 0.9990
Accuracy: 0.9955, Precision: 0.9912, Recall: 0.9885, F1: 0.9899
Epoch 20/30
Training - Loss: 45.6797
Training Metrics: {'accuracy': 0.9995335820895522, 'precision': 0.9995420334476977, 'recall': 0.9984077846842587, 'f1': 0.9989739955778534}
Validation Metrics: {'accuracy': 0.9954824510598865, 'precision': 0.9911878144856486, 'recall': 0.9885300609248849, 'f1': 0.989853871117611}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 21/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0347
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0237
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9953, Precision: 0.9914, Recall: 0.9872, F1: 0.9893
Epoch 21/30
Training - Loss: 45.4470
Training Metrics: {'accuracy': 0.9996501865671642, 'precision': 0.9996095324150671, 'recall': 0.9988545984876883, 'f1': 0.9992316606864511}
Validation Metrics: {'accuracy': 0.9952507818834704, 'precision': 0.9914200575047535, 'recall': 0.9872390135650435, 'f1': 0.9893169913510165}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 22/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0388
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 22/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0371
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9993, F1: 0.9994
Accuracy: 0.9961, Precision: 0.9912, Recall: 0.9912, F1: 0.9912
Epoch 22/30
Training - Loss: 45.3517
Training Metrics: {'accuracy': 0.9997376399253731, 'precision': 0.9995692955472869, 'recall': 0.999290245950863, 'f1': 0.9994297151553214}
Validation Metrics: {'accuracy': 0.9960616240009267, 'precision': 0.9911785743480749, 'recall': 0.9911785743480749, 'f1': 0.9911785743480749}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 23/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0227
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9959, Precision: 0.9911, Recall: 0.9907, F1: 0.9909
Epoch 23/30
Training - Loss: 45.2153
Training Metrics: {'accuracy': 0.9997376399253731, 'precision': 0.9996597054976442, 'recall': 0.9991871211349379, 'f1': 0.9994232548441826}
Validation Metrics: {'accuracy': 0.9959457894127186, 'precision': 0.9911053467654538, 'recall': 0.990726085660292, 'f1': 0.9909156131703301}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Accuracy: 0.9998, Precision: 0.9997, Recall: 0.9993, F1: 0.9995
Accuracy: 0.9959, Precision: 0.9922, Recall: 0.9896, F1: 0.9909
Epoch 24/30
Training - Loss: 45.0418
Training Metrics: {'accuracy': 0.9997667910447762, 'precision': 0.9996772580643996, 'recall': 0.9993008083341609, 'f1': 0.9994889324884421}
Validation Metrics: {'accuracy': 0.9959457894127186, 'precision': 0.9922312752993618, 'recall': 0.9895678757074644, 'f1': 0.990894499720933}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 25/30, Step 100/1,Classification Loss: 0.3141, Contrastive Loss: 0.0200
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Accuracy: 0.9993, Precision: 0.9994, Recall: 0.9975, F1: 0.9985
Accuracy: 0.9962, Precision: 0.9947, Recall: 0.9882, F1: 0.9914
Epoch 25/30
Training - Loss: 44.9301
Training Metrics: {'accuracy': 0.9993003731343284, 'precision': 0.999409799592545, 'recall': 0.9975488086558867, 'f1': 0.9984768282885572}
Validation Metrics: {'accuracy': 0.9961774585891348, 'precision': 0.9946668031029509, 'recall': 0.9881564331773747, 'f1': 0.9913813875981397}
Epoch 26/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0231
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9991, F1: 0.9994
Accuracy: 0.9962, Precision: 0.9924, Recall: 0.9905, F1: 0.9914
Epoch 26/30
Training - Loss: 44.7631
Training Metrics: {'accuracy': 0.9997084888059702, 'precision': 0.9996449482538229, 'recall': 0.9990847659012141, 'f1': 0.9993646333402432}
Validation Metrics: {'accuracy': 0.9961774585891348, 'precision': 0.9923752458877907, 'recall': 0.99047285308303, 'f1': 0.9914214620181783}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 27/30, Step 20/1,Classification Loss: 0.3170, Contrastive Loss: 0.0253
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 100/1,Classification Loss: 0.3197, Contrastive Loss: 0.0234
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9964, Precision: 0.9937, Recall: 0.9902, F1: 0.9919
Epoch 27/30
Training - Loss: 44.7063
Training Metrics: {'accuracy': 0.9997376399253731, 'precision': 0.9996591087839393, 'recall': 0.9991848732773654, 'f1': 0.9994218316605433}
Validation Metrics: {'accuracy': 0.9964091277655508, 'precision': 0.9936549639781942, 'recall': 0.9902196205057678, 'f1': 0.9919288716033339}
Epoch 28/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0204
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 28/30, Step 60/1,Classification Loss: 0.3154, Contrastive Loss: 0.0215
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Accuracy: 0.9997, Precision: 0.9997, Recall: 0.9989, F1: 0.9993
Accuracy: 0.9962, Precision: 0.9928, Recall: 0.9901, F1: 0.9914
Epoch 28/30
Training - Loss: 44.5721
Training Metrics: {'accuracy': 0.9996793376865671, 'precision': 0.999720838953922, 'recall': 0.9988706325344598, 'f1': 0.9992952226292452}
Validation Metrics: {'accuracy': 0.9961774585891348, 'precision': 0.9927530057062186, 'recall': 0.9900867830987541, 'f1': 0.991414814022594}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0192
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9964, Precision: 0.9929, Recall: 0.9910, F1: 0.9919
Epoch 29/30
Training - Loss: 44.5857
Training Metrics: {'accuracy': 0.999825093283582, 'precision': 0.9998049856481742, 'recall': 0.9994280366075946, 'f1': 0.999616410220643}
Validation Metrics: {'accuracy': 0.9964091277655508, 'precision': 0.9928961659606821, 'recall': 0.9909917604743197, 'f1': 0.9919413734110158}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 20/1,Classification Loss: 0.3279, Contrastive Loss: 0.0235
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Accuracy: 0.9998, Precision: 0.9998, Recall: 0.9994, F1: 0.9996
Accuracy: 0.9966, Precision: 0.9927, Recall: 0.9923, F1: 0.9925
Epoch 30/30
Training - Loss: 44.4698
Training Metrics: {'accuracy': 0.999825093283582, 'precision': 0.9998051385915646, 'recall': 0.9994288943725481, 'f1': 0.9996169158798016}
Validation Metrics: {'accuracy': 0.9966407969419668, 'precision': 0.9926632720629989, 'recall': 0.9922828078341612, 'f1': 0.9924729366268448}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5217, 5814), y shape: (5217,), y distribution: Counter({np.float64(0.0): 4617, np.float64(1.0): 600}), env shape: (5217,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9557, Precision: 0.9631, Recall: 0.8155, F1: 0.8712
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9115]))
original train data shape: torch.Size([43262]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5217, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43262]), new train data shape: torch.Size([43262])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9115]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.5454
Epoch 1/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.9735
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4219
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2588
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2004
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1704
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1516
Accuracy: 0.9994, Precision: 0.9985, Recall: 0.9988, F1: 0.9987
Accuracy: 0.9963, Precision: 0.9933, Recall: 0.9903, F1: 0.9918
Epoch 1/30
Training - Loss: 102.6635
Training Metrics: {'accuracy': 0.9993923611111111, 'precision': 0.9985434990900179, 'recall': 0.9988194076429371, 'f1': 0.9986813988729328}
Validation Metrics: {'accuracy': 0.9963018606263724, 'precision': 0.9932829044735356, 'recall': 0.9902827922304027, 'f1': 0.9917763876929978}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1427
Epoch 2/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1441
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1278
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1228
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1188
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1155
Epoch 2/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.1132
Accuracy: 0.9993, Precision: 0.9986, Recall: 0.9983, F1: 0.9984
Accuracy: 0.9963, Precision: 0.9929, Recall: 0.9907, F1: 0.9918
Epoch 2/30
Training - Loss: 59.5530
Training Metrics: {'accuracy': 0.9992766203703703, 'precision': 0.99856944091647, 'recall': 0.9982940331059911, 'f1': 0.9984316826561551}
Validation Metrics: {'accuracy': 0.9963018606263724, 'precision': 0.9929101223457353, 'recall': 0.9906624391297695, 'f1': 0.991782652926771}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1103
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1083
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1052
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1031
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1009
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0999
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0970
Accuracy: 0.9993, Precision: 0.9984, Recall: 0.9986, F1: 0.9985
Accuracy: 0.9965, Precision: 0.9938, Recall: 0.9908, F1: 0.9923
Epoch 3/30
Training - Loss: 56.8049
Training Metrics: {'accuracy': 0.9993055555555556, 'precision': 0.9983991504659467, 'recall': 0.9985833343812921, 'f1': 0.9984912181452554}
Validation Metrics: {'accuracy': 0.9965329943372241, 'precision': 0.993798453769176, 'recall': 0.9907952059911609, 'f1': 0.9922903634621855}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0958
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0944
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0922
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0905
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0894
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0879
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0861
Accuracy: 0.9996, Precision: 0.9989, Recall: 0.9992, F1: 0.9991
Accuracy: 0.9963, Precision: 0.9922, Recall: 0.9914, F1: 0.9918
Epoch 4/30
Training - Loss: 54.9335
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.9989211867873005, 'recall': 0.999196941226498, 'f1': 0.9990590095936931}
Validation Metrics: {'accuracy': 0.9963018606263724, 'precision': 0.9921693683896631, 'recall': 0.991421732928503, 'f1': 0.9917951489636078}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0849
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0837
Epoch 5/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0981
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0810
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0800
Epoch 5/30, Step 100/1,Classification Loss: 0.3142, Contrastive Loss: 0.0817
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0773
Accuracy: 0.9995, Precision: 0.9988, Recall: 0.9988, F1: 0.9988
Accuracy: 0.9963, Precision: 0.9929, Recall: 0.9907, F1: 0.9918
Epoch 5/30
Training - Loss: 53.7911
Training Metrics: {'accuracy': 0.9994502314814815, 'precision': 0.9987546847439159, 'recall': 0.9988473338951767, 'f1': 0.9988010031935286}
Validation Metrics: {'accuracy': 0.9963018606263724, 'precision': 0.9929101223457353, 'recall': 0.9906624391297695, 'f1': 0.991782652926771}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0764
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0758
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0742
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0731
Epoch 6/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0864
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0711
Epoch 6/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0716
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9991, F1: 0.9990
Accuracy: 0.9965, Precision: 0.9934, Recall: 0.9912, F1: 0.9923
Epoch 6/30
Training - Loss: 52.5963
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.9989979568138889, 'recall': 0.9990918397923376, 'f1': 0.9990448920470167}
Validation Metrics: {'accuracy': 0.9965329943372241, 'precision': 0.9934248834306777, 'recall': 0.9911748528905275, 'f1': 0.9922962371188478}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0701
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0684
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0675
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0665
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0657
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0647
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0639
Accuracy: 0.9994, Precision: 0.9990, Recall: 0.9984, F1: 0.9987
Accuracy: 0.9962, Precision: 0.9943, Recall: 0.9887, F1: 0.9915
Epoch 7/30
Training - Loss: 51.7136
Training Metrics: {'accuracy': 0.9993923611111111, 'precision': 0.9990020005887325, 'recall': 0.9983565184727732, 'f1': 0.9986789615827681}
Validation Metrics: {'accuracy': 0.9961862937709465, 'precision': 0.9943412481301626, 'recall': 0.98869782120224, 'f1': 0.9914966924832017}
Epoch 8/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0793
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0629
Epoch 8/30, Step 40/1,Classification Loss: 0.3193, Contrastive Loss: 0.0651
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0618
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0600
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0592
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0584
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9994, F1: 0.9992
Accuracy: 0.9963, Precision: 0.9922, Recall: 0.9914, F1: 0.9918
Epoch 8/30
Training - Loss: 50.8124
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9989522399241506, 'recall': 0.9994133993038223, 'f1': 0.9991826676629773}
Validation Metrics: {'accuracy': 0.9963018606263724, 'precision': 0.9921693683896631, 'recall': 0.991421732928503, 'f1': 0.9917951489636078}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0579
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0572
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0564
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0565
Epoch 9/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0555
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0548
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0537
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9935, Recall: 0.9916, F1: 0.9926
Epoch 9/30
Training - Loss: 50.1590
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.9990996141034222, 'recall': 0.9990068935863958, 'f1': 0.9990532477136393}
Validation Metrics: {'accuracy': 0.99664856119265, 'precision': 0.9934958862443486, 'recall': 0.99162088322059, 'f1': 0.9925558642433748}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0534
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0520
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0512
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0510
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0504
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0498
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9963, Precision: 0.9929, Recall: 0.9907, F1: 0.9918
Epoch 10/30
Training - Loss: 49.5763
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.9991961176620512, 'recall': 0.9989199280626396, 'f1': 0.9990579683106973}
Validation Metrics: {'accuracy': 0.9963018606263724, 'precision': 0.9929101223457353, 'recall': 0.9906624391297695, 'f1': 0.991782652926771}
Epoch 11/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0495
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0483
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0477
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0472
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0469
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0460
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0457
Accuracy: 0.9997, Precision: 0.9991, Recall: 0.9994, F1: 0.9992
Accuracy: 0.9961, Precision: 0.9913, Recall: 0.9913, F1: 0.9913
Epoch 11/30
Training - Loss: 49.0968
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9990670283610823, 'recall': 0.9994329628615426, 'f1': 0.99924989963935}
Validation Metrics: {'accuracy': 0.9960707269155207, 'precision': 0.9912889660671116, 'recall': 0.9912889660671116, 'f1': 0.9912889660671116}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0451
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0446
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0441
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0434
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0430
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0425
Epoch 12/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0422
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9965, Precision: 0.9934, Recall: 0.9912, F1: 0.9923
Epoch 12/30
Training - Loss: 48.5665
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9994309842228923, 'recall': 0.9990629312180709, 'f1': 0.9992468608523994}
Validation Metrics: {'accuracy': 0.9965329943372241, 'precision': 0.9934248834306777, 'recall': 0.9911748528905275, 'f1': 0.9922962371188478}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0415
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0410
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0406
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0404
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0396
Epoch 13/30, Step 100/1,Classification Loss: 0.3269, Contrastive Loss: 0.0445
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0387
Accuracy: 0.9995, Precision: 0.9989, Recall: 0.9991, F1: 0.9990
Accuracy: 0.9965, Precision: 0.9931, Recall: 0.9916, F1: 0.9923
Epoch 13/30
Training - Loss: 48.0574
Training Metrics: {'accuracy': 0.999537037037037, 'precision': 0.9989057510238881, 'recall': 0.9990892508094558, 'f1': 0.9989974768019838}
Validation Metrics: {'accuracy': 0.9965329943372241, 'precision': 0.9930529222192443, 'recall': 0.9915544997898944, 'f1': 0.9923021000063341}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0383
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0388
Epoch 14/30, Step 40/1,Classification Loss: 0.3275, Contrastive Loss: 0.0443
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0378
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0367
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0362
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0358
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9965, Precision: 0.9946, Recall: 0.9900, F1: 0.9923
Epoch 14/30
Training - Loss: 47.6214
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.999339585035236, 'recall': 0.9991558484271763, 'f1': 0.9992476925756081}
Validation Metrics: {'accuracy': 0.9965329943372241, 'precision': 0.9945504557811485, 'recall': 0.9900359121924274, 'f1': 0.9922785837258636}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0355
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0350
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0350
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0341
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9958, Precision: 0.9919, Recall: 0.9896, F1: 0.9908
Epoch 15/30
Training - Loss: 47.3460
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9993276286827699, 'recall': 0.9990551062354438, 'f1': 0.9991913140781737}
Validation Metrics: {'accuracy': 0.9958395932046689, 'precision': 0.9918806001758504, 'recall': 0.9896376116082533, 'f1': 0.9907554845426174}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0329
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0325
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0317
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0319
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9994, F1: 0.9994
Accuracy: 0.9965, Precision: 0.9934, Recall: 0.9912, F1: 0.9923
Epoch 16/30
Training - Loss: 46.9254
Training Metrics: {'accuracy': 0.9997106481481481, 'precision': 0.9993731924828164, 'recall': 0.9993731924828164, 'f1': 0.9993731924828164}
Validation Metrics: {'accuracy': 0.9965329943372241, 'precision': 0.9934248834306777, 'recall': 0.9911748528905275, 'f1': 0.9922962371188478}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0299
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0292
Epoch 17/30, Step 100/1,Classification Loss: 0.3184, Contrastive Loss: 0.0297
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9964, Precision: 0.9926, Recall: 0.9915, F1: 0.9920
Epoch 17/30
Training - Loss: 46.6093
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9991391589515597, 'recall': 0.99923100365705, 'f1': 0.9991850752673266}
Validation Metrics: {'accuracy': 0.9964174274817982, 'precision': 0.992610750308934, 'recall': 0.9914881163591986, 'f1': 0.9920485283346414}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0275
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0270
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9958, Precision: 0.9923, Recall: 0.9893, F1: 0.9907
Epoch 18/30
Training - Loss: 46.3761
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9994126759227182, 'recall': 0.99895054375961, 'f1': 0.9991814573728433}
Validation Metrics: {'accuracy': 0.9958395932046689, 'precision': 0.9922518058822548, 'recall': 0.9892579647088865, 'f1': 0.9907484361546226}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0265
Epoch 19/30, Step 20/1,Classification Loss: 0.3144, Contrastive Loss: 0.0272
Epoch 19/30, Step 40/1,Classification Loss: 0.3138, Contrastive Loss: 0.0277
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 19/30, Step 100/1,Classification Loss: 0.3203, Contrastive Loss: 0.0263
Epoch 19/30, Step 120/1,Classification Loss: 0.3275, Contrastive Loss: 0.0332
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9965, Precision: 0.9946, Recall: 0.9900, F1: 0.9923
Epoch 19/30
Training - Loss: 46.2497
Training Metrics: {'accuracy': 0.9995949074074074, 'precision': 0.9993982392374274, 'recall': 0.998847456853032, 'f1': 0.9991226308748806}
Validation Metrics: {'accuracy': 0.9965329943372241, 'precision': 0.9945504557811485, 'recall': 0.9900359121924274, 'f1': 0.9922785837258636}
Epoch 20/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0396
Epoch 20/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0366
Epoch 20/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0249
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9969, Precision: 0.9940, Recall: 0.9921, F1: 0.9931
Epoch 20/30
Training - Loss: 46.0600
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9991433465147301, 'recall': 0.9992345676701454, 'f1': 0.9991889511212732}
Validation Metrics: {'accuracy': 0.9968796949035017, 'precision': 0.9940102543105149, 'recall': 0.9921332969813482, 'f1': 0.9930692529162455}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 40/1,Classification Loss: 0.3147, Contrastive Loss: 0.0253
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0237
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9992, F1: 0.9993
Accuracy: 0.9958, Precision: 0.9930, Recall: 0.9885, F1: 0.9907
Epoch 21/30
Training - Loss: 45.7164
Training Metrics: {'accuracy': 0.9996817129629629, 'precision': 0.9994483043220375, 'recall': 0.999172700973018, 'f1': 0.9993104483031224}
Validation Metrics: {'accuracy': 0.9958395932046689, 'precision': 0.992999052388297, 'recall': 0.9884986709101529, 'f1': 0.9907343004710365}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 22/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0362
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Accuracy: 0.9997, Precision: 0.9992, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9962, Precision: 0.9928, Recall: 0.9902, F1: 0.9915
Epoch 22/30
Training - Loss: 45.7114
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9992468608523994, 'recall': 0.9992468608523994, 'f1': 0.9992468608523994}
Validation Metrics: {'accuracy': 0.9961862937709465, 'precision': 0.9928387346897272, 'recall': 0.990216408799707, 'f1': 0.9915226318023103}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 23/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0355
Epoch 23/30, Step 80/1,Classification Loss: 0.3319, Contrastive Loss: 0.0373
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Accuracy: 0.9994, Precision: 0.9995, Recall: 0.9980, F1: 0.9987
Accuracy: 0.9964, Precision: 0.9945, Recall: 0.9896, F1: 0.9920
Epoch 23/30
Training - Loss: 45.5691
Training Metrics: {'accuracy': 0.9994212962962963, 'precision': 0.999480358045959, 'recall': 0.9979959998110938, 'f1': 0.9987366071492871}
Validation Metrics: {'accuracy': 0.9964174274817982, 'precision': 0.9944807090070886, 'recall': 0.989589881862365, 'f1': 0.9920181530830536}
Epoch 24/30, Step 0/1,Classification Loss: 0.3189, Contrastive Loss: 0.0232
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 24/30, Step 100/1,Classification Loss: 0.3145, Contrastive Loss: 0.0232
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9964, Precision: 0.9934, Recall: 0.9907, F1: 0.9920
Epoch 24/30
Training - Loss: 45.4598
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9994303504465281, 'recall': 0.9990616192296703, 'f1': 0.999245887682171}
Validation Metrics: {'accuracy': 0.9964174274817982, 'precision': 0.9933538895171797, 'recall': 0.9907288225604651, 'f1': 0.9920364116930793}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 25/30, Step 20/1,Classification Loss: 0.3296, Contrastive Loss: 0.0374
Epoch 25/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0195
Epoch 25/30, Step 60/1,Classification Loss: 0.3139, Contrastive Loss: 0.0199
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9989, F1: 0.9992
Accuracy: 0.9965, Precision: 0.9934, Recall: 0.9912, F1: 0.9923
Epoch 25/30
Training - Loss: 45.3538
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9995067623358649, 'recall': 0.9988636801313979, 'f1': 0.9991849252964023}
Validation Metrics: {'accuracy': 0.9965329943372241, 'precision': 0.9934248834306777, 'recall': 0.9911748528905275, 'f1': 0.9922962371188478}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0335
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9946, Recall: 0.9905, F1: 0.9925
Epoch 26/30
Training - Loss: 45.2142
Training Metrics: {'accuracy': 0.9995949074074074, 'precision': 0.9993042766499595, 'recall': 0.9989353471074844, 'f1': 0.9991197146198634}
Validation Metrics: {'accuracy': 0.99664856119265, 'precision': 0.9946202134787578, 'recall': 0.9904819425224898, 'f1': 0.9925388149644725}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 40/1,Classification Loss: 0.3277, Contrastive Loss: 0.0277
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0334
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9966, Precision: 0.9928, Recall: 0.9924, F1: 0.9926
Epoch 27/30
Training - Loss: 45.1753
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9995233830110464, 'recall': 0.9989718833227696, 'f1': 0.9992474155824288}
Validation Metrics: {'accuracy': 0.99664856119265, 'precision': 0.9927543807248109, 'recall': 0.9923801770193236, 'f1': 0.9925671784012549}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 120/1,Classification Loss: 0.3269, Contrastive Loss: 0.0192
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9966, Precision: 0.9920, Recall: 0.9931, F1: 0.9926
Epoch 28/30
Training - Loss: 44.9840
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9993375192366156, 'recall': 0.9991529108238929, 'f1': 0.9992451906896718}
Validation Metrics: {'accuracy': 0.99664856119265, 'precision': 0.9920192338143048, 'recall': 0.9931394708180571, 'f1': 0.9925784511952802}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 100/1,Classification Loss: 0.3174, Contrastive Loss: 0.0188
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Accuracy: 0.9997, Precision: 0.9996, Recall: 0.9992, F1: 0.9994
Accuracy: 0.9961, Precision: 0.9906, Recall: 0.9920, F1: 0.9913
Epoch 29/30
Training - Loss: 44.9140
Training Metrics: {'accuracy': 0.9997106481481481, 'precision': 0.9995552705100703, 'recall': 0.9991852786202328, 'f1': 0.9993701768917245}
Validation Metrics: {'accuracy': 0.9960707269155207, 'precision': 0.9905592750029519, 'recall': 0.9920482598658451, 'f1': 0.9913021703627756}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0174
Epoch 30/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0477
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9963, Precision: 0.9914, Recall: 0.9922, F1: 0.9918
Epoch 30/30
Training - Loss: 45.0154
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9993360167498256, 'recall': 0.9991507745470226, 'f1': 0.9992433711728752}
Validation Metrics: {'accuracy': 0.9963018606263724, 'precision': 0.9914349724876097, 'recall': 0.9921810267272364, 'f1': 0.9918075992966446}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5206, 5814), y shape: (5206,), y distribution: Counter({np.float64(0.0): 4606, np.float64(1.0): 600}), env shape: (5206,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9549, Precision: 0.9603, Recall: 0.8136, F1: 0.8690
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9215]))
original train data shape: torch.Size([43362]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5206, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43362]), new train data shape: torch.Size([43362])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9215]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.5317
Epoch 1/30, Step 20/1,Classification Loss: 0.3144, Contrastive Loss: 0.6788
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3180
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2211
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1820
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1641
Epoch 1/30, Step 120/1,Classification Loss: 0.3369, Contrastive Loss: 0.1691
Accuracy: 0.9992, Precision: 0.9984, Recall: 0.9983, F1: 0.9983
Accuracy: 0.9967, Precision: 0.9939, Recall: 0.9913, F1: 0.9926
Epoch 1/30
Training - Loss: 93.3518
Training Metrics: {'accuracy': 0.99921875, 'precision': 0.9983651807117832, 'recall': 0.9982744511236145, 'f1': 0.9983198099903023}
Validation Metrics: {'accuracy': 0.9966562896344978, 'precision': 0.9939187422716835, 'recall': 0.9913201237241127, 'f1': 0.9926145778145226}
Epoch 2/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.1458
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1323
Epoch 2/30, Step 40/1,Classification Loss: 0.3229, Contrastive Loss: 0.1290
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1215
Epoch 2/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1266
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1141
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1112
Accuracy: 0.9993, Precision: 0.9985, Recall: 0.9986, F1: 0.9986
Accuracy: 0.9969, Precision: 0.9941, Recall: 0.9922, F1: 0.9931
Epoch 2/30
Training - Loss: 59.8623
Training Metrics: {'accuracy': 0.9993344907407408, 'precision': 0.9985225276966339, 'recall': 0.9986133736355632, 'f1': 0.9985679447287343}
Validation Metrics: {'accuracy': 0.9968868903493601, 'precision': 0.9940596227197824, 'recall': 0.9922035159502611, 'f1': 0.9931290942810583}
Epoch 3/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1234
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1064
Epoch 3/30, Step 40/1,Classification Loss: 0.3227, Contrastive Loss: 0.1098
Epoch 3/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1166
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0998
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0978
Epoch 3/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1051
Accuracy: 0.9995, Precision: 0.9988, Recall: 0.9989, F1: 0.9988
Accuracy: 0.9968, Precision: 0.9944, Recall: 0.9914, F1: 0.9929
Epoch 3/30
Training - Loss: 56.8774
Training Metrics: {'accuracy': 0.9994502314814815, 'precision': 0.9987665305682103, 'recall': 0.9988579459597924, 'f1': 0.9988122322689565}
Validation Metrics: {'accuracy': 0.9967715899919289, 'precision': 0.9943593905346281, 'recall': 0.9913864279277992, 'f1': 0.992866559508199}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0945
Epoch 4/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1433
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0913
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0895
Epoch 4/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1038
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0865
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0854
Accuracy: 0.9994, Precision: 0.9988, Recall: 0.9988, F1: 0.9988
Accuracy: 0.9968, Precision: 0.9944, Recall: 0.9914, F1: 0.9929
Epoch 4/30
Training - Loss: 55.1353
Training Metrics: {'accuracy': 0.9994212962962963, 'precision': 0.9987532575385585, 'recall': 0.9987532575385585, 'f1': 0.9987532575385585}
Validation Metrics: {'accuracy': 0.9967715899919289, 'precision': 0.9943593905346281, 'recall': 0.9913864279277992, 'f1': 0.992866559508199}
Epoch 5/30, Step 0/1,Classification Loss: 0.3275, Contrastive Loss: 0.0868
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0827
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0815
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0803
Epoch 5/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0918
Epoch 5/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0934
Epoch 5/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0913
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9990, F1: 0.9990
Accuracy: 0.9968, Precision: 0.9940, Recall: 0.9918, F1: 0.9929
Epoch 5/30
Training - Loss: 53.8245
Training Metrics: {'accuracy': 0.999537037037037, 'precision': 0.9990044224772108, 'recall': 0.9990044224772108, 'f1': 0.9990044224772108}
Validation Metrics: {'accuracy': 0.9967715899919289, 'precision': 0.9939891775895331, 'recall': 0.9917618198371869, 'f1': 0.9928719331384017}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0760
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0752
Epoch 6/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0910
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0732
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0733
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0710
Epoch 6/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0703
Accuracy: 0.9995, Precision: 0.9989, Recall: 0.9990, F1: 0.9989
Accuracy: 0.9967, Precision: 0.9939, Recall: 0.9913, F1: 0.9926
Epoch 6/30
Training - Loss: 52.6624
Training Metrics: {'accuracy': 0.9995081018518519, 'precision': 0.9988882277819702, 'recall': 0.9989800504517582, 'f1': 0.9989341330799109}
Validation Metrics: {'accuracy': 0.9966562896344978, 'precision': 0.9939187422716835, 'recall': 0.9913201237241127, 'f1': 0.9926145778145226}
Epoch 7/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.1043
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0683
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0673
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0668
Epoch 7/30, Step 80/1,Classification Loss: 0.3283, Contrastive Loss: 0.0695
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0648
Epoch 7/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0772
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9965, Precision: 0.9935, Recall: 0.9913, F1: 0.9924
Epoch 7/30
Training - Loss: 51.7499
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.999238359838912, 'recall': 0.999147802628122, 'f1': 0.9991930753319944}
Validation Metrics: {'accuracy': 0.9965409892770668, 'precision': 0.9934788763653044, 'recall': 0.9912538195204261, 'f1': 0.9923627855054304}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0633
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0626
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0618
Epoch 8/30, Step 60/1,Classification Loss: 0.3158, Contrastive Loss: 0.0635
Epoch 8/30, Step 80/1,Classification Loss: 0.3325, Contrastive Loss: 0.1087
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0596
Epoch 8/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0738
Accuracy: 0.9995, Precision: 0.9988, Recall: 0.9991, F1: 0.9989
Accuracy: 0.9967, Precision: 0.9939, Recall: 0.9913, F1: 0.9926
Epoch 8/30
Training - Loss: 51.1842
Training Metrics: {'accuracy': 0.9995081018518519, 'precision': 0.9988033761526118, 'recall': 0.9990766884916096, 'f1': 0.9989399786720865}
Validation Metrics: {'accuracy': 0.9966562896344978, 'precision': 0.9939187422716835, 'recall': 0.9913201237241127, 'f1': 0.9926145778145226}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0583
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0576
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0572
Epoch 9/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0572
Epoch 9/30, Step 80/1,Classification Loss: 0.3145, Contrastive Loss: 0.0561
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0548
Epoch 9/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0700
Accuracy: 0.9995, Precision: 0.9988, Recall: 0.9990, F1: 0.9989
Accuracy: 0.9967, Precision: 0.9943, Recall: 0.9909, F1: 0.9926
Epoch 9/30
Training - Loss: 50.3820
Training Metrics: {'accuracy': 0.9994791666666667, 'precision': 0.9987887239535312, 'recall': 0.9989704581631951, 'f1': 0.9988795673112582}
Validation Metrics: {'accuracy': 0.9966562896344978, 'precision': 0.9942893621036368, 'recall': 0.990944731814725, 'f1': 0.9926090072040412}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0537
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0531
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0518
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0512
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0507
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0500
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9968, Precision: 0.9944, Recall: 0.9914, F1: 0.9929
Epoch 10/30
Training - Loss: 49.7812
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9991489080893055, 'recall': 0.999239300524596, 'f1': 0.9991940984226423}
Validation Metrics: {'accuracy': 0.9967715899919289, 'precision': 0.9943593905346281, 'recall': 0.9913864279277992, 'f1': 0.992866559508199}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0495
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0490
Epoch 11/30, Step 40/1,Classification Loss: 0.3164, Contrastive Loss: 0.0492
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0472
Epoch 11/30, Step 100/1,Classification Loss: 0.3169, Contrastive Loss: 0.0500
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0461
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9967, Precision: 0.9943, Recall: 0.9909, F1: 0.9926
Epoch 11/30
Training - Loss: 49.1922
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9991433465147301, 'recall': 0.9992345676701454, 'f1': 0.9991889511212732}
Validation Metrics: {'accuracy': 0.9966562896344978, 'precision': 0.9942893621036368, 'recall': 0.990944731814725, 'f1': 0.9926090072040412}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0457
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0454
Epoch 12/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0544
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0442
Epoch 12/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0459
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0431
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0428
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9968, Precision: 0.9947, Recall: 0.9910, F1: 0.9929
Epoch 12/30
Training - Loss: 48.8012
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9992399706567148, 'recall': 0.9991496956242711, 'f1': 0.9991948272684326}
Validation Metrics: {'accuracy': 0.9967715899919289, 'precision': 0.9947311933044247, 'recall': 0.9910110360184115, 'f1': 0.9928611760909898}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0412
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0407
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0402
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0394
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9968, Precision: 0.9947, Recall: 0.9910, F1: 0.9929
Epoch 13/30
Training - Loss: 48.1474
Training Metrics: {'accuracy': 0.9994791666666667, 'precision': 0.9990623350779428, 'recall': 0.9986994347304191, 'f1': 0.998880790154091}
Validation Metrics: {'accuracy': 0.9967715899919289, 'precision': 0.9947311933044247, 'recall': 0.9910110360184115, 'f1': 0.9928611760909898}
Epoch 14/30, Step 0/1,Classification Loss: 0.3278, Contrastive Loss: 0.0418
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0385
Epoch 14/30, Step 40/1,Classification Loss: 0.3330, Contrastive Loss: 0.0409
Epoch 14/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0380
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0372
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0367
Epoch 14/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0367
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9988, F1: 0.9989
Accuracy: 0.9968, Precision: 0.9947, Recall: 0.9910, F1: 0.9929
Epoch 14/30
Training - Loss: 47.8346
Training Metrics: {'accuracy': 0.9994791666666667, 'precision': 0.998968106573251, 'recall': 0.9987857544337313, 'f1': 0.9988769066264849}
Validation Metrics: {'accuracy': 0.9967715899919289, 'precision': 0.9947311933044247, 'recall': 0.9910110360184115, 'f1': 0.9928611760909898}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0356
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0353
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0348
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0344
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0336
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9989, F1: 0.9989
Accuracy: 0.9968, Precision: 0.9940, Recall: 0.9918, F1: 0.9929
Epoch 15/30
Training - Loss: 47.5132
Training Metrics: {'accuracy': 0.9995081018518519, 'precision': 0.9989785749638236, 'recall': 0.9988865591357843, 'f1': 0.9989325609923743}
Validation Metrics: {'accuracy': 0.9967715899919289, 'precision': 0.9939891775895331, 'recall': 0.9917618198371869, 'f1': 0.9928719331384017}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0329
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0325
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0318
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0311
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9989, F1: 0.9989
Accuracy: 0.9971, Precision: 0.9946, Recall: 0.9927, F1: 0.9936
Epoch 16/30
Training - Loss: 47.1590
Training Metrics: {'accuracy': 0.9995081018518519, 'precision': 0.9989828027684335, 'recall': 0.9988913405164797, 'f1': 0.9989370656436087}
Validation Metrics: {'accuracy': 0.9971174910642223, 'precision': 0.9945695387132831, 'recall': 0.9927115162670218, 'f1': 0.9936380502602392}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0299
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9971, Precision: 0.9953, Recall: 0.9920, F1: 0.9936
Epoch 17/30
Training - Loss: 46.8511
Training Metrics: {'accuracy': 0.9995949074074074, 'precision': 0.9992216407858792, 'recall': 0.9990405724435031, 'f1': 0.9991310830160169}
Validation Metrics: {'accuracy': 0.9971174910642223, 'precision': 0.9953122843848962, 'recall': 0.9919607324482465, 'f1': 0.9936284544862424}
Epoch 18/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0435
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0282
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 18/30, Step 80/1,Classification Loss: 0.3287, Contrastive Loss: 0.0378
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Accuracy: 0.9995, Precision: 0.9987, Recall: 0.9989, F1: 0.9988
Accuracy: 0.9972, Precision: 0.9950, Recall: 0.9928, F1: 0.9939
Epoch 18/30
Training - Loss: 46.4537
Training Metrics: {'accuracy': 0.9994502314814815, 'precision': 0.9986718574442052, 'recall': 0.9989470395456562, 'f1': 0.9988093942427855}
Validation Metrics: {'accuracy': 0.9972327914216534, 'precision': 0.9950097800379905, 'recall': 0.9927778204707083, 'f1': 0.9938902284043444}
Epoch 19/30, Step 0/1,Classification Loss: 0.3225, Contrastive Loss: 0.0282
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 19/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0403
Epoch 19/30, Step 120/1,Classification Loss: 0.3161, Contrastive Loss: 0.0260
Accuracy: 0.9995, Precision: 0.9989, Recall: 0.9991, F1: 0.9990
Accuracy: 0.9972, Precision: 0.9954, Recall: 0.9924, F1: 0.9939
Epoch 19/30
Training - Loss: 46.2491
Training Metrics: {'accuracy': 0.999537037037037, 'precision': 0.9989154445040301, 'recall': 0.9990967036006202, 'f1': 0.9990060504092924}
Validation Metrics: {'accuracy': 0.9972327914216534, 'precision': 0.9953815381264706, 'recall': 0.9924024285613207, 'f1': 0.9938856224355992}
Epoch 20/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 0.0274
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 20/30, Step 60/1,Classification Loss: 0.3166, Contrastive Loss: 0.0256
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0238
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Accuracy: 0.9995, Precision: 0.9989, Recall: 0.9991, F1: 0.9990
Accuracy: 0.9970, Precision: 0.9945, Recall: 0.9923, F1: 0.9934
Epoch 20/30
Training - Loss: 45.9907
Training Metrics: {'accuracy': 0.999537037037037, 'precision': 0.9989178874346852, 'recall': 0.9990985814725926, 'f1': 0.9990082109287407}
Validation Metrics: {'accuracy': 0.9970021907067912, 'precision': 0.9944994788137618, 'recall': 0.9922698201539476, 'f1': 0.993381080771373}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 21/30, Step 120/1,Classification Loss: 0.3356, Contrastive Loss: 0.0383
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9992, F1: 0.9991
Accuracy: 0.9973, Precision: 0.9955, Recall: 0.9928, F1: 0.9941
Epoch 21/30
Training - Loss: 45.8968
Training Metrics: {'accuracy': 0.9995949074074074, 'precision': 0.9990343666829231, 'recall': 0.9992170488162473, 'f1': 0.9991256838121522}
Validation Metrics: {'accuracy': 0.9973480917790846, 'precision': 0.9954508037449215, 'recall': 0.9928441246743949, 'f1': 0.9941425961977248}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0362
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9988, F1: 0.9989
Accuracy: 0.9971, Precision: 0.9949, Recall: 0.9923, F1: 0.9936
Epoch 22/30
Training - Loss: 45.5567
Training Metrics: {'accuracy': 0.9995081018518519, 'precision': 0.9990777915662944, 'recall': 0.9988049783252757, 'f1': 0.9989413314531155}
Validation Metrics: {'accuracy': 0.9971174910642223, 'precision': 0.9949401165871754, 'recall': 0.9923361243576341, 'f1': 0.9936332567366575}
Epoch 23/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0367
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9970, Precision: 0.9952, Recall: 0.9915, F1: 0.9934
Epoch 23/30
Training - Loss: 45.5657
Training Metrics: {'accuracy': 0.9995081018518519, 'precision': 0.999166545090643, 'recall': 0.9987098318495178, 'f1': 0.9989380388143234}
Validation Metrics: {'accuracy': 0.9970021907067912, 'precision': 0.9952430424981782, 'recall': 0.9915190363351722, 'f1': 0.9933710920844905}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 24/30, Step 20/1,Classification Loss: 0.3206, Contrastive Loss: 0.0268
Epoch 24/30, Step 40/1,Classification Loss: 0.3389, Contrastive Loss: 0.0364
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0221
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9970, Precision: 0.9949, Recall: 0.9919, F1: 0.9934
Epoch 24/30
Training - Loss: 45.4398
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9991391589515597, 'recall': 0.99923100365705, 'f1': 0.9991850752673266}
Validation Metrics: {'accuracy': 0.9970021907067912, 'precision': 0.9948704643305493, 'recall': 0.9918944282445599, 'f1': 0.9933760909718992}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 25/30, Step 20/1,Classification Loss: 0.3147, Contrastive Loss: 0.0207
Epoch 25/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0195
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Accuracy: 0.9997, Precision: 0.9992, Recall: 0.9993, F1: 0.9993
Accuracy: 0.9971, Precision: 0.9953, Recall: 0.9920, F1: 0.9936
Epoch 25/30
Training - Loss: 45.4745
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9991613337550997, 'recall': 0.9993434415859799, 'f1': 0.9992523638584728}
Validation Metrics: {'accuracy': 0.9971174910642223, 'precision': 0.9953122843848962, 'recall': 0.9919607324482465, 'f1': 0.9936284544862424}
Epoch 26/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0398
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 26/30, Step 100/1,Classification Loss: 0.3144, Contrastive Loss: 0.0198
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9993, F1: 0.9992
Accuracy: 0.9970, Precision: 0.9952, Recall: 0.9915, F1: 0.9934
Epoch 26/30
Training - Loss: 45.3340
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9990482919296957, 'recall': 0.9993234647422069, 'f1': 0.9991858241178326}
Validation Metrics: {'accuracy': 0.9970021907067912, 'precision': 0.9952430424981782, 'recall': 0.9915190363351722, 'f1': 0.9933710920844905}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Accuracy: 0.9995, Precision: 0.9989, Recall: 0.9991, F1: 0.9990
Accuracy: 0.9969, Precision: 0.9944, Recall: 0.9918, F1: 0.9931
Epoch 27/30
Training - Loss: 45.1986
Training Metrics: {'accuracy': 0.999537037037037, 'precision': 0.9989133988638533, 'recall': 0.9990951310103312, 'f1': 0.9990042411949106}
Validation Metrics: {'accuracy': 0.9968868903493601, 'precision': 0.9944294294294295, 'recall': 0.9918281240408734, 'f1': 0.99312391727559}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9986, F1: 0.9989
Accuracy: 0.9969, Precision: 0.9952, Recall: 0.9911, F1: 0.9931
Epoch 28/30
Training - Loss: 45.2920
Training Metrics: {'accuracy': 0.9994791666666667, 'precision': 0.9991423803527572, 'recall': 0.9985864882123849, 'f1': 0.9988642137691075}
Validation Metrics: {'accuracy': 0.9968868903493601, 'precision': 0.9951738124442462, 'recall': 0.991077340222098, 'f1': 0.9931135349647101}
Epoch 29/30, Step 0/1,Classification Loss: 0.3285, Contrastive Loss: 0.0280
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 29/30, Step 80/1,Classification Loss: 0.3188, Contrastive Loss: 0.0208
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9965, Precision: 0.9942, Recall: 0.9905, F1: 0.9924
Epoch 29/30
Training - Loss: 45.1763
Training Metrics: {'accuracy': 0.999537037037037, 'precision': 0.9990970172772122, 'recall': 0.998915852553619, 'f1': 0.9990064112921357}
Validation Metrics: {'accuracy': 0.9965409892770668, 'precision': 0.9942193441106713, 'recall': 0.9905030357016508, 'f1': 0.9923512600974891}
Epoch 30/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0322
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0201
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9971, Precision: 0.9953, Recall: 0.9920, F1: 0.9936
Epoch 30/30
Training - Loss: 45.1603
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9992443565522453, 'recall': 0.9991548502942811, 'f1': 0.999199597631059}
Validation Metrics: {'accuracy': 0.9971174910642223, 'precision': 0.9953122843848962, 'recall': 0.9919607324482465, 'f1': 0.9936284544862424}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5181, 5814), y shape: (5181,), y distribution: Counter({np.float64(0.0): 4581, np.float64(1.0): 600}), env shape: (5181,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9456, Precision: 0.9521, Recall: 0.7751, F1: 0.8360
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9315]))
original train data shape: torch.Size([43462]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5181, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43462]), new train data shape: torch.Size([43462])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9315]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.5936
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.7659
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3566
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2397
Epoch 1/30, Step 80/1,Classification Loss: 0.3241, Contrastive Loss: 0.1985
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1692
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1540
Accuracy: 0.9993, Precision: 0.9983, Recall: 0.9986, F1: 0.9985
Accuracy: 0.9967, Precision: 0.9940, Recall: 0.9914, F1: 0.9927
Epoch 1/30
Training - Loss: 97.4337
Training Metrics: {'accuracy': 0.9992766203703703, 'precision': 0.9983279972933294, 'recall': 0.9985958419547691, 'f1': 0.9984618676454163}
Validation Metrics: {'accuracy': 0.9966639825146669, 'precision': 0.9939879296706724, 'recall': 0.9914313191697666, 'f1': 0.9927049003309978}
Epoch 2/30, Step 0/1,Classification Loss: 0.3153, Contrastive Loss: 0.1480
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1374
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1310
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1259
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1222
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1181
Epoch 2/30, Step 120/1,Classification Loss: 0.3270, Contrastive Loss: 0.1171
Accuracy: 0.9994, Precision: 0.9986, Recall: 0.9990, F1: 0.9988
Accuracy: 0.9965, Precision: 0.9939, Recall: 0.9910, F1: 0.9925
Epoch 2/30
Training - Loss: 60.0220
Training Metrics: {'accuracy': 0.9994212962962963, 'precision': 0.9985971441191028, 'recall': 0.9989523330699801, 'f1': 0.9987746470300922}
Validation Metrics: {'accuracy': 0.9965489474289658, 'precision': 0.993917660230279, 'recall': 0.9909957791000801, 'f1': 0.9924505468700064}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1123
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1097
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1072
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1048
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1028
Epoch 3/30, Step 100/1,Classification Loss: 0.3279, Contrastive Loss: 0.1060
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0987
Accuracy: 0.9994, Precision: 0.9985, Recall: 0.9989, F1: 0.9987
Accuracy: 0.9965, Precision: 0.9950, Recall: 0.9899, F1: 0.9924
Epoch 3/30
Training - Loss: 56.9648
Training Metrics: {'accuracy': 0.9993923611111111, 'precision': 0.9984751931469151, 'recall': 0.9989256524860535, 'f1': 0.9987002763823518}
Validation Metrics: {'accuracy': 0.9965489474289658, 'precision': 0.995017444195025, 'recall': 0.9898879660480786, 'f1': 0.9924337041734131}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0968
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0952
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0943
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0916
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0905
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0885
Epoch 4/30, Step 120/1,Classification Loss: 0.3277, Contrastive Loss: 0.0932
Accuracy: 0.9994, Precision: 0.9984, Recall: 0.9990, F1: 0.9987
Accuracy: 0.9965, Precision: 0.9939, Recall: 0.9910, F1: 0.9925
Epoch 4/30
Training - Loss: 55.2039
Training Metrics: {'accuracy': 0.9993923611111111, 'precision': 0.9983993465856431, 'recall': 0.9990226940437095, 'f1': 0.998710738598682}
Validation Metrics: {'accuracy': 0.9965489474289658, 'precision': 0.993917660230279, 'recall': 0.9909957791000801, 'f1': 0.9924505468700064}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0858
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0844
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0831
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0817
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0805
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0791
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0780
Accuracy: 0.9995, Precision: 0.9988, Recall: 0.9990, F1: 0.9989
Accuracy: 0.9965, Precision: 0.9939, Recall: 0.9910, F1: 0.9925
Epoch 5/30
Training - Loss: 53.9012
Training Metrics: {'accuracy': 0.9994791666666667, 'precision': 0.9988026552678282, 'recall': 0.998981488079121, 'f1': 0.9988920485310955}
Validation Metrics: {'accuracy': 0.9965489474289658, 'precision': 0.993917660230279, 'recall': 0.9909957791000801, 'f1': 0.9924505468700064}
Epoch 6/30, Step 0/1,Classification Loss: 0.3140, Contrastive Loss: 0.0793
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0761
Epoch 6/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0889
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0737
Epoch 6/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0743
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0716
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0706
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9993, F1: 0.9992
Accuracy: 0.9963, Precision: 0.9938, Recall: 0.9901, F1: 0.9919
Epoch 6/30
Training - Loss: 52.7770
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9991623687432551, 'recall': 0.9992507526243369, 'f1': 0.9992065550070974}
Validation Metrics: {'accuracy': 0.9963188772575635, 'precision': 0.9937771515040843, 'recall': 0.9901246989607073, 'f1': 0.9919412722416321}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0699
Epoch 7/30, Step 20/1,Classification Loss: 0.3140, Contrastive Loss: 0.0700
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0681
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0671
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0661
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0655
Epoch 7/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.0650
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9969, Precision: 0.9952, Recall: 0.9912, F1: 0.9932
Epoch 7/30
Training - Loss: 52.0097
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.9990265523864117, 'recall': 0.999116711310494, 'f1': 0.9990716259873942}
Validation Metrics: {'accuracy': 0.9968940526860692, 'precision': 0.9952246911131566, 'recall': 0.9911945862571377, 'f1': 0.9931979231888218}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0638
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0629
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0623
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0619
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0605
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0598
Epoch 8/30, Step 120/1,Classification Loss: 0.3295, Contrastive Loss: 0.0664
Accuracy: 0.9994, Precision: 0.9987, Recall: 0.9987, F1: 0.9987
Accuracy: 0.9965, Precision: 0.9954, Recall: 0.9895, F1: 0.9924
Epoch 8/30
Training - Loss: 51.0410
Training Metrics: {'accuracy': 0.9993923611111111, 'precision': 0.9987421949551278, 'recall': 0.9986517748737525, 'f1': 0.9986969790228147}
Validation Metrics: {'accuracy': 0.9965489474289658, 'precision': 0.9953871643728768, 'recall': 0.9895186950307446, 'f1': 0.9924280697108852}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0584
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0577
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0569
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0563
Epoch 9/30, Step 80/1,Classification Loss: 0.3176, Contrastive Loss: 0.0588
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0553
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0543
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9967, Precision: 0.9951, Recall: 0.9903, F1: 0.9927
Epoch 9/30
Training - Loss: 50.3515
Training Metrics: {'accuracy': 0.999537037037037, 'precision': 0.9991052289082836, 'recall': 0.9989265366845095, 'f1': 0.9990158596873909}
Validation Metrics: {'accuracy': 0.9966639825146669, 'precision': 0.9950865145080686, 'recall': 0.9903235061177649, 'f1': 0.9926886336831084}
Epoch 10/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0601
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0534
Epoch 10/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0538
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0517
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0512
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0505
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0499
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9993, F1: 0.9992
Accuracy: 0.9968, Precision: 0.9944, Recall: 0.9915, F1: 0.9930
Epoch 10/30
Training - Loss: 49.8165
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9990685854354207, 'recall': 0.9993358594462196, 'f1': 0.9992021706966343}
Validation Metrics: {'accuracy': 0.9967790176003681, 'precision': 0.9944224555828868, 'recall': 0.9914975882221191, 'f1': 0.9929538437453393}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0494
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0489
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0483
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0472
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0466
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0462
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9965, Precision: 0.9936, Recall: 0.9914, F1: 0.9925
Epoch 11/30
Training - Loss: 49.2746
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.9990320766558193, 'recall': 0.9991215145987247, 'f1': 0.999076789841061}
Validation Metrics: {'accuracy': 0.9965489474289658, 'precision': 0.9935541644314285, 'recall': 0.991365050117414, 'f1': 0.9924561409598656}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0458
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0454
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0445
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0441
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0435
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0430
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0425
Accuracy: 0.9995, Precision: 0.9988, Recall: 0.9992, F1: 0.9990
Accuracy: 0.9969, Precision: 0.9941, Recall: 0.9923, F1: 0.9932
Epoch 12/30
Training - Loss: 48.6649
Training Metrics: {'accuracy': 0.999537037037037, 'precision': 0.9988348086567111, 'recall': 0.9991932105698149, 'f1': 0.9990139167560281}
Validation Metrics: {'accuracy': 0.9968940526860692, 'precision': 0.9941284988383075, 'recall': 0.9923023993091393, 'f1': 0.9932130408185955}
Epoch 13/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0430
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0421
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0414
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0408
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Epoch 13/30, Step 100/1,Classification Loss: 0.3276, Contrastive Loss: 0.0430
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0393
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9993, F1: 0.9991
Accuracy: 0.9963, Precision: 0.9938, Recall: 0.9901, F1: 0.9919
Epoch 13/30
Training - Loss: 48.2100
Training Metrics: {'accuracy': 0.9995949074074074, 'precision': 0.9989554011078134, 'recall': 0.999315100429109, 'f1': 0.9991351573900226}
Validation Metrics: {'accuracy': 0.9963188772575635, 'precision': 0.9937771515040843, 'recall': 0.9901246989607073, 'f1': 0.9919412722416321}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0390
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0386
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0381
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0377
Epoch 14/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0375
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0368
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9963, Precision: 0.9923, Recall: 0.9916, F1: 0.9920
Epoch 14/30
Training - Loss: 47.7505
Training Metrics: {'accuracy': 0.9995949074074074, 'precision': 0.9992282684778091, 'recall': 0.9990495322027748, 'f1': 0.9991388772264671}
Validation Metrics: {'accuracy': 0.9963188772575635, 'precision': 0.9923292220410038, 'recall': 0.9916017830300428, 'f1': 0.9919651190223935}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0362
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0357
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 15/30, Step 100/1,Classification Loss: 0.3275, Contrastive Loss: 0.0405
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9963, Precision: 0.9938, Recall: 0.9901, F1: 0.9919
Epoch 15/30
Training - Loss: 47.4259
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9991496956242711, 'recall': 0.9992399706567148, 'f1': 0.9991948272684326}
Validation Metrics: {'accuracy': 0.9963188772575635, 'precision': 0.9937771515040843, 'recall': 0.9901246989607073, 'f1': 0.9919412722416321}
Epoch 16/30, Step 0/1,Classification Loss: 0.3285, Contrastive Loss: 0.0381
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0331
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0325
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0322
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0318
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0314
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9967, Precision: 0.9936, Recall: 0.9918, F1: 0.9927
Epoch 16/30
Training - Loss: 47.1212
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.999122436714919, 'recall': 0.9990331372522456, 'f1': 0.9990777812116868}
Validation Metrics: {'accuracy': 0.9966639825146669, 'precision': 0.9936248283534095, 'recall': 0.9918005901871003, 'f1': 0.9927103031014546}
Epoch 17/30, Step 0/1,Classification Loss: 0.3228, Contrastive Loss: 0.0321
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 17/30, Step 80/1,Classification Loss: 0.3281, Contrastive Loss: 0.0327
Epoch 17/30, Step 100/1,Classification Loss: 0.3236, Contrastive Loss: 0.0346
Epoch 17/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0448
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9965, Precision: 0.9954, Recall: 0.9895, F1: 0.9924
Epoch 17/30
Training - Loss: 46.9015
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.9991251885369532, 'recall': 0.9990363024676734, 'f1': 0.9990807397730362}
Validation Metrics: {'accuracy': 0.9965489474289658, 'precision': 0.9953871643728768, 'recall': 0.9895186950307446, 'f1': 0.9924280697108852}
Epoch 18/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0295
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Epoch 18/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0422
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9965, Precision: 0.9939, Recall: 0.9910, F1: 0.9925
Epoch 18/30
Training - Loss: 46.4907
Training Metrics: {'accuracy': 0.9996238425925926, 'precision': 0.9992456730607491, 'recall': 0.9991563976997514, 'f1': 0.9992010296119129}
Validation Metrics: {'accuracy': 0.9965489474289658, 'precision': 0.993917660230279, 'recall': 0.9909957791000801, 'f1': 0.9924505468700064}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 19/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0413
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 19/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0267
Epoch 19/30, Step 120/1,Classification Loss: 0.3147, Contrastive Loss: 0.0282
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9970, Precision: 0.9957, Recall: 0.9913, F1: 0.9934
Epoch 19/30
Training - Loss: 46.3052
Training Metrics: {'accuracy': 0.9994502314814815, 'precision': 0.9991427315096049, 'recall': 0.998515679198722, 'f1': 0.998828921009133}
Validation Metrics: {'accuracy': 0.9970090877717704, 'precision': 0.9956619014736827, 'recall': 0.9912608553094904, 'f1': 0.9934474180360472}
Epoch 20/30, Step 0/1,Classification Loss: 0.3139, Contrastive Loss: 0.0260
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Accuracy: 0.9997, Precision: 0.9992, Recall: 0.9993, F1: 0.9993
Accuracy: 0.9968, Precision: 0.9944, Recall: 0.9915, F1: 0.9930
Epoch 20/30
Training - Loss: 46.1941
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9991701916103074, 'recall': 0.9993496667789217, 'f1': 0.9992599059321023}
Validation Metrics: {'accuracy': 0.9967790176003681, 'precision': 0.9944224555828868, 'recall': 0.9914975882221191, 'f1': 0.9929538437453393}
Epoch 21/30, Step 0/1,Classification Loss: 0.3194, Contrastive Loss: 0.0256
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0377
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9969, Precision: 0.9949, Recall: 0.9916, F1: 0.9932
Epoch 21/30
Training - Loss: 45.8514
Training Metrics: {'accuracy': 0.9995949074074074, 'precision': 0.9991401085062783, 'recall': 0.9991401085062783, 'f1': 0.9991401085062783}
Validation Metrics: {'accuracy': 0.9968940526860692, 'precision': 0.9948577441717266, 'recall': 0.9915638572744716, 'f1': 0.993202971450951}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9988, F1: 0.9989
Accuracy: 0.9962, Precision: 0.9933, Recall: 0.9901, F1: 0.9917
Epoch 22/30
Training - Loss: 45.6756
Training Metrics: {'accuracy': 0.9994791666666667, 'precision': 0.9989717187575058, 'recall': 0.9987903158885321, 'f1': 0.9988809936454082}
Validation Metrics: {'accuracy': 0.9962038421718624, 'precision': 0.9933422291895193, 'recall': 0.9900584299083548, 'f1': 0.9916925206622735}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 23/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0376
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9964, Precision: 0.9942, Recall: 0.9902, F1: 0.9922
Epoch 23/30
Training - Loss: 45.5068
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.9991257971112788, 'recall': 0.9990370024926309, 'f1': 0.9990813940820824}
Validation Metrics: {'accuracy': 0.9964339123432647, 'precision': 0.9942128384811758, 'recall': 0.9901909680130598, 'f1': 0.9921902081056844}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 24/30, Step 20/1,Classification Loss: 0.3250, Contrastive Loss: 0.0258
Epoch 24/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0208
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 24/30, Step 80/1,Classification Loss: 0.3151, Contrastive Loss: 0.0212
Epoch 24/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0362
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Accuracy: 0.9997, Precision: 0.9991, Recall: 0.9994, F1: 0.9993
Accuracy: 0.9964, Precision: 0.9931, Recall: 0.9913, F1: 0.9922
Epoch 24/30
Training - Loss: 45.4527
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9990752867997841, 'recall': 0.9994369485410461, 'f1': 0.9992560234919193}
Validation Metrics: {'accuracy': 0.9964339123432647, 'precision': 0.9931211578685115, 'recall': 0.9912987810650614, 'f1': 0.9922075653843134}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 25/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0209
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 25/30, Step 120/1,Classification Loss: 0.3148, Contrastive Loss: 0.0213
Accuracy: 0.9996, Precision: 0.9990, Recall: 0.9992, F1: 0.9991
Accuracy: 0.9964, Precision: 0.9931, Recall: 0.9913, F1: 0.9922
Epoch 25/30
Training - Loss: 45.3689
Training Metrics: {'accuracy': 0.9995949074074074, 'precision': 0.999048111735439, 'recall': 0.9992272179023042, 'f1': 0.9991376416285138}
Validation Metrics: {'accuracy': 0.9964339123432647, 'precision': 0.9931211578685115, 'recall': 0.9912987810650614, 'f1': 0.9922075653843134}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 26/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0191
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 80/1,Classification Loss: 0.3176, Contrastive Loss: 0.0190
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9965, Precision: 0.9928, Recall: 0.9921, F1: 0.9925
Epoch 26/30
Training - Loss: 45.2543
Training Metrics: {'accuracy': 0.9995949074074074, 'precision': 0.9991345335970001, 'recall': 0.9991345335970001, 'f1': 0.9991345335970001}
Validation Metrics: {'accuracy': 0.9965489474289658, 'precision': 0.9928317737061824, 'recall': 0.9921035921520818, 'f1': 0.992467299083494}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9996, F1: 0.9994
Accuracy: 0.9969, Precision: 0.9945, Recall: 0.9919, F1: 0.9932
Epoch 27/30
Training - Loss: 45.2823
Training Metrics: {'accuracy': 0.9997395833333333, 'precision': 0.9993072817959512, 'recall': 0.9995781709174387, 'f1': 0.9994426735079401}
Validation Metrics: {'accuracy': 0.9968940526860692, 'precision': 0.9944923493924449, 'recall': 0.9919331282918055, 'f1': 0.9932080106529979}
Epoch 28/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0325
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0186
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 120/1,Classification Loss: 0.3187, Contrastive Loss: 0.0202
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9993, F1: 0.9993
Accuracy: 0.9964, Precision: 0.9928, Recall: 0.9917, F1: 0.9922
Epoch 28/30
Training - Loss: 45.1088
Training Metrics: {'accuracy': 0.9996527777777777, 'precision': 0.9992597728774999, 'recall': 0.9992597728774999, 'f1': 0.9992597728774999}
Validation Metrics: {'accuracy': 0.9964339123432647, 'precision': 0.99276033675597, 'recall': 0.9916680520823953, 'f1': 0.9922133304114866}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 29/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0174
Accuracy: 0.9994, Precision: 0.9991, Recall: 0.9984, F1: 0.9988
Accuracy: 0.9968, Precision: 0.9948, Recall: 0.9911, F1: 0.9929
Epoch 29/30
Training - Loss: 45.0219
Training Metrics: {'accuracy': 0.9994212962962963, 'precision': 0.999121587706089, 'recall': 0.9983987944944418, 'f1': 0.9987598145463419}
Validation Metrics: {'accuracy': 0.9967790176003681, 'precision': 0.9947882487999544, 'recall': 0.9911283172047852, 'f1': 0.992948613211428}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9963, Precision: 0.9923, Recall: 0.9916, F1: 0.9920
Epoch 30/30
Training - Loss: 45.0495
Training Metrics: {'accuracy': 0.9995659722222222, 'precision': 0.9991210526275272, 'recall': 0.9990315453158121, 'f1': 0.9990762931782802}
Validation Metrics: {'accuracy': 0.9963188772575635, 'precision': 0.9923292220410038, 'recall': 0.9916017830300428, 'f1': 0.9919651190223935}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5173, 5814), y shape: (5173,), y distribution: Counter({np.float64(0.0): 4573, np.float64(1.0): 600}), env shape: (5173,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9550, Precision: 0.9661, Recall: 0.8116, F1: 0.8690
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9415]))
original train data shape: torch.Size([43562]), new train data shape: torch.Size([100])
original test data shape: torch.Size([5173, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43562]), new train data shape: torch.Size([43562])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9415]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.6173
Epoch 1/30, Step 20/1,Classification Loss: 0.3152, Contrastive Loss: 1.0615
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4578
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2683
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2016
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1716
Epoch 1/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1666
Accuracy: 0.9994, Precision: 0.9989, Recall: 0.9987, F1: 0.9988
Accuracy: 0.9960, Precision: 0.9940, Recall: 0.9886, F1: 0.9913
Epoch 1/30
Training - Loss: 106.7696
Training Metrics: {'accuracy': 0.9994255514705882, 'precision': 0.9988704734657616, 'recall': 0.9986938654230648, 'f1': 0.9987821468237157}
Validation Metrics: {'accuracy': 0.9959830138872948, 'precision': 0.9939993906259881, 'recall': 0.9886079591330791, 'f1': 0.9912825080009084}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1438
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1346
Epoch 2/30, Step 40/1,Classification Loss: 0.3256, Contrastive Loss: 0.1310
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1227
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1180
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1151
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1117
Accuracy: 0.9995, Precision: 0.9988, Recall: 0.9990, F1: 0.9989
Accuracy: 0.9962, Precision: 0.9941, Recall: 0.9895, F1: 0.9918
Epoch 2/30
Training - Loss: 59.9758
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9988301468561877, 'recall': 0.9990037686785249, 'f1': 0.9989169357569154}
Validation Metrics: {'accuracy': 0.996212555950878, 'precision': 0.9941387593866184, 'recall': 0.9894663282317915, 'f1': 0.9917866581534562}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1088
Epoch 3/30, Step 20/1,Classification Loss: 0.3434, Contrastive Loss: 0.1252
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1039
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1016
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0994
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0977
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0964
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9961, Precision: 0.9941, Recall: 0.9890, F1: 0.9915
Epoch 3/30
Training - Loss: 56.9760
Training Metrics: {'accuracy': 0.9995691636029411, 'precision': 0.9991355002428968, 'recall': 0.9990478495952624, 'f1': 0.999091669333053}
Validation Metrics: {'accuracy': 0.9960977849190864, 'precision': 0.9940690695693475, 'recall': 0.9890371436824352, 'f1': 0.9915346754771286}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0941
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0926
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0908
Epoch 4/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0901
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0875
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0860
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0851
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9988, F1: 0.9989
Accuracy: 0.9961, Precision: 0.9923, Recall: 0.9909, F1: 0.9916
Epoch 4/30
Training - Loss: 55.2352
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9989980668557856, 'recall': 0.9988229407860438, 'f1': 0.9989104815062977}
Validation Metrics: {'accuracy': 0.9960977849190864, 'precision': 0.9922821067643324, 'recall': 0.9908518528627087, 'f1': 0.9915654877486291}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0840
Epoch 5/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0879
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0809
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0795
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0785
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0773
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0766
Accuracy: 0.9995, Precision: 0.9988, Recall: 0.9993, F1: 0.9990
Accuracy: 0.9962, Precision: 0.9920, Recall: 0.9916, F1: 0.9918
Epoch 5/30
Training - Loss: 53.9243
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9987760444388062, 'recall': 0.9992975636766335, 'f1': 0.9990366056042554}
Validation Metrics: {'accuracy': 0.996212555950878, 'precision': 0.9920011708157336, 'recall': 0.9916439792481195, 'f1': 0.9918224819702492}
Epoch 6/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0768
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0740
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0729
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0721
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0711
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0720
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0689
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9995, F1: 0.9994
Accuracy: 0.9963, Precision: 0.9935, Recall: 0.9906, F1: 0.9921
Epoch 6/30
Training - Loss: 52.9120
Training Metrics: {'accuracy': 0.9997127757352942, 'precision': 0.9993045045814447, 'recall': 0.9994806966571605, 'f1': 0.9993925781041867}
Validation Metrics: {'accuracy': 0.9963273269826696, 'precision': 0.9934907230277826, 'recall': 0.9906213964532571, 'f1': 0.9920500664243274}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0681
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0673
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0663
Epoch 7/30, Step 60/1,Classification Loss: 0.3286, Contrastive Loss: 0.0698
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0646
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0637
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0634
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9994, F1: 0.9993
Accuracy: 0.9963, Precision: 0.9935, Recall: 0.9906, F1: 0.9921
Epoch 7/30
Training - Loss: 51.9664
Training Metrics: {'accuracy': 0.9996840533088235, 'precision': 0.9992879924855259, 'recall': 0.9993760440839071, 'f1': 0.9993320126599523}
Validation Metrics: {'accuracy': 0.9963273269826696, 'precision': 0.9934907230277826, 'recall': 0.9906213964532571, 'f1': 0.9920500664243274}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0622
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0615
Epoch 8/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0757
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0599
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0591
Epoch 8/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0730
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0576
Accuracy: 0.9997, Precision: 0.9991, Recall: 0.9994, F1: 0.9993
Accuracy: 0.9963, Precision: 0.9938, Recall: 0.9903, F1: 0.9920
Epoch 8/30
Training - Loss: 51.1268
Training Metrics: {'accuracy': 0.9996553308823529, 'precision': 0.9991000355366026, 'recall': 0.9994497413178538, 'f1': 0.9992747994388027}
Validation Metrics: {'accuracy': 0.9963273269826696, 'precision': 0.9938488388210538, 'recall': 0.9902584546172024, 'f1': 0.9920442664937887}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0573
Epoch 9/30, Step 20/1,Classification Loss: 0.3178, Contrastive Loss: 0.0594
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0560
Epoch 9/30, Step 60/1,Classification Loss: 0.3139, Contrastive Loss: 0.0572
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0543
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0536
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0531
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9992, F1: 0.9993
Accuracy: 0.9961, Precision: 0.9933, Recall: 0.9898, F1: 0.9915
Epoch 9/30
Training - Loss: 50.4094
Training Metrics: {'accuracy': 0.9996553308823529, 'precision': 0.9993599323507437, 'recall': 0.9991840974467474, 'f1': 0.9992719924522747}
Validation Metrics: {'accuracy': 0.9960977849190864, 'precision': 0.993349783320675, 'recall': 0.9897630273545446, 'f1': 0.9915470331496505}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0518
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0518
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0506
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0501
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0495
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0488
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9961, Precision: 0.9933, Recall: 0.9898, F1: 0.9915
Epoch 10/30
Training - Loss: 49.9538
Training Metrics: {'accuracy': 0.9995691636029411, 'precision': 0.9992216791800179, 'recall': 0.9989579221005159, 'f1': 0.9990897501204599}
Validation Metrics: {'accuracy': 0.9960977849190864, 'precision': 0.993349783320675, 'recall': 0.9897630273545446, 'f1': 0.9915470331496505}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0483
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0472
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0466
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0463
Epoch 11/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0469
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0452
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9988, F1: 0.9989
Accuracy: 0.9956, Precision: 0.9924, Recall: 0.9888, F1: 0.9906
Epoch 11/30
Training - Loss: 49.2766
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.999002434597422, 'recall': 0.9988284606866003, 'f1': 0.998915425560581}
Validation Metrics: {'accuracy': 0.9956387007919201, 'precision': 0.9923516723199179, 'recall': 0.9887721728292291, 'f1': 0.9905525664613741}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0449
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0443
Epoch 12/30, Step 40/1,Classification Loss: 0.3223, Contrastive Loss: 0.0446
Epoch 12/30, Step 60/1,Classification Loss: 0.3210, Contrastive Loss: 0.0438
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0434
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0416
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9962, Precision: 0.9938, Recall: 0.9898, F1: 0.9918
Epoch 12/30
Training - Loss: 48.8438
Training Metrics: {'accuracy': 0.9995691636029411, 'precision': 0.9993100005908155, 'recall': 0.998870741442208, 'f1': 0.9990902308547045}
Validation Metrics: {'accuracy': 0.996212555950878, 'precision': 0.9937787498598547, 'recall': 0.9898292700678462, 'f1': 0.9917926552558117}
Epoch 13/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0416
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0407
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0405
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0393
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0392
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0384
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9960, Precision: 0.9936, Recall: 0.9890, F1: 0.9913
Epoch 13/30
Training - Loss: 48.5167
Training Metrics: {'accuracy': 0.9996266084558824, 'precision': 0.9992571295552206, 'recall': 0.9991695468414878, 'f1': 0.9992133326202353}
Validation Metrics: {'accuracy': 0.9959830138872948, 'precision': 0.9936386027899013, 'recall': 0.9889709009691336, 'f1': 0.9912888798597264}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0388
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0376
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0368
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0386
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0356
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9960, Precision: 0.9929, Recall: 0.9897, F1: 0.9913
Epoch 14/30
Training - Loss: 47.9383
Training Metrics: {'accuracy': 0.9995978860294118, 'precision': 0.9992374298535871, 'recall': 0.9990612335699123, 'f1': 0.9991493091875536}
Validation Metrics: {'accuracy': 0.9959830138872948, 'precision': 0.9929215585540664, 'recall': 0.9896967846412431, 'f1': 0.9913015897193008}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0348
Epoch 15/30, Step 40/1,Classification Loss: 0.3143, Contrastive Loss: 0.0393
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0341
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0343
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Epoch 15/30, Step 120/1,Classification Loss: 0.3276, Contrastive Loss: 0.0448
Accuracy: 0.9997, Precision: 0.9993, Recall: 0.9994, F1: 0.9993
Accuracy: 0.9961, Precision: 0.9937, Recall: 0.9894, F1: 0.9915
Epoch 15/30
Training - Loss: 47.6439
Training Metrics: {'accuracy': 0.9996840533088235, 'precision': 0.9992939961045141, 'recall': 0.9993810014413116, 'f1': 0.9993374932541819}
Validation Metrics: {'accuracy': 0.9960977849190864, 'precision': 0.9937086711913251, 'recall': 0.9894000855184899, 'f1': 0.9915408597928108}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0326
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0314
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Accuracy: 0.9997, Precision: 0.9991, Recall: 0.9994, F1: 0.9993
Accuracy: 0.9961, Precision: 0.9941, Recall: 0.9890, F1: 0.9915
Epoch 16/30
Training - Loss: 47.4278
Training Metrics: {'accuracy': 0.9996553308823529, 'precision': 0.9990920741084048, 'recall': 0.9994459067245043, 'f1': 0.9992688997478779}
Validation Metrics: {'accuracy': 0.9960977849190864, 'precision': 0.9940690695693475, 'recall': 0.9890371436824352, 'f1': 0.9915346754771286}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0304
Epoch 17/30, Step 20/1,Classification Loss: 0.3143, Contrastive Loss: 0.0333
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 17/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0296
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0290
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Accuracy: 0.9996, Precision: 0.9989, Recall: 0.9994, F1: 0.9992
Accuracy: 0.9960, Precision: 0.9929, Recall: 0.9897, F1: 0.9913
Epoch 17/30
Training - Loss: 47.0930
Training Metrics: {'accuracy': 0.9995978860294118, 'precision': 0.9988923461780622, 'recall': 0.9994165115758838, 'f1': 0.9991542288557214}
Validation Metrics: {'accuracy': 0.9959830138872948, 'precision': 0.9929215585540664, 'recall': 0.9896967846412431, 'f1': 0.9913015897193008}
Epoch 18/30, Step 0/1,Classification Loss: 0.3305, Contrastive Loss: 0.0433
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9960, Precision: 0.9915, Recall: 0.9911, F1: 0.9913
Epoch 18/30
Training - Loss: 46.8380
Training Metrics: {'accuracy': 0.9995978860294118, 'precision': 0.9990641575631339, 'recall': 0.9992395917630199, 'f1': 0.9991518522940079}
Validation Metrics: {'accuracy': 0.9959830138872948, 'precision': 0.9915053836128588, 'recall': 0.9911485519854619, 'f1': 0.991326874816931}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 19/30, Step 20/1,Classification Loss: 0.3141, Contrastive Loss: 0.0272
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0270
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Epoch 19/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0263
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9993, F1: 0.9992
Accuracy: 0.9960, Precision: 0.9929, Recall: 0.9897, F1: 0.9913
Epoch 19/30
Training - Loss: 46.4358
Training Metrics: {'accuracy': 0.9996266084558824, 'precision': 0.9991696959627623, 'recall': 0.9992572563982112, 'f1': 0.9992134706046273}
Validation Metrics: {'accuracy': 0.9959830138872948, 'precision': 0.9929215585540664, 'recall': 0.9896967846412431, 'f1': 0.9913015897193008}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 20/30, Step 40/1,Classification Loss: 0.3281, Contrastive Loss: 0.0369
Epoch 20/30, Step 60/1,Classification Loss: 0.3443, Contrastive Loss: 0.0554
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 20/30, Step 100/1,Classification Loss: 0.3138, Contrastive Loss: 0.0258
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9962, Precision: 0.9938, Recall: 0.9898, F1: 0.9918
Epoch 20/30
Training - Loss: 46.5030
Training Metrics: {'accuracy': 0.9996266084558824, 'precision': 0.9993420225290419, 'recall': 0.9990775271037291, 'f1': 0.9992097240800746}
Validation Metrics: {'accuracy': 0.996212555950878, 'precision': 0.9937787498598547, 'recall': 0.9898292700678462, 'f1': 0.9917926552558117}
Epoch 21/30, Step 0/1,Classification Loss: 0.3229, Contrastive Loss: 0.0249
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 21/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0228
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9992, F1: 0.9993
Accuracy: 0.9955, Precision: 0.9923, Recall: 0.9883, F1: 0.9903
Epoch 21/30
Training - Loss: 46.2143
Training Metrics: {'accuracy': 0.9996553308823529, 'precision': 0.9993616187442769, 'recall': 0.9991864989188795, 'f1': 0.999274036530375}
Validation Metrics: {'accuracy': 0.9955239297601285, 'precision': 0.9922804842231293, 'recall': 0.9883429882798729, 'f1': 0.9903004107568684}
Epoch 22/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0364
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 22/30, Step 120/1,Classification Loss: 0.3278, Contrastive Loss: 0.0331
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9961, Precision: 0.9926, Recall: 0.9905, F1: 0.9916
Epoch 22/30
Training - Loss: 46.0987
Training Metrics: {'accuracy': 0.9995691636029411, 'precision': 0.9993111429592834, 'recall': 0.9988731125926336, 'f1': 0.9990919882384449}
Validation Metrics: {'accuracy': 0.9960977849190864, 'precision': 0.9926365086533702, 'recall': 0.990488911026654, 'f1': 0.9915593470995053}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 23/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0220
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9993, F1: 0.9993
Accuracy: 0.9956, Precision: 0.9924, Recall: 0.9888, F1: 0.9906
Epoch 23/30
Training - Loss: 45.7847
Training Metrics: {'accuracy': 0.9996840533088235, 'precision': 0.9993787988991493, 'recall': 0.9992913285417464, 'f1': 0.999335058154727}
Validation Metrics: {'accuracy': 0.9956387007919201, 'precision': 0.9923516723199179, 'recall': 0.9887721728292291, 'f1': 0.9905525664613741}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0213
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0331
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9963, Precision: 0.9946, Recall: 0.9895, F1: 0.9920
Epoch 24/30
Training - Loss: 45.6705
Training Metrics: {'accuracy': 0.9995691636029411, 'precision': 0.9991305690548621, 'recall': 0.9990421772286231, 'f1': 0.9990863674801826}
Validation Metrics: {'accuracy': 0.9963273269826696, 'precision': 0.9945695945087365, 'recall': 0.9895325709450931, 'f1': 0.9920326357431799}
Epoch 25/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0201
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9956, Precision: 0.9938, Recall: 0.9873, F1: 0.9905
Epoch 25/30
Training - Loss: 45.7621
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9992932530959937, 'recall': 0.9987661389317477, 'f1': 0.9990294941605569}
Validation Metrics: {'accuracy': 0.9956387007919201, 'precision': 0.9937904187987328, 'recall': 0.9873204054850104, 'f1': 0.9905248943095908}
Epoch 26/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0435
Epoch 26/30, Step 20/1,Classification Loss: 0.3228, Contrastive Loss: 0.0264
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 26/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0349
Epoch 26/30, Step 120/1,Classification Loss: 0.3293, Contrastive Loss: 0.0650
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9993, F1: 0.9993
Accuracy: 0.9962, Precision: 0.9931, Recall: 0.9906, F1: 0.9918
Epoch 26/30
Training - Loss: 45.5638
Training Metrics: {'accuracy': 0.9996840533088235, 'precision': 0.9993751901763721, 'recall': 0.9992869584959356, 'f1': 0.9993310686930268}
Validation Metrics: {'accuracy': 0.996212555950878, 'precision': 0.9930632471832925, 'recall': 0.9905551537399555, 'f1': 0.9918046176193667}
Epoch 27/30, Step 0/1,Classification Loss: 0.3174, Contrastive Loss: 0.0188
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0195
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9992, F1: 0.9993
Accuracy: 0.9964, Precision: 0.9939, Recall: 0.9907, F1: 0.9923
Epoch 27/30
Training - Loss: 45.4950
Training Metrics: {'accuracy': 0.9996553308823529, 'precision': 0.9993586598031908, 'recall': 0.9991822855325729, 'f1': 0.9992704501114944}
Validation Metrics: {'accuracy': 0.9964420980144612, 'precision': 0.9939189381004252, 'recall': 0.9906876391665587, 'f1': 0.9922956937513807}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9960, Precision: 0.9936, Recall: 0.9890, F1: 0.9913
Epoch 28/30
Training - Loss: 45.3966
Training Metrics: {'accuracy': 0.9995691636029411, 'precision': 0.9992206638012335, 'recall': 0.9989563677981002, 'f1': 0.9990884651151154}
Validation Metrics: {'accuracy': 0.9959830138872948, 'precision': 0.9936386027899013, 'recall': 0.9889709009691336, 'f1': 0.9912888798597264}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9962, Precision: 0.9945, Recall: 0.9891, F1: 0.9918
Epoch 29/30
Training - Loss: 45.3595
Training Metrics: {'accuracy': 0.9996266084558824, 'precision': 0.9992591524839203, 'recall': 0.9991719251439047, 'f1': 0.9992155332717753}
Validation Metrics: {'accuracy': 0.996212555950878, 'precision': 0.9945002845661659, 'recall': 0.9891033863957368, 'f1': 0.9917806504008566}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0307
Epoch 30/30, Step 100/1,Classification Loss: 0.3283, Contrastive Loss: 0.0283
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Accuracy: 0.9996, Precision: 0.9991, Recall: 0.9992, F1: 0.9991
Accuracy: 0.9956, Precision: 0.9920, Recall: 0.9891, F1: 0.9906
Epoch 30/30
Training - Loss: 45.2846
Training Metrics: {'accuracy': 0.9995978860294118, 'precision': 0.9990617511167748, 'recall': 0.9992378125322261, 'f1': 0.9991497593278007}
Validation Metrics: {'accuracy': 0.9956387007919201, 'precision': 0.9919957489408956, 'recall': 0.9891351146652838, 'f1': 0.9905594538788888}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5686, 5814), y shape: (5686,), y distribution: Counter({np.float64(0.0): 4643, np.float64(1.0): 1043}), env shape: (5686,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9705, Precision: 0.9784, Recall: 0.9228, F1: 0.9477
month: 2018-03, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5215, 5814), y shape: (5215,), y distribution: Counter({np.float64(0.0): 4615, np.float64(1.0): 600}), env shape: (5215,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9779, Precision: 0.9701, Recall: 0.9194, F1: 0.9428
month: 2018-04, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5277, 5814), y shape: (5277,), y distribution: Counter({np.float64(0.0): 4677, np.float64(1.0): 600}), env shape: (5277,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9854, Precision: 0.9799, Recall: 0.9467, F1: 0.9625
month: 2018-05, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5200, 5814), y shape: (5200,), y distribution: Counter({np.float64(0.0): 4600, np.float64(1.0): 600}), env shape: (5200,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9835, Precision: 0.9626, Recall: 0.9559, F1: 0.9592
month: 2018-06, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (4979, 5814), y shape: (4979,), y distribution: Counter({np.float64(0.0): 4379, np.float64(1.0): 600}), env shape: (4979,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9815, Precision: 0.9620, Recall: 0.9499, F1: 0.9558
month: 2018-07, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5026, 5814), y shape: (5026,), y distribution: Counter({np.float64(0.0): 4426, np.float64(1.0): 600}), env shape: (5026,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9831, Precision: 0.9807, Recall: 0.9378, F1: 0.9579
month: 2018-08, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (4912, 5814), y shape: (4912,), y distribution: Counter({np.float64(0.0): 4312, np.float64(1.0): 600}), env shape: (4912,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9847, Precision: 0.9732, Recall: 0.9547, F1: 0.9637
month: 2018-09, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (5299, 5814), y shape: (5299,), y distribution: Counter({np.float64(0.0): 4235, np.float64(1.0): 1064}), env shape: (5299,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9645, Precision: 0.9729, Recall: 0.9162, F1: 0.9413
month: 2018-10, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (4875, 5814), y shape: (4875,), y distribution: Counter({np.float64(0.0): 3899, np.float64(1.0): 976}), env shape: (4875,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9764, Precision: 0.9786, Recall: 0.9472, F1: 0.9619
month: 2018-11, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1345, 5814), y shape: (1345,), y distribution: Counter({np.float64(0.0): 701, np.float64(1.0): 644}), env shape: (1345,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9636, Precision: 0.9668, Recall: 0.9621, F1: 0.9634
month: 2018-12, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1972, 5814), y shape: (1972,), y distribution: Counter({np.float64(0.0): 1777, np.float64(1.0): 195}), env shape: (1972,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.3555, Precision: 0.5580, Recall: 0.6264, F1: 0.3375
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9515]))
original train data shape: torch.Size([43662]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1972, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43662]), new train data shape: torch.Size([43662])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9515]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.6306
Epoch 1/30, Step 20/1,Classification Loss: 0.3284, Contrastive Loss: 1.0006
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4181
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2287
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1754
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1512
Epoch 1/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.1389
Accuracy: 0.9993, Precision: 0.9989, Recall: 0.9982, F1: 0.9985
Accuracy: 0.9968, Precision: 0.9934, Recall: 0.9927, F1: 0.9931
Epoch 1/30
Training - Loss: 103.6889
Training Metrics: {'accuracy': 0.9993106617647058, 'precision': 0.9988966666298146, 'recall': 0.9981956026172124, 'f1': 0.9985457769399511}
Validation Metrics: {'accuracy': 0.996793770754609, 'precision': 0.9934202530466576, 'recall': 0.9927033522670562, 'f1': 0.9930614293516827}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1293
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1223
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1171
Epoch 2/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1279
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1096
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1067
Epoch 2/30, Step 120/1,Classification Loss: 0.3223, Contrastive Loss: 0.1121
Accuracy: 0.9994, Precision: 0.9989, Recall: 0.9984, F1: 0.9987
Accuracy: 0.9967, Precision: 0.9937, Recall: 0.9919, F1: 0.9928
Epoch 2/30
Training - Loss: 59.0710
Training Metrics: {'accuracy': 0.9993681066176471, 'precision': 0.9989296239917762, 'recall': 0.99840329655081, 'f1': 0.9986662587879204}
Validation Metrics: {'accuracy': 0.9966792625672736, 'precision': 0.993705177650182, 'recall': 0.9919110508216207, 'f1': 0.9928057762409693}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1025
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1001
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0998
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0996
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0941
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0923
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0948
Accuracy: 0.9994, Precision: 0.9990, Recall: 0.9983, F1: 0.9987
Accuracy: 0.9966, Precision: 0.9933, Recall: 0.9918, F1: 0.9926
Epoch 3/30
Training - Loss: 56.9479
Training Metrics: {'accuracy': 0.9993681066176471, 'precision': 0.9990122351084707, 'recall': 0.9983039847113182, 'f1': 0.9986577464226385}
Validation Metrics: {'accuracy': 0.9965647543799382, 'precision': 0.9932788213341415, 'recall': 0.9918449831683438, 'f1': 0.9925604078187986}
Epoch 4/30, Step 0/1,Classification Loss: 0.3284, Contrastive Loss: 0.1034
Epoch 4/30, Step 20/1,Classification Loss: 0.3263, Contrastive Loss: 0.1002
Epoch 4/30, Step 40/1,Classification Loss: 0.3160, Contrastive Loss: 0.0874
Epoch 4/30, Step 60/1,Classification Loss: 0.3339, Contrastive Loss: 0.1102
Epoch 4/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0841
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0821
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0813
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9963, Precision: 0.9928, Recall: 0.9913, F1: 0.9921
Epoch 4/30
Training - Loss: 55.0191
Training Metrics: {'accuracy': 0.9994542738970589, 'precision': 0.9991564738971852, 'recall': 0.9985433727650947, 'f1': 0.9988496498387454}
Validation Metrics: {'accuracy': 0.9963357380052674, 'precision': 0.9927821253605353, 'recall': 0.9913497309657107, 'f1': 0.9920644350067186}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0808
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0786
Epoch 5/30, Step 40/1,Classification Loss: 0.3293, Contrastive Loss: 0.0924
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0767
Epoch 5/30, Step 80/1,Classification Loss: 0.3221, Contrastive Loss: 0.0772
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0740
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0729
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9963, Precision: 0.9917, Recall: 0.9924, F1: 0.9921
Epoch 5/30
Training - Loss: 53.9119
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9990995391713303, 'recall': 0.9988355097480238, 'f1': 0.9989674738474127}
Validation Metrics: {'accuracy': 0.9963357380052674, 'precision': 0.9917250899878838, 'recall': 0.9924390816539483, 'f1': 0.992081714386359}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0722
Epoch 6/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.0854
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0701
Epoch 6/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0865
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0689
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0673
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0665
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9965, Precision: 0.9925, Recall: 0.9921, F1: 0.9923
Epoch 6/30
Training - Loss: 52.8203
Training Metrics: {'accuracy': 0.9995691636029411, 'precision': 0.9993065397213514, 'recall': 0.998863561074468, 'f1': 0.9990849083369955}
Validation Metrics: {'accuracy': 0.9964502461926028, 'precision': 0.9924997582379566, 'recall': 0.9921420324111461, 'f1': 0.9923208021949691}
Epoch 7/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0819
Epoch 7/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0651
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0655
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0634
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0627
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0617
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0606
Accuracy: 0.9995, Precision: 0.9989, Recall: 0.9989, F1: 0.9989
Accuracy: 0.9962, Precision: 0.9924, Recall: 0.9913, F1: 0.9918
Epoch 7/30
Training - Loss: 51.8684
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9989043200673879, 'recall': 0.9989043200673879, 'f1': 0.9989043200673879}
Validation Metrics: {'accuracy': 0.9962212298179319, 'precision': 0.9923568644826679, 'recall': 0.9912836633124337, 'f1': 0.9918194250539472}
Epoch 8/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0631
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0592
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0585
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0577
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0570
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0562
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0557
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9963, Precision: 0.9931, Recall: 0.9910, F1: 0.9921
Epoch 8/30
Training - Loss: 51.2604
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9991125851077145, 'recall': 0.9989354380444786, 'f1': 0.9990239888533561}
Validation Metrics: {'accuracy': 0.9963357380052674, 'precision': 0.9931374260019006, 'recall': 0.9909866140696313, 'f1': 0.992058654831792}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0550
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0563
Epoch 9/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0540
Epoch 9/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0669
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0523
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0519
Epoch 9/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0511
Accuracy: 0.9994, Precision: 0.9991, Recall: 0.9982, F1: 0.9987
Accuracy: 0.9965, Precision: 0.9925, Recall: 0.9921, F1: 0.9923
Epoch 9/30
Training - Loss: 50.5707
Training Metrics: {'accuracy': 0.9993681066176471, 'precision': 0.9991009710793433, 'recall': 0.998215657664052, 'f1': 0.9986577464226385}
Validation Metrics: {'accuracy': 0.9964502461926028, 'precision': 0.9924997582379566, 'recall': 0.9921420324111461, 'f1': 0.9923208021949691}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0505
Epoch 10/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0502
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0495
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0487
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0482
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0475
Epoch 10/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0821
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9963, Precision: 0.9931, Recall: 0.9910, F1: 0.9921
Epoch 10/30
Training - Loss: 50.0917
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9991030825867964, 'recall': 0.998840662075303, 'f1': 0.9989718222094529}
Validation Metrics: {'accuracy': 0.9963357380052674, 'precision': 0.9931374260019006, 'recall': 0.9909866140696313, 'f1': 0.992058654831792}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0459
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0454
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0448
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0443
Epoch 11/30, Step 100/1,Classification Loss: 0.3146, Contrastive Loss: 0.0442
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0432
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9986, F1: 0.9989
Accuracy: 0.9962, Precision: 0.9927, Recall: 0.9909, F1: 0.9918
Epoch 11/30
Training - Loss: 49.3890
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9992575967533754, 'recall': 0.9985509915415106, 'f1': 0.9989039321413442}
Validation Metrics: {'accuracy': 0.9962212298179319, 'precision': 0.9927110606191689, 'recall': 0.9909205464163544, 'f1': 0.9918134695155858}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0429
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0418
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0415
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0408
Epoch 12/30, Step 100/1,Classification Loss: 0.3161, Contrastive Loss: 0.0410
Epoch 12/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0463
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9979, F1: 0.9985
Accuracy: 0.9958, Precision: 0.9931, Recall: 0.9885, F1: 0.9908
Epoch 12/30
Training - Loss: 48.8785
Training Metrics: {'accuracy': 0.9992819393382353, 'precision': 0.9990533053196627, 'recall': 0.9979085388428169, 'f1': 0.9984799701533478}
Validation Metrics: {'accuracy': 0.9957631970685904, 'precision': 0.9931428076770874, 'recall': 0.988477574426771, 'f1': 0.9907943346131064}
Epoch 13/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0558
Epoch 13/30, Step 20/1,Classification Loss: 0.3150, Contrastive Loss: 0.0472
Epoch 13/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0388
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0382
Epoch 13/30, Step 80/1,Classification Loss: 0.3137, Contrastive Loss: 0.0380
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0372
Epoch 13/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0535
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9962, Precision: 0.9931, Recall: 0.9906, F1: 0.9918
Epoch 13/30
Training - Loss: 48.5079
Training Metrics: {'accuracy': 0.9995691636029411, 'precision': 0.9992228172354058, 'recall': 0.9989596643551923, 'f1': 0.9990911904598386}
Validation Metrics: {'accuracy': 0.9962212298179319, 'precision': 0.9930667419073513, 'recall': 0.990557429520275, 'f1': 0.9918075034363889}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 14/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0374
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0351
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0365
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0343
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9961, Precision: 0.9926, Recall: 0.9905, F1: 0.9916
Epoch 14/30
Training - Loss: 47.9379
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9992868462595559, 'recall': 0.9987514340772141, 'f1': 0.9990189332138559}
Validation Metrics: {'accuracy': 0.9961067216305965, 'precision': 0.9926400043015329, 'recall': 0.9904913618669982, 'f1': 0.9915623207587789}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0336
Epoch 15/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0336
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Epoch 15/30, Step 60/1,Classification Loss: 0.3298, Contrastive Loss: 0.0624
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0322
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0318
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Accuracy: 0.9994, Precision: 0.9990, Recall: 0.9986, F1: 0.9988
Accuracy: 0.9958, Precision: 0.9928, Recall: 0.9888, F1: 0.9908
Epoch 15/30
Training - Loss: 47.5876
Training Metrics: {'accuracy': 0.9994255514705882, 'precision': 0.9989574795919415, 'recall': 0.998603539902178, 'f1': 0.9987804189679796}
Validation Metrics: {'accuracy': 0.9957631970685904, 'precision': 0.9927840953396037, 'recall': 0.9888406913228502, 'f1': 0.9908010594919252}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0337
Epoch 16/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0452
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Epoch 16/30, Step 80/1,Classification Loss: 0.3268, Contrastive Loss: 0.0342
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0296
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0292
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9986, F1: 0.9989
Accuracy: 0.9966, Precision: 0.9940, Recall: 0.9911, F1: 0.9925
Epoch 16/30
Training - Loss: 47.5606
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9991702462729273, 'recall': 0.9986415098259585, 'f1': 0.9989056751672416}
Validation Metrics: {'accuracy': 0.9965647543799382, 'precision': 0.9939923668337168, 'recall': 0.9911187493761853, 'f1': 0.9925495603959098}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0282
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0280
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9959, Precision: 0.9914, Recall: 0.9907, F1: 0.9911
Epoch 17/30
Training - Loss: 46.9493
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9991115297024851, 'recall': 0.9989340645918845, 'f1': 0.9990227743592002}
Validation Metrics: {'accuracy': 0.9958777052559258, 'precision': 0.9914363617983373, 'recall': 0.9907223434565235, 'f1': 0.9910789805950206}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Epoch 18/30, Step 20/1,Classification Loss: 0.3247, Contrastive Loss: 0.0270
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0263
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 18/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0379
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9985, F1: 0.9989
Accuracy: 0.9959, Precision: 0.9925, Recall: 0.9896, F1: 0.9911
Epoch 18/30
Training - Loss: 46.8352
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9993445823039189, 'recall': 0.9984570178294684, 'f1': 0.9989002300172514}
Validation Metrics: {'accuracy': 0.9958777052559258, 'precision': 0.9924979168168779, 'recall': 0.9896329927682856, 'f1': 0.9910594724750919}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0260
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 19/30, Step 100/1,Classification Loss: 0.3177, Contrastive Loss: 0.0248
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9960, Precision: 0.9922, Recall: 0.9904, F1: 0.9913
Epoch 19/30
Training - Loss: 46.6299
Training Metrics: {'accuracy': 0.9995978860294118, 'precision': 0.9992339630665761, 'recall': 0.9990565455166134, 'f1': 0.9991452315175676}
Validation Metrics: {'accuracy': 0.9959922134432612, 'precision': 0.9922140021036623, 'recall': 0.9904252942137213, 'f1': 0.991317316152894}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 20/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0243
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 20/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0719
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 20/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0235
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9961, Precision: 0.9926, Recall: 0.9905, F1: 0.9916
Epoch 20/30
Training - Loss: 46.5219
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9992025022926991, 'recall': 0.9988491136655545, 'f1': 0.9990257174589725}
Validation Metrics: {'accuracy': 0.9961067216305965, 'precision': 0.9926400043015329, 'recall': 0.9904913618669982, 'f1': 0.9915623207587789}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 21/30, Step 40/1,Classification Loss: 0.3212, Contrastive Loss: 0.0241
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9960, Precision: 0.9922, Recall: 0.9904, F1: 0.9913
Epoch 21/30
Training - Loss: 46.2139
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9991833250353999, 'recall': 0.9987394319724394, 'f1': 0.99896123594768}
Validation Metrics: {'accuracy': 0.9959922134432612, 'precision': 0.9922140021036623, 'recall': 0.9904252942137213, 'f1': 0.991317316152894}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 22/30, Step 60/1,Classification Loss: 0.3171, Contrastive Loss: 0.0218
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9960, Precision: 0.9929, Recall: 0.9897, F1: 0.9913
Epoch 22/30
Training - Loss: 45.9401
Training Metrics: {'accuracy': 0.9996266084558824, 'precision': 0.9993410687048198, 'recall': 0.9990759641417986, 'f1': 0.9992084655003676}
Validation Metrics: {'accuracy': 0.9959922134432612, 'precision': 0.9929254007187112, 'recall': 0.9896990604215626, 'f1': 0.9913046496249311}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 23/30, Step 60/1,Classification Loss: 0.3147, Contrastive Loss: 0.0262
Epoch 23/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0337
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9961, Precision: 0.9941, Recall: 0.9890, F1: 0.9915
Epoch 23/30
Training - Loss: 46.0569
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9991882679362807, 'recall': 0.9987487796114162, 'f1': 0.9989683834698545}
Validation Metrics: {'accuracy': 0.9961067216305965, 'precision': 0.9940732554880426, 'recall': 0.9890388942826811, 'f1': 0.9915376459925785}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 24/30, Step 20/1,Classification Loss: 0.3246, Contrastive Loss: 0.0267
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 24/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0265
Epoch 24/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0330
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9958, Precision: 0.9928, Recall: 0.9888, F1: 0.9908
Epoch 24/30
Training - Loss: 45.9687
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9992931494747883, 'recall': 0.9987659009353346, 'f1': 0.9990293232696996}
Validation Metrics: {'accuracy': 0.9957631970685904, 'precision': 0.9927840953396037, 'recall': 0.9888406913228502, 'f1': 0.9908010594919252}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 25/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0323
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9965, Precision: 0.9939, Recall: 0.9907, F1: 0.9923
Epoch 25/30
Training - Loss: 45.9719
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.999292630672356, 'recall': 0.9987647094375094, 'f1': 0.9990284677085538}
Validation Metrics: {'accuracy': 0.9964502461926028, 'precision': 0.9939224309773751, 'recall': 0.990689564826829, 'f1': 0.9922984039535104}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 26/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0189
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 26/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0184
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9962, Precision: 0.9934, Recall: 0.9902, F1: 0.9918
Epoch 26/30
Training - Loss: 45.4419
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9992033917639453, 'recall': 0.9988506348302182, 'f1': 0.9990269230351069}
Validation Metrics: {'accuracy': 0.9962212298179319, 'precision': 0.9934239158480431, 'recall': 0.9901943126241959, 'f1': 0.9918015267892208}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 27/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0323
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9959, Precision: 0.9918, Recall: 0.9904, F1: 0.9911
Epoch 27/30
Training - Loss: 45.5285
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9991834528503375, 'recall': 0.998739673608225, 'f1': 0.9989614207314901}
Validation Metrics: {'accuracy': 0.9958777052559258, 'precision': 0.9917887334133234, 'recall': 0.9903592265604442, 'f1': 0.9910724893825584}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9985, F1: 0.9989
Accuracy: 0.9959, Precision: 0.9925, Recall: 0.9896, F1: 0.9911
Epoch 28/30
Training - Loss: 45.6850
Training Metrics: {'accuracy': 0.9994542738970589, 'precision': 0.9991584488272921, 'recall': 0.9985478352749636, 'f1': 0.9988528703234969}
Validation Metrics: {'accuracy': 0.9958777052559258, 'precision': 0.9924979168168779, 'recall': 0.9896329927682856, 'f1': 0.9910594724750919}
Epoch 29/30, Step 0/1,Classification Loss: 0.3261, Contrastive Loss: 0.0265
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 29/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0305
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0166
Epoch 29/30, Step 120/1,Classification Loss: 0.3150, Contrastive Loss: 0.0265
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9986, F1: 0.9989
Accuracy: 0.9966, Precision: 0.9929, Recall: 0.9922, F1: 0.9926
Epoch 29/30
Training - Loss: 45.4693
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9991717507441094, 'recall': 0.998644630400493, 'f1': 0.998907988678412}
Validation Metrics: {'accuracy': 0.9965647543799382, 'precision': 0.9929242802345776, 'recall': 0.9922081000644231, 'f1': 0.9925658171625172}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 30/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0166
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9965, Precision: 0.9929, Recall: 0.9918, F1: 0.9923
Epoch 30/30
Training - Loss: 45.4442
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9991985299091225, 'recall': 0.9988423219549982, 'f1': 0.9990203342546589}
Validation Metrics: {'accuracy': 0.9964502461926028, 'precision': 0.9928531985556809, 'recall': 0.9917789155150668, 'f1': 0.9923152174749201}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1980, 5814), y shape: (1980,), y distribution: Counter({np.float64(0.0): 1781, np.float64(1.0): 199}), env shape: (1980,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.6500, Precision: 0.6069, Recall: 0.7921, F1: 0.5586
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9615]))
original train data shape: torch.Size([43762]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1980, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43762]), new train data shape: torch.Size([43762])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9615]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.5046
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.8665
Epoch 1/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.5995
Epoch 1/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.3229
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2214
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1849
Epoch 1/30, Step 120/1,Classification Loss: 0.3446, Contrastive Loss: 0.2196
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9977, F1: 0.9984
Accuracy: 0.9965, Precision: 0.9932, Recall: 0.9914, F1: 0.9923
Epoch 1/30
Training - Loss: 105.9773
Training Metrics: {'accuracy': 0.9992532169117647, 'precision': 0.9991220582855749, 'recall': 0.9977026161280734, 'f1': 0.9984108778913752}
Validation Metrics: {'accuracy': 0.9964583571346967, 'precision': 0.9932159197450692, 'recall': 0.9914245749873225, 'f1': 0.9923179155332811}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1561
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1466
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1397
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1341
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1295
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1254
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1230
Accuracy: 0.9993, Precision: 0.9989, Recall: 0.9981, F1: 0.9985
Accuracy: 0.9965, Precision: 0.9922, Recall: 0.9925, F1: 0.9923
Epoch 2/30
Training - Loss: 62.0256
Training Metrics: {'accuracy': 0.9992819393382353, 'precision': 0.9988746793827046, 'recall': 0.998079716653041, 'f1': 0.9984767395299867}
Validation Metrics: {'accuracy': 0.9964583571346967, 'precision': 0.9921561524397421, 'recall': 0.992513317783579, 'f1': 0.9923346423019052}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1193
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1164
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1135
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1110
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1084
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1062
Epoch 3/30, Step 120/1,Classification Loss: 0.3141, Contrastive Loss: 0.1043
Accuracy: 0.9993, Precision: 0.9989, Recall: 0.9979, F1: 0.9984
Accuracy: 0.9961, Precision: 0.9937, Recall: 0.9894, F1: 0.9916
Epoch 3/30
Training - Loss: 58.7151
Training Metrics: {'accuracy': 0.9992532169117647, 'precision': 0.9989425246469841, 'recall': 0.9978752101621582, 'f1': 0.9984080431638207}
Validation Metrics: {'accuracy': 0.9961156175025705, 'precision': 0.9937206117834988, 'recall': 0.9894122970568281, 'f1': 0.9915529616661445}
Epoch 4/30, Step 0/1,Classification Loss: 0.3206, Contrastive Loss: 0.1030
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1000
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0981
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0973
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0943
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0926
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0910
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9981, F1: 0.9986
Accuracy: 0.9962, Precision: 0.9934, Recall: 0.9902, F1: 0.9918
Epoch 4/30
Training - Loss: 56.5692
Training Metrics: {'accuracy': 0.9993393841911765, 'precision': 0.9990805956948496, 'recall': 0.9980994715216392, 'f1': 0.9985893380875104}
Validation Metrics: {'accuracy': 0.9962298640466126, 'precision': 0.9934318681123623, 'recall': 0.9902040277887991, 'f1': 0.9918103740478943}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0897
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0882
Epoch 5/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.2076
Epoch 5/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0930
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0837
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0825
Epoch 5/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0973
Accuracy: 0.9994, Precision: 0.9990, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9965, Precision: 0.9925, Recall: 0.9922, F1: 0.9923
Epoch 5/30
Training - Loss: 55.1039
Training Metrics: {'accuracy': 0.9994255514705882, 'precision': 0.9990497657674675, 'recall': 0.9985222360156651, 'f1': 0.9987857987106477}
Validation Metrics: {'accuracy': 0.9964583571346967, 'precision': 0.9925079355024083, 'recall': 0.9921504035181602, 'f1': 0.9923290765465396}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0802
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0788
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0776
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0765
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0754
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0743
Epoch 6/30, Step 120/1,Classification Loss: 0.3203, Contrastive Loss: 0.0800
Accuracy: 0.9994, Precision: 0.9991, Recall: 0.9982, F1: 0.9987
Accuracy: 0.9958, Precision: 0.9924, Recall: 0.9892, F1: 0.9908
Epoch 6/30
Training - Loss: 53.8527
Training Metrics: {'accuracy': 0.9993681066176471, 'precision': 0.999099971345192, 'recall': 0.9982128416566682, 'f1': 0.9986558366877516}
Validation Metrics: {'accuracy': 0.9957728778704444, 'precision': 0.9924359156413578, 'recall': 0.9892145904534275, 'f1': 0.9908176921143057}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0724
Epoch 7/30, Step 20/1,Classification Loss: 0.3444, Contrastive Loss: 0.0909
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0710
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0694
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0684
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0675
Epoch 7/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0749
Accuracy: 0.9994, Precision: 0.9991, Recall: 0.9982, F1: 0.9987
Accuracy: 0.9967, Precision: 0.9923, Recall: 0.9934, F1: 0.9928
Epoch 7/30
Training - Loss: 52.6842
Training Metrics: {'accuracy': 0.9993681066176471, 'precision': 0.9991010957894011, 'recall': 0.9982160089907467, 'f1': 0.9986579846733648}
Validation Metrics: {'accuracy': 0.9966868502227808, 'precision': 0.992299476544199, 'recall': 0.9933709507166836, 'f1': 0.9928343790142835}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0659
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0668
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0642
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0633
Epoch 8/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0651
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0621
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0609
Accuracy: 0.9994, Precision: 0.9990, Recall: 0.9986, F1: 0.9988
Accuracy: 0.9960, Precision: 0.9922, Recall: 0.9904, F1: 0.9913
Epoch 8/30
Training - Loss: 51.8027
Training Metrics: {'accuracy': 0.9994255514705882, 'precision': 0.9989574795919415, 'recall': 0.998603539902178, 'f1': 0.9987804189679796}
Validation Metrics: {'accuracy': 0.9960013709585285, 'precision': 0.9922228757048763, 'recall': 0.9904351376519509, 'f1': 0.991326678827898}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0603
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0595
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0587
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0583
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0580
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0566
Epoch 9/30, Step 120/1,Classification Loss: 0.3283, Contrastive Loss: 0.0585
Accuracy: 0.9993, Precision: 0.9992, Recall: 0.9980, F1: 0.9986
Accuracy: 0.9963, Precision: 0.9939, Recall: 0.9903, F1: 0.9921
Epoch 9/30
Training - Loss: 51.1139
Training Metrics: {'accuracy': 0.9993393841911765, 'precision': 0.9991728247143483, 'recall': 0.9980213201662864, 'f1': 0.9985961117223943}
Validation Metrics: {'accuracy': 0.9963441105906546, 'precision': 0.9938600900100341, 'recall': 0.9902699299899327, 'f1': 0.9920556476784574}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0553
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0546
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0540
Epoch 10/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0695
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0526
Epoch 10/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0619
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0519
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9986, F1: 0.9990
Accuracy: 0.9965, Precision: 0.9936, Recall: 0.9911, F1: 0.9923
Epoch 10/30
Training - Loss: 50.5386
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9992708713254705, 'recall': 0.9986473433416776, 'f1': 0.9989588264273541}
Validation Metrics: {'accuracy': 0.9964583571346967, 'precision': 0.9935721357604194, 'recall': 0.9910616607219038, 'f1': 0.9923123202248425}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0509
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0503
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0496
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0497
Epoch 11/30, Step 80/1,Classification Loss: 0.3188, Contrastive Loss: 0.0493
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0483
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0474
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9961, Precision: 0.9930, Recall: 0.9901, F1: 0.9916
Epoch 11/30
Training - Loss: 49.9093
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9992772271600439, 'recall': 0.9986633525340238, 'f1': 0.9989700158544839}
Validation Metrics: {'accuracy': 0.9961156175025705, 'precision': 0.99300438544129, 'recall': 0.9901381255876656, 'f1': 0.9915652787486585}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0469
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0459
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0459
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0457
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0442
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0438
Accuracy: 0.9993, Precision: 0.9990, Recall: 0.9982, F1: 0.9986
Accuracy: 0.9970, Precision: 0.9939, Recall: 0.9932, F1: 0.9936
Epoch 12/30
Training - Loss: 49.7074
Training Metrics: {'accuracy': 0.9993393841911765, 'precision': 0.9989953165529297, 'recall': 0.9981983261404465, 'f1': 0.9985963610731637}
Validation Metrics: {'accuracy': 0.9970295898549069, 'precision': 0.9939229731583831, 'recall': 0.9932057430546654, 'f1': 0.9935639851493548}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0433
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0428
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0418
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0425
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0409
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0404
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9970, Precision: 0.9943, Recall: 0.9928, F1: 0.9936
Epoch 13/30
Training - Loss: 49.0722
Training Metrics: {'accuracy': 0.9994542738970589, 'precision': 0.9991470254287985, 'recall': 0.9985220455422834, 'f1': 0.9988342534789019}
Validation Metrics: {'accuracy': 0.9970295898549069, 'precision': 0.9942787692917443, 'recall': 0.9928428287892466, 'f1': 0.9935593047270896}
Epoch 14/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0879
Epoch 14/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1033
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0391
Epoch 14/30, Step 60/1,Classification Loss: 0.3329, Contrastive Loss: 0.0563
Epoch 14/30, Step 80/1,Classification Loss: 0.3145, Contrastive Loss: 0.0389
Epoch 14/30, Step 100/1,Classification Loss: 0.3217, Contrastive Loss: 0.0438
Epoch 14/30, Step 120/1,Classification Loss: 0.3222, Contrastive Loss: 0.0424
Accuracy: 0.9993, Precision: 0.9992, Recall: 0.9980, F1: 0.9986
Accuracy: 0.9965, Precision: 0.9939, Recall: 0.9907, F1: 0.9923
Epoch 14/30
Training - Loss: 48.5501
Training Metrics: {'accuracy': 0.9993393841911765, 'precision': 0.9991747457722138, 'recall': 0.9980288226942773, 'f1': 0.9986008309442851}
Validation Metrics: {'accuracy': 0.9964583571346967, 'precision': 0.9939298443478645, 'recall': 0.990698746456485, 'f1': 0.9923067150146885}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0370
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 15/30, Step 60/1,Classification Loss: 0.3157, Contrastive Loss: 0.0397
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0351
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9985, F1: 0.9989
Accuracy: 0.9963, Precision: 0.9924, Recall: 0.9917, F1: 0.9921
Epoch 15/30
Training - Loss: 48.2049
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9992516160738971, 'recall': 0.9985345916624159, 'f1': 0.9988927332822952}
Validation Metrics: {'accuracy': 0.9963441105906546, 'precision': 0.9924366588646345, 'recall': 0.9917215870516078, 'f1': 0.9920787509530522}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 16/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.0384
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0331
Epoch 16/30, Step 80/1,Classification Loss: 0.3270, Contrastive Loss: 0.0343
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9968, Precision: 0.9941, Recall: 0.9920, F1: 0.9931
Epoch 16/30
Training - Loss: 47.6592
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9990805249586516, 'recall': 0.9987271322227986, 'f1': 0.9989037380522827}
Validation Metrics: {'accuracy': 0.9968010967668228, 'precision': 0.9941391685626961, 'recall': 0.991985195856142, 'f1': 0.9930588172653296}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0318
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0311
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 17/30, Step 80/1,Classification Loss: 0.3587, Contrastive Loss: 0.0525
Epoch 17/30, Step 100/1,Classification Loss: 0.3277, Contrastive Loss: 0.0400
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0300
Accuracy: 0.9994, Precision: 0.9989, Recall: 0.9984, F1: 0.9987
Accuracy: 0.9965, Precision: 0.9939, Recall: 0.9907, F1: 0.9923
Epoch 17/30
Training - Loss: 47.5917
Training Metrics: {'accuracy': 0.9993681066176471, 'precision': 0.9989252431140654, 'recall': 0.9983954127130665, 'f1': 0.9986601242861234}
Validation Metrics: {'accuracy': 0.9964583571346967, 'precision': 0.9939298443478645, 'recall': 0.990698746456485, 'f1': 0.9923067150146885}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0296
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0290
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9985, F1: 0.9989
Accuracy: 0.9967, Precision: 0.9941, Recall: 0.9916, F1: 0.9928
Epoch 18/30
Training - Loss: 47.2306
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9992558293066689, 'recall': 0.9985461420664961, 'f1': 0.9989006211541003}
Validation Metrics: {'accuracy': 0.9966868502227808, 'precision': 0.9940693835990131, 'recall': 0.9915563793895896, 'f1': 0.9928082995651752}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0268
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9962, Precision: 0.9945, Recall: 0.9891, F1: 0.9918
Epoch 19/30
Training - Loss: 47.2462
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.999285885980322, 'recall': 0.9987492318366118, 'f1': 0.9990173511844012}
Validation Metrics: {'accuracy': 0.9962298640466126, 'precision': 0.9945118242467172, 'recall': 0.9891152849925428, 'f1': 0.9917924100230067}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Epoch 20/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0324
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9985, F1: 0.9989
Accuracy: 0.9966, Precision: 0.9936, Recall: 0.9915, F1: 0.9926
Epoch 20/30
Training - Loss: 46.8454
Training Metrics: {'accuracy': 0.9994542738970589, 'precision': 0.9992453524625677, 'recall': 0.9984592803178307, 'f1': 0.9988518662991377}
Validation Metrics: {'accuracy': 0.9965726036787387, 'precision': 0.9936422839548222, 'recall': 0.9914904771884561, 'f1': 0.9925630184985674}
Epoch 21/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0274
Epoch 21/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0381
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 21/30, Step 80/1,Classification Loss: 0.3137, Contrastive Loss: 0.0240
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0678
Accuracy: 0.9995, Precision: 0.9994, Recall: 0.9986, F1: 0.9990
Accuracy: 0.9966, Precision: 0.9944, Recall: 0.9908, F1: 0.9926
Epoch 21/30
Training - Loss: 46.4413
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9993638929577762, 'recall': 0.9985716018088997, 'f1': 0.9989672916871519}
Validation Metrics: {'accuracy': 0.9965726036787387, 'precision': 0.9943584314150595, 'recall': 0.9907646486576185, 'f1': 0.992552169698554}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 22/30, Step 60/1,Classification Loss: 0.3368, Contrastive Loss: 0.0392
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 22/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0437
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9970, Precision: 0.9954, Recall: 0.9918, F1: 0.9935
Epoch 22/30
Training - Loss: 46.4028
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9991866298048557, 'recall': 0.9987456810098991, 'f1': 0.998966014358804}
Validation Metrics: {'accuracy': 0.9970295898549069, 'precision': 0.9953551142251107, 'recall': 0.9917540859929901, 'f1': 0.9935452137387467}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 23/30, Step 20/1,Classification Loss: 0.3149, Contrastive Loss: 0.0263
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9968, Precision: 0.9941, Recall: 0.9920, F1: 0.9931
Epoch 23/30
Training - Loss: 46.1116
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.9992870591243486, 'recall': 0.9987519223088617, 'f1': 0.9990192839324844}
Validation Metrics: {'accuracy': 0.9968010967668228, 'precision': 0.9941391685626961, 'recall': 0.991985195856142, 'f1': 0.9930588172653296}
Epoch 24/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0349
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 24/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0220
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9966, Precision: 0.9929, Recall: 0.9922, F1: 0.9926
Epoch 24/30
Training - Loss: 46.0643
Training Metrics: {'accuracy': 0.9995404411764706, 'precision': 0.999202375000672, 'recall': 0.998848895984314, 'f1': 0.9990255449353624}
Validation Metrics: {'accuracy': 0.9965726036787387, 'precision': 0.9929320969625508, 'recall': 0.9922163057192936, 'f1': 0.9925738290184863}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9965, Precision: 0.9932, Recall: 0.9914, F1: 0.9923
Epoch 25/30
Training - Loss: 45.7914
Training Metrics: {'accuracy': 0.9995691636029411, 'precision': 0.9993085385607727, 'recall': 0.9988677075485466, 'f1': 0.9990879820920087}
Validation Metrics: {'accuracy': 0.9964583571346967, 'precision': 0.9932159197450692, 'recall': 0.9914245749873225, 'f1': 0.9923179155332811}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0190
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9963, Precision: 0.9946, Recall: 0.9895, F1: 0.9920
Epoch 26/30
Training - Loss: 45.7609
Training Metrics: {'accuracy': 0.9994542738970589, 'precision': 0.9991538603027437, 'recall': 0.998537469660427, 'f1': 0.9988453891458129}
Validation Metrics: {'accuracy': 0.9963441105906546, 'precision': 0.9945807911787923, 'recall': 0.9895441014590951, 'f1': 0.9920440345824992}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 60/1,Classification Loss: 0.3268, Contrastive Loss: 0.0191
Epoch 27/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0343
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9970, Precision: 0.9939, Recall: 0.9932, F1: 0.9936
Epoch 27/30
Training - Loss: 45.7684
Training Metrics: {'accuracy': 0.99951171875, 'precision': 0.9991023474327856, 'recall': 0.9988395930207739, 'f1': 0.9989709200035709}
Validation Metrics: {'accuracy': 0.9970295898549069, 'precision': 0.9939229731583831, 'recall': 0.9932057430546654, 'f1': 0.9935639851493548}
Epoch 28/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0348
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 28/30, Step 60/1,Classification Loss: 0.3139, Contrastive Loss: 0.0184
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9992, F1: 0.9992
Accuracy: 0.9968, Precision: 0.9941, Recall: 0.9920, F1: 0.9931
Epoch 28/30
Training - Loss: 45.7369
Training Metrics: {'accuracy': 0.9996266084558824, 'precision': 0.9992521395532439, 'recall': 0.9991636808926591, 'f1': 0.999207904555593}
Validation Metrics: {'accuracy': 0.9968010967668228, 'precision': 0.9941391685626961, 'recall': 0.991985195856142, 'f1': 0.9930588172653296}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 60/1,Classification Loss: 0.3442, Contrastive Loss: 0.0329
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9965, Precision: 0.9932, Recall: 0.9914, F1: 0.9923
Epoch 29/30
Training - Loss: 45.6848
Training Metrics: {'accuracy': 0.9994829963235294, 'precision': 0.9990821589954884, 'recall': 0.9987297581072097, 'f1': 0.9989058684182326}
Validation Metrics: {'accuracy': 0.9964583571346967, 'precision': 0.9932159197450692, 'recall': 0.9914245749873225, 'f1': 0.9923179155332811}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0173
Epoch 30/30, Step 40/1,Classification Loss: 0.3194, Contrastive Loss: 0.0236
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9963, Precision: 0.9935, Recall: 0.9906, F1: 0.9921
Epoch 30/30
Training - Loss: 45.3965
Training Metrics: {'accuracy': 0.9995978860294118, 'precision': 0.9992299316908295, 'recall': 0.9990510951890722, 'f1': 0.999140490373744}
Validation Metrics: {'accuracy': 0.9963441105906546, 'precision': 0.993501997155205, 'recall': 0.9906328442553515, 'f1': 0.9920614388222668}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1977, 5814), y shape: (1977,), y distribution: Counter({np.float64(0.0): 1778, np.float64(1.0): 199}), env shape: (1977,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8017, Precision: 0.6632, Recall: 0.8719, F1: 0.6851
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9715]))
original train data shape: torch.Size([43862]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1977, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43862]), new train data shape: torch.Size([43862])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9715]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3193, Contrastive Loss: 1.5937
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.9496
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4215
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2628
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2014
Epoch 1/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.2073
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1524
Accuracy: 0.9992, Precision: 0.9988, Recall: 0.9977, F1: 0.9982
Accuracy: 0.9973, Precision: 0.9934, Recall: 0.9948, F1: 0.9941
Epoch 1/30
Training - Loss: 104.6906
Training Metrics: {'accuracy': 0.9991731295620438, 'precision': 0.9988163900832469, 'recall': 0.9976767476838324, 'f1': 0.9982456262092414}
Validation Metrics: {'accuracy': 0.9972643337512823, 'precision': 0.9933644815928928, 'recall': 0.9947951837959523, 'f1': 0.9940783496507398}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1432
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1338
Epoch 2/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1705
Epoch 2/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.1286
Epoch 2/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.1189
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1149
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1116
Accuracy: 0.9993, Precision: 0.9988, Recall: 0.9981, F1: 0.9984
Accuracy: 0.9973, Precision: 0.9930, Recall: 0.9952, F1: 0.9941
Epoch 2/30
Training - Loss: 60.8847
Training Metrics: {'accuracy': 0.9992586678832117, 'precision': 0.9987760942362607, 'recall': 0.9980724687099494, 'f1': 0.9984239227029659}
Validation Metrics: {'accuracy': 0.9972643337512823, 'precision': 0.9930140328442589, 'recall': 0.9951578952349214, 'f1': 0.9940826326989683}
Epoch 3/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1254
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1066
Epoch 3/30, Step 40/1,Classification Loss: 0.3339, Contrastive Loss: 0.1180
Epoch 3/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1234
Epoch 3/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.1078
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0980
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0961
Accuracy: 0.9991, Precision: 0.9989, Recall: 0.9975, F1: 0.9982
Accuracy: 0.9973, Precision: 0.9930, Recall: 0.9952, F1: 0.9941
Epoch 3/30
Training - Loss: 57.9310
Training Metrics: {'accuracy': 0.9991446167883211, 'precision': 0.9988867344760162, 'recall': 0.9974815934311038, 'f1': 0.9981827317901975}
Validation Metrics: {'accuracy': 0.9972643337512823, 'precision': 0.9930140328442589, 'recall': 0.9951578952349214, 'f1': 0.9940826326989683}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0949
Epoch 4/30, Step 20/1,Classification Loss: 0.3272, Contrastive Loss: 0.0972
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0911
Epoch 4/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0904
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0880
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0864
Epoch 4/30, Step 120/1,Classification Loss: 0.3264, Contrastive Loss: 0.0883
Accuracy: 0.9993, Precision: 0.9989, Recall: 0.9981, F1: 0.9985
Accuracy: 0.9974, Precision: 0.9945, Recall: 0.9941, F1: 0.9943
Epoch 4/30
Training - Loss: 55.9168
Training Metrics: {'accuracy': 0.9992871806569343, 'precision': 0.9988738550353019, 'recall': 0.9980737544816121, 'f1': 0.9984733428785968}
Validation Metrics: {'accuracy': 0.9973783198449789, 'precision': 0.9944942716614042, 'recall': 0.9941354984936125, 'f1': 0.994314791962984}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0838
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0826
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0816
Epoch 5/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0961
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0795
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0788
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0776
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9974, Precision: 0.9934, Recall: 0.9952, F1: 0.9943
Epoch 5/30
Training - Loss: 54.7885
Training Metrics: {'accuracy': 0.9995152828467153, 'precision': 0.999186653400742, 'recall': 0.9987436480015636, 'f1': 0.9989650090179203}
Validation Metrics: {'accuracy': 0.9973783198449789, 'precision': 0.9934352763894458, 'recall': 0.9952236328105197, 'f1': 0.9943271382778565}
Epoch 6/30, Step 0/1,Classification Loss: 0.3169, Contrastive Loss: 0.0783
Epoch 6/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0763
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0735
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0725
Epoch 6/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0814
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0706
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0697
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9980, F1: 0.9985
Accuracy: 0.9974, Precision: 0.9938, Recall: 0.9949, F1: 0.9943
Epoch 6/30
Training - Loss: 53.5923
Training Metrics: {'accuracy': 0.999315693430657, 'precision': 0.9990733257780988, 'recall': 0.9980165549161174, 'f1': 0.998544131632551}
Validation Metrics: {'accuracy': 0.9973783198449789, 'precision': 0.9937868093004223, 'recall': 0.9948609213715506, 'f1': 0.9943230300798462}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0690
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0680
Epoch 7/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0675
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0664
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0654
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0648
Epoch 7/30, Step 120/1,Classification Loss: 0.3214, Contrastive Loss: 0.0662
Accuracy: 0.9993, Precision: 0.9990, Recall: 0.9979, F1: 0.9985
Accuracy: 0.9975, Precision: 0.9939, Recall: 0.9953, F1: 0.9946
Epoch 7/30
Training - Loss: 52.7038
Training Metrics: {'accuracy': 0.9992871806569343, 'precision': 0.9990472774558516, 'recall': 0.9978799482165824, 'f1': 0.9984626335411115}
Validation Metrics: {'accuracy': 0.9974923059386754, 'precision': 0.9938572392406062, 'recall': 0.9952893703861179, 'f1': 0.9945718205131782}
Epoch 8/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0702
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0623
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0615
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0608
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0600
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0593
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0586
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9986, F1: 0.9988
Accuracy: 0.9967, Precision: 0.9923, Recall: 0.9934, F1: 0.9928
Epoch 8/30
Training - Loss: 51.9372
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9990675033742668, 'recall': 0.9986266344376464, 'f1': 0.9988469282889492}
Validation Metrics: {'accuracy': 0.9966944032827995, 'precision': 0.9923074674751644, 'recall': 0.9933783616010541, 'f1': 0.9928420814050236}
Epoch 9/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0725
Epoch 9/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0580
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0566
Epoch 9/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0717
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0556
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0547
Epoch 9/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0675
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9987, F1: 0.9988
Accuracy: 0.9968, Precision: 0.9910, Recall: 0.9953, F1: 0.9931
Epoch 9/30
Training - Loss: 51.2124
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9989766795505588, 'recall': 0.9987111446877931, 'f1': 0.9988438611862742}
Validation Metrics: {'accuracy': 0.9968083893764961, 'precision': 0.9909915041628106, 'recall': 0.9952576563714977, 'f1': 0.9931113429353435}
Epoch 10/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0548
Epoch 10/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0671
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0521
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0521
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0512
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0504
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0497
Accuracy: 0.9994, Precision: 0.9991, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9973, Precision: 0.9930, Recall: 0.9952, F1: 0.9941
Epoch 10/30
Training - Loss: 50.8575
Training Metrics: {'accuracy': 0.9994297445255474, 'precision': 0.9990512995509917, 'recall': 0.9985226576932343, 'f1': 0.9987867763604592}
Validation Metrics: {'accuracy': 0.9972643337512823, 'precision': 0.9930140328442589, 'recall': 0.9951578952349214, 'f1': 0.9940826326989683}
Epoch 11/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0582
Epoch 11/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0503
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0481
Epoch 11/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0615
Epoch 11/30, Step 80/1,Classification Loss: 0.3256, Contrastive Loss: 0.0498
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0460
Accuracy: 0.9994, Precision: 0.9990, Recall: 0.9983, F1: 0.9987
Accuracy: 0.9972, Precision: 0.9926, Recall: 0.9951, F1: 0.9938
Epoch 11/30
Training - Loss: 50.0796
Training Metrics: {'accuracy': 0.9993727189781022, 'precision': 0.99901448735439, 'recall': 0.9983052962159844, 'f1': 0.9986595285952837}
Validation Metrics: {'accuracy': 0.9971503476575858, 'precision': 0.9925935067668951, 'recall': 0.9950921576593232, 'f1': 0.9938383035437235}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0455
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0450
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0443
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0439
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0442
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0435
Epoch 12/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0433
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9974, Precision: 0.9934, Recall: 0.9952, F1: 0.9943
Epoch 12/30
Training - Loss: 49.4375
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.9990865105872564, 'recall': 0.9987352499292232, 'f1': 0.9989107908559435}
Validation Metrics: {'accuracy': 0.9973783198449789, 'precision': 0.9934352763894458, 'recall': 0.9952236328105197, 'f1': 0.9943271382778565}
Epoch 13/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0576
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0417
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0411
Epoch 13/30, Step 60/1,Classification Loss: 0.3257, Contrastive Loss: 0.0439
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0409
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0398
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0397
Accuracy: 0.9993, Precision: 0.9990, Recall: 0.9978, F1: 0.9984
Accuracy: 0.9961, Precision: 0.9899, Recall: 0.9934, F1: 0.9916
Epoch 13/30
Training - Loss: 49.2225
Training Metrics: {'accuracy': 0.9992586678832117, 'precision': 0.9990365437915454, 'recall': 0.9977944780849135, 'f1': 0.9984143968492704}
Validation Metrics: {'accuracy': 0.9961244728143167, 'precision': 0.9898643161919948, 'recall': 0.9934123851620321, 'f1': 0.9916291663617101}
Epoch 14/30, Step 0/1,Classification Loss: 0.3144, Contrastive Loss: 0.0400
Epoch 14/30, Step 20/1,Classification Loss: 0.3269, Contrastive Loss: 0.0424
Epoch 14/30, Step 40/1,Classification Loss: 0.3215, Contrastive Loss: 0.0389
Epoch 14/30, Step 60/1,Classification Loss: 0.3360, Contrastive Loss: 0.0561
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0370
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0367
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0365
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9986, F1: 0.9989
Accuracy: 0.9968, Precision: 0.9924, Recall: 0.9938, F1: 0.9931
Epoch 14/30
Training - Loss: 48.6702
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.9991725607365509, 'recall': 0.998643655648046, 'f1': 0.9989079058066267}
Validation Metrics: {'accuracy': 0.9968083893764961, 'precision': 0.9923789662974664, 'recall': 0.9938068106156215, 'f1': 0.9930914079258631}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0358
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0355
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0358
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Epoch 15/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0347
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9972, Precision: 0.9916, Recall: 0.9962, F1: 0.9939
Epoch 15/30
Training - Loss: 48.1856
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.999081024907191, 'recall': 0.9987264375088882, 'f1': 0.998903640447362}
Validation Metrics: {'accuracy': 0.9971503476575858, 'precision': 0.9915540517916814, 'recall': 0.9961802919762304, 'f1': 0.9938516294534547}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0325
Epoch 16/30, Step 60/1,Classification Loss: 0.3176, Contrastive Loss: 0.0349
Epoch 16/30, Step 80/1,Classification Loss: 0.3281, Contrastive Loss: 0.0360
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Accuracy: 0.9994, Precision: 0.9990, Recall: 0.9986, F1: 0.9988
Accuracy: 0.9972, Precision: 0.9933, Recall: 0.9944, F1: 0.9938
Epoch 16/30
Training - Loss: 48.0993
Training Metrics: {'accuracy': 0.9994297445255474, 'precision': 0.998958650124881, 'recall': 0.9986038774770545, 'f1': 0.9987811729475553}
Validation Metrics: {'accuracy': 0.9971503476575858, 'precision': 0.9932936953586697, 'recall': 0.9943667347813852, 'f1': 0.9938293805215721}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 17/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0455
Epoch 17/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0459
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0295
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0294
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9970, Precision: 0.9932, Recall: 0.9939, F1: 0.9936
Epoch 17/30
Training - Loss: 47.5747
Training Metrics: {'accuracy': 0.9995437956204379, 'precision': 0.9991169968906162, 'recall': 0.998940517576238, 'f1': 0.9990287347140022}
Validation Metrics: {'accuracy': 0.9970363615638892, 'precision': 0.9932229176575833, 'recall': 0.9939382857668179, 'f1': 0.9935802306521484}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0282
Epoch 18/30, Step 60/1,Classification Loss: 0.3256, Contrastive Loss: 0.0326
Epoch 18/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0285
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0268
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9981, F1: 0.9986
Accuracy: 0.9966, Precision: 0.9908, Recall: 0.9944, F1: 0.9926
Epoch 18/30
Training - Loss: 47.2538
Training Metrics: {'accuracy': 0.9993442062043796, 'precision': 0.9990842338745647, 'recall': 0.9981040869813513, 'f1': 0.9985934680437367}
Validation Metrics: {'accuracy': 0.996580417189103, 'precision': 0.990845582099956, 'recall': 0.9944007583423631, 'f1': 0.9926139703191559}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0268
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 19/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0257
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9981, F1: 0.9986
Accuracy: 0.9968, Precision: 0.9931, Recall: 0.9931, F1: 0.9931
Epoch 19/30
Training - Loss: 47.1198
Training Metrics: {'accuracy': 0.9993442062043796, 'precision': 0.9990883438607713, 'recall': 0.9981164299547538, 'f1': 0.9986017038215775}
Validation Metrics: {'accuracy': 0.9968083893764961, 'precision': 0.9930813877376834, 'recall': 0.9930813877376834, 'f1': 0.9930813877376834}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0247
Epoch 20/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0408
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9970, Precision: 0.9925, Recall: 0.9947, F1: 0.9936
Epoch 20/30
Training - Loss: 46.7389
Training Metrics: {'accuracy': 0.9995437956204379, 'precision': 0.9992085806088047, 'recall': 0.9988579477787576, 'f1': 0.9990331750627973}
Validation Metrics: {'accuracy': 0.9970363615638892, 'precision': 0.9925219859110692, 'recall': 0.994663708644756, 'f1': 0.9935895187572157}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 21/30, Step 80/1,Classification Loss: 0.3280, Contrastive Loss: 0.0288
Epoch 21/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0236
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Accuracy: 0.9994, Precision: 0.9991, Recall: 0.9984, F1: 0.9988
Accuracy: 0.9973, Precision: 0.9941, Recall: 0.9941, F1: 0.9941
Epoch 21/30
Training - Loss: 46.5889
Training Metrics: {'accuracy': 0.9994297445255474, 'precision': 0.9991349206970335, 'recall': 0.9984233758147663, 'f1': 0.9987787831993856}
Validation Metrics: {'accuracy': 0.9972643337512823, 'precision': 0.9940697609180142, 'recall': 0.9940697609180142, 'f1': 0.9940697609180142}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 22/30, Step 80/1,Classification Loss: 0.3285, Contrastive Loss: 0.0240
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 22/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0371
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9986, F1: 0.9988
Accuracy: 0.9972, Precision: 0.9936, Recall: 0.9940, F1: 0.9938
Epoch 22/30
Training - Loss: 46.2912
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9990646868434789, 'recall': 0.9986216764281766, 'f1': 0.9988430399239201}
Validation Metrics: {'accuracy': 0.9971503476575858, 'precision': 0.9936459768717408, 'recall': 0.9940040233424161, 'f1': 0.9938249072257948}
Epoch 23/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0213
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9987, F1: 0.9988
Accuracy: 0.9973, Precision: 0.9934, Recall: 0.9948, F1: 0.9941
Epoch 23/30
Training - Loss: 46.4026
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9989790694187162, 'recall': 0.998714480733932, 'f1': 0.9988467244335826}
Validation Metrics: {'accuracy': 0.9972643337512823, 'precision': 0.9933644815928928, 'recall': 0.9947951837959523, 'f1': 0.9940783496507398}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 24/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0318
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 24/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0213
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Accuracy: 0.9994, Precision: 0.9991, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9973, Precision: 0.9934, Recall: 0.9948, F1: 0.9941
Epoch 24/30
Training - Loss: 46.2485
Training Metrics: {'accuracy': 0.9994297445255474, 'precision': 0.9990518868012952, 'recall': 0.998523782760983, 'f1': 0.9987876328484353}
Validation Metrics: {'accuracy': 0.9972643337512823, 'precision': 0.9933644815928928, 'recall': 0.9947951837959523, 'f1': 0.9940783496507398}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 25/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.0471
Epoch 25/30, Step 40/1,Classification Loss: 0.3148, Contrastive Loss: 0.0196
Epoch 25/30, Step 60/1,Classification Loss: 0.3354, Contrastive Loss: 0.0254
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Accuracy: 0.9994, Precision: 0.9991, Recall: 0.9982, F1: 0.9987
Accuracy: 0.9968, Precision: 0.9927, Recall: 0.9934, F1: 0.9931
Epoch 25/30
Training - Loss: 46.2059
Training Metrics: {'accuracy': 0.9993727189781022, 'precision': 0.9991034655523393, 'recall': 0.998217202641898, 'f1': 0.9986597668448984}
Validation Metrics: {'accuracy': 0.9968083893764961, 'precision': 0.992729446795145, 'recall': 0.9934440991766523, 'f1': 0.9930864022407753}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 26/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0187
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 26/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0186
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9972, Precision: 0.9936, Recall: 0.9940, F1: 0.9938
Epoch 26/30
Training - Loss: 46.0537
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.9990793767211903, 'recall': 0.9987237905671716, 'f1': 0.9989014924734861}
Validation Metrics: {'accuracy': 0.9971503476575858, 'precision': 0.9936459768717408, 'recall': 0.9940040233424161, 'f1': 0.9938249072257948}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0181
Epoch 27/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0332
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Accuracy: 0.9995, Precision: 0.9990, Recall: 0.9988, F1: 0.9989
Accuracy: 0.9972, Precision: 0.9929, Recall: 0.9947, F1: 0.9938
Epoch 27/30
Training - Loss: 45.8330
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.9989876344257969, 'recall': 0.9988091109769421, 'f1': 0.9988983497583159}
Validation Metrics: {'accuracy': 0.9971503476575858, 'precision': 0.9929428744107228, 'recall': 0.9947294462203542, 'f1': 0.9938338459541919}
Epoch 28/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0183
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9973, Precision: 0.9941, Recall: 0.9941, F1: 0.9941
Epoch 28/30
Training - Loss: 45.8049
Training Metrics: {'accuracy': 0.9995152828467153, 'precision': 0.9991880486552644, 'recall': 0.9987462850880733, 'f1': 0.998967025823729}
Validation Metrics: {'accuracy': 0.9972643337512823, 'precision': 0.9940697609180142, 'recall': 0.9940697609180142, 'f1': 0.9940697609180142}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 29/30, Step 20/1,Classification Loss: 0.3280, Contrastive Loss: 0.0235
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 29/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0171
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9987, F1: 0.9989
Accuracy: 0.9974, Precision: 0.9938, Recall: 0.9949, F1: 0.9943
Epoch 29/30
Training - Loss: 45.6853
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.999082218575082, 'recall': 0.9987283547278833, 'f1': 0.9989051961872075}
Validation Metrics: {'accuracy': 0.9973783198449789, 'precision': 0.9937868093004223, 'recall': 0.9948609213715506, 'f1': 0.9943230300798462}
Epoch 30/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0323
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.0172
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0166
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9972, Precision: 0.9936, Recall: 0.9940, F1: 0.9938
Epoch 30/30
Training - Loss: 45.6873
Training Metrics: {'accuracy': 0.9995723083941606, 'precision': 0.9992184730556997, 'recall': 0.9989519244502985, 'f1': 0.9990851475271346}
Validation Metrics: {'accuracy': 0.9971503476575858, 'precision': 0.9936459768717408, 'recall': 0.9940040233424161, 'f1': 0.9938249072257948}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1979, 5814), y shape: (1979,), y distribution: Counter({np.float64(0.0): 1780, np.float64(1.0): 199}), env shape: (1979,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8711, Precision: 0.7117, Recall: 0.8927, F1: 0.7565
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9815]))
original train data shape: torch.Size([43962]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1979, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([43962]), new train data shape: torch.Size([43962])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9815]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 1.6169
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.8102
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3315
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2282
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1891
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1651
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1490
Accuracy: 0.9991, Precision: 0.9987, Recall: 0.9974, F1: 0.9981
Accuracy: 0.9970, Precision: 0.9925, Recall: 0.9947, F1: 0.9936
Epoch 1/30
Training - Loss: 99.4923
Training Metrics: {'accuracy': 0.9990875912408759, 'precision': 0.9986746754897278, 'recall': 0.9974410939064671, 'f1': 0.9980567821637957}
Validation Metrics: {'accuracy': 0.9970431024678722, 'precision': 0.9925408524969657, 'recall': 0.9946770401315856, 'f1': 0.9936056346537245}
Epoch 2/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1492
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1325
Epoch 2/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.1291
Epoch 2/30, Step 60/1,Classification Loss: 0.3331, Contrastive Loss: 0.1347
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1181
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1150
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1121
Accuracy: 0.9992, Precision: 0.9987, Recall: 0.9980, F1: 0.9983
Accuracy: 0.9970, Precision: 0.9932, Recall: 0.9940, F1: 0.9936
Epoch 2/30
Training - Loss: 60.8195
Training Metrics: {'accuracy': 0.9992016423357665, 'precision': 0.9986541416028851, 'recall': 0.9979501504045378, 'f1': 0.9983017868694792}
Validation Metrics: {'accuracy': 0.9970431024678722, 'precision': 0.993240005499444, 'recall': 0.9939535212262485, 'f1': 0.9935963941854683}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1096
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1072
Epoch 3/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.1130
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1031
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1006
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0986
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0967
Accuracy: 0.9993, Precision: 0.9987, Recall: 0.9982, F1: 0.9984
Accuracy: 0.9972, Precision: 0.9930, Recall: 0.9947, F1: 0.9938
Epoch 3/30
Training - Loss: 57.7928
Training Metrics: {'accuracy': 0.9992586678832117, 'precision': 0.9986884056962354, 'recall': 0.9981609549923611, 'f1': 0.9984244787001639}
Validation Metrics: {'accuracy': 0.9971568292960309, 'precision': 0.9929606810298117, 'recall': 0.9947426311062675, 'f1': 0.9938493534371502}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0956
Epoch 4/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0943
Epoch 4/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.1213
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0902
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0886
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0878
Epoch 4/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.0869
Accuracy: 0.9994, Precision: 0.9990, Recall: 0.9983, F1: 0.9987
Accuracy: 0.9974, Precision: 0.9942, Recall: 0.9945, F1: 0.9943
Epoch 4/30
Training - Loss: 56.2625
Training Metrics: {'accuracy': 0.9993727189781022, 'precision': 0.9990242273979002, 'recall': 0.9983270114952626, 'f1': 0.9986752660099036}
Validation Metrics: {'accuracy': 0.9973842829523485, 'precision': 0.9941545788282873, 'recall': 0.9945120536029627, 'f1': 0.9943332237276694}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0856
Epoch 5/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0881
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0820
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0807
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0796
Epoch 5/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0878
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0785
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9973, Precision: 0.9934, Recall: 0.9948, F1: 0.9941
Epoch 5/30
Training - Loss: 54.8736
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9991496141130864, 'recall': 0.9985246178461504, 'f1': 0.9988368347826645}
Validation Metrics: {'accuracy': 0.9972705561241897, 'precision': 0.9933812246036929, 'recall': 0.9948082220809493, 'f1': 0.9940932478202631}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0762
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0751
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0742
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0730
Epoch 6/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0871
Epoch 6/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0770
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0701
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9986, F1: 0.9988
Accuracy: 0.9972, Precision: 0.9933, Recall: 0.9944, F1: 0.9938
Epoch 6/30
Training - Loss: 53.6178
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9990654303311544, 'recall': 0.99862298507307, 'f1': 0.998844066279614}
Validation Metrics: {'accuracy': 0.9971568292960309, 'precision': 0.9933106107900196, 'recall': 0.9943808716535989, 'f1': 0.9938449109068179}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0693
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0690
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0677
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0665
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0656
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0649
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0639
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9973, Precision: 0.9930, Recall: 0.9952, F1: 0.9941
Epoch 7/30
Training - Loss: 52.6625
Training Metrics: {'accuracy': 0.9995152828467153, 'precision': 0.9991863989851677, 'recall': 0.9987431671983864, 'f1': 0.9989646412925606}
Validation Metrics: {'accuracy': 0.9972705561241897, 'precision': 0.9930316652064528, 'recall': 0.9951699815336179, 'f1': 0.9940975089111304}
Epoch 8/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1192
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0627
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0617
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0609
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0608
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0594
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0587
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9985, F1: 0.9989
Accuracy: 0.9972, Precision: 0.9933, Recall: 0.9944, F1: 0.9938
Epoch 8/30
Training - Loss: 51.8761
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9991594169770202, 'recall': 0.9985467318534179, 'f1': 0.9988528020320868}
Validation Metrics: {'accuracy': 0.9971568292960309, 'precision': 0.9933106107900196, 'recall': 0.9943808716535989, 'f1': 0.9938449109068179}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0580
Epoch 9/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0645
Epoch 9/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0572
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0561
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0553
Epoch 9/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0620
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0541
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9980, F1: 0.9985
Accuracy: 0.9975, Precision: 0.9949, Recall: 0.9942, F1: 0.9946
Epoch 9/30
Training - Loss: 51.5542
Training Metrics: {'accuracy': 0.999315693430657, 'precision': 0.9990692562662864, 'recall': 0.9980035515635207, 'f1': 0.9985355842240016}
Validation Metrics: {'accuracy': 0.9974980097805072, 'precision': 0.9949322928362901, 'recall': 0.994215885124976, 'f1': 0.994573717951595}
Epoch 10/30, Step 0/1,Classification Loss: 0.3140, Contrastive Loss: 0.0568
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0528
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0523
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0521
Epoch 10/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0529
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0503
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0521
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9986, F1: 0.9988
Accuracy: 0.9970, Precision: 0.9929, Recall: 0.9943, F1: 0.9936
Epoch 10/30
Training - Loss: 50.5391
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9990654303311544, 'recall': 0.99862298507307, 'f1': 0.998844066279614}
Validation Metrics: {'accuracy': 0.9970431024678722, 'precision': 0.99288970481534, 'recall': 0.9943152806789171, 'f1': 0.9936010184719517}
Epoch 11/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0555
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0487
Epoch 11/30, Step 40/1,Classification Loss: 0.3154, Contrastive Loss: 0.0520
Epoch 11/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0580
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0472
Epoch 11/30, Step 100/1,Classification Loss: 0.3144, Contrastive Loss: 0.0484
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0461
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9973, Precision: 0.9937, Recall: 0.9944, F1: 0.9941
Epoch 11/30
Training - Loss: 50.2401
Training Metrics: {'accuracy': 0.9995152828467153, 'precision': 0.9992767446751036, 'recall': 0.9986585907531125, 'f1': 0.9989673914855399}
Validation Metrics: {'accuracy': 0.9972705561241897, 'precision': 0.9937322348477554, 'recall': 0.9944464626282808, 'f1': 0.9940889792481247}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0461
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Epoch 12/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0574
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0440
Epoch 12/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0492
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0429
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0425
Accuracy: 0.9996, Precision: 0.9992, Recall: 0.9991, F1: 0.9991
Accuracy: 0.9974, Precision: 0.9942, Recall: 0.9945, F1: 0.9943
Epoch 12/30
Training - Loss: 49.6382
Training Metrics: {'accuracy': 0.9996008211678832, 'precision': 0.9992341794405584, 'recall': 0.9990561626990184, 'f1': 0.9991451482395699}
Validation Metrics: {'accuracy': 0.9973842829523485, 'precision': 0.9941545788282873, 'recall': 0.9945120536029627, 'f1': 0.9943332237276694}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0421
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0418
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Epoch 13/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0417
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0401
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0392
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9973, Precision: 0.9941, Recall: 0.9941, F1: 0.9941
Epoch 13/30
Training - Loss: 48.9351
Training Metrics: {'accuracy': 0.9995437956204379, 'precision': 0.9992959378959746, 'recall': 0.9987694541721437, 'f1': 0.9990324951638552}
Validation Metrics: {'accuracy': 0.9972705561241897, 'precision': 0.9940847031756123, 'recall': 0.9940847031756123, 'f1': 0.9940847031756123}
Epoch 14/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0570
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0391
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0380
Epoch 14/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0540
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0371
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0363
Accuracy: 0.9995, Precision: 0.9991, Recall: 0.9989, F1: 0.9990
Accuracy: 0.9972, Precision: 0.9933, Recall: 0.9944, F1: 0.9938
Epoch 14/30
Training - Loss: 48.6471
Training Metrics: {'accuracy': 0.9995437956204379, 'precision': 0.999113848232901, 'recall': 0.9989364206053177, 'f1': 0.9990251117056608}
Validation Metrics: {'accuracy': 0.9971568292960309, 'precision': 0.9933106107900196, 'recall': 0.9943808716535989, 'f1': 0.9938449109068179}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 15/30, Step 40/1,Classification Loss: 0.3241, Contrastive Loss: 0.0379
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0348
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0344
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0337
Accuracy: 0.9994, Precision: 0.9989, Recall: 0.9984, F1: 0.9987
Accuracy: 0.9970, Precision: 0.9929, Recall: 0.9943, F1: 0.9936
Epoch 15/30
Training - Loss: 48.1307
Training Metrics: {'accuracy': 0.9993727189781022, 'precision': 0.998923288201661, 'recall': 0.9983894871756522, 'f1': 0.9986561822183918}
Validation Metrics: {'accuracy': 0.9970431024678722, 'precision': 0.99288970481534, 'recall': 0.9943152806789171, 'f1': 0.9936010184719517}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0338
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0326
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9985, F1: 0.9989
Accuracy: 0.9972, Precision: 0.9937, Recall: 0.9940, F1: 0.9938
Epoch 16/30
Training - Loss: 48.0194
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.9992572342665007, 'recall': 0.9985456973568201, 'f1': 0.9989011008292628}
Validation Metrics: {'accuracy': 0.9971568292960309, 'precision': 0.993661993765631, 'recall': 0.9940191122009304, 'f1': 0.9938404605735538}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0310
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0303
Epoch 17/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0324
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Epoch 17/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0321
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9970, Precision: 0.9932, Recall: 0.9940, F1: 0.9936
Epoch 17/30
Training - Loss: 47.7890
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9992440636175729, 'recall': 0.9984502968196458, 'f1': 0.9988467244335826}
Validation Metrics: {'accuracy': 0.9970431024678722, 'precision': 0.993240005499444, 'recall': 0.9939535212262485, 'f1': 0.9935963941854683}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0290
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 40/1,Classification Loss: 0.3154, Contrastive Loss: 0.0289
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0275
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9978, F1: 0.9985
Accuracy: 0.9969, Precision: 0.9928, Recall: 0.9939, F1: 0.9934
Epoch 18/30
Training - Loss: 47.2727
Training Metrics: {'accuracy': 0.9992871806569343, 'precision': 0.9991433904338044, 'recall': 0.9978166840766394, 'f1': 0.9984787647187819}
Validation Metrics: {'accuracy': 0.9969293756397134, 'precision': 0.9928187365326138, 'recall': 0.9938879302515666, 'f1': 0.9933525037793633}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0270
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Epoch 19/30, Step 60/1,Classification Loss: 0.3279, Contrastive Loss: 0.0296
Epoch 19/30, Step 80/1,Classification Loss: 0.3261, Contrastive Loss: 0.0334
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0255
Accuracy: 0.9994, Precision: 0.9992, Recall: 0.9982, F1: 0.9987
Accuracy: 0.9972, Precision: 0.9933, Recall: 0.9944, F1: 0.9938
Epoch 19/30
Training - Loss: 47.1520
Training Metrics: {'accuracy': 0.9994012317518248, 'precision': 0.9992085180406995, 'recall': 0.9982326370842194, 'f1': 0.9987198901316896}
Validation Metrics: {'accuracy': 0.9971568292960309, 'precision': 0.9933106107900196, 'recall': 0.9943808716535989, 'f1': 0.9938449109068179}
Epoch 20/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0273
Epoch 20/30, Step 20/1,Classification Loss: 0.3240, Contrastive Loss: 0.0279
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 20/30, Step 120/1,Classification Loss: 0.3264, Contrastive Loss: 0.0262
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9988, F1: 0.9990
Accuracy: 0.9972, Precision: 0.9937, Recall: 0.9940, F1: 0.9938
Epoch 20/30
Training - Loss: 46.8355
Training Metrics: {'accuracy': 0.9995437956204379, 'precision': 0.9992928212775298, 'recall': 0.9987623022000915, 'f1': 0.9990273584014289}
Validation Metrics: {'accuracy': 0.9971568292960309, 'precision': 0.993661993765631, 'recall': 0.9940191122009304, 'f1': 0.9938404605735538}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0238
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9987, F1: 0.9990
Accuracy: 0.9969, Precision: 0.9928, Recall: 0.9939, F1: 0.9934
Epoch 21/30
Training - Loss: 46.6345
Training Metrics: {'accuracy': 0.9995152828467153, 'precision': 0.9992777808881814, 'recall': 0.9986611994485233, 'f1': 0.9989692150628477}
Validation Metrics: {'accuracy': 0.9969293756397134, 'precision': 0.9928187365326138, 'recall': 0.9938879302515666, 'f1': 0.9933525037793633}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 22/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.1108
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9973, Precision: 0.9934, Recall: 0.9948, F1: 0.9941
Epoch 22/30
Training - Loss: 46.7131
Training Metrics: {'accuracy': 0.9996293339416058, 'precision': 0.9993429349379159, 'recall': 0.9990778829652289, 'f1': 0.9992103581948246}
Validation Metrics: {'accuracy': 0.9972705561241897, 'precision': 0.9933812246036929, 'recall': 0.9948082220809493, 'f1': 0.9940932478202631}
Epoch 23/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 0.0243
Epoch 23/30, Step 20/1,Classification Loss: 0.3267, Contrastive Loss: 0.0296
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9985, F1: 0.9988
Accuracy: 0.9968, Precision: 0.9917, Recall: 0.9945, F1: 0.9931
Epoch 23/30
Training - Loss: 46.4834
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9992445761635941, 'recall': 0.9984518192140175, 'f1': 0.998847742830852}
Validation Metrics: {'accuracy': 0.9968156488115546, 'precision': 0.991703333270163, 'recall': 0.9945458581822219, 'f1': 0.9931187229630577}
Epoch 24/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0290
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 24/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0343
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 24/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0349
Epoch 24/30, Step 100/1,Classification Loss: 0.3218, Contrastive Loss: 0.0208
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9969, Precision: 0.9918, Recall: 0.9950, F1: 0.9934
Epoch 24/30
Training - Loss: 46.2852
Training Metrics: {'accuracy': 0.9995723083941606, 'precision': 0.999309943614634, 'recall': 0.998868410308295, 'f1': 0.9990890360569964}
Validation Metrics: {'accuracy': 0.9969293756397134, 'precision': 0.9917753956652771, 'recall': 0.9949732086095723, 'f1': 0.9933668723818835}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 25/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0197
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0338
Epoch 25/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0634
Accuracy: 0.9995, Precision: 0.9992, Recall: 0.9986, F1: 0.9989
Accuracy: 0.9970, Precision: 0.9939, Recall: 0.9932, F1: 0.9936
Epoch 25/30
Training - Loss: 46.0767
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.9991687692439275, 'recall': 0.998635799124018, 'f1': 0.9989020793021057}
Validation Metrics: {'accuracy': 0.9970431024678722, 'precision': 0.9939449809117449, 'recall': 0.9932300023209114, 'f1': 0.9935871212155213}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 100/1,Classification Loss: 0.3292, Contrastive Loss: 0.0361
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9991, F1: 0.9992
Accuracy: 0.9966, Precision: 0.9916, Recall: 0.9937, F1: 0.9926
Epoch 26/30
Training - Loss: 45.9907
Training Metrics: {'accuracy': 0.9996293339416058, 'precision': 0.9993421922267076, 'recall': 0.9990766664825581, 'f1': 0.9992093784526215}
Validation Metrics: {'accuracy': 0.9965881951552371, 'precision': 0.9915592270779915, 'recall': 0.993691157327521, 'f1': 0.9926218861389129}
Epoch 27/30, Step 0/1,Classification Loss: 0.3276, Contrastive Loss: 0.0198
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0279
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 120/1,Classification Loss: 0.3144, Contrastive Loss: 0.0186
Accuracy: 0.9992, Precision: 0.9990, Recall: 0.9977, F1: 0.9984
Accuracy: 0.9965, Precision: 0.9922, Recall: 0.9925, F1: 0.9924
Epoch 27/30
Training - Loss: 45.8740
Training Metrics: {'accuracy': 0.9992301551094891, 'precision': 0.99902310836365, 'recall': 0.997701112538351, 'f1': 0.9983608449070542}
Validation Metrics: {'accuracy': 0.9964744683270783, 'precision': 0.9921842385776622, 'recall': 0.9925402879948335, 'f1': 0.9923621711112067}
Epoch 28/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0221
Epoch 28/30, Step 20/1,Classification Loss: 0.3419, Contrastive Loss: 0.0638
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9985, F1: 0.9989
Accuracy: 0.9972, Precision: 0.9940, Recall: 0.9937, F1: 0.9938
Epoch 28/30
Training - Loss: 45.9650
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.9992516183556095, 'recall': 0.9985303213589167, 'f1': 0.9988905967991584}
Validation Metrics: {'accuracy': 0.9971568292960309, 'precision': 0.9940148372120996, 'recall': 0.9936573527482618, 'f1': 0.9938360024174255}
Epoch 29/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.0184
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9968, Precision: 0.9914, Recall: 0.9949, F1: 0.9931
Epoch 29/30
Training - Loss: 45.8251
Training Metrics: {'accuracy': 0.9995723083941606, 'precision': 0.9993066706912586, 'recall': 0.998861626169862, 'f1': 0.9990840057271582}
Validation Metrics: {'accuracy': 0.9968156488115546, 'precision': 0.9913580583613667, 'recall': 0.9949076176348903, 'f1': 0.9931236768459919}
Epoch 30/30, Step 0/1,Classification Loss: 0.3177, Contrastive Loss: 0.0230
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0175
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Accuracy: 0.9994, Precision: 0.9991, Recall: 0.9984, F1: 0.9988
Accuracy: 0.9974, Precision: 0.9942, Recall: 0.9945, F1: 0.9943
Epoch 30/30
Training - Loss: 45.6408
Training Metrics: {'accuracy': 0.9994297445255474, 'precision': 0.9991371892622425, 'recall': 0.9984289110228071, 'f1': 0.9987826877680689}
Validation Metrics: {'accuracy': 0.9973842829523485, 'precision': 0.9941545788282873, 'recall': 0.9945120536029627, 'f1': 0.9943332237276694}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1981, 5814), y shape: (1981,), y distribution: Counter({np.float64(0.0): 1784, np.float64(1.0): 197}), env shape: (1981,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9157, Precision: 0.7682, Recall: 0.9238, F1: 0.8196
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9915]))
original train data shape: torch.Size([44062]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1981, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44062]), new train data shape: torch.Size([44062])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  9915]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.6517
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 1.0095
Epoch 1/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.4098
Epoch 1/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.2402
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1907
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1684
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1526
Accuracy: 0.9994, Precision: 0.9990, Recall: 0.9984, F1: 0.9987
Accuracy: 0.9968, Precision: 0.9917, Recall: 0.9946, F1: 0.9931
Epoch 1/30
Training - Loss: 105.3844
Training Metrics: {'accuracy': 0.9994012317518248, 'precision': 0.9990365527248151, 'recall': 0.9984218358046935, 'f1': 0.9987289203876787}
Validation Metrics: {'accuracy': 0.9968228752978554, 'precision': 0.9917242032744166, 'recall': 0.9945594149337404, 'f1': 0.9931359659761279}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1441
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1361
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1301
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1252
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1209
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1172
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1142
Accuracy: 0.9995, Precision: 0.9993, Recall: 0.9986, F1: 0.9990
Accuracy: 0.9970, Precision: 0.9922, Recall: 0.9951, F1: 0.9936
Epoch 2/30
Training - Loss: 60.7306
Training Metrics: {'accuracy': 0.9995152828467153, 'precision': 0.9992718112698551, 'recall': 0.9986461800016249, 'f1': 0.9989587140323684}
Validation Metrics: {'accuracy': 0.99704981277658, 'precision': 0.9922130869266532, 'recall': 0.9950511174194239, 'f1': 0.9936262541206902}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1124
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1093
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1063
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1035
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1013
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0997
Epoch 3/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1403
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9990, F1: 0.9991
Accuracy: 0.9967, Precision: 0.9913, Recall: 0.9945, F1: 0.9929
Epoch 3/30
Training - Loss: 57.8037
Training Metrics: {'accuracy': 0.9996008211678832, 'precision': 0.999325171180922, 'recall': 0.9989707729938377, 'f1': 0.9991478814376482}
Validation Metrics: {'accuracy': 0.9967094065584932, 'precision': 0.9913075528374, 'recall': 0.9944939699075623, 'f1': 0.9928933753262537}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0984
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0938
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0918
Epoch 4/30, Step 60/1,Classification Loss: 0.3275, Contrastive Loss: 0.0967
Epoch 4/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1044
Epoch 4/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0888
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0855
Accuracy: 0.9993, Precision: 0.9993, Recall: 0.9977, F1: 0.9985
Accuracy: 0.9969, Precision: 0.9921, Recall: 0.9946, F1: 0.9934
Epoch 4/30
Training - Loss: 55.8284
Training Metrics: {'accuracy': 0.999315693430657, 'precision': 0.9993350248048573, 'recall': 0.9977241232706908, 'f1': 0.9985277068242481}
Validation Metrics: {'accuracy': 0.9969363440372178, 'precision': 0.9921415597306077, 'recall': 0.9946248599599183, 'f1': 0.9933787306466424}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0842
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0829
Epoch 5/30, Step 40/1,Classification Loss: 0.3230, Contrastive Loss: 0.0827
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0803
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0788
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0775
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0763
Accuracy: 0.9994, Precision: 0.9994, Recall: 0.9982, F1: 0.9988
Accuracy: 0.9969, Precision: 0.9921, Recall: 0.9946, F1: 0.9934
Epoch 5/30
Training - Loss: 54.5655
Training Metrics: {'accuracy': 0.9994297445255474, 'precision': 0.9994050817082799, 'recall': 0.9981740892656353, 'f1': 0.9987884878601316}
Validation Metrics: {'accuracy': 0.9969363440372178, 'precision': 0.9921415597306077, 'recall': 0.9946248599599183, 'f1': 0.9933787306466424}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0758
Epoch 6/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.1071
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0735
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0728
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0710
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0699
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0690
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9967, Precision: 0.9906, Recall: 0.9952, F1: 0.9929
Epoch 6/30
Training - Loss: 53.3484
Training Metrics: {'accuracy': 0.9995723083941606, 'precision': 0.9993942240629035, 'recall': 0.9987681176601928, 'f1': 0.9990808889671681}
Validation Metrics: {'accuracy': 0.9967094065584932, 'precision': 0.9906222590331544, 'recall': 0.9952155947742174, 'f1': 0.9929035667589703}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0683
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0672
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0669
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0660
Epoch 7/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0784
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0638
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0631
Accuracy: 0.9994, Precision: 0.9994, Recall: 0.9980, F1: 0.9987
Accuracy: 0.9969, Precision: 0.9925, Recall: 0.9943, F1: 0.9934
Epoch 7/30
Training - Loss: 52.6242
Training Metrics: {'accuracy': 0.9994012317518248, 'precision': 0.9993837670807315, 'recall': 0.9980365300385001, 'f1': 0.9987088447575381}
Validation Metrics: {'accuracy': 0.9969363440372178, 'precision': 0.9924884617907657, 'recall': 0.9942640475265909, 'f1': 0.9933739656001799}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0621
Epoch 8/30, Step 20/1,Classification Loss: 0.3168, Contrastive Loss: 0.0647
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0604
Epoch 8/30, Step 60/1,Classification Loss: 0.3212, Contrastive Loss: 0.0630
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0589
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0583
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0575
Accuracy: 0.9993, Precision: 0.9991, Recall: 0.9977, F1: 0.9984
Accuracy: 0.9968, Precision: 0.9935, Recall: 0.9928, F1: 0.9931
Epoch 8/30
Training - Loss: 51.7581
Training Metrics: {'accuracy': 0.9992586678832117, 'precision': 0.999124901513935, 'recall': 0.9977028534449246, 'f1': 0.9984124181592013}
Validation Metrics: {'accuracy': 0.9968228752978554, 'precision': 0.9934677702507447, 'recall': 0.9927553527671027, 'f1': 0.9931111932975197}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0574
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0561
Epoch 9/30, Step 40/1,Classification Loss: 0.3207, Contrastive Loss: 0.0567
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0555
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0541
Epoch 9/30, Step 100/1,Classification Loss: 0.3285, Contrastive Loss: 0.0614
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0527
Accuracy: 0.9993, Precision: 0.9993, Recall: 0.9976, F1: 0.9985
Accuracy: 0.9972, Precision: 0.9933, Recall: 0.9944, F1: 0.9939
Epoch 9/30
Training - Loss: 51.1296
Training Metrics: {'accuracy': 0.9992871806569343, 'precision': 0.999320451618763, 'recall': 0.9976352272944282, 'f1': 0.9984757885309772}
Validation Metrics: {'accuracy': 0.9971632815159424, 'precision': 0.993327440967221, 'recall': 0.9943949375789469, 'f1': 0.9938603631594146}
Epoch 10/30, Step 0/1,Classification Loss: 0.3184, Contrastive Loss: 0.0534
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0514
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0510
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0501
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0496
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0500
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0484
Accuracy: 0.9994, Precision: 0.9993, Recall: 0.9982, F1: 0.9987
Accuracy: 0.9969, Precision: 0.9925, Recall: 0.9943, F1: 0.9934
Epoch 10/30
Training - Loss: 50.2122
Training Metrics: {'accuracy': 0.9994012317518248, 'precision': 0.999299019366583, 'recall': 0.9981512839911271, 'f1': 0.9987241989751343}
Validation Metrics: {'accuracy': 0.9969363440372178, 'precision': 0.9924884617907657, 'recall': 0.9942640475265909, 'f1': 0.9933739656001799}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0477
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0466
Epoch 11/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0514
Epoch 11/30, Step 80/1,Classification Loss: 0.3418, Contrastive Loss: 0.0921
Epoch 11/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0470
Epoch 11/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0460
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9967, Precision: 0.9906, Recall: 0.9952, F1: 0.9929
Epoch 11/30
Training - Loss: 49.8075
Training Metrics: {'accuracy': 0.9996008211678832, 'precision': 0.9995008734435429, 'recall': 0.9987867952291472, 'f1': 0.9991434673968183}
Validation Metrics: {'accuracy': 0.9967094065584932, 'precision': 0.9906222590331544, 'recall': 0.9952155947742174, 'f1': 0.9929035667589703}
Epoch 12/30, Step 0/1,Classification Loss: 0.3155, Contrastive Loss: 0.0446
Epoch 12/30, Step 20/1,Classification Loss: 0.3228, Contrastive Loss: 0.0449
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0439
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0424
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0419
Epoch 12/30, Step 100/1,Classification Loss: 0.3294, Contrastive Loss: 0.0580
Epoch 12/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0545
Accuracy: 0.9996, Precision: 0.9993, Recall: 0.9989, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9905, Recall: 0.9948, F1: 0.9927
Epoch 12/30
Training - Loss: 49.3217
Training Metrics: {'accuracy': 0.9995723083941606, 'precision': 0.999309943614634, 'recall': 0.998868410308295, 'f1': 0.9990890360569964}
Validation Metrics: {'accuracy': 0.9965959378191308, 'precision': 0.9905493086762295, 'recall': 0.9947893373147119, 'f1': 0.9926562298969189}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0407
Epoch 13/30, Step 20/1,Classification Loss: 0.3449, Contrastive Loss: 0.0505
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0395
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0391
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0386
Epoch 13/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0535
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0377
Accuracy: 0.9995, Precision: 0.9994, Recall: 0.9983, F1: 0.9988
Accuracy: 0.9966, Precision: 0.9909, Recall: 0.9944, F1: 0.9927
Epoch 13/30
Training - Loss: 48.7080
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9994216399846187, 'recall': 0.9982785824735768, 'f1': 0.9988491649013276}
Validation Metrics: {'accuracy': 0.9965959378191308, 'precision': 0.9908916066290802, 'recall': 0.9944285248813844, 'f1': 0.9926509584691179}
Epoch 14/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0459
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0370
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0362
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0356
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0347
Accuracy: 0.9995, Precision: 0.9995, Recall: 0.9986, F1: 0.9990
Accuracy: 0.9965, Precision: 0.9901, Recall: 0.9947, F1: 0.9924
Epoch 14/30
Training - Loss: 48.2761
Training Metrics: {'accuracy': 0.9995437956204379, 'precision': 0.9994682903272645, 'recall': 0.9985775110073039, 'f1': 0.9990223290911726}
Validation Metrics: {'accuracy': 0.9964824690797686, 'precision': 0.9901351172976275, 'recall': 0.9947238922885339, 'f1': 0.9924141575699337}
Epoch 15/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0381
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Epoch 15/30, Step 100/1,Classification Loss: 0.3295, Contrastive Loss: 0.0429
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0325
Accuracy: 0.9997, Precision: 0.9994, Recall: 0.9991, F1: 0.9993
Accuracy: 0.9970, Precision: 0.9919, Recall: 0.9954, F1: 0.9936
Epoch 15/30
Training - Loss: 48.1238
Training Metrics: {'accuracy': 0.9996578467153284, 'precision': 0.9994473668165268, 'recall': 0.9990933345180747, 'f1': 0.9992702601839819}
Validation Metrics: {'accuracy': 0.99704981277658, 'precision': 0.991867976765648, 'recall': 0.9954119298527515, 'f1': 0.9936308306732354}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0318
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 16/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0488
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9966, Precision: 0.9902, Recall: 0.9952, F1: 0.9927
Epoch 16/30
Training - Loss: 47.5939
Training Metrics: {'accuracy': 0.9995723083941606, 'precision': 0.9994016472868217, 'recall': 0.9987897523061924, 'f1': 0.99909542807239}
Validation Metrics: {'accuracy': 0.9965959378191308, 'precision': 0.9902084188110951, 'recall': 0.9951501497480394, 'f1': 0.9926614921382845}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0294
Epoch 17/30, Step 20/1,Classification Loss: 0.3444, Contrastive Loss: 0.1082
Epoch 17/30, Step 40/1,Classification Loss: 0.3207, Contrastive Loss: 0.0302
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 17/30, Step 120/1,Classification Loss: 0.3152, Contrastive Loss: 0.0292
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9987, F1: 0.9991
Accuracy: 0.9968, Precision: 0.9910, Recall: 0.9953, F1: 0.9931
Epoch 17/30
Training - Loss: 47.3506
Training Metrics: {'accuracy': 0.9995723083941606, 'precision': 0.999486932540237, 'recall': 0.9986923745573357, 'f1': 0.9990891972041533}
Validation Metrics: {'accuracy': 0.9968228752978554, 'precision': 0.9910367975856217, 'recall': 0.9952810398003955, 'f1': 0.9931458145704577}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0270
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0268
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0265
Epoch 18/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0368
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Accuracy: 0.9995, Precision: 0.9995, Recall: 0.9986, F1: 0.9990
Accuracy: 0.9968, Precision: 0.9917, Recall: 0.9946, F1: 0.9931
Epoch 18/30
Training - Loss: 47.1203
Training Metrics: {'accuracy': 0.9995437956204379, 'precision': 0.9994665335016266, 'recall': 0.9985690952414331, 'f1': 0.9990172359199823}
Validation Metrics: {'accuracy': 0.9968228752978554, 'precision': 0.9917242032744166, 'recall': 0.9945594149337404, 'f1': 0.9931359659761279}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0255
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9987, F1: 0.9991
Accuracy: 0.9968, Precision: 0.9917, Recall: 0.9946, F1: 0.9931
Epoch 19/30
Training - Loss: 46.8007
Training Metrics: {'accuracy': 0.9995723083941606, 'precision': 0.9994861544002887, 'recall': 0.998688956837155, 'f1': 0.9990870968453349}
Validation Metrics: {'accuracy': 0.9968228752978554, 'precision': 0.9917242032744166, 'recall': 0.9945594149337404, 'f1': 0.9931359659761279}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0238
Epoch 20/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0370
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Accuracy: 0.9995, Precision: 0.9994, Recall: 0.9984, F1: 0.9989
Accuracy: 0.9968, Precision: 0.9924, Recall: 0.9938, F1: 0.9931
Epoch 20/30
Training - Loss: 46.6858
Training Metrics: {'accuracy': 0.9994867700729927, 'precision': 0.9994344498671616, 'recall': 0.9983619317614497, 'f1': 0.9988973631599449}
Validation Metrics: {'accuracy': 0.9968228752978554, 'precision': 0.9924173069211573, 'recall': 0.9938377900670854, 'f1': 0.9931260829113113}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Accuracy: 0.9995, Precision: 0.9994, Recall: 0.9983, F1: 0.9988
Accuracy: 0.9967, Precision: 0.9917, Recall: 0.9941, F1: 0.9929
Epoch 21/30
Training - Loss: 46.4728
Training Metrics: {'accuracy': 0.9994582572992701, 'precision': 0.9994181003317812, 'recall': 0.9982570932475411, 'f1': 0.99883662654625}
Validation Metrics: {'accuracy': 0.9967094065584932, 'precision': 0.99165232587316, 'recall': 0.9941331574742349, 'f1': 0.9928882662500975}
Epoch 22/30, Step 0/1,Classification Loss: 0.3256, Contrastive Loss: 0.0278
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Accuracy: 0.9996, Precision: 0.9994, Recall: 0.9990, F1: 0.9992
Accuracy: 0.9967, Precision: 0.9906, Recall: 0.9952, F1: 0.9929
Epoch 22/30
Training - Loss: 46.4029
Training Metrics: {'accuracy': 0.9996293339416058, 'precision': 0.9994318754412088, 'recall': 0.9989907970868213, 'f1': 0.9992111956174714}
Validation Metrics: {'accuracy': 0.9967094065584932, 'precision': 0.9906222590331544, 'recall': 0.9952155947742174, 'f1': 0.9929035667589703}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 23/30, Step 40/1,Classification Loss: 0.3244, Contrastive Loss: 0.0281
Epoch 23/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0206
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 23/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0280
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Accuracy: 0.9994, Precision: 0.9992, Recall: 0.9982, F1: 0.9987
Accuracy: 0.9972, Precision: 0.9937, Recall: 0.9940, F1: 0.9939
Epoch 23/30
Training - Loss: 46.0444
Training Metrics: {'accuracy': 0.9994012317518248, 'precision': 0.9992076947651323, 'recall': 0.9982298150815921, 'f1': 0.9987180652342736}
Validation Metrics: {'accuracy': 0.9971632815159424, 'precision': 0.9936779299626479, 'recall': 0.9940341251456194, 'f1': 0.9938559356123804}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 24/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0335
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Accuracy: 0.9994, Precision: 0.9994, Recall: 0.9982, F1: 0.9988
Accuracy: 0.9968, Precision: 0.9921, Recall: 0.9942, F1: 0.9931
Epoch 24/30
Training - Loss: 45.9966
Training Metrics: {'accuracy': 0.9994297445255474, 'precision': 0.9994053080437353, 'recall': 0.9981755664444918, 'f1': 0.9987893413992358}
Validation Metrics: {'accuracy': 0.9968228752978554, 'precision': 0.9920700393289874, 'recall': 0.9941986025004128, 'f1': 0.993131028763476}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 25/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0201
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9968, Precision: 0.9931, Recall: 0.9931, F1: 0.9931
Epoch 25/30
Training - Loss: 46.1474
Training Metrics: {'accuracy': 0.9996008211678832, 'precision': 0.9995017914580523, 'recall': 0.9987904528389439, 'f1': 0.9991457574640008}
Validation Metrics: {'accuracy': 0.9968228752978554, 'precision': 0.9931161652004303, 'recall': 0.9931161652004303, 'f1': 0.9931161652004303}
Epoch 26/30, Step 0/1,Classification Loss: 0.3336, Contrastive Loss: 0.0386
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Accuracy: 0.9993, Precision: 0.9993, Recall: 0.9978, F1: 0.9985
Accuracy: 0.9973, Precision: 0.9941, Recall: 0.9941, F1: 0.9941
Epoch 26/30
Training - Loss: 45.8487
Training Metrics: {'accuracy': 0.999315693430657, 'precision': 0.9993387500025535, 'recall': 0.9977552021388327, 'f1': 0.9985451594181224}
Validation Metrics: {'accuracy': 0.9972767502553047, 'precision': 0.9940995701717974, 'recall': 0.9940995701717974, 'f1': 0.9940995701717974}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 27/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0177
Accuracy: 0.9995, Precision: 0.9995, Recall: 0.9985, F1: 0.9990
Accuracy: 0.9968, Precision: 0.9921, Recall: 0.9942, F1: 0.9931
Epoch 27/30
Training - Loss: 45.8739
Training Metrics: {'accuracy': 0.9995152828467153, 'precision': 0.9994517551471074, 'recall': 0.9984718920803921, 'f1': 0.9989611319361622}
Validation Metrics: {'accuracy': 0.9968228752978554, 'precision': 0.9920700393289874, 'recall': 0.9941986025004128, 'f1': 0.993131028763476}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 28/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0304
Accuracy: 0.9997, Precision: 0.9995, Recall: 0.9990, F1: 0.9993
Accuracy: 0.9966, Precision: 0.9899, Recall: 0.9955, F1: 0.9927
Epoch 28/30
Training - Loss: 45.7629
Training Metrics: {'accuracy': 0.9996578467153284, 'precision': 0.9995370905528724, 'recall': 0.9990084730628204, 'f1': 0.9992725797090611}
Validation Metrics: {'accuracy': 0.9965959378191308, 'precision': 0.9898689301281333, 'recall': 0.9955109621813669, 'f1': 0.9926667452164513}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 29/30, Step 100/1,Classification Loss: 0.3270, Contrastive Loss: 0.0220
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Accuracy: 0.9996, Precision: 0.9995, Recall: 0.9988, F1: 0.9991
Accuracy: 0.9970, Precision: 0.9922, Recall: 0.9951, F1: 0.9936
Epoch 29/30
Training - Loss: 45.9100
Training Metrics: {'accuracy': 0.9996008211678832, 'precision': 0.9995014250302467, 'recall': 0.9987889925973765, 'f1': 0.9991448432298857}
Validation Metrics: {'accuracy': 0.99704981277658, 'precision': 0.9922130869266532, 'recall': 0.9950511174194239, 'f1': 0.9936262541206902}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Accuracy: 0.9994, Precision: 0.9994, Recall: 0.9982, F1: 0.9988
Accuracy: 0.9970, Precision: 0.9943, Recall: 0.9929, F1: 0.9936
Epoch 30/30
Training - Loss: 45.7236
Training Metrics: {'accuracy': 0.9994297445255474, 'precision': 0.9994030818793477, 'recall': 0.9981610572834038, 'f1': 0.9987809561690135}
Validation Metrics: {'accuracy': 0.99704981277658, 'precision': 0.9943139623421916, 'recall': 0.9928862428194587, 'f1': 0.9935986260476566}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1990, 5814), y shape: (1990,), y distribution: Counter({np.float64(0.0): 1791, np.float64(1.0): 199}), env shape: (1990,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9628, Precision: 0.8700, Recall: 0.9592, F1: 0.9080
month: 2019-06, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1975, 5814), y shape: (1975,), y distribution: Counter({np.float64(0.0): 1780, np.float64(1.0): 195}), env shape: (1975,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9241, Precision: 0.7811, Recall: 0.9213, F1: 0.8306
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10015]))
original train data shape: torch.Size([44162]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1975, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44162]), new train data shape: torch.Size([44162])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10015]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.6245
Epoch 1/30, Step 20/1,Classification Loss: 0.3266, Contrastive Loss: 0.9425
Epoch 1/30, Step 40/1,Classification Loss: 0.3446, Contrastive Loss: 0.4463
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2551
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2018
Epoch 1/30, Step 100/1,Classification Loss: 0.3140, Contrastive Loss: 0.1761
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1563
Accuracy: 0.9984, Precision: 0.9955, Recall: 0.9978, F1: 0.9966
Accuracy: 0.9964, Precision: 0.9901, Recall: 0.9943, F1: 0.9922
Epoch 1/30
Training - Loss: 105.7594
Training Metrics: {'accuracy': 0.9984148550724637, 'precision': 0.9954799607559774, 'recall': 0.9977568175334995, 'f1': 0.996614626603394}
Validation Metrics: {'accuracy': 0.996377221781954, 'precision': 0.9901021091414454, 'recall': 0.9943185485257148, 'f1': 0.9921973548918248}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1479
Epoch 2/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1522
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1314
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1266
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1223
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1201
Epoch 2/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.1184
Accuracy: 0.9984, Precision: 0.9953, Recall: 0.9980, F1: 0.9967
Accuracy: 0.9959, Precision: 0.9878, Recall: 0.9948, F1: 0.9912
Epoch 2/30
Training - Loss: 62.9632
Training Metrics: {'accuracy': 0.998443161231884, 'precision': 0.9953363070326184, 'recall': 0.9980414383769556, 'f1': 0.9966835546158793}
Validation Metrics: {'accuracy': 0.9959243745046983, 'precision': 0.9877899533494483, 'recall': 0.9947755442418651, 'f1': 0.9912470023980815}
Epoch 3/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.1253
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1129
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1078
Epoch 3/30, Step 60/1,Classification Loss: 0.3303, Contrastive Loss: 0.1286
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1024
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1003
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0981
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9985, F1: 0.9976
Accuracy: 0.9962, Precision: 0.9900, Recall: 0.9935, F1: 0.9917
Epoch 3/30
Training - Loss: 59.7681
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9967086310516635, 'recall': 0.9984621326059467, 'f1': 0.9975831545213385}
Validation Metrics: {'accuracy': 0.9961507981433262, 'precision': 0.9899559140566334, 'recall': 0.9934696520910797, 'f1': 0.9917037663191509}
Epoch 4/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1125
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0945
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0926
Epoch 4/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1058
Epoch 4/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1042
Epoch 4/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.1228
Epoch 4/30, Step 120/1,Classification Loss: 0.3602, Contrastive Loss: 0.1348
Accuracy: 0.9988, Precision: 0.9965, Recall: 0.9983, F1: 0.9974
Accuracy: 0.9964, Precision: 0.9904, Recall: 0.9940, F1: 0.9922
Epoch 4/30
Training - Loss: 57.1965
Training Metrics: {'accuracy': 0.9987828351449275, 'precision': 0.9964622264251857, 'recall': 0.9983174914503015, 'f1': 0.997387372430445}
Validation Metrics: {'accuracy': 0.996377221781954, 'precision': 0.9904421917011845, 'recall': 0.9939594170948114, 'f1': 0.9921917800650832}
Epoch 5/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1468
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0830
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0817
Epoch 5/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1152
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0789
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0777
Epoch 5/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.0809
Accuracy: 0.9988, Precision: 0.9965, Recall: 0.9983, F1: 0.9974
Accuracy: 0.9966, Precision: 0.9909, Recall: 0.9944, F1: 0.9927
Epoch 5/30
Training - Loss: 55.8298
Training Metrics: {'accuracy': 0.9987828351449275, 'precision': 0.9965070309060079, 'recall': 0.9983320475098737, 'f1': 0.9974171173441579}
Validation Metrics: {'accuracy': 0.9966036454205819, 'precision': 0.9909284693457355, 'recall': 0.994449182098543, 'f1': 0.9926797938110155}
Epoch 6/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0896
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0742
Epoch 6/30, Step 40/1,Classification Loss: 0.3281, Contrastive Loss: 0.0803
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0720
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0717
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0704
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0692
Accuracy: 0.9986, Precision: 0.9961, Recall: 0.9979, F1: 0.9970
Accuracy: 0.9964, Precision: 0.9904, Recall: 0.9940, F1: 0.9922
Epoch 6/30
Training - Loss: 54.6386
Training Metrics: {'accuracy': 0.9985846920289855, 'precision': 0.9961137433179978, 'recall': 0.9978602565077959, 'f1': 0.9969847847774401}
Validation Metrics: {'accuracy': 0.996377221781954, 'precision': 0.9904421917011845, 'recall': 0.9939594170948114, 'f1': 0.9921917800650832}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0681
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0680
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0664
Epoch 7/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0808
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0646
Epoch 7/30, Step 100/1,Classification Loss: 0.3319, Contrastive Loss: 0.0799
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0630
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9986, F1: 0.9976
Accuracy: 0.9964, Precision: 0.9901, Recall: 0.9943, F1: 0.9922
Epoch 7/30
Training - Loss: 53.8652
Training Metrics: {'accuracy': 0.9988960597826086, 'precision': 0.9967008693713975, 'recall': 0.9985598758398742, 'f1': 0.9976278789632004}
Validation Metrics: {'accuracy': 0.996377221781954, 'precision': 0.9901021091414454, 'recall': 0.9943185485257148, 'f1': 0.9921973548918248}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0627
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0614
Epoch 8/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0745
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0620
Epoch 8/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0597
Epoch 8/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0728
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0579
Accuracy: 0.9986, Precision: 0.9964, Recall: 0.9977, F1: 0.9970
Accuracy: 0.9962, Precision: 0.9910, Recall: 0.9924, F1: 0.9917
Epoch 8/30
Training - Loss: 52.6906
Training Metrics: {'accuracy': 0.9986129981884058, 'precision': 0.9963937070805975, 'recall': 0.9977025915645568, 'f1': 0.9970469049443442}
Validation Metrics: {'accuracy': 0.9961507981433262, 'precision': 0.9909825109399233, 'recall': 0.9923922577983697, 'f1': 0.9916859346174205}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0571
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0562
Epoch 9/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0715
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0549
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0548
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0536
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0531
Accuracy: 0.9989, Precision: 0.9968, Recall: 0.9985, F1: 0.9977
Accuracy: 0.9960, Precision: 0.9892, Recall: 0.9938, F1: 0.9915
Epoch 9/30
Training - Loss: 52.1227
Training Metrics: {'accuracy': 0.9988960597826086, 'precision': 0.9968346004721192, 'recall': 0.9984857704343153, 'f1': 0.997658203717366}
Validation Metrics: {'accuracy': 0.9960375863240122, 'precision': 0.9892047263663554, 'recall': 0.993763466735569, 'f1': 0.9914689016761771}
Epoch 10/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0540
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0518
Epoch 10/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0518
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0508
Epoch 10/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0520
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0497
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0489
Accuracy: 0.9988, Precision: 0.9967, Recall: 0.9983, F1: 0.9975
Accuracy: 0.9960, Precision: 0.9889, Recall: 0.9941, F1: 0.9915
Epoch 10/30
Training - Loss: 51.7201
Training Metrics: {'accuracy': 0.9988111413043478, 'precision': 0.9966938517483394, 'recall': 0.9982601117582774, 'f1': 0.9974751990188953}
Validation Metrics: {'accuracy': 0.9960375863240122, 'precision': 0.9888677626468536, 'recall': 0.9941225981664724, 'f1': 0.9914749832790768}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0496
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0489
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0474
Epoch 11/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0621
Epoch 11/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1073
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0464
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0452
Accuracy: 0.9988, Precision: 0.9967, Recall: 0.9982, F1: 0.9974
Accuracy: 0.9958, Precision: 0.9884, Recall: 0.9936, F1: 0.9910
Epoch 11/30
Training - Loss: 51.2269
Training Metrics: {'accuracy': 0.9988111413043478, 'precision': 0.9967449340337808, 'recall': 0.9981573818121732, 'f1': 0.9974497164220293}
Validation Metrics: {'accuracy': 0.9958111626853844, 'precision': 0.9883832061370209, 'recall': 0.9936328331627409, 'f1': 0.9909878394664526}
Epoch 12/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0450
Epoch 12/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0573
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0438
Epoch 12/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0574
Epoch 12/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.0457
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Accuracy: 0.9988, Precision: 0.9967, Recall: 0.9984, F1: 0.9975
Accuracy: 0.9960, Precision: 0.9895, Recall: 0.9934, F1: 0.9915
Epoch 12/30
Training - Loss: 50.5054
Training Metrics: {'accuracy': 0.9988394474637681, 'precision': 0.996672744627893, 'recall': 0.9983508728614012, 'f1': 0.9975097745459767}
Validation Metrics: {'accuracy': 0.9960375863240122, 'precision': 0.9895430773719852, 'recall': 0.9934043353046657, 'f1': 0.9914628095040493}
Epoch 13/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0710
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0412
Epoch 13/30, Step 40/1,Classification Loss: 0.3237, Contrastive Loss: 0.0510
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0406
Epoch 13/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0559
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0401
Epoch 13/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0394
Accuracy: 0.9988, Precision: 0.9964, Recall: 0.9984, F1: 0.9974
Accuracy: 0.9962, Precision: 0.9896, Recall: 0.9938, F1: 0.9917
Epoch 13/30
Training - Loss: 50.2915
Training Metrics: {'accuracy': 0.9987828351449275, 'precision': 0.9964072238462698, 'recall': 0.9984156479570013, 'f1': 0.9974085084205471}
Validation Metrics: {'accuracy': 0.9961507981433262, 'precision': 0.9896165217362622, 'recall': 0.9938287835219831, 'f1': 0.9917096895725638}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0385
Epoch 14/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0536
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0376
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0372
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0364
Epoch 14/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0501
Accuracy: 0.9989, Precision: 0.9969, Recall: 0.9984, F1: 0.9976
Accuracy: 0.9960, Precision: 0.9892, Recall: 0.9938, F1: 0.9915
Epoch 14/30
Training - Loss: 49.6323
Training Metrics: {'accuracy': 0.9988960597826086, 'precision': 0.9969001589999189, 'recall': 0.9983906256101513, 'f1': 0.997643783238093}
Validation Metrics: {'accuracy': 0.9960375863240122, 'precision': 0.9892047263663554, 'recall': 0.993763466735569, 'f1': 0.9914689016761771}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0357
Epoch 15/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0817
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Epoch 15/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0642
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0336
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9985, F1: 0.9976
Accuracy: 0.9962, Precision: 0.9903, Recall: 0.9931, F1: 0.9917
Epoch 15/30
Training - Loss: 49.4349
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9967002000421159, 'recall': 0.9984594840422103, 'f1': 0.9975776029480177}
Validation Metrics: {'accuracy': 0.9961507981433262, 'precision': 0.9902967050972385, 'recall': 0.9931105206601764, 'f1': 0.9916978327595499}
Epoch 16/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0486
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0329
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0326
Epoch 16/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0469
Epoch 16/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0476
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0314
Accuracy: 0.9988, Precision: 0.9964, Recall: 0.9985, F1: 0.9975
Accuracy: 0.9962, Precision: 0.9893, Recall: 0.9942, F1: 0.9917
Epoch 16/30
Training - Loss: 49.0475
Training Metrics: {'accuracy': 0.9988111413043478, 'precision': 0.9964193568733009, 'recall': 0.9985188022162268, 'f1': 0.9974658832481454}
Validation Metrics: {'accuracy': 0.9961507981433262, 'precision': 0.9892785212940785, 'recall': 0.9941879149528865, 'f1': 0.9917156025457692}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 17/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0472
Epoch 17/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0440
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Epoch 17/30, Step 100/1,Classification Loss: 0.3140, Contrastive Loss: 0.0305
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Accuracy: 0.9989, Precision: 0.9965, Recall: 0.9986, F1: 0.9976
Accuracy: 0.9958, Precision: 0.9884, Recall: 0.9936, F1: 0.9910
Epoch 17/30
Training - Loss: 48.9131
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.996530108910012, 'recall': 0.9986375136160792, 'f1': 0.9975805961178867}
Validation Metrics: {'accuracy': 0.9958111626853844, 'precision': 0.9883832061370209, 'recall': 0.9936328331627409, 'f1': 0.9909878394664526}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0299
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0310
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0435
Epoch 18/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0281
Epoch 18/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0446
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9986, F1: 0.9976
Accuracy: 0.9959, Precision: 0.9891, Recall: 0.9933, F1: 0.9912
Epoch 18/30
Training - Loss: 48.4391
Training Metrics: {'accuracy': 0.9988960597826086, 'precision': 0.9967353293918173, 'recall': 0.998569531497651, 'f1': 0.9976499899429799}
Validation Metrics: {'accuracy': 0.9959243745046983, 'precision': 0.989130934331079, 'recall': 0.9933390185182516, 'f1': 0.9912220242533029}
Epoch 19/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0411
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0304
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 19/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0392
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 19/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0822
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Accuracy: 0.9990, Precision: 0.9967, Recall: 0.9989, F1: 0.9978
Accuracy: 0.9959, Precision: 0.9885, Recall: 0.9941, F1: 0.9912
Epoch 19/30
Training - Loss: 48.2185
Training Metrics: {'accuracy': 0.9989526721014492, 'precision': 0.9966752387469011, 'recall': 0.9988648720258565, 'f1': 0.9977665818872243}
Validation Metrics: {'accuracy': 0.9959243745046983, 'precision': 0.9884576918716723, 'recall': 0.9940572813800583, 'f1': 0.9912345349861104}
Epoch 20/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0401
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 20/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0261
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0247
Epoch 20/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0410
Epoch 20/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0388
Accuracy: 0.9989, Precision: 0.9968, Recall: 0.9986, F1: 0.9977
Accuracy: 0.9956, Precision: 0.9879, Recall: 0.9931, F1: 0.9905
Epoch 20/30
Training - Loss: 47.8479
Training Metrics: {'accuracy': 0.9989243659420289, 'precision': 0.9968305114575118, 'recall': 0.9985835515890823, 'f1': 0.9977048055633517}
Validation Metrics: {'accuracy': 0.9955847390467565, 'precision': 0.9878986496271882, 'recall': 0.9931430681590092, 'f1': 0.9905006956538285}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0238
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 21/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0359
Accuracy: 0.9989, Precision: 0.9966, Recall: 0.9985, F1: 0.9976
Accuracy: 0.9955, Precision: 0.9865, Recall: 0.9942, F1: 0.9903
Epoch 21/30
Training - Loss: 47.8499
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.996601909764925, 'recall': 0.9985449990372199, 'f1': 0.997570727380457}
Validation Metrics: {'accuracy': 0.9954715272274426, 'precision': 0.986493787938338, 'recall': 0.9941551456653053, 'f1': 0.9902813554741945}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9987, F1: 0.9977
Accuracy: 0.9954, Precision: 0.9884, Recall: 0.9916, F1: 0.9900
Epoch 22/30
Training - Loss: 47.5667
Training Metrics: {'accuracy': 0.9989243659420289, 'precision': 0.9967368420340088, 'recall': 0.9986700762038943, 'f1': 0.9977007547549839}
Validation Metrics: {'accuracy': 0.9953583154081286, 'precision': 0.988422951492331, 'recall': 0.9915759088625675, 'f1': 0.9899921421764499}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0221
Epoch 23/30, Step 80/1,Classification Loss: 0.3157, Contrastive Loss: 0.0218
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 23/30, Step 120/1,Classification Loss: 0.3277, Contrastive Loss: 0.0246
Accuracy: 0.9988, Precision: 0.9967, Recall: 0.9983, F1: 0.9975
Accuracy: 0.9959, Precision: 0.9891, Recall: 0.9933, F1: 0.9912
Epoch 23/30
Training - Loss: 47.4604
Training Metrics: {'accuracy': 0.9988111413043478, 'precision': 0.9967090902003586, 'recall': 0.9982659284449565, 'f1': 0.9974857436921393}
Validation Metrics: {'accuracy': 0.9959243745046983, 'precision': 0.989130934331079, 'recall': 0.9933390185182516, 'f1': 0.9912220242533029}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Accuracy: 0.9989, Precision: 0.9965, Recall: 0.9986, F1: 0.9976
Accuracy: 0.9952, Precision: 0.9877, Recall: 0.9919, F1: 0.9898
Epoch 24/30
Training - Loss: 47.4045
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9965259488122964, 'recall': 0.9986365593632968, 'f1': 0.9975780310966876}
Validation Metrics: {'accuracy': 0.9952451035888147, 'precision': 0.9876741721155294, 'recall': 0.9918697235070568, 'f1': 0.98975902829552}
Epoch 25/30, Step 0/1,Classification Loss: 0.3155, Contrastive Loss: 0.0232
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 25/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0340
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 25/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0469
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9985, F1: 0.9976
Accuracy: 0.9958, Precision: 0.9884, Recall: 0.9936, F1: 0.9910
Epoch 25/30
Training - Loss: 47.2287
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9967086310516635, 'recall': 0.9984621326059467, 'f1': 0.9975831545213385}
Validation Metrics: {'accuracy': 0.9958111626853844, 'precision': 0.9883832061370209, 'recall': 0.9936328331627409, 'f1': 0.9909878394664526}
Epoch 26/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0316
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0327
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Accuracy: 0.9989, Precision: 0.9968, Recall: 0.9985, F1: 0.9977
Accuracy: 0.9957, Precision: 0.9890, Recall: 0.9925, F1: 0.9907
Epoch 26/30
Training - Loss: 47.0221
Training Metrics: {'accuracy': 0.9988960597826086, 'precision': 0.9968358317840467, 'recall': 0.9984861709768698, 'f1': 0.9976590212378929}
Validation Metrics: {'accuracy': 0.9956979508660704, 'precision': 0.9889833587675314, 'recall': 0.9924901220836166, 'f1': 0.9907277388272864}
Epoch 27/30, Step 0/1,Classification Loss: 0.3295, Contrastive Loss: 0.0356
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0320
Epoch 27/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0336
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Accuracy: 0.9988, Precision: 0.9964, Recall: 0.9986, F1: 0.9975
Accuracy: 0.9957, Precision: 0.9886, Recall: 0.9928, F1: 0.9907
Epoch 27/30
Training - Loss: 47.1936
Training Metrics: {'accuracy': 0.9988111413043478, 'precision': 0.9963600073897962, 'recall': 0.998612739646473, 'f1': 0.9974826793048095}
Validation Metrics: {'accuracy': 0.9956979508660704, 'precision': 0.9886453469258958, 'recall': 0.9928492535145199, 'f1': 0.9907343589340419}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 28/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0321
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0469
Accuracy: 0.9988, Precision: 0.9966, Recall: 0.9981, F1: 0.9973
Accuracy: 0.9959, Precision: 0.9891, Recall: 0.9933, F1: 0.9912
Epoch 28/30
Training - Loss: 47.1586
Training Metrics: {'accuracy': 0.9987545289855072, 'precision': 0.9965585796742658, 'recall': 0.9981335722526585, 'f1': 0.9973442769649705}
Validation Metrics: {'accuracy': 0.9959243745046983, 'precision': 0.989130934331079, 'recall': 0.9933390185182516, 'f1': 0.9912220242533029}
Epoch 29/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0432
Epoch 29/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0222
Epoch 29/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0340
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Accuracy: 0.9988, Precision: 0.9967, Recall: 0.9982, F1: 0.9975
Accuracy: 0.9960, Precision: 0.9892, Recall: 0.9938, F1: 0.9915
Epoch 29/30
Training - Loss: 46.8074
Training Metrics: {'accuracy': 0.9988111413043478, 'precision': 0.9966576917671035, 'recall': 0.9982462933447164, 'f1': 0.9974501688988836}
Validation Metrics: {'accuracy': 0.9960375863240122, 'precision': 0.9892047263663554, 'recall': 0.993763466735569, 'f1': 0.9914689016761771}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 20/1,Classification Loss: 0.3219, Contrastive Loss: 0.0223
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 60/1,Classification Loss: 0.3398, Contrastive Loss: 0.0341
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9988, Precision: 0.9967, Recall: 0.9984, F1: 0.9975
Accuracy: 0.9958, Precision: 0.9877, Recall: 0.9944, F1: 0.9910
Epoch 30/30
Training - Loss: 46.9317
Training Metrics: {'accuracy': 0.9988394474637681, 'precision': 0.9966883725140149, 'recall': 0.9983563159590825, 'f1': 0.9975203298098583}
Validation Metrics: {'accuracy': 0.9958111626853844, 'precision': 0.9877147797904049, 'recall': 0.9943510960245476, 'f1': 0.9910006643054566}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1983, 5814), y shape: (1983,), y distribution: Counter({np.float64(0.0): 1787, np.float64(1.0): 196}), env shape: (1983,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9324, Precision: 0.7971, Recall: 0.9353, F1: 0.8472
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10115]))
original train data shape: torch.Size([44262]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1983, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44262]), new train data shape: torch.Size([44262])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10115]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.5782
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.6615
Epoch 1/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.2934
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1900
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1558
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1384
Epoch 1/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1403
Accuracy: 0.9984, Precision: 0.9961, Recall: 0.9971, F1: 0.9966
Accuracy: 0.9967, Precision: 0.9914, Recall: 0.9945, F1: 0.9929
Epoch 1/30
Training - Loss: 93.2576
Training Metrics: {'accuracy': 0.9984148550724637, 'precision': 0.9960768227184882, 'recall': 0.9971324710958961, 'f1': 0.9966038395430367}
Validation Metrics: {'accuracy': 0.9967242742573139, 'precision': 0.9913709385254983, 'recall': 0.9945314511043306, 'f1': 0.992943918502708}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1205
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1147
Epoch 2/30, Step 40/1,Classification Loss: 0.3194, Contrastive Loss: 0.1166
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1079
Epoch 2/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1180
Epoch 2/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1151
Epoch 2/30, Step 120/1,Classification Loss: 0.3139, Contrastive Loss: 0.1001
Accuracy: 0.9979, Precision: 0.9960, Recall: 0.9952, F1: 0.9956
Accuracy: 0.9963, Precision: 0.9928, Recall: 0.9911, F1: 0.9919
Epoch 2/30
Training - Loss: 60.0706
Training Metrics: {'accuracy': 0.9979336503623188, 'precision': 0.9959857091423336, 'recall': 0.9952006900549353, 'f1': 0.9955927509175595}
Validation Metrics: {'accuracy': 0.9962724500169434, 'precision': 0.9928150525332907, 'recall': 0.991050247255965, 'f1': 0.9919303821200189}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0972
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0961
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0948
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0916
Epoch 3/30, Step 80/1,Classification Loss: 0.3297, Contrastive Loss: 0.1313
Epoch 3/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1042
Epoch 3/30, Step 120/1,Classification Loss: 0.3202, Contrastive Loss: 0.0883
Accuracy: 0.9986, Precision: 0.9962, Recall: 0.9980, F1: 0.9971
Accuracy: 0.9973, Precision: 0.9931, Recall: 0.9952, F1: 0.9942
Epoch 3/30
Training - Loss: 57.4867
Training Metrics: {'accuracy': 0.998641304347826, 'precision': 0.9962421319919199, 'recall': 0.9979842294263073, 'f1': 0.9971109749369225}
Validation Metrics: {'accuracy': 0.997289054557777, 'precision': 0.9930997845381406, 'recall': 0.9952151851491575, 'f1': 0.9941542362473009}
Epoch 4/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1005
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0839
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0827
Epoch 4/30, Step 60/1,Classification Loss: 0.3444, Contrastive Loss: 0.0939
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0803
Epoch 4/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0931
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0771
Accuracy: 0.9985, Precision: 0.9959, Recall: 0.9978, F1: 0.9969
Accuracy: 0.9973, Precision: 0.9931, Recall: 0.9952, F1: 0.9942
Epoch 4/30
Training - Loss: 56.1957
Training Metrics: {'accuracy': 0.9985280797101449, 'precision': 0.9959033341695007, 'recall': 0.9978259746228019, 'f1': 0.9968619702925617}
Validation Metrics: {'accuracy': 0.997289054557777, 'precision': 0.9930997845381406, 'recall': 0.9952151851491575, 'f1': 0.9941542362473009}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0773
Epoch 5/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0787
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0738
Epoch 5/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0859
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0719
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0706
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0695
Accuracy: 0.9988, Precision: 0.9964, Recall: 0.9983, F1: 0.9973
Accuracy: 0.9968, Precision: 0.9918, Recall: 0.9946, F1: 0.9932
Epoch 5/30
Training - Loss: 55.1833
Training Metrics: {'accuracy': 0.9987545289855072, 'precision': 0.9963908389989766, 'recall': 0.9983114640973682, 'f1': 0.997348473913372}
Validation Metrics: {'accuracy': 0.9968372303174066, 'precision': 0.9917844888183645, 'recall': 0.9945966316544544, 'f1': 0.9931848039747226}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0685
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0691
Epoch 6/30, Step 40/1,Classification Loss: 0.3221, Contrastive Loss: 0.0684
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0686
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0647
Epoch 6/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0792
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0641
Accuracy: 0.9988, Precision: 0.9965, Recall: 0.9982, F1: 0.9973
Accuracy: 0.9967, Precision: 0.9910, Recall: 0.9949, F1: 0.9929
Epoch 6/30
Training - Loss: 53.7645
Training Metrics: {'accuracy': 0.9987545289855072, 'precision': 0.9964680604621936, 'recall': 0.9982202671336975, 'f1': 0.9973419383082874}
Validation Metrics: {'accuracy': 0.9967242742573139, 'precision': 0.9910303029639826, 'recall': 0.9948892823985385, 'f1': 0.9929489407426988}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0625
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0614
Epoch 7/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.0886
Epoch 7/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0869
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0589
Epoch 7/30, Step 100/1,Classification Loss: 0.3188, Contrastive Loss: 0.0593
Epoch 7/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0590
Accuracy: 0.9987, Precision: 0.9965, Recall: 0.9980, F1: 0.9972
Accuracy: 0.9970, Precision: 0.9919, Recall: 0.9950, F1: 0.9934
Epoch 7/30
Training - Loss: 52.8941
Training Metrics: {'accuracy': 0.9986979166666666, 'precision': 0.9964558111157509, 'recall': 0.998020132350797, 'f1': 0.9972361918779666}
Validation Metrics: {'accuracy': 0.9969501863774991, 'precision': 0.9918560109197998, 'recall': 0.9950196434987861, 'f1': 0.9934305448128662}
Epoch 8/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.0617
Epoch 8/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0712
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0552
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0561
Epoch 8/30, Step 80/1,Classification Loss: 0.3218, Contrastive Loss: 0.0550
Epoch 8/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0706
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Accuracy: 0.9989, Precision: 0.9968, Recall: 0.9985, F1: 0.9976
Accuracy: 0.9971, Precision: 0.9923, Recall: 0.9951, F1: 0.9937
Epoch 8/30
Training - Loss: 52.1973
Training Metrics: {'accuracy': 0.9988960597826086, 'precision': 0.9968135094915472, 'recall': 0.9984789052935612, 'f1': 0.9976441982638043}
Validation Metrics: {'accuracy': 0.9970631424375918, 'precision': 0.9922699054827464, 'recall': 0.9950848240489099, 'f1': 0.993671603690814}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0518
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0516
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0509
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0502
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0494
Epoch 9/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0625
Epoch 9/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0630
Accuracy: 0.9988, Precision: 0.9965, Recall: 0.9982, F1: 0.9974
Accuracy: 0.9966, Precision: 0.9910, Recall: 0.9945, F1: 0.9927
Epoch 9/30
Training - Loss: 51.3689
Training Metrics: {'accuracy': 0.9987545289855072, 'precision': 0.9964994445398537, 'recall': 0.9982314568404693, 'f1': 0.9973632660929141}
Validation Metrics: {'accuracy': 0.9966113181972213, 'precision': 0.990958081943847, 'recall': 0.9944662705542068, 'f1': 0.9927032041832435}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0475
Epoch 10/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0616
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0465
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0458
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0452
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0459
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0441
Accuracy: 0.9988, Precision: 0.9967, Recall: 0.9982, F1: 0.9974
Accuracy: 0.9971, Precision: 0.9926, Recall: 0.9947, F1: 0.9937
Epoch 10/30
Training - Loss: 50.7641
Training Metrics: {'accuracy': 0.9987828351449275, 'precision': 0.9966742691346301, 'recall': 0.9981550129408123, 'f1': 0.9974130481600663}
Validation Metrics: {'accuracy': 0.9970631424375918, 'precision': 0.9926136775451844, 'recall': 0.9947269927547021, 'f1': 0.9936670892679094}
Epoch 11/30, Step 0/1,Classification Loss: 0.3256, Contrastive Loss: 0.0514
Epoch 11/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0577
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0425
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0415
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0410
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0413
Accuracy: 0.9988, Precision: 0.9965, Recall: 0.9983, F1: 0.9974
Accuracy: 0.9962, Precision: 0.9900, Recall: 0.9935, F1: 0.9917
Epoch 11/30
Training - Loss: 50.3424
Training Metrics: {'accuracy': 0.9987828351449275, 'precision': 0.9964719806244204, 'recall': 0.998320663179332, 'f1': 0.997393849541945}
Validation Metrics: {'accuracy': 0.9961594939568508, 'precision': 0.9899886245071131, 'recall': 0.9934898857652957, 'f1': 0.9917302980743427}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0403
Epoch 12/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0543
Epoch 12/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0552
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0386
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0383
Epoch 12/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0549
Epoch 12/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0391
Accuracy: 0.9989, Precision: 0.9966, Recall: 0.9985, F1: 0.9976
Accuracy: 0.9970, Precision: 0.9922, Recall: 0.9947, F1: 0.9934
Epoch 12/30
Training - Loss: 49.8287
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9966120324317994, 'recall': 0.9985477376141647, 'f1': 0.9975771746147153}
Validation Metrics: {'accuracy': 0.9969501863774991, 'precision': 0.9921987345728327, 'recall': 0.9946618122045783, 'f1': 0.9934258608220706}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0371
Epoch 13/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0424
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 13/30, Step 60/1,Classification Loss: 0.3240, Contrastive Loss: 0.0371
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 13/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0362
Accuracy: 0.9989, Precision: 0.9966, Recall: 0.9987, F1: 0.9977
Accuracy: 0.9965, Precision: 0.9902, Recall: 0.9948, F1: 0.9925
Epoch 13/30
Training - Loss: 49.2727
Training Metrics: {'accuracy': 0.9988960597826086, 'precision': 0.9965657739184933, 'recall': 0.9987460498046746, 'f1': 0.9976524614628857}
Validation Metrics: {'accuracy': 0.9964983621371286, 'precision': 0.9902073582907802, 'recall': 0.9947589212982907, 'f1': 0.9924680201047105}
Epoch 14/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0355
Epoch 14/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0489
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0338
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0329
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0327
Epoch 14/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0466
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9987, F1: 0.9977
Accuracy: 0.9965, Precision: 0.9902, Recall: 0.9948, F1: 0.9925
Epoch 14/30
Training - Loss: 49.0573
Training Metrics: {'accuracy': 0.9989243659420289, 'precision': 0.996740087354559, 'recall': 0.9986708750821736, 'f1': 0.9977027823380173}
Validation Metrics: {'accuracy': 0.9964983621371286, 'precision': 0.9902073582907802, 'recall': 0.9947589212982907, 'f1': 0.9924680201047105}
Epoch 15/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0350
Epoch 15/30, Step 20/1,Classification Loss: 0.3272, Contrastive Loss: 0.0344
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 15/30, Step 60/1,Classification Loss: 0.3197, Contrastive Loss: 0.0367
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 15/30, Step 120/1,Classification Loss: 0.3239, Contrastive Loss: 0.0380
Accuracy: 0.9988, Precision: 0.9964, Recall: 0.9986, F1: 0.9975
Accuracy: 0.9958, Precision: 0.9878, Recall: 0.9944, F1: 0.9910
Epoch 15/30
Training - Loss: 48.8178
Training Metrics: {'accuracy': 0.9988394474637681, 'precision': 0.9964070958526744, 'recall': 0.9986168512778585, 'f1': 0.9975084474276168}
Validation Metrics: {'accuracy': 0.9958206257765729, 'precision': 0.9877549659131417, 'recall': 0.9943678379975476, 'f1': 0.9910293410800564}
Epoch 16/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0435
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 16/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0441
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0280
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Epoch 16/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0416
Accuracy: 0.9988, Precision: 0.9965, Recall: 0.9985, F1: 0.9975
Accuracy: 0.9968, Precision: 0.9914, Recall: 0.9950, F1: 0.9932
Epoch 16/30
Training - Loss: 48.3493
Training Metrics: {'accuracy': 0.9988394474637681, 'precision': 0.9965165002233947, 'recall': 0.9985335508471447, 'f1': 0.9975220784280223}
Validation Metrics: {'accuracy': 0.9968372303174066, 'precision': 0.991442810662214, 'recall': 0.9949544629486622, 'f1': 0.9931896572376939}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Epoch 17/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0284
Epoch 17/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0411
Epoch 17/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0420
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Accuracy: 0.9990, Precision: 0.9967, Recall: 0.9989, F1: 0.9978
Accuracy: 0.9967, Precision: 0.9914, Recall: 0.9945, F1: 0.9929
Epoch 17/30
Training - Loss: 48.2616
Training Metrics: {'accuracy': 0.9989526721014492, 'precision': 0.9966779101235816, 'recall': 0.9988653305633421, 'f1': 0.9977681524640273}
Validation Metrics: {'accuracy': 0.9967242742573139, 'precision': 0.9913709385254983, 'recall': 0.9945314511043306, 'f1': 0.992943918502708}
Epoch 18/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0426
Epoch 18/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0401
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0247
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Accuracy: 0.9988, Precision: 0.9963, Recall: 0.9986, F1: 0.9974
Accuracy: 0.9962, Precision: 0.9890, Recall: 0.9946, F1: 0.9917
Epoch 18/30
Training - Loss: 47.8250
Training Metrics: {'accuracy': 0.9988111413043478, 'precision': 0.9963051600811901, 'recall': 0.9986009834855069, 'f1': 0.9974492637494798}
Validation Metrics: {'accuracy': 0.9961594939568508, 'precision': 0.9889780921610043, 'recall': 0.9945633796479192, 'f1': 0.9917479167055052}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 19/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0250
Epoch 19/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0386
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9985, F1: 0.9976
Accuracy: 0.9966, Precision: 0.9910, Recall: 0.9945, F1: 0.9927
Epoch 19/30
Training - Loss: 47.8445
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9967086310516635, 'recall': 0.9984621326059467, 'f1': 0.9975831545213385}
Validation Metrics: {'accuracy': 0.9966113181972213, 'precision': 0.990958081943847, 'recall': 0.9944662705542068, 'f1': 0.9927032041832435}
Epoch 20/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0367
Epoch 20/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0258
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Accuracy: 0.9990, Precision: 0.9970, Recall: 0.9987, F1: 0.9978
Accuracy: 0.9965, Precision: 0.9909, Recall: 0.9940, F1: 0.9925
Epoch 20/30
Training - Loss: 47.5072
Training Metrics: {'accuracy': 0.9989809782608695, 'precision': 0.9969553196489245, 'recall': 0.9987056841698179, 'f1': 0.9978282817951087}
Validation Metrics: {'accuracy': 0.9964983621371286, 'precision': 0.9908858661311967, 'recall': 0.9940432587098751, 'f1': 0.9924572921925501}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 21/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0348
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 21/30, Step 60/1,Classification Loss: 0.3446, Contrastive Loss: 0.0430
Epoch 21/30, Step 80/1,Classification Loss: 0.3283, Contrastive Loss: 0.0231
Epoch 21/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0361
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Accuracy: 0.9989, Precision: 0.9966, Recall: 0.9986, F1: 0.9976
Accuracy: 0.9965, Precision: 0.9902, Recall: 0.9948, F1: 0.9925
Epoch 21/30
Training - Loss: 47.2964
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9966300928159504, 'recall': 0.9985526192691947, 'f1': 0.9975886751440124}
Validation Metrics: {'accuracy': 0.9964983621371286, 'precision': 0.9902073582907802, 'recall': 0.9947589212982907, 'f1': 0.9924680201047105}
Epoch 22/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0376
Epoch 22/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0344
Epoch 22/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.0476
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 22/30, Step 80/1,Classification Loss: 0.3443, Contrastive Loss: 0.0425
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Accuracy: 0.9986, Precision: 0.9964, Recall: 0.9976, F1: 0.9970
Accuracy: 0.9964, Precision: 0.9915, Recall: 0.9929, F1: 0.9922
Epoch 22/30
Training - Loss: 47.3870
Training Metrics: {'accuracy': 0.9985846920289855, 'precision': 0.9963649929428423, 'recall': 0.9975918805864883, 'f1': 0.9969773451816017}
Validation Metrics: {'accuracy': 0.9963854060770361, 'precision': 0.9914984633339132, 'recall': 0.9929045842771278, 'f1': 0.9922000824660885}
Epoch 23/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0337
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 23/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.0413
Epoch 23/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0359
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Accuracy: 0.9988, Precision: 0.9967, Recall: 0.9981, F1: 0.9974
Accuracy: 0.9966, Precision: 0.9913, Recall: 0.9941, F1: 0.9927
Epoch 23/30
Training - Loss: 47.3201
Training Metrics: {'accuracy': 0.9987828351449275, 'precision': 0.9967492470121444, 'recall': 0.9980620643107547, 'f1': 0.9974044059770446}
Validation Metrics: {'accuracy': 0.9966113181972213, 'precision': 0.9912990721539823, 'recall': 0.9941084392599989, 'f1': 0.9926980042586315}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 24/30, Step 20/1,Classification Loss: 0.3273, Contrastive Loss: 0.0203
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9986, F1: 0.9976
Accuracy: 0.9964, Precision: 0.9898, Recall: 0.9947, F1: 0.9922
Epoch 24/30
Training - Loss: 47.0406
Training Metrics: {'accuracy': 0.9988960597826086, 'precision': 0.9967263013699752, 'recall': 0.998567003891892, 'f1': 0.9976441982638043}
Validation Metrics: {'accuracy': 0.9963854060770361, 'precision': 0.989796917852945, 'recall': 0.9946937407481669, 'f1': 0.9922278155183827}
Epoch 25/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0183
Epoch 25/30, Step 20/1,Classification Loss: 0.3141, Contrastive Loss: 0.0201
Epoch 25/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0184
Epoch 25/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0315
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9985, F1: 0.9976
Accuracy: 0.9966, Precision: 0.9910, Recall: 0.9945, F1: 0.9927
Epoch 25/30
Training - Loss: 46.8746
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9967221533248827, 'recall': 0.9984663779639058, 'f1': 0.9975920571748466}
Validation Metrics: {'accuracy': 0.9966113181972213, 'precision': 0.990958081943847, 'recall': 0.9944662705542068, 'f1': 0.9927032041832435}
Epoch 26/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0314
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 26/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.0445
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 26/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0217
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 26/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0344
Accuracy: 0.9989, Precision: 0.9965, Recall: 0.9987, F1: 0.9976
Accuracy: 0.9960, Precision: 0.9889, Recall: 0.9941, F1: 0.9915
Epoch 26/30
Training - Loss: 47.0255
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9964803081420446, 'recall': 0.9987330171747346, 'f1': 0.9976029691753764}
Validation Metrics: {'accuracy': 0.9960465378967581, 'precision': 0.9889041438496974, 'recall': 0.9941403678035876, 'f1': 0.9915021921028679}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 27/30, Step 20/1,Classification Loss: 0.3299, Contrastive Loss: 0.0343
Epoch 27/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0317
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 27/30, Step 80/1,Classification Loss: 0.3257, Contrastive Loss: 0.0216
Epoch 27/30, Step 100/1,Classification Loss: 0.3446, Contrastive Loss: 0.0701
Epoch 27/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0331
Accuracy: 0.9990, Precision: 0.9966, Recall: 0.9989, F1: 0.9977
Accuracy: 0.9957, Precision: 0.9877, Recall: 0.9939, F1: 0.9908
Epoch 27/30
Training - Loss: 47.3548
Training Metrics: {'accuracy': 0.9989526721014492, 'precision': 0.9965526443026057, 'recall': 0.9989482646039316, 'f1': 0.9977463179213696}
Validation Metrics: {'accuracy': 0.9957076697164803, 'precision': 0.9876799947732915, 'recall': 0.993944826153216, 'f1': 0.9907836245082704}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 28/30, Step 80/1,Classification Loss: 0.3209, Contrastive Loss: 0.0217
Epoch 28/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0788
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Accuracy: 0.9989, Precision: 0.9966, Recall: 0.9986, F1: 0.9976
Accuracy: 0.9963, Precision: 0.9904, Recall: 0.9936, F1: 0.9920
Epoch 28/30
Training - Loss: 46.8419
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9966294275594902, 'recall': 0.9985524395534775, 'f1': 0.9975882515738692}
Validation Metrics: {'accuracy': 0.9962724500169434, 'precision': 0.9904007937368952, 'recall': 0.9935550663154196, 'f1': 0.9919706658823919}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0166
Epoch 29/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0336
Epoch 29/30, Step 40/1,Classification Loss: 0.3280, Contrastive Loss: 0.0270
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 29/30, Step 120/1,Classification Loss: 0.3285, Contrastive Loss: 0.0221
Accuracy: 0.9988, Precision: 0.9967, Recall: 0.9983, F1: 0.9975
Accuracy: 0.9965, Precision: 0.9912, Recall: 0.9937, F1: 0.9925
Epoch 29/30
Training - Loss: 46.6721
Training Metrics: {'accuracy': 0.9988111413043478, 'precision': 0.9966719994705935, 'recall': 0.998251763598519, 'f1': 0.9974600741262258}
Validation Metrics: {'accuracy': 0.9964983621371286, 'precision': 0.9912272115126306, 'recall': 0.9936854274156672, 'f1': 0.9924519142771921}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0165
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0166
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0164
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0318
Epoch 30/30, Step 100/1,Classification Loss: 0.3448, Contrastive Loss: 0.0477
Epoch 30/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0412
Accuracy: 0.9989, Precision: 0.9967, Recall: 0.9985, F1: 0.9976
Accuracy: 0.9964, Precision: 0.9912, Recall: 0.9933, F1: 0.9922
Epoch 30/30
Training - Loss: 46.9513
Training Metrics: {'accuracy': 0.9988677536231884, 'precision': 0.9967150851096047, 'recall': 0.9984641592788738, 'f1': 0.9975874038881478}
Validation Metrics: {'accuracy': 0.9963854060770361, 'precision': 0.9911553565663155, 'recall': 0.9932624155713357, 'f1': 0.9922056483297346}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1975, 5814), y shape: (1975,), y distribution: Counter({np.float64(0.0): 1776, np.float64(1.0): 199}), env shape: (1975,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9544, Precision: 0.8531, Recall: 0.9323, F1: 0.8871
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10215]))
original train data shape: torch.Size([44362]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1975, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44362]), new train data shape: torch.Size([44362])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10215]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.6063
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 1.0046
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4474
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2561
Epoch 1/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.2258
Epoch 1/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1818
Epoch 1/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1650
Accuracy: 0.9979, Precision: 0.9933, Recall: 0.9978, F1: 0.9955
Accuracy: 0.9958, Precision: 0.9882, Recall: 0.9940, F1: 0.9911
Epoch 1/30
Training - Loss: 107.3530
Training Metrics: {'accuracy': 0.9979053442028986, 'precision': 0.9933006087433897, 'recall': 0.9978182083152765, 'f1': 0.9955445248514385}
Validation Metrics: {'accuracy': 0.9958300462075961, 'precision': 0.98818134606319, 'recall': 0.9940477854795542, 'f1': 0.9910892727031164}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1410
Epoch 2/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1461
Epoch 2/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1378
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1209
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1148
Epoch 2/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.1279
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1077
Accuracy: 0.9981, Precision: 0.9939, Recall: 0.9981, F1: 0.9960
Accuracy: 0.9962, Precision: 0.9901, Recall: 0.9935, F1: 0.9918
Epoch 2/30
Training - Loss: 61.9769
Training Metrics: {'accuracy': 0.9981034873188406, 'precision': 0.9939180621495891, 'recall': 0.9981187320614611, 'f1': 0.9960054676875638}
Validation Metrics: {'accuracy': 0.9961681505691423, 'precision': 0.9900664190890297, 'recall': 0.9935343377583841, 'f1': 0.9917915663746826}
Epoch 3/30, Step 0/1,Classification Loss: 0.3252, Contrastive Loss: 0.1153
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1027
Epoch 3/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1130
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0981
Epoch 3/30, Step 80/1,Classification Loss: 0.3334, Contrastive Loss: 0.1118
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0937
Epoch 3/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1062
Accuracy: 0.9982, Precision: 0.9943, Recall: 0.9983, F1: 0.9963
Accuracy: 0.9958, Precision: 0.9882, Recall: 0.9940, F1: 0.9911
Epoch 3/30
Training - Loss: 59.0451
Training Metrics: {'accuracy': 0.998245018115942, 'precision': 0.9943097406136464, 'recall': 0.9982838192616923, 'f1': 0.9962852490037244}
Validation Metrics: {'accuracy': 0.9958300462075961, 'precision': 0.98818134606319, 'recall': 0.9940477854795542, 'f1': 0.9910892727031164}
Epoch 4/30, Step 0/1,Classification Loss: 0.3168, Contrastive Loss: 0.0912
Epoch 4/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1017
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0875
Epoch 4/30, Step 60/1,Classification Loss: 0.3294, Contrastive Loss: 0.1038
Epoch 4/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0971
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0826
Epoch 4/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.1013
Accuracy: 0.9981, Precision: 0.9940, Recall: 0.9981, F1: 0.9960
Accuracy: 0.9957, Precision: 0.9881, Recall: 0.9936, F1: 0.9908
Epoch 4/30
Training - Loss: 57.0603
Training Metrics: {'accuracy': 0.9981317934782609, 'precision': 0.9939881065258511, 'recall': 0.9981309016095232, 'f1': 0.9960469637888992}
Validation Metrics: {'accuracy': 0.9957173447537473, 'precision': 0.9881069560183685, 'recall': 0.9936283223923059, 'f1': 0.9908452256831313}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0795
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0785
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0774
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0757
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0766
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0734
Epoch 5/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0860
Accuracy: 0.9981, Precision: 0.9940, Recall: 0.9981, F1: 0.9960
Accuracy: 0.9958, Precision: 0.9888, Recall: 0.9933, F1: 0.9911
Epoch 5/30
Training - Loss: 55.5449
Training Metrics: {'accuracy': 0.9981317934782609, 'precision': 0.9939844989562571, 'recall': 0.9981304100324523, 'f1': 0.9960448991393711}
Validation Metrics: {'accuracy': 0.9958300462075961, 'precision': 0.9888440834031389, 'recall': 0.9933390506863882, 'f1': 0.9910767289437334}
Epoch 6/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0875
Epoch 6/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0845
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0692
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0681
Epoch 6/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0948
Epoch 6/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0796
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0652
Accuracy: 0.9983, Precision: 0.9945, Recall: 0.9982, F1: 0.9964
Accuracy: 0.9962, Precision: 0.9897, Recall: 0.9939, F1: 0.9918
Epoch 6/30
Training - Loss: 54.5922
Training Metrics: {'accuracy': 0.9982733242753623, 'precision': 0.9945112628008445, 'recall': 0.9982149823367412, 'f1': 0.996353095897607}
Validation Metrics: {'accuracy': 0.9961681505691423, 'precision': 0.9897313319490948, 'recall': 0.993888705154967, 'f1': 0.9917973495456597}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0648
Epoch 7/30, Step 20/1,Classification Loss: 0.3285, Contrastive Loss: 0.0751
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0627
Epoch 7/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1013
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0611
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0602
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0595
Accuracy: 0.9983, Precision: 0.9945, Recall: 0.9982, F1: 0.9964
Accuracy: 0.9957, Precision: 0.9878, Recall: 0.9940, F1: 0.9909
Epoch 7/30
Training - Loss: 54.0062
Training Metrics: {'accuracy': 0.9983016304347826, 'precision': 0.9945323694210326, 'recall': 0.9982188708168129, 'f1': 0.9963657619220729}
Validation Metrics: {'accuracy': 0.9957173447537473, 'precision': 0.9877772660945641, 'recall': 0.993982689788889, 'f1': 0.9908516560322082}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0603
Epoch 8/30, Step 20/1,Classification Loss: 0.3284, Contrastive Loss: 0.0694
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0572
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0564
Epoch 8/30, Step 80/1,Classification Loss: 0.3601, Contrastive Loss: 0.0963
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0550
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0559
Accuracy: 0.9982, Precision: 0.9946, Recall: 0.9980, F1: 0.9963
Accuracy: 0.9961, Precision: 0.9890, Recall: 0.9942, F1: 0.9916
Epoch 8/30
Training - Loss: 53.0066
Training Metrics: {'accuracy': 0.998245018115942, 'precision': 0.9945704208919598, 'recall': 0.9980226559448284, 'f1': 0.9962878333776917}
Validation Metrics: {'accuracy': 0.9960554491152935, 'precision': 0.988991514193122, 'recall': 0.9941779768608848, 'f1': 0.9915650058682766}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0537
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0532
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0533
Epoch 9/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0789
Epoch 9/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0804
Epoch 9/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0650
Epoch 9/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0502
Accuracy: 0.9982, Precision: 0.9945, Recall: 0.9980, F1: 0.9962
Accuracy: 0.9957, Precision: 0.9874, Recall: 0.9943, F1: 0.9909
Epoch 9/30
Training - Loss: 52.1496
Training Metrics: {'accuracy': 0.9982167119565217, 'precision': 0.9944773413965752, 'recall': 0.998007936704836, 'f1': 0.996233525271299}
Validation Metrics: {'accuracy': 0.9957173447537473, 'precision': 0.9874489129502952, 'recall': 0.994337057185472, 'f1': 0.9908580753712743}
Epoch 10/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0621
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0488
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0483
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0477
Epoch 10/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0748
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0465
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0479
Accuracy: 0.9983, Precision: 0.9946, Recall: 0.9982, F1: 0.9964
Accuracy: 0.9957, Precision: 0.9888, Recall: 0.9929, F1: 0.9908
Epoch 10/30
Training - Loss: 51.8652
Training Metrics: {'accuracy': 0.9983016304347826, 'precision': 0.994608612769804, 'recall': 0.9982307099624315, 'f1': 0.9964100774394097}
Validation Metrics: {'accuracy': 0.9957173447537473, 'precision': 0.9887703720678973, 'recall': 0.9929195875991399, 'f1': 0.9908323318451491}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0454
Epoch 11/30, Step 20/1,Classification Loss: 0.3302, Contrastive Loss: 0.0591
Epoch 11/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0582
Epoch 11/30, Step 60/1,Classification Loss: 0.3163, Contrastive Loss: 0.0450
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0437
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0429
Epoch 11/30, Step 120/1,Classification Loss: 0.3453, Contrastive Loss: 0.0768
Accuracy: 0.9983, Precision: 0.9947, Recall: 0.9980, F1: 0.9963
Accuracy: 0.9956, Precision: 0.9890, Recall: 0.9921, F1: 0.9906
Epoch 11/30
Training - Loss: 51.2616
Training Metrics: {'accuracy': 0.9982733242753623, 'precision': 0.9946722902966154, 'recall': 0.9980390440143138, 'f1': 0.9963473894334098}
Validation Metrics: {'accuracy': 0.9956046432998986, 'precision': 0.9890307455813239, 'recall': 0.9921457571153085, 'f1': 0.9905811226860166}
Epoch 12/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0568
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0416
Epoch 12/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0444
Epoch 12/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0594
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0401
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0397
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0393
Accuracy: 0.9981, Precision: 0.9944, Recall: 0.9974, F1: 0.9959
Accuracy: 0.9950, Precision: 0.9873, Recall: 0.9915, F1: 0.9894
Epoch 12/30
Training - Loss: 50.6478
Training Metrics: {'accuracy': 0.9980751811594203, 'precision': 0.9944352783681905, 'recall': 0.9973904445141144, 'f1': 0.9959064971972391}
Validation Metrics: {'accuracy': 0.9950411360306548, 'precision': 0.987328932246101, 'recall': 0.9914659112653991, 'f1': 0.9893848052943831}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0388
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0387
Epoch 13/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0524
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0375
Epoch 13/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0517
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0367
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0363
Accuracy: 0.9983, Precision: 0.9947, Recall: 0.9980, F1: 0.9963
Accuracy: 0.9953, Precision: 0.9881, Recall: 0.9916, F1: 0.9899
Epoch 13/30
Training - Loss: 50.3914
Training Metrics: {'accuracy': 0.9982733242753623, 'precision': 0.9946521884322634, 'recall': 0.9980350343905584, 'f1': 0.9963352703514509}
Validation Metrics: {'accuracy': 0.9952665389383523, 'precision': 0.988141803377719, 'recall': 0.9915961026467297, 'f1': 0.989860170227549}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 14/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0514
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0344
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0337
Accuracy: 0.9982, Precision: 0.9944, Recall: 0.9980, F1: 0.9962
Accuracy: 0.9956, Precision: 0.9887, Recall: 0.9925, F1: 0.9906
Epoch 14/30
Training - Loss: 49.9461
Training Metrics: {'accuracy': 0.9981884057971014, 'precision': 0.9943533821886126, 'recall': 0.997987370972707, 'f1': 0.9961607388230391}
Validation Metrics: {'accuracy': 0.9956046432998986, 'precision': 0.9886966633828294, 'recall': 0.9925001245118916, 'f1': 0.9905877620262068}
Epoch 15/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.0470
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Epoch 15/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0351
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 15/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0585
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0314
Accuracy: 0.9983, Precision: 0.9945, Recall: 0.9983, F1: 0.9964
Accuracy: 0.9956, Precision: 0.9874, Recall: 0.9939, F1: 0.9906
Epoch 15/30
Training - Loss: 49.7028
Training Metrics: {'accuracy': 0.9983016304347826, 'precision': 0.9944957941901622, 'recall': 0.9983142600254014, 'f1': 0.9963944026775751}
Validation Metrics: {'accuracy': 0.9956046432998986, 'precision': 0.9873738533123562, 'recall': 0.9939175940982237, 'f1': 0.9906142056835525}
Epoch 16/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0602
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 16/30, Step 40/1,Classification Loss: 0.3283, Contrastive Loss: 0.0426
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0304
Epoch 16/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0442
Epoch 16/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0308
Epoch 16/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0442
Accuracy: 0.9983, Precision: 0.9947, Recall: 0.9981, F1: 0.9964
Accuracy: 0.9955, Precision: 0.9880, Recall: 0.9928, F1: 0.9904
Epoch 16/30
Training - Loss: 49.2918
Training Metrics: {'accuracy': 0.9983016304347826, 'precision': 0.9946981709782785, 'recall': 0.998144326910632, 'f1': 0.996412569945476}
Validation Metrics: {'accuracy': 0.9954919418460498, 'precision': 0.9879581809226984, 'recall': 0.9927893962178093, 'f1': 0.9903566150490711}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0285
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 17/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0282
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0276
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0275
Accuracy: 0.9984, Precision: 0.9948, Recall: 0.9983, F1: 0.9965
Accuracy: 0.9950, Precision: 0.9877, Recall: 0.9911, F1: 0.9894
Epoch 17/30
Training - Loss: 49.0642
Training Metrics: {'accuracy': 0.9983582427536232, 'precision': 0.9947966558371302, 'recall': 0.9982609707199597, 'f1': 0.9965200626956097}
Validation Metrics: {'accuracy': 0.9950411360306548, 'precision': 0.9876606494498914, 'recall': 0.9911115438688161, 'f1': 0.9893773211907657}
Epoch 18/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0420
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0265
Epoch 18/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0404
Epoch 18/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0400
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Accuracy: 0.9983, Precision: 0.9947, Recall: 0.9980, F1: 0.9963
Accuracy: 0.9952, Precision: 0.9881, Recall: 0.9912, F1: 0.9896
Epoch 18/30
Training - Loss: 48.7558
Training Metrics: {'accuracy': 0.9982733242753623, 'precision': 0.9946680714905, 'recall': 0.9980382029005381, 'f1': 0.9963448462013076}
Validation Metrics: {'accuracy': 0.9951538374845036, 'precision': 0.9880677620057668, 'recall': 0.9911766395594813, 'f1': 0.9896150839871465}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 19/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0390
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 19/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0519
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Accuracy: 0.9980, Precision: 0.9963, Recall: 0.9951, F1: 0.9957
Accuracy: 0.9947, Precision: 0.9895, Recall: 0.9877, F1: 0.9886
Epoch 19/30
Training - Loss: 48.6317
Training Metrics: {'accuracy': 0.9979902626811594, 'precision': 0.996280919624932, 'recall': 0.9951464395577476, 'f1': 0.9957127428818282}
Validation Metrics: {'accuracy': 0.9947030316691086, 'precision': 0.989462783239628, 'recall': 0.9877269502275727, 'f1': 0.9885926489655792}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 20/30, Step 40/1,Classification Loss: 0.3599, Contrastive Loss: 0.0573
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 20/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0408
Epoch 20/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0711
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Accuracy: 0.9984, Precision: 0.9952, Recall: 0.9981, F1: 0.9966
Accuracy: 0.9955, Precision: 0.9876, Recall: 0.9931, F1: 0.9904
Epoch 20/30
Training - Loss: 48.3370
Training Metrics: {'accuracy': 0.9984148550724637, 'precision': 0.9951879589734749, 'recall': 0.9981222591474832, 'f1': 0.9966488234066492}
Validation Metrics: {'accuracy': 0.9954919418460498, 'precision': 0.9876278171615194, 'recall': 0.9931437636143923, 'f1': 0.9903633954559277}
Epoch 21/30, Step 0/1,Classification Loss: 0.3371, Contrastive Loss: 0.0352
Epoch 21/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0247
Epoch 21/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0229
Epoch 21/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0366
Epoch 21/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0223
Epoch 21/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0585
Epoch 21/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0222
Accuracy: 0.9982, Precision: 0.9946, Recall: 0.9980, F1: 0.9963
Accuracy: 0.9956, Precision: 0.9897, Recall: 0.9914, F1: 0.9906
Epoch 21/30
Training - Loss: 48.2888
Training Metrics: {'accuracy': 0.998245018115942, 'precision': 0.9945982102071972, 'recall': 0.9980280703358781, 'f1': 0.9963045250995135}
Validation Metrics: {'accuracy': 0.9956046432998986, 'precision': 0.9897030116545489, 'recall': 0.9914370223221425, 'f1': 0.9905678096955908}
Epoch 22/30, Step 0/1,Classification Loss: 0.3139, Contrastive Loss: 0.0247
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 22/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0352
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 22/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0412
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 22/30, Step 120/1,Classification Loss: 0.3284, Contrastive Loss: 0.0237
Accuracy: 0.9982, Precision: 0.9945, Recall: 0.9981, F1: 0.9963
Accuracy: 0.9950, Precision: 0.9873, Recall: 0.9915, F1: 0.9894
Epoch 22/30
Training - Loss: 48.0429
Training Metrics: {'accuracy': 0.998245018115942, 'precision': 0.9944817139498361, 'recall': 0.9981092947888903, 'f1': 0.9962858955100855}
Validation Metrics: {'accuracy': 0.9950411360306548, 'precision': 0.987328932246101, 'recall': 0.9914659112653991, 'f1': 0.9893848052943831}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0356
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 23/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0345
Epoch 23/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0343
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Accuracy: 0.9984, Precision: 0.9949, Recall: 0.9984, F1: 0.9966
Accuracy: 0.9953, Precision: 0.9868, Recall: 0.9930, F1: 0.9899
Epoch 23/30
Training - Loss: 47.9911
Training Metrics: {'accuracy': 0.9984148550724637, 'precision': 0.9949314546992805, 'recall': 0.998383591928232, 'f1': 0.9966488234066492}
Validation Metrics: {'accuracy': 0.9952665389383523, 'precision': 0.986820322619262, 'recall': 0.9930135722330617, 'f1': 0.9898886724566511}
Epoch 24/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0350
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0338
Epoch 24/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0347
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Accuracy: 0.9984, Precision: 0.9949, Recall: 0.9982, F1: 0.9965
Accuracy: 0.9956, Precision: 0.9897, Recall: 0.9914, F1: 0.9906
Epoch 24/30
Training - Loss: 47.6489
Training Metrics: {'accuracy': 0.9983582427536232, 'precision': 0.9949036785820599, 'recall': 0.9981774892362856, 'f1': 0.9965327526629011}
Validation Metrics: {'accuracy': 0.9956046432998986, 'precision': 0.9897030116545489, 'recall': 0.9914370223221425, 'f1': 0.9905678096955908}
Epoch 25/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0199
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 25/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.0519
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 25/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0339
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Accuracy: 0.9983, Precision: 0.9948, Recall: 0.9982, F1: 0.9965
Accuracy: 0.9957, Precision: 0.9898, Recall: 0.9919, F1: 0.9908
Epoch 25/30
Training - Loss: 47.6489
Training Metrics: {'accuracy': 0.9983299365942029, 'precision': 0.9947864723361033, 'recall': 0.9981582630662034, 'f1': 0.996464071692309}
Validation Metrics: {'accuracy': 0.9957173447537473, 'precision': 0.9897756847732104, 'recall': 0.9918564854093908, 'f1': 0.990812907824453}
Epoch 26/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0245
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 40/1,Classification Loss: 0.3149, Contrastive Loss: 0.0235
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 26/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0337
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Accuracy: 0.9984, Precision: 0.9951, Recall: 0.9984, F1: 0.9967
Accuracy: 0.9955, Precision: 0.9886, Recall: 0.9921, F1: 0.9903
Epoch 26/30
Training - Loss: 47.4421
Training Metrics: {'accuracy': 0.998443161231884, 'precision': 0.9950560003406363, 'recall': 0.998403339960609, 'f1': 0.9967214729213505}
Validation Metrics: {'accuracy': 0.9954919418460498, 'precision': 0.9886229573055467, 'recall': 0.9920806614246432, 'f1': 0.9903430192643324}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9984, Precision: 0.9951, Recall: 0.9982, F1: 0.9966
Accuracy: 0.9955, Precision: 0.9893, Recall: 0.9914, F1: 0.9903
Epoch 27/30
Training - Loss: 47.5712
Training Metrics: {'accuracy': 0.9984148550724637, 'precision': 0.9950810037473176, 'recall': 0.9982051189134136, 'f1': 0.9966359519669563}
Validation Metrics: {'accuracy': 0.9954919418460498, 'precision': 0.9892931759229552, 'recall': 0.9913719266314771, 'f1': 0.990329376657319}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0191
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0176
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Accuracy: 0.9985, Precision: 0.9951, Recall: 0.9984, F1: 0.9968
Accuracy: 0.9954, Precision: 0.9889, Recall: 0.9913, F1: 0.9901
Epoch 28/30
Training - Loss: 47.5029
Training Metrics: {'accuracy': 0.9984714673913043, 'precision': 0.995140079057939, 'recall': 0.9984171073222241, 'f1': 0.9967707524947418}
Validation Metrics: {'accuracy': 0.995379240392201, 'precision': 0.9888840235423361, 'recall': 0.9913068309408118, 'f1': 0.9900911115042421}
Epoch 29/30, Step 0/1,Classification Loss: 0.3173, Contrastive Loss: 0.0190
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0314
Accuracy: 0.9984, Precision: 0.9950, Recall: 0.9984, F1: 0.9967
Accuracy: 0.9955, Precision: 0.9886, Recall: 0.9921, F1: 0.9903
Epoch 29/30
Training - Loss: 47.1762
Training Metrics: {'accuracy': 0.998443161231884, 'precision': 0.9950184181225104, 'recall': 0.9983977705935858, 'f1': 0.9966997716239722}
Validation Metrics: {'accuracy': 0.9954919418460498, 'precision': 0.9886229573055467, 'recall': 0.9920806614246432, 'f1': 0.9903430192643324}
Epoch 30/30, Step 0/1,Classification Loss: 0.3244, Contrastive Loss: 0.0202
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 60/1,Classification Loss: 0.3440, Contrastive Loss: 0.0472
Epoch 30/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0470
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Accuracy: 0.9984, Precision: 0.9951, Recall: 0.9983, F1: 0.9967
Accuracy: 0.9953, Precision: 0.9888, Recall: 0.9909, F1: 0.9898
Epoch 30/30
Training - Loss: 47.4683
Training Metrics: {'accuracy': 0.998443161231884, 'precision': 0.995121730806834, 'recall': 0.9983133333186118, 'f1': 0.9967100949072702}
Validation Metrics: {'accuracy': 0.9952665389383523, 'precision': 0.9888106670726999, 'recall': 0.9908873678535635, 'f1': 0.9898458454901851}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1975, 5814), y shape: (1975,), y distribution: Counter({np.float64(0.0): 1780, np.float64(1.0): 195}), env shape: (1975,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9559, Precision: 0.8546, Recall: 0.9345, F1: 0.8890
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10315]))
original train data shape: torch.Size([44462]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1975, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44462]), new train data shape: torch.Size([44462])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10315]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.6340
Epoch 1/30, Step 20/1,Classification Loss: 0.3601, Contrastive Loss: 0.9321
Epoch 1/30, Step 40/1,Classification Loss: 0.3295, Contrastive Loss: 0.3923
Epoch 1/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.2472
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1863
Epoch 1/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.1660
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1457
Accuracy: 0.9976, Precision: 0.9930, Recall: 0.9970, F1: 0.9950
Accuracy: 0.9965, Precision: 0.9904, Recall: 0.9948, F1: 0.9926
Epoch 1/30
Training - Loss: 104.0612
Training Metrics: {'accuracy': 0.9976222826086957, 'precision': 0.9930322174790912, 'recall': 0.996970084415451, 'f1': 0.9949897646103502}
Validation Metrics: {'accuracy': 0.9965141122230968, 'precision': 0.9903751376089043, 'recall': 0.9948318433072401, 'f1': 0.992588900703829}
Epoch 2/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1503
Epoch 2/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1439
Epoch 2/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.1240
Epoch 2/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1310
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1163
Epoch 2/30, Step 100/1,Classification Loss: 0.3178, Contrastive Loss: 0.1178
Epoch 2/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1184
Accuracy: 0.9976, Precision: 0.9923, Recall: 0.9978, F1: 0.9950
Accuracy: 0.9963, Precision: 0.9889, Recall: 0.9954, F1: 0.9921
Epoch 2/30
Training - Loss: 62.6031
Training Metrics: {'accuracy': 0.9976222826086957, 'precision': 0.9922831213182014, 'recall': 0.9977524805988158, 'f1': 0.994995820913378}
Validation Metrics: {'accuracy': 0.9962892162374901, 'precision': 0.98891407731645, 'recall': 0.9954022962431985, 'f1': 0.9921271946220618}
Epoch 3/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1203
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1035
Epoch 3/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.1019
Epoch 3/30, Step 60/1,Classification Loss: 0.3185, Contrastive Loss: 0.1100
Epoch 3/30, Step 80/1,Classification Loss: 0.3293, Contrastive Loss: 0.1132
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0959
Epoch 3/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.1215
Accuracy: 0.9978, Precision: 0.9930, Recall: 0.9977, F1: 0.9953
Accuracy: 0.9962, Precision: 0.9905, Recall: 0.9932, F1: 0.9919
Epoch 3/30
Training - Loss: 59.7017
Training Metrics: {'accuracy': 0.9977921195652174, 'precision': 0.9930212823625901, 'recall': 0.9976717172856298, 'f1': 0.99533066685683}
Validation Metrics: {'accuracy': 0.9961767682446868, 'precision': 0.9904903896847177, 'recall': 0.9932357417011575, 'f1': 0.9918575254107296}
Epoch 4/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.1099
Epoch 4/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1045
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0891
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0879
Epoch 4/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1009
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0849
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0837
Accuracy: 0.9977, Precision: 0.9937, Recall: 0.9967, F1: 0.9952
Accuracy: 0.9947, Precision: 0.9899, Recall: 0.9875, F1: 0.9887
Epoch 4/30
Training - Loss: 57.9360
Training Metrics: {'accuracy': 0.9977072010869565, 'precision': 0.9936845013214741, 'recall': 0.9966769021990272, 'f1': 0.9951741250257842}
Validation Metrics: {'accuracy': 0.9947149443382436, 'precision': 0.9898916231153073, 'recall': 0.9874868161748089, 'f1': 0.9886849496817557}
Epoch 5/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0827
Epoch 5/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0960
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0802
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0805
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0776
Epoch 5/30, Step 100/1,Classification Loss: 0.3439, Contrastive Loss: 0.1023
Epoch 5/30, Step 120/1,Classification Loss: 0.3427, Contrastive Loss: 0.0969
Accuracy: 0.9975, Precision: 0.9934, Recall: 0.9962, F1: 0.9948
Accuracy: 0.9949, Precision: 0.9904, Recall: 0.9880, F1: 0.9892
Epoch 5/30
Training - Loss: 56.7252
Training Metrics: {'accuracy': 0.9975373641304348, 'precision': 0.9933928489751489, 'recall': 0.9962234816624194, 'f1': 0.9948022849824467}
Validation Metrics: {'accuracy': 0.9949398403238502, 'precision': 0.9903743028743028, 'recall': 0.9879671265288592, 'f1': 0.9891664411846597}
Epoch 6/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0885
Epoch 6/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0896
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0723
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0714
Epoch 6/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0852
Epoch 6/30, Step 100/1,Classification Loss: 0.3454, Contrastive Loss: 0.1039
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0687
Accuracy: 0.9979, Precision: 0.9934, Recall: 0.9977, F1: 0.9955
Accuracy: 0.9964, Precision: 0.9903, Recall: 0.9944, F1: 0.9923
Epoch 6/30
Training - Loss: 55.5667
Training Metrics: {'accuracy': 0.9978770380434783, 'precision': 0.9933637808091227, 'recall': 0.9977273593784495, 'f1': 0.9955315972460965}
Validation Metrics: {'accuracy': 0.9964016642302935, 'precision': 0.9903026512892235, 'recall': 0.9944165609152135, 'f1': 0.9923471698275574}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0678
Epoch 7/30, Step 20/1,Classification Loss: 0.3149, Contrastive Loss: 0.0677
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0664
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0652
Epoch 7/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0800
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0638
Epoch 7/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0776
Accuracy: 0.9980, Precision: 0.9955, Recall: 0.9958, F1: 0.9957
Accuracy: 0.9949, Precision: 0.9907, Recall: 0.9876, F1: 0.9892
Epoch 7/30
Training - Loss: 54.5494
Training Metrics: {'accuracy': 0.9979619565217391, 'precision': 0.9954896331096516, 'recall': 0.9958373881812277, 'f1': 0.9956634224897327}
Validation Metrics: {'accuracy': 0.9949398403238502, 'precision': 0.9907149169865346, 'recall': 0.9876168720988563, 'f1': 0.9891588187740863}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0623
Epoch 8/30, Step 20/1,Classification Loss: 0.3167, Contrastive Loss: 0.0669
Epoch 8/30, Step 40/1,Classification Loss: 0.3450, Contrastive Loss: 0.0909
Epoch 8/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0640
Epoch 8/30, Step 80/1,Classification Loss: 0.3381, Contrastive Loss: 0.0762
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0587
Epoch 8/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1080
Accuracy: 0.9978, Precision: 0.9950, Recall: 0.9960, F1: 0.9955
Accuracy: 0.9955, Precision: 0.9894, Recall: 0.9914, F1: 0.9904
Epoch 8/30
Training - Loss: 53.8683
Training Metrics: {'accuracy': 0.997848731884058, 'precision': 0.9949654104618308, 'recall': 0.9959903189456597, 'f1': 0.9954770932127526}
Validation Metrics: {'accuracy': 0.9955020802878669, 'precision': 0.9893895290988046, 'recall': 0.9914445562090037, 'f1': 0.9904139289826606}
Epoch 9/30, Step 0/1,Classification Loss: 0.3413, Contrastive Loss: 0.0735
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0564
Epoch 9/30, Step 40/1,Classification Loss: 0.3269, Contrastive Loss: 0.0627
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0551
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0545
Epoch 9/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0831
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0537
Accuracy: 0.9980, Precision: 0.9955, Recall: 0.9962, F1: 0.9958
Accuracy: 0.9958, Precision: 0.9913, Recall: 0.9909, F1: 0.9911
Epoch 9/30
Training - Loss: 53.2502
Training Metrics: {'accuracy': 0.9980185688405797, 'precision': 0.9954805409449159, 'recall': 0.9961668675714805, 'f1': 0.9958233591126151}
Validation Metrics: {'accuracy': 0.9958394242662768, 'precision': 0.991283332630712, 'recall': 0.990939131235069, 'f1': 0.991111144849133}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0527
Epoch 10/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0526
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0518
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0512
Epoch 10/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0636
Epoch 10/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0617
Epoch 10/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0641
Accuracy: 0.9980, Precision: 0.9939, Recall: 0.9979, F1: 0.9959
Accuracy: 0.9960, Precision: 0.9897, Recall: 0.9931, F1: 0.9914
Epoch 10/30
Training - Loss: 52.7639
Training Metrics: {'accuracy': 0.998046875, 'precision': 0.9939283916567733, 'recall': 0.9979197078482933, 'f1': 0.9959123298355442}
Validation Metrics: {'accuracy': 0.9959518722590802, 'precision': 0.9896807184831735, 'recall': 0.9931056857771101, 'f1': 0.9913845662993452}
Epoch 11/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 0.0511
Epoch 11/30, Step 20/1,Classification Loss: 0.3198, Contrastive Loss: 0.0527
Epoch 11/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0629
Epoch 11/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0475
Epoch 11/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0625
Epoch 11/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0467
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0457
Accuracy: 0.9977, Precision: 0.9953, Recall: 0.9951, F1: 0.9952
Accuracy: 0.9951, Precision: 0.9901, Recall: 0.9887, F1: 0.9894
Epoch 11/30
Training - Loss: 51.9621
Training Metrics: {'accuracy': 0.9977355072463768, 'precision': 0.9953067651298926, 'recall': 0.9951350904207785, 'f1': 0.9952209061654591}
Validation Metrics: {'accuracy': 0.9950522883166536, 'precision': 0.9901068070540318, 'recall': 0.9887326633508887, 'f1': 0.9894183425491818}
Epoch 12/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0607
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0449
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0442
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0438
Epoch 12/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0941
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0429
Epoch 12/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0574
Accuracy: 0.9980, Precision: 0.9976, Recall: 0.9942, F1: 0.9959
Accuracy: 0.9952, Precision: 0.9915, Recall: 0.9877, F1: 0.9896
Epoch 12/30
Training - Loss: 51.4990
Training Metrics: {'accuracy': 0.998046875, 'precision': 0.9975518787381992, 'recall': 0.9941697606289419, 'f1': 0.9958524753915168}
Validation Metrics: {'accuracy': 0.9951647363094569, 'precision': 0.9915409695082789, 'recall': 0.9877469280229036, 'f1': 0.9896333529091059}
Epoch 13/30, Step 0/1,Classification Loss: 0.3161, Contrastive Loss: 0.0451
Epoch 13/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0560
Epoch 13/30, Step 40/1,Classification Loss: 0.3283, Contrastive Loss: 0.0430
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0412
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0400
Epoch 13/30, Step 100/1,Classification Loss: 0.3138, Contrastive Loss: 0.0402
Epoch 13/30, Step 120/1,Classification Loss: 0.3291, Contrastive Loss: 0.0556
Accuracy: 0.9981, Precision: 0.9974, Recall: 0.9944, F1: 0.9959
Accuracy: 0.9953, Precision: 0.9909, Recall: 0.9889, F1: 0.9899
Epoch 13/30
Training - Loss: 50.8905
Training Metrics: {'accuracy': 0.9980751811594203, 'precision': 0.9973911304448992, 'recall': 0.9944374507600583, 'f1': 0.9959079314836077}
Validation Metrics: {'accuracy': 0.9952771843022602, 'precision': 0.9909280249408533, 'recall': 0.9888627192749361, 'f1': 0.989892230993153}
Epoch 14/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0468
Epoch 14/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0541
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0379
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0374
Epoch 14/30, Step 80/1,Classification Loss: 0.3153, Contrastive Loss: 0.0391
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Epoch 14/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0371
Accuracy: 0.9981, Precision: 0.9957, Recall: 0.9962, F1: 0.9959
Accuracy: 0.9960, Precision: 0.9910, Recall: 0.9917, F1: 0.9914
Epoch 14/30
Training - Loss: 50.6562
Training Metrics: {'accuracy': 0.9980751811594203, 'precision': 0.995685451555474, 'recall': 0.9962003202308078, 'f1': 0.9959426917093975}
Validation Metrics: {'accuracy': 0.9959518722590802, 'precision': 0.9910169567582063, 'recall': 0.9917046680570984, 'f1': 0.9913604647648326}
Epoch 15/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0467
Epoch 15/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1196
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0351
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0344
Epoch 15/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0387
Epoch 15/30, Step 120/1,Classification Loss: 0.3144, Contrastive Loss: 0.0356
Accuracy: 0.9981, Precision: 0.9956, Recall: 0.9963, F1: 0.9959
Accuracy: 0.9961, Precision: 0.9914, Recall: 0.9918, F1: 0.9916
Epoch 15/30
Training - Loss: 49.9415
Training Metrics: {'accuracy': 0.9980751811594203, 'precision': 0.9955958488988679, 'recall': 0.9962831986438624, 'f1': 0.9959391778670265}
Validation Metrics: {'accuracy': 0.9960643202518835, 'precision': 0.991425501185228, 'recall': 0.9917696960191221, 'f1': 0.9915975115860018}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Epoch 16/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0374
Epoch 16/30, Step 40/1,Classification Loss: 0.3295, Contrastive Loss: 0.0385
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0329
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0317
Accuracy: 0.9979, Precision: 0.9972, Recall: 0.9938, F1: 0.9955
Accuracy: 0.9957, Precision: 0.9926, Recall: 0.9891, F1: 0.9908
Epoch 16/30
Training - Loss: 49.5989
Training Metrics: {'accuracy': 0.9978770380434783, 'precision': 0.9971746927989689, 'recall': 0.9937590847632001, 'f1': 0.995458406960171}
Validation Metrics: {'accuracy': 0.9957269762734735, 'precision': 0.9925787094540982, 'recall': 0.9891228311230307, 'f1': 0.9908420022490798}
Epoch 17/30, Step 0/1,Classification Loss: 0.3388, Contrastive Loss: 0.0383
Epoch 17/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0457
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 17/30, Step 60/1,Classification Loss: 0.3293, Contrastive Loss: 0.0364
Epoch 17/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0317
Epoch 17/30, Step 100/1,Classification Loss: 0.3410, Contrastive Loss: 0.0346
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Accuracy: 0.9982, Precision: 0.9970, Recall: 0.9954, F1: 0.9962
Accuracy: 0.9957, Precision: 0.9909, Recall: 0.9909, F1: 0.9909
Epoch 17/30
Training - Loss: 49.2856
Training Metrics: {'accuracy': 0.9982167119565217, 'precision': 0.99704362769436, 'recall': 0.9953984789264756, 'f1': 0.996219078805007}
Validation Metrics: {'accuracy': 0.9957269762734735, 'precision': 0.9908741032730453, 'recall': 0.9908741032730453, 'f1': 0.9908741032730453}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0294
Epoch 18/30, Step 20/1,Classification Loss: 0.3348, Contrastive Loss: 0.0400
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 18/30, Step 60/1,Classification Loss: 0.3173, Contrastive Loss: 0.0295
Epoch 18/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0782
Epoch 18/30, Step 100/1,Classification Loss: 0.3397, Contrastive Loss: 0.0362
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Accuracy: 0.9981, Precision: 0.9969, Recall: 0.9952, F1: 0.9961
Accuracy: 0.9954, Precision: 0.9897, Recall: 0.9907, F1: 0.9902
Epoch 18/30
Training - Loss: 49.1854
Training Metrics: {'accuracy': 0.9981317934782609, 'precision': 0.9969229732643508, 'recall': 0.9952067521774116, 'f1': 0.9960627055372817}
Validation Metrics: {'accuracy': 0.9953896322950635, 'precision': 0.9896504819121522, 'recall': 0.9906790193869743, 'f1': 0.9901639706898935}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0272
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0270
Epoch 19/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0277
Epoch 19/30, Step 60/1,Classification Loss: 0.3302, Contrastive Loss: 0.0473
Epoch 19/30, Step 80/1,Classification Loss: 0.3252, Contrastive Loss: 0.0289
Epoch 19/30, Step 100/1,Classification Loss: 0.3285, Contrastive Loss: 0.0334
Epoch 19/30, Step 120/1,Classification Loss: 0.3299, Contrastive Loss: 0.0334
Accuracy: 0.9981, Precision: 0.9976, Recall: 0.9945, F1: 0.9961
Accuracy: 0.9951, Precision: 0.9898, Recall: 0.9891, F1: 0.9894
Epoch 19/30
Training - Loss: 48.8680
Training Metrics: {'accuracy': 0.9981317934782609, 'precision': 0.9976146037659556, 'recall': 0.9945261423057581, 'f1': 0.9960633864795608}
Validation Metrics: {'accuracy': 0.9950522883166536, 'precision': 0.9897693048750068, 'recall': 0.9890829177808916, 'f1': 0.9894257637224666}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 20/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.0288
Epoch 20/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0260
Epoch 20/30, Step 60/1,Classification Loss: 0.3278, Contrastive Loss: 0.0288
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Accuracy: 0.9980, Precision: 0.9972, Recall: 0.9941, F1: 0.9957
Accuracy: 0.9951, Precision: 0.9911, Recall: 0.9877, F1: 0.9894
Epoch 20/30
Training - Loss: 48.6207
Training Metrics: {'accuracy': 0.9979619565217391, 'precision': 0.9972383931476538, 'recall': 0.9941148365700796, 'f1': 0.9956694971183916}
Validation Metrics: {'accuracy': 0.9950522883166536, 'precision': 0.9911275975495959, 'recall': 0.98768190006088, 'f1': 0.9893960026041977}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 21/30, Step 20/1,Classification Loss: 0.3455, Contrastive Loss: 0.0347
Epoch 21/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0268
Epoch 21/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0402
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 120/1,Classification Loss: 0.3266, Contrastive Loss: 0.0301
Accuracy: 0.9981, Precision: 0.9972, Recall: 0.9948, F1: 0.9960
Accuracy: 0.9955, Precision: 0.9911, Recall: 0.9897, F1: 0.9904
Epoch 21/30
Training - Loss: 48.2844
Training Metrics: {'accuracy': 0.9981034873188406, 'precision': 0.9972469519398484, 'recall': 0.9947509315102563, 'f1': 0.9959943840186831}
Validation Metrics: {'accuracy': 0.9955020802878669, 'precision': 0.991070128688418, 'recall': 0.9896932840589893, 'f1': 0.9903803114083471}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 22/30, Step 20/1,Classification Loss: 0.3260, Contrastive Loss: 0.0263
Epoch 22/30, Step 40/1,Classification Loss: 0.3146, Contrastive Loss: 0.0240
Epoch 22/30, Step 60/1,Classification Loss: 0.3198, Contrastive Loss: 0.0277
Epoch 22/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0383
Epoch 22/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0305
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Accuracy: 0.9981, Precision: 0.9968, Recall: 0.9951, F1: 0.9959
Accuracy: 0.9955, Precision: 0.9894, Recall: 0.9914, F1: 0.9904
Epoch 22/30
Training - Loss: 48.0495
Training Metrics: {'accuracy': 0.9980751811594203, 'precision': 0.9967887581245778, 'recall': 0.9950600215454815, 'f1': 0.9959222070777167}
Validation Metrics: {'accuracy': 0.9955020802878669, 'precision': 0.9893895290988046, 'recall': 0.9914445562090037, 'f1': 0.9904139289826606}
Epoch 23/30, Step 0/1,Classification Loss: 0.3638, Contrastive Loss: 0.0796
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 23/30, Step 60/1,Classification Loss: 0.3496, Contrastive Loss: 0.0420
Epoch 23/30, Step 80/1,Classification Loss: 0.3181, Contrastive Loss: 0.0252
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 23/30, Step 120/1,Classification Loss: 0.3208, Contrastive Loss: 0.0240
Accuracy: 0.9982, Precision: 0.9976, Recall: 0.9950, F1: 0.9963
Accuracy: 0.9951, Precision: 0.9904, Recall: 0.9884, F1: 0.9894
Epoch 23/30
Training - Loss: 48.2248
Training Metrics: {'accuracy': 0.998245018115942, 'precision': 0.9975773415915006, 'recall': 0.9949679514467756, 'f1': 0.9962676886210122}
Validation Metrics: {'accuracy': 0.9950522883166536, 'precision': 0.9904456854124428, 'recall': 0.9883824089208858, 'f1': 0.9894109086594938}
Epoch 24/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0369
Epoch 24/30, Step 20/1,Classification Loss: 0.3440, Contrastive Loss: 0.0407
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 24/30, Step 100/1,Classification Loss: 0.3286, Contrastive Loss: 0.0251
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Accuracy: 0.9981, Precision: 0.9975, Recall: 0.9944, F1: 0.9959
Accuracy: 0.9952, Precision: 0.9895, Recall: 0.9898, F1: 0.9897
Epoch 24/30
Training - Loss: 48.1147
Training Metrics: {'accuracy': 0.9980751811594203, 'precision': 0.9974838878682479, 'recall': 0.9943690026585481, 'f1': 0.9959193617072235}
Validation Metrics: {'accuracy': 0.9951647363094569, 'precision': 0.989505604466302, 'recall': 0.9898484546029211, 'f1': 0.9896769428056593}
Epoch 25/30, Step 0/1,Classification Loss: 0.3323, Contrastive Loss: 0.0256
Epoch 25/30, Step 20/1,Classification Loss: 0.3237, Contrastive Loss: 0.0262
Epoch 25/30, Step 40/1,Classification Loss: 0.3198, Contrastive Loss: 0.0232
Epoch 25/30, Step 60/1,Classification Loss: 0.3207, Contrastive Loss: 0.0221
Epoch 25/30, Step 80/1,Classification Loss: 0.3265, Contrastive Loss: 0.0232
Epoch 25/30, Step 100/1,Classification Loss: 0.3323, Contrastive Loss: 0.0367
Epoch 25/30, Step 120/1,Classification Loss: 0.3281, Contrastive Loss: 0.0240
Accuracy: 0.9982, Precision: 0.9976, Recall: 0.9947, F1: 0.9961
Accuracy: 0.9955, Precision: 0.9921, Recall: 0.9886, F1: 0.9904
Epoch 25/30
Training - Loss: 47.7994
Training Metrics: {'accuracy': 0.9981884057971014, 'precision': 0.997630152717895, 'recall': 0.9946690814068678, 'f1': 0.9961432347830866}
Validation Metrics: {'accuracy': 0.9955020802878669, 'precision': 0.9920950054859308, 'recall': 0.9886425207689804, 'f1': 0.9903600023674524}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0335
Epoch 26/30, Step 40/1,Classification Loss: 0.3267, Contrastive Loss: 0.0208
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 80/1,Classification Loss: 0.3456, Contrastive Loss: 0.0396
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0332
Accuracy: 0.9982, Precision: 0.9975, Recall: 0.9948, F1: 0.9961
Accuracy: 0.9954, Precision: 0.9907, Recall: 0.9896, F1: 0.9901
Epoch 26/30
Training - Loss: 47.5493
Training Metrics: {'accuracy': 0.9981884057971014, 'precision': 0.9975410353590036, 'recall': 0.994751338942584, 'f1': 0.9961405245151234}
Validation Metrics: {'accuracy': 0.9953896322950635, 'precision': 0.9906598678601599, 'recall': 0.9896282560969656, 'f1': 0.9901432782649868}
Epoch 27/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0214
Epoch 27/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0188
Epoch 27/30, Step 40/1,Classification Loss: 0.3207, Contrastive Loss: 0.0216
Epoch 27/30, Step 60/1,Classification Loss: 0.3176, Contrastive Loss: 0.0191
Epoch 27/30, Step 80/1,Classification Loss: 0.3146, Contrastive Loss: 0.0205
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 120/1,Classification Loss: 0.3310, Contrastive Loss: 0.0264
Accuracy: 0.9982, Precision: 0.9976, Recall: 0.9946, F1: 0.9961
Accuracy: 0.9953, Precision: 0.9906, Recall: 0.9892, F1: 0.9899
Epoch 27/30
Training - Loss: 47.5179
Training Metrics: {'accuracy': 0.9981600996376812, 'precision': 0.9976158858294184, 'recall': 0.9945738409658544, 'f1': 0.9960881212759677}
Validation Metrics: {'accuracy': 0.9952771843022602, 'precision': 0.9905884678712249, 'recall': 0.989212973704939, 'f1': 0.9898993269787644}
Epoch 28/30, Step 0/1,Classification Loss: 0.3268, Contrastive Loss: 0.0205
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 40/1,Classification Loss: 0.3271, Contrastive Loss: 0.0214
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0199
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 120/1,Classification Loss: 0.3238, Contrastive Loss: 0.0198
Accuracy: 0.9981, Precision: 0.9972, Recall: 0.9946, F1: 0.9959
Accuracy: 0.9949, Precision: 0.9894, Recall: 0.9890, F1: 0.9892
Epoch 28/30
Training - Loss: 47.2493
Training Metrics: {'accuracy': 0.9980751811594203, 'precision': 0.9972070229064371, 'recall': 0.9945856965585189, 'f1': 0.9958913626862755}
Validation Metrics: {'accuracy': 0.9949398403238502, 'precision': 0.9893607442166149, 'recall': 0.989017889818868, 'f1': 0.9891892302219184}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 20/1,Classification Loss: 0.3279, Contrastive Loss: 0.0201
Epoch 29/30, Step 40/1,Classification Loss: 0.3163, Contrastive Loss: 0.0186
Epoch 29/30, Step 60/1,Classification Loss: 0.3348, Contrastive Loss: 0.0231
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 120/1,Classification Loss: 0.3314, Contrastive Loss: 0.0334
Accuracy: 0.9980, Precision: 0.9975, Recall: 0.9943, F1: 0.9959
Accuracy: 0.9953, Precision: 0.9909, Recall: 0.9889, F1: 0.9899
Epoch 29/30
Training - Loss: 47.3094
Training Metrics: {'accuracy': 0.998046875, 'precision': 0.9974646399096031, 'recall': 0.994256776039365, 'f1': 0.9958532005941487}
Validation Metrics: {'accuracy': 0.9952771843022602, 'precision': 0.9909280249408533, 'recall': 0.9888627192749361, 'f1': 0.989892230993153}
Epoch 30/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0188
Epoch 30/30, Step 20/1,Classification Loss: 0.3294, Contrastive Loss: 0.0329
Epoch 30/30, Step 40/1,Classification Loss: 0.3301, Contrastive Loss: 0.0367
Epoch 30/30, Step 60/1,Classification Loss: 0.3183, Contrastive Loss: 0.0190
Epoch 30/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0177
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Accuracy: 0.9981, Precision: 0.9975, Recall: 0.9945, F1: 0.9960
Accuracy: 0.9949, Precision: 0.9911, Recall: 0.9873, F1: 0.9892
Epoch 30/30
Training - Loss: 47.2609
Training Metrics: {'accuracy': 0.9981034873188406, 'precision': 0.9974954710125119, 'recall': 0.9944549291794914, 'f1': 0.995968462071214}
Validation Metrics: {'accuracy': 0.9949398403238502, 'precision': 0.9910569229596891, 'recall': 0.9872666176688534, 'f1': 0.9891511832769713}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1963, 5814), y shape: (1963,), y distribution: Counter({np.float64(0.0): 1767, np.float64(1.0): 196}), env shape: (1963,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9740, Precision: 0.9153, Recall: 0.9470, F1: 0.9304
month: 2019-11, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1965, 5814), y shape: (1965,), y distribution: Counter({np.float64(0.0): 1769, np.float64(1.0): 196}), env shape: (1965,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9725, Precision: 0.9036, Recall: 0.9575, F1: 0.9283
month: 2019-12, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1945, 5814), y shape: (1945,), y distribution: Counter({np.float64(0.0): 1761, np.float64(1.0): 184}), env shape: (1945,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9661, Precision: 0.8788, Recall: 0.9472, F1: 0.9092
month: 2020-01, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1969, 5814), y shape: (1969,), y distribution: Counter({np.float64(0.0): 1775, np.float64(1.0): 194}), env shape: (1969,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9777, Precision: 0.9424, Recall: 0.9302, F1: 0.9362
month: 2020-02, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1952, 5814), y shape: (1952,), y distribution: Counter({np.float64(0.0): 1761, np.float64(1.0): 191}), env shape: (1952,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9452, Precision: 0.8245, Recall: 0.9299, F1: 0.8669
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10415]))
original train data shape: torch.Size([44562]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1952, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44562]), new train data shape: torch.Size([44562])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10415]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 1.6338
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.9770
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.5766
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2937
Epoch 1/30, Step 80/1,Classification Loss: 0.3322, Contrastive Loss: 0.2236
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1773
Epoch 1/30, Step 120/1,Classification Loss: 0.3301, Contrastive Loss: 0.1795
Accuracy: 0.9971, Precision: 0.9954, Recall: 0.9924, F1: 0.9939
Accuracy: 0.9954, Precision: 0.9907, Recall: 0.9897, F1: 0.9902
Epoch 1/30
Training - Loss: 112.4764
Training Metrics: {'accuracy': 0.9971335431654677, 'precision': 0.9953629629728662, 'recall': 0.992432272413358, 'f1': 0.9938913364599948}
Validation Metrics: {'accuracy': 0.9953999775608662, 'precision': 0.9906827309323486, 'recall': 0.9896536898372263, 'f1': 0.9901674305233891}
Epoch 2/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.1586
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1416
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1352
Epoch 2/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1410
Epoch 2/30, Step 80/1,Classification Loss: 0.3447, Contrastive Loss: 0.1541
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1215
Epoch 2/30, Step 120/1,Classification Loss: 0.3287, Contrastive Loss: 0.1288
Accuracy: 0.9974, Precision: 0.9963, Recall: 0.9926, F1: 0.9944
Accuracy: 0.9953, Precision: 0.9893, Recall: 0.9906, F1: 0.9900
Epoch 2/30
Training - Loss: 64.4275
Training Metrics: {'accuracy': 0.9973864658273381, 'precision': 0.9962903497085542, 'recall': 0.9925700610917264, 'f1': 0.9944201069218158}
Validation Metrics: {'accuracy': 0.995287781891619, 'precision': 0.9892702700790232, 'recall': 0.9906369024362816, 'f1': 0.9899522081275172}
Epoch 3/30, Step 0/1,Classification Loss: 0.3350, Contrastive Loss: 0.1267
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1133
Epoch 3/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1232
Epoch 3/30, Step 60/1,Classification Loss: 0.3147, Contrastive Loss: 0.1094
Epoch 3/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.1067
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1037
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1014
Accuracy: 0.9976, Precision: 0.9971, Recall: 0.9927, F1: 0.9949
Accuracy: 0.9960, Precision: 0.9914, Recall: 0.9914, F1: 0.9914
Epoch 3/30
Training - Loss: 61.3560
Training Metrics: {'accuracy': 0.9976112859712231, 'precision': 0.997126360091389, 'recall': 0.992721731881842, 'f1': 0.9949098912125729}
Validation Metrics: {'accuracy': 0.995960955907102, 'precision': 0.9913755751713069, 'recall': 0.9913755751713069, 'f1': 0.9913755751713069}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1000
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0984
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0958
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0935
Epoch 4/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0968
Epoch 4/30, Step 100/1,Classification Loss: 0.3191, Contrastive Loss: 0.0957
Epoch 4/30, Step 120/1,Classification Loss: 0.3282, Contrastive Loss: 0.0913
Accuracy: 0.9978, Precision: 0.9975, Recall: 0.9932, F1: 0.9953
Accuracy: 0.9956, Precision: 0.9902, Recall: 0.9912, F1: 0.9907
Epoch 4/30
Training - Loss: 58.8968
Training Metrics: {'accuracy': 0.9978080035971223, 'precision': 0.9975059337683571, 'recall': 0.9931931880482456, 'f1': 0.9953359923140341}
Validation Metrics: {'accuracy': 0.9956243688993605, 'precision': 0.9901539380921676, 'recall': 0.9911809216545667, 'f1': 0.9906666530983228}
Epoch 5/30, Step 0/1,Classification Loss: 0.3243, Contrastive Loss: 0.0918
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0875
Epoch 5/30, Step 40/1,Classification Loss: 0.3336, Contrastive Loss: 0.0986
Epoch 5/30, Step 60/1,Classification Loss: 0.3138, Contrastive Loss: 0.0873
Epoch 5/30, Step 80/1,Classification Loss: 0.3137, Contrastive Loss: 0.0838
Epoch 5/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0818
Epoch 5/30, Step 120/1,Classification Loss: 0.3154, Contrastive Loss: 0.0829
Accuracy: 0.9979, Precision: 0.9977, Recall: 0.9934, F1: 0.9956
Accuracy: 0.9955, Precision: 0.9908, Recall: 0.9901, F1: 0.9904
Epoch 5/30
Training - Loss: 57.1506
Training Metrics: {'accuracy': 0.9979204136690647, 'precision': 0.9977436659834266, 'recall': 0.9934169560510997, 'f1': 0.9955666769353739}
Validation Metrics: {'accuracy': 0.9955121732301133, 'precision': 0.990753961503595, 'recall': 0.9900679400443515, 'f1': 0.9904106043029952}
Epoch 6/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0793
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0776
Epoch 6/30, Step 40/1,Classification Loss: 0.3327, Contrastive Loss: 0.0814
Epoch 6/30, Step 60/1,Classification Loss: 0.3285, Contrastive Loss: 0.0790
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0744
Epoch 6/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0765
Epoch 6/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0735
Accuracy: 0.9977, Precision: 0.9978, Recall: 0.9926, F1: 0.9952
Accuracy: 0.9955, Precision: 0.9908, Recall: 0.9901, F1: 0.9904
Epoch 6/30
Training - Loss: 55.9836
Training Metrics: {'accuracy': 0.9977236960431655, 'precision': 0.9978132989672921, 'recall': 0.9926024485724265, 'f1': 0.9951879835419348}
Validation Metrics: {'accuracy': 0.9955121732301133, 'precision': 0.990753961503595, 'recall': 0.9900679400443515, 'f1': 0.9904106043029952}
Epoch 7/30, Step 0/1,Classification Loss: 0.3312, Contrastive Loss: 0.0754
Epoch 7/30, Step 20/1,Classification Loss: 0.3267, Contrastive Loss: 0.0733
Epoch 7/30, Step 40/1,Classification Loss: 0.3308, Contrastive Loss: 0.0749
Epoch 7/30, Step 60/1,Classification Loss: 0.3328, Contrastive Loss: 0.0834
Epoch 7/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.0716
Epoch 7/30, Step 100/1,Classification Loss: 0.3402, Contrastive Loss: 0.0712
Epoch 7/30, Step 120/1,Classification Loss: 0.3222, Contrastive Loss: 0.0675
Accuracy: 0.9975, Precision: 0.9977, Recall: 0.9919, F1: 0.9948
Accuracy: 0.9954, Precision: 0.9914, Recall: 0.9890, F1: 0.9902
Epoch 7/30
Training - Loss: 54.9784
Training Metrics: {'accuracy': 0.9975269784172662, 'precision': 0.9976971944538426, 'recall': 0.9918794836321896, 'f1': 0.99476354588388}
Validation Metrics: {'accuracy': 0.9953999775608662, 'precision': 0.9913608518086348, 'recall': 0.9889549584341364, 'f1': 0.9901536455718187}
Epoch 8/30, Step 0/1,Classification Loss: 0.3151, Contrastive Loss: 0.0675
Epoch 8/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.0888
Epoch 8/30, Step 40/1,Classification Loss: 0.3299, Contrastive Loss: 0.0780
Epoch 8/30, Step 60/1,Classification Loss: 0.3179, Contrastive Loss: 0.0648
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0617
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0613
Epoch 8/30, Step 120/1,Classification Loss: 0.3190, Contrastive Loss: 0.0614
Accuracy: 0.9974, Precision: 0.9977, Recall: 0.9912, F1: 0.9944
Accuracy: 0.9946, Precision: 0.9912, Recall: 0.9857, F1: 0.9884
Epoch 8/30
Training - Loss: 54.0467
Training Metrics: {'accuracy': 0.9973864658273381, 'precision': 0.9976960327092079, 'recall': 0.9912133324384895, 'f1': 0.9944240091881643}
Validation Metrics: {'accuracy': 0.994614607876136, 'precision': 0.9912109534275781, 'recall': 0.9857058412827155, 'f1': 0.9884360465455722}
Epoch 9/30, Step 0/1,Classification Loss: 0.3174, Contrastive Loss: 0.0621
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0588
Epoch 9/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0616
Epoch 9/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0712
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0566
Epoch 9/30, Step 100/1,Classification Loss: 0.3281, Contrastive Loss: 0.0589
Epoch 9/30, Step 120/1,Classification Loss: 0.3286, Contrastive Loss: 0.0575
Accuracy: 0.9976, Precision: 0.9980, Recall: 0.9920, F1: 0.9950
Accuracy: 0.9953, Precision: 0.9910, Recall: 0.9889, F1: 0.9899
Epoch 9/30
Training - Loss: 53.2439
Training Metrics: {'accuracy': 0.9976393884892086, 'precision': 0.9980190675107791, 'recall': 0.9919642718417473, 'f1': 0.9949649413870527}
Validation Metrics: {'accuracy': 0.995287781891619, 'precision': 0.990950228198493, 'recall': 0.9888900739285562, 'f1': 0.9899170254037111}
Epoch 10/30, Step 0/1,Classification Loss: 0.3199, Contrastive Loss: 0.0564
Epoch 10/30, Step 20/1,Classification Loss: 0.3307, Contrastive Loss: 0.0631
Epoch 10/30, Step 40/1,Classification Loss: 0.3318, Contrastive Loss: 0.0571
Epoch 10/30, Step 60/1,Classification Loss: 0.3261, Contrastive Loss: 0.0542
Epoch 10/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0534
Epoch 10/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0656
Epoch 10/30, Step 120/1,Classification Loss: 0.3305, Contrastive Loss: 0.0541
Accuracy: 0.9981, Precision: 0.9980, Recall: 0.9939, F1: 0.9959
Accuracy: 0.9955, Precision: 0.9908, Recall: 0.9901, F1: 0.9904
Epoch 10/30
Training - Loss: 52.7374
Training Metrics: {'accuracy': 0.9980890287769785, 'precision': 0.9980203643169292, 'recall': 0.993882382325967, 'f1': 0.9959388907681868}
Validation Metrics: {'accuracy': 0.9955121732301133, 'precision': 0.990753961503595, 'recall': 0.9900679400443515, 'f1': 0.9904106043029952}
Epoch 11/30, Step 0/1,Classification Loss: 0.3208, Contrastive Loss: 0.0528
Epoch 11/30, Step 20/1,Classification Loss: 0.3348, Contrastive Loss: 0.0533
Epoch 11/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0497
Epoch 11/30, Step 60/1,Classification Loss: 0.3333, Contrastive Loss: 0.0539
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0479
Epoch 11/30, Step 100/1,Classification Loss: 0.3199, Contrastive Loss: 0.0484
Epoch 11/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0474
Accuracy: 0.9983, Precision: 0.9983, Recall: 0.9947, F1: 0.9965
Accuracy: 0.9957, Precision: 0.9912, Recall: 0.9905, F1: 0.9909
Epoch 11/30
Training - Loss: 52.0445
Training Metrics: {'accuracy': 0.998341951438849, 'precision': 0.9982502208397526, 'recall': 0.9946883407203824, 'f1': 0.9964600678321197}
Validation Metrics: {'accuracy': 0.9957365645686077, 'precision': 0.9912337669328843, 'recall': 0.9905470747570567, 'f1': 0.9908900740878455}
Epoch 12/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0542
Epoch 12/30, Step 20/1,Classification Loss: 0.3146, Contrastive Loss: 0.0469
Epoch 12/30, Step 40/1,Classification Loss: 0.3168, Contrastive Loss: 0.0462
Epoch 12/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0453
Epoch 12/30, Step 80/1,Classification Loss: 0.3396, Contrastive Loss: 0.0593
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0435
Epoch 12/30, Step 120/1,Classification Loss: 0.3215, Contrastive Loss: 0.0441
Accuracy: 0.9978, Precision: 0.9982, Recall: 0.9926, F1: 0.9954
Accuracy: 0.9954, Precision: 0.9910, Recall: 0.9893, F1: 0.9902
Epoch 12/30
Training - Loss: 51.3406
Training Metrics: {'accuracy': 0.9978361061151079, 'precision': 0.9982208732200224, 'recall': 0.9925903229182764, 'f1': 0.9953825122252997}
Validation Metrics: {'accuracy': 0.9953999775608662, 'precision': 0.9910211032449052, 'recall': 0.9893043241356814, 'f1': 0.9901605439354642}
Epoch 13/30, Step 0/1,Classification Loss: 0.3344, Contrastive Loss: 0.0470
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Epoch 13/30, Step 40/1,Classification Loss: 0.3409, Contrastive Loss: 0.0478
Epoch 13/30, Step 60/1,Classification Loss: 0.3145, Contrastive Loss: 0.0425
Epoch 13/30, Step 80/1,Classification Loss: 0.3415, Contrastive Loss: 0.0440
Epoch 13/30, Step 100/1,Classification Loss: 0.3285, Contrastive Loss: 0.0440
Epoch 13/30, Step 120/1,Classification Loss: 0.3357, Contrastive Loss: 0.0474
Accuracy: 0.9976, Precision: 0.9976, Recall: 0.9921, F1: 0.9948
Accuracy: 0.9947, Precision: 0.9896, Recall: 0.9879, F1: 0.9887
Epoch 13/30
Training - Loss: 50.9272
Training Metrics: {'accuracy': 0.9975831834532374, 'precision': 0.9976303851309714, 'recall': 0.9920667841455766, 'f1': 0.9948260573412129}
Validation Metrics: {'accuracy': 0.9947268035453831, 'precision': 0.9895786558131295, 'recall': 0.9878669199975658, 'f1': 0.9887206235357759}
Epoch 14/30, Step 0/1,Classification Loss: 0.3177, Contrastive Loss: 0.0414
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0386
Epoch 14/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0388
Epoch 14/30, Step 60/1,Classification Loss: 0.3151, Contrastive Loss: 0.0397
Epoch 14/30, Step 80/1,Classification Loss: 0.3598, Contrastive Loss: 0.0830
Epoch 14/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0375
Epoch 14/30, Step 120/1,Classification Loss: 0.3292, Contrastive Loss: 0.1091
Accuracy: 0.9977, Precision: 0.9980, Recall: 0.9921, F1: 0.9951
Accuracy: 0.9943, Precision: 0.9907, Recall: 0.9848, F1: 0.9877
Epoch 14/30
Training - Loss: 50.5791
Training Metrics: {'accuracy': 0.9976674910071942, 'precision': 0.9980387594034359, 'recall': 0.9921150100543887, 'f1': 0.9950512268393064}
Validation Metrics: {'accuracy': 0.9942780208683945, 'precision': 0.9906559257135459, 'recall': 0.9848124563628853, 'f1': 0.9877089702591004}
Epoch 15/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0723
Epoch 15/30, Step 20/1,Classification Loss: 0.3191, Contrastive Loss: 0.0376
Epoch 15/30, Step 40/1,Classification Loss: 0.3398, Contrastive Loss: 0.0390
Epoch 15/30, Step 60/1,Classification Loss: 0.3140, Contrastive Loss: 0.0365
Epoch 15/30, Step 80/1,Classification Loss: 0.3163, Contrastive Loss: 0.0358
Epoch 15/30, Step 100/1,Classification Loss: 0.3163, Contrastive Loss: 0.0360
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Accuracy: 0.9983, Precision: 0.9967, Recall: 0.9963, F1: 0.9965
Accuracy: 0.9950, Precision: 0.9864, Recall: 0.9922, F1: 0.9893
Epoch 15/30
Training - Loss: 50.0059
Training Metrics: {'accuracy': 0.998341951438849, 'precision': 0.9966875172338946, 'recall': 0.9962551048057755, 'f1': 0.9964711749926705}
Validation Metrics: {'accuracy': 0.9949511948838775, 'precision': 0.9864262098388581, 'recall': 0.9921890774272665, 'f1': 0.9892830360896769}
Epoch 16/30, Step 0/1,Classification Loss: 0.3285, Contrastive Loss: 0.0357
Epoch 16/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0341
Epoch 16/30, Step 40/1,Classification Loss: 0.3254, Contrastive Loss: 0.0363
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0330
Epoch 16/30, Step 80/1,Classification Loss: 0.3172, Contrastive Loss: 0.0344
Epoch 16/30, Step 100/1,Classification Loss: 0.3217, Contrastive Loss: 0.0344
Epoch 16/30, Step 120/1,Classification Loss: 0.3291, Contrastive Loss: 0.0362
Accuracy: 0.9982, Precision: 0.9981, Recall: 0.9943, F1: 0.9962
Accuracy: 0.9957, Precision: 0.9912, Recall: 0.9905, F1: 0.9909
Epoch 16/30
Training - Loss: 49.6221
Training Metrics: {'accuracy': 0.9982014388489209, 'precision': 0.9980803105641747, 'recall': 0.9942577067103084, 'f1': 0.9961583928557054}
Validation Metrics: {'accuracy': 0.9957365645686077, 'precision': 0.9912337669328843, 'recall': 0.9905470747570567, 'f1': 0.9908900740878455}
Epoch 17/30, Step 0/1,Classification Loss: 0.3237, Contrastive Loss: 0.0331
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 17/30, Step 60/1,Classification Loss: 0.3162, Contrastive Loss: 0.0310
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 17/30, Step 100/1,Classification Loss: 0.3286, Contrastive Loss: 0.0315
Epoch 17/30, Step 120/1,Classification Loss: 0.3581, Contrastive Loss: 0.0346
Accuracy: 0.9983, Precision: 0.9983, Recall: 0.9943, F1: 0.9963
Accuracy: 0.9955, Precision: 0.9904, Recall: 0.9904, F1: 0.9904
Epoch 17/30
Training - Loss: 49.3192
Training Metrics: {'accuracy': 0.9982576438848921, 'precision': 0.9982924752809638, 'recall': 0.9943210778869136, 'f1': 0.9962952918243227}
Validation Metrics: {'accuracy': 0.9955121732301133, 'precision': 0.9904173057458966, 'recall': 0.9904173057458966, 'f1': 0.9904173057458966}
Epoch 18/30, Step 0/1,Classification Loss: 0.3165, Contrastive Loss: 0.0297
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0303
Epoch 18/30, Step 60/1,Classification Loss: 0.3268, Contrastive Loss: 0.0316
Epoch 18/30, Step 80/1,Classification Loss: 0.3238, Contrastive Loss: 0.0291
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0275
Epoch 18/30, Step 120/1,Classification Loss: 0.3149, Contrastive Loss: 0.0283
Accuracy: 0.9981, Precision: 0.9984, Recall: 0.9935, F1: 0.9959
Accuracy: 0.9955, Precision: 0.9911, Recall: 0.9897, F1: 0.9904
Epoch 18/30
Training - Loss: 48.7857
Training Metrics: {'accuracy': 0.9980609262589928, 'precision': 0.9983543388577756, 'recall': 0.9934526486806616, 'f1': 0.995885959661592}
Validation Metrics: {'accuracy': 0.9955121732301133, 'precision': 0.9910919846945542, 'recall': 0.9897185743428065, 'f1': 0.9904038914142121}
Epoch 19/30, Step 0/1,Classification Loss: 0.3146, Contrastive Loss: 0.0278
Epoch 19/30, Step 20/1,Classification Loss: 0.3150, Contrastive Loss: 0.0282
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0266
Epoch 19/30, Step 60/1,Classification Loss: 0.3263, Contrastive Loss: 0.0289
Epoch 19/30, Step 80/1,Classification Loss: 0.3280, Contrastive Loss: 0.0286
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 19/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0279
Accuracy: 0.9983, Precision: 0.9976, Recall: 0.9952, F1: 0.9964
Accuracy: 0.9954, Precision: 0.9897, Recall: 0.9907, F1: 0.9902
Epoch 19/30
Training - Loss: 48.9980
Training Metrics: {'accuracy': 0.9983138489208633, 'precision': 0.9976365941564331, 'recall': 0.9952349091762773, 'f1': 0.9964315412284146}
Validation Metrics: {'accuracy': 0.9953999775608662, 'precision': 0.9896758051762595, 'recall': 0.9907017869418615, 'f1': 0.9901880199238778}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Epoch 20/30, Step 40/1,Classification Loss: 0.3371, Contrastive Loss: 0.0352
Epoch 20/30, Step 60/1,Classification Loss: 0.3167, Contrastive Loss: 0.0280
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 20/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0247
Epoch 20/30, Step 120/1,Classification Loss: 0.3281, Contrastive Loss: 0.0284
Accuracy: 0.9976, Precision: 0.9981, Recall: 0.9916, F1: 0.9948
Accuracy: 0.9945, Precision: 0.9905, Recall: 0.9860, F1: 0.9882
Epoch 20/30
Training - Loss: 48.4003
Training Metrics: {'accuracy': 0.9975550809352518, 'precision': 0.9980599924002859, 'recall': 0.9916065060781322, 'f1': 0.9948028139088971}
Validation Metrics: {'accuracy': 0.9945024122068888, 'precision': 0.9904542794292749, 'recall': 0.9859903224786806, 'f1': 0.9882075877352562}
Epoch 21/30, Step 0/1,Classification Loss: 0.3216, Contrastive Loss: 0.0261
Epoch 21/30, Step 20/1,Classification Loss: 0.3296, Contrastive Loss: 0.0276
Epoch 21/30, Step 40/1,Classification Loss: 0.3190, Contrastive Loss: 0.0248
Epoch 21/30, Step 60/1,Classification Loss: 0.3161, Contrastive Loss: 0.0250
Epoch 21/30, Step 80/1,Classification Loss: 0.3143, Contrastive Loss: 0.0241
Epoch 21/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0260
Epoch 21/30, Step 120/1,Classification Loss: 0.3232, Contrastive Loss: 0.0238
Accuracy: 0.9982, Precision: 0.9984, Recall: 0.9940, F1: 0.9962
Accuracy: 0.9951, Precision: 0.9885, Recall: 0.9905, F1: 0.9895
Epoch 21/30
Training - Loss: 48.3557
Training Metrics: {'accuracy': 0.9982014388489209, 'precision': 0.9984359152190272, 'recall': 0.9939620980486361, 'f1': 0.996184409349055}
Validation Metrics: {'accuracy': 0.9950633905531246, 'precision': 0.988461204912153, 'recall': 0.9905071334251214, 'f1': 0.989481075850023}
Epoch 22/30, Step 0/1,Classification Loss: 0.3320, Contrastive Loss: 0.0348
Epoch 22/30, Step 20/1,Classification Loss: 0.3197, Contrastive Loss: 0.0246
Epoch 22/30, Step 40/1,Classification Loss: 0.3301, Contrastive Loss: 0.0268
Epoch 22/30, Step 60/1,Classification Loss: 0.3335, Contrastive Loss: 0.0274
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 22/30, Step 100/1,Classification Loss: 0.3177, Contrastive Loss: 0.0234
Epoch 22/30, Step 120/1,Classification Loss: 0.3264, Contrastive Loss: 0.0225
Accuracy: 0.9977, Precision: 0.9981, Recall: 0.9921, F1: 0.9951
Accuracy: 0.9946, Precision: 0.9912, Recall: 0.9857, F1: 0.9884
Epoch 22/30
Training - Loss: 48.1173
Training Metrics: {'accuracy': 0.9976955935251799, 'precision': 0.9981427388415529, 'recall': 0.9921376385631497, 'f1': 0.9951138157891432}
Validation Metrics: {'accuracy': 0.994614607876136, 'precision': 0.9912109534275781, 'recall': 0.9857058412827155, 'f1': 0.9884360465455722}
Epoch 23/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0215
Epoch 23/30, Step 20/1,Classification Loss: 0.3455, Contrastive Loss: 0.0438
Epoch 23/30, Step 40/1,Classification Loss: 0.3616, Contrastive Loss: 0.0426
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 80/1,Classification Loss: 0.3171, Contrastive Loss: 0.0228
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 23/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0207
Accuracy: 0.9982, Precision: 0.9984, Recall: 0.9939, F1: 0.9961
Accuracy: 0.9948, Precision: 0.9890, Recall: 0.9890, F1: 0.9890
Epoch 23/30
Training - Loss: 47.6729
Training Metrics: {'accuracy': 0.9981733363309353, 'precision': 0.998419071741423, 'recall': 0.9938535019145116, 'f1': 0.9961210909162801}
Validation Metrics: {'accuracy': 0.9948389992146304, 'precision': 0.988979901607781, 'recall': 0.988979901607781, 'f1': 0.988979901607781}
Epoch 24/30, Step 0/1,Classification Loss: 0.3166, Contrastive Loss: 0.0223
Epoch 24/30, Step 20/1,Classification Loss: 0.3278, Contrastive Loss: 0.0215
Epoch 24/30, Step 40/1,Classification Loss: 0.3424, Contrastive Loss: 0.0358
Epoch 24/30, Step 60/1,Classification Loss: 0.3170, Contrastive Loss: 0.0215
Epoch 24/30, Step 80/1,Classification Loss: 0.3214, Contrastive Loss: 0.0226
Epoch 24/30, Step 100/1,Classification Loss: 0.3144, Contrastive Loss: 0.0210
Epoch 24/30, Step 120/1,Classification Loss: 0.3161, Contrastive Loss: 0.0202
Accuracy: 0.9985, Precision: 0.9978, Recall: 0.9959, F1: 0.9969
Accuracy: 0.9953, Precision: 0.9893, Recall: 0.9906, F1: 0.9900
Epoch 24/30
Training - Loss: 47.6598
Training Metrics: {'accuracy': 0.9985105665467626, 'precision': 0.99784134852656, 'recall': 0.9958725303822349, 'f1': 0.9968541094403949}
Validation Metrics: {'accuracy': 0.995287781891619, 'precision': 0.9892702700790232, 'recall': 0.9906369024362816, 'f1': 0.9899522081275172}
Epoch 25/30, Step 0/1,Classification Loss: 0.3471, Contrastive Loss: 0.0412
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 25/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0352
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 25/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0233
Epoch 25/30, Step 100/1,Classification Loss: 0.3244, Contrastive Loss: 0.0202
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Accuracy: 0.9985, Precision: 0.9985, Recall: 0.9952, F1: 0.9968
Accuracy: 0.9951, Precision: 0.9888, Recall: 0.9902, F1: 0.9895
Epoch 25/30
Training - Loss: 47.7878
Training Metrics: {'accuracy': 0.9985105665467626, 'precision': 0.998530118059614, 'recall': 0.9951824947169654, 'f1': 0.9968481337034721}
Validation Metrics: {'accuracy': 0.9950633905531246, 'precision': 0.9887924699601871, 'recall': 0.9901577677235763, 'f1': 0.9894737418478752}
Epoch 26/30, Step 0/1,Classification Loss: 0.3150, Contrastive Loss: 0.0207
Epoch 26/30, Step 20/1,Classification Loss: 0.3212, Contrastive Loss: 0.0236
Epoch 26/30, Step 40/1,Classification Loss: 0.3396, Contrastive Loss: 0.0243
Epoch 26/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0187
Epoch 26/30, Step 80/1,Classification Loss: 0.3200, Contrastive Loss: 0.0192
Epoch 26/30, Step 100/1,Classification Loss: 0.3281, Contrastive Loss: 0.0214
Epoch 26/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0190
Accuracy: 0.9984, Precision: 0.9986, Recall: 0.9947, F1: 0.9966
Accuracy: 0.9947, Precision: 0.9876, Recall: 0.9900, F1: 0.9888
Epoch 26/30
Training - Loss: 47.3203
Training Metrics: {'accuracy': 0.9983981564748201, 'precision': 0.9985551304932412, 'recall': 0.9947286735053185, 'f1': 0.9966311795717228}
Validation Metrics: {'accuracy': 0.9947268035453831, 'precision': 0.9875808664254521, 'recall': 0.9899631142068361, 'f1': 0.9887677885042715}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0221
Epoch 27/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0231
Epoch 27/30, Step 60/1,Classification Loss: 0.3284, Contrastive Loss: 0.0201
Epoch 27/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0186
Epoch 27/30, Step 100/1,Classification Loss: 0.3237, Contrastive Loss: 0.0216
Epoch 27/30, Step 120/1,Classification Loss: 0.3278, Contrastive Loss: 0.0192
Accuracy: 0.9984, Precision: 0.9984, Recall: 0.9950, F1: 0.9967
Accuracy: 0.9952, Precision: 0.9885, Recall: 0.9909, F1: 0.9897
Epoch 27/30
Training - Loss: 47.4259
Training Metrics: {'accuracy': 0.9984262589928058, 'precision': 0.9983942189304904, 'recall': 0.9949607062751713, 'f1': 0.9966688629024942}
Validation Metrics: {'accuracy': 0.9951755862223718, 'precision': 0.9885344766527586, 'recall': 0.9909213836322465, 'f1': 0.989723721397525}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 20/1,Classification Loss: 0.3350, Contrastive Loss: 0.0344
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 80/1,Classification Loss: 0.3207, Contrastive Loss: 0.0193
Epoch 28/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0183
Epoch 28/30, Step 120/1,Classification Loss: 0.3163, Contrastive Loss: 0.0193
Accuracy: 0.9982, Precision: 0.9985, Recall: 0.9938, F1: 0.9962
Accuracy: 0.9953, Precision: 0.9910, Recall: 0.9889, F1: 0.9899
Epoch 28/30
Training - Loss: 47.2281
Training Metrics: {'accuracy': 0.9982014388489209, 'precision': 0.998520566757864, 'recall': 0.993836182635303, 'f1': 0.9961624235830794}
Validation Metrics: {'accuracy': 0.995287781891619, 'precision': 0.990950228198493, 'recall': 0.9888900739285562, 'f1': 0.9899170254037111}
Epoch 29/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0178
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 40/1,Classification Loss: 0.3177, Contrastive Loss: 0.0188
Epoch 29/30, Step 60/1,Classification Loss: 0.3281, Contrastive Loss: 0.0190
Epoch 29/30, Step 80/1,Classification Loss: 0.3258, Contrastive Loss: 0.0192
Epoch 29/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0178
Epoch 29/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0275
Accuracy: 0.9979, Precision: 0.9984, Recall: 0.9929, F1: 0.9956
Accuracy: 0.9950, Precision: 0.9918, Recall: 0.9866, F1: 0.9892
Epoch 29/30
Training - Loss: 47.3919
Training Metrics: {'accuracy': 0.9979485161870504, 'precision': 0.9983732346883168, 'recall': 0.9928982335097944, 'f1': 0.9956139420656263}
Validation Metrics: {'accuracy': 0.9949511948838775, 'precision': 0.9917653001619395, 'recall': 0.9865992262025458, 'f1': 0.9891626102393034}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 20/1,Classification Loss: 0.3316, Contrastive Loss: 0.0256
Epoch 30/30, Step 40/1,Classification Loss: 0.3146, Contrastive Loss: 0.0185
Epoch 30/30, Step 60/1,Classification Loss: 0.3419, Contrastive Loss: 0.0354
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 100/1,Classification Loss: 0.3225, Contrastive Loss: 0.0186
Epoch 30/30, Step 120/1,Classification Loss: 0.3488, Contrastive Loss: 0.0369
Accuracy: 0.9983, Precision: 0.9986, Recall: 0.9943, F1: 0.9964
Accuracy: 0.9953, Precision: 0.9910, Recall: 0.9889, F1: 0.9899
Epoch 30/30
Training - Loss: 47.3529
Training Metrics: {'accuracy': 0.9983138489208633, 'precision': 0.9985882090309651, 'recall': 0.9942833314824149, 'f1': 0.996422263407036}
Validation Metrics: {'accuracy': 0.995287781891619, 'precision': 0.990950228198493, 'recall': 0.9888900739285562, 'f1': 0.9899170254037111}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1936, 5814), y shape: (1936,), y distribution: Counter({np.float64(0.0): 1742, np.float64(1.0): 194}), env shape: (1936,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9587, Precision: 0.8867, Recall: 0.8831, F1: 0.8849
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10515]))
original train data shape: torch.Size([44662]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1936, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44662]), new train data shape: torch.Size([44662])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10515]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 1.6063
Epoch 1/30, Step 20/1,Classification Loss: 0.3313, Contrastive Loss: 0.9992
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4821
Epoch 1/30, Step 60/1,Classification Loss: 0.3354, Contrastive Loss: 0.3439
Epoch 1/30, Step 80/1,Classification Loss: 0.3591, Contrastive Loss: 0.2652
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1991
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1777
Accuracy: 0.9979, Precision: 0.9978, Recall: 0.9932, F1: 0.9955
Accuracy: 0.9947, Precision: 0.9896, Recall: 0.9879, F1: 0.9887
Epoch 1/30
Training - Loss: 111.5430
Training Metrics: {'accuracy': 0.9978923111510791, 'precision': 0.9978171176979774, 'recall': 0.9932433626466635, 'f1': 0.9955149867328357}
Validation Metrics: {'accuracy': 0.9947386096496138, 'precision': 0.9896041124369647, 'recall': 0.9878966230525328, 'f1': 0.9887482139825452}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1612
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1505
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1424
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1378
Epoch 2/30, Step 80/1,Classification Loss: 0.3269, Contrastive Loss: 0.1388
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1268
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1230
Accuracy: 0.9971, Precision: 0.9968, Recall: 0.9909, F1: 0.9938
Accuracy: 0.9941, Precision: 0.9916, Recall: 0.9830, F1: 0.9872
Epoch 2/30
Training - Loss: 65.0762
Training Metrics: {'accuracy': 0.997105440647482, 'precision': 0.996831365794113, 'recall': 0.990886462314048, 'f1': 0.993833061919388}
Validation Metrics: {'accuracy': 0.994066942796373, 'precision': 0.9915760484807294, 'recall': 0.9829779139909447, 'f1': 0.9872223996705264}
Epoch 3/30, Step 0/1,Classification Loss: 0.3242, Contrastive Loss: 0.1263
Epoch 3/30, Step 20/1,Classification Loss: 0.3206, Contrastive Loss: 0.1211
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1135
Epoch 3/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1241
Epoch 3/30, Step 80/1,Classification Loss: 0.3234, Contrastive Loss: 0.1128
Epoch 3/30, Step 100/1,Classification Loss: 0.3257, Contrastive Loss: 0.1144
Epoch 3/30, Step 120/1,Classification Loss: 0.3286, Contrastive Loss: 0.1113
Accuracy: 0.9980, Precision: 0.9972, Recall: 0.9941, F1: 0.9957
Accuracy: 0.9947, Precision: 0.9896, Recall: 0.9879, F1: 0.9887
Epoch 3/30
Training - Loss: 61.4557
Training Metrics: {'accuracy': 0.997976618705036, 'precision': 0.9972457452296045, 'recall': 0.9941172930289934, 'f1': 0.9956744042662096}
Validation Metrics: {'accuracy': 0.9947386096496138, 'precision': 0.9896041124369647, 'recall': 0.9878966230525328, 'f1': 0.9887482139825452}
Epoch 4/30, Step 0/1,Classification Loss: 0.3275, Contrastive Loss: 0.1111
Epoch 4/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.1022
Epoch 4/30, Step 40/1,Classification Loss: 0.3152, Contrastive Loss: 0.1032
Epoch 4/30, Step 60/1,Classification Loss: 0.3282, Contrastive Loss: 0.1022
Epoch 4/30, Step 80/1,Classification Loss: 0.3296, Contrastive Loss: 0.1030
Epoch 4/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0953
Epoch 4/30, Step 120/1,Classification Loss: 0.3546, Contrastive Loss: 0.1019
Accuracy: 0.9983, Precision: 0.9980, Recall: 0.9948, F1: 0.9964
Accuracy: 0.9947, Precision: 0.9876, Recall: 0.9900, F1: 0.9888
Epoch 4/30
Training - Loss: 59.1709
Training Metrics: {'accuracy': 0.9982857464028777, 'precision': 0.9979588013364762, 'recall': 0.994760465986839, 'f1': 0.996352189209373}
Validation Metrics: {'accuracy': 0.9947386096496138, 'precision': 0.9876111404319232, 'recall': 0.9899875118113439, 'f1': 0.9887951448038271}
Epoch 5/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0905
Epoch 5/30, Step 20/1,Classification Loss: 0.3142, Contrastive Loss: 0.0897
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0875
Epoch 5/30, Step 60/1,Classification Loss: 0.3281, Contrastive Loss: 0.0898
Epoch 5/30, Step 80/1,Classification Loss: 0.3282, Contrastive Loss: 0.0871
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0830
Epoch 5/30, Step 120/1,Classification Loss: 0.3291, Contrastive Loss: 0.1022
Accuracy: 0.9979, Precision: 0.9981, Recall: 0.9932, F1: 0.9956
Accuracy: 0.9950, Precision: 0.9911, Recall: 0.9873, F1: 0.9892
Epoch 5/30
Training - Loss: 57.4380
Training Metrics: {'accuracy': 0.9979485161870504, 'precision': 0.9981131429642568, 'recall': 0.9932003506765839, 'f1': 0.9956391427051665}
Validation Metrics: {'accuracy': 0.9949624986006941, 'precision': 0.9911005701889752, 'recall': 0.9873291434943172, 'f1': 0.9892043737453141}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0812
Epoch 6/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0816
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0784
Epoch 6/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0797
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0751
Epoch 6/30, Step 100/1,Classification Loss: 0.3339, Contrastive Loss: 0.0822
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0735
Accuracy: 0.9977, Precision: 0.9979, Recall: 0.9921, F1: 0.9950
Accuracy: 0.9946, Precision: 0.9905, Recall: 0.9864, F1: 0.9885
Epoch 6/30
Training - Loss: 55.9005
Training Metrics: {'accuracy': 0.9976674910071942, 'precision': 0.9979437637899815, 'recall': 0.9921091655698051, 'f1': 0.9950017133869247}
Validation Metrics: {'accuracy': 0.9946266651740736, 'precision': 0.9905482418985316, 'recall': 0.9864379555326315, 'f1': 0.9884806284653432}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0725
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0710
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0701
Epoch 7/30, Step 60/1,Classification Loss: 0.3173, Contrastive Loss: 0.0730
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0690
Epoch 7/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0697
Epoch 7/30, Step 120/1,Classification Loss: 0.3246, Contrastive Loss: 0.0705
Accuracy: 0.9962, Precision: 0.9974, Recall: 0.9866, F1: 0.9919
Accuracy: 0.9931, Precision: 0.9906, Recall: 0.9796, F1: 0.9850
Epoch 7/30
Training - Loss: 54.9646
Training Metrics: {'accuracy': 0.9962061600719424, 'precision': 0.9973664602071073, 'recall': 0.9866396816112724, 'f1': 0.9919185298091397}
Validation Metrics: {'accuracy': 0.9930594425165118, 'precision': 0.9906029737099347, 'recall': 0.9796073871862837, 'f1': 0.9850155827160958}
Epoch 8/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1214
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0652
Epoch 8/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0645
Epoch 8/30, Step 60/1,Classification Loss: 0.3566, Contrastive Loss: 0.0824
Epoch 8/30, Step 80/1,Classification Loss: 0.3220, Contrastive Loss: 0.0691
Epoch 8/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0931
Epoch 8/30, Step 120/1,Classification Loss: 0.3262, Contrastive Loss: 0.0624
Accuracy: 0.9983, Precision: 0.9975, Recall: 0.9954, F1: 0.9964
Accuracy: 0.9946, Precision: 0.9889, Recall: 0.9882, F1: 0.9885
Epoch 8/30
Training - Loss: 54.2763
Training Metrics: {'accuracy': 0.9983138489208633, 'precision': 0.9974675086832019, 'recall': 0.9954140411648282, 'f1': 0.9964376938125219}
Validation Metrics: {'accuracy': 0.9946266651740736, 'precision': 0.9888620094729849, 'recall': 0.9881803628316406, 'f1': 0.9885208425159311}
Epoch 9/30, Step 0/1,Classification Loss: 0.3238, Contrastive Loss: 0.0611
Epoch 9/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0603
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0591
Epoch 9/30, Step 60/1,Classification Loss: 0.3352, Contrastive Loss: 0.0655
Epoch 9/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0576
Epoch 9/30, Step 100/1,Classification Loss: 0.3227, Contrastive Loss: 0.0580
Epoch 9/30, Step 120/1,Classification Loss: 0.3323, Contrastive Loss: 0.0640
Accuracy: 0.9983, Precision: 0.9974, Recall: 0.9953, F1: 0.9963
Accuracy: 0.9950, Precision: 0.9901, Recall: 0.9884, F1: 0.9892
Epoch 9/30
Training - Loss: 53.4334
Training Metrics: {'accuracy': 0.9982857464028777, 'precision': 0.9974335465212376, 'recall': 0.9952687412662178, 'f1': 0.9963477356998317}
Validation Metrics: {'accuracy': 0.9949624986006941, 'precision': 0.9900837499892614, 'recall': 0.9883745878737227, 'f1': 0.9892270133875434}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0550
Epoch 10/30, Step 20/1,Classification Loss: 0.3267, Contrastive Loss: 0.0563
Epoch 10/30, Step 40/1,Classification Loss: 0.3195, Contrastive Loss: 0.0561
Epoch 10/30, Step 60/1,Classification Loss: 0.3139, Contrastive Loss: 0.0545
Epoch 10/30, Step 80/1,Classification Loss: 0.3278, Contrastive Loss: 0.0574
Epoch 10/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0558
Epoch 10/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0516
Accuracy: 0.9983, Precision: 0.9973, Recall: 0.9953, F1: 0.9963
Accuracy: 0.9949, Precision: 0.9893, Recall: 0.9887, F1: 0.9890
Epoch 10/30
Training - Loss: 52.5362
Training Metrics: {'accuracy': 0.9982576438848921, 'precision': 0.9973336456680276, 'recall': 0.9952606165705706, 'f1': 0.9962940023804707}
Validation Metrics: {'accuracy': 0.9948505541251539, 'precision': 0.9893406416768469, 'recall': 0.9886583276528305, 'f1': 0.9889991407444341}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0506
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0500
Epoch 11/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0501
Epoch 11/30, Step 60/1,Classification Loss: 0.3358, Contrastive Loss: 0.0552
Epoch 11/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0495
Epoch 11/30, Step 100/1,Classification Loss: 0.3158, Contrastive Loss: 0.0491
Epoch 11/30, Step 120/1,Classification Loss: 0.3146, Contrastive Loss: 0.0490
Accuracy: 0.9980, Precision: 0.9982, Recall: 0.9932, F1: 0.9957
Accuracy: 0.9946, Precision: 0.9902, Recall: 0.9868, F1: 0.9885
Epoch 11/30
Training - Loss: 52.1053
Training Metrics: {'accuracy': 0.997976618705036, 'precision': 0.99821939730616, 'recall': 0.9932465246337179, 'f1': 0.9957148874824795}
Validation Metrics: {'accuracy': 0.9946266651740736, 'precision': 0.9902082525108841, 'recall': 0.9867864369924333, 'f1': 0.9884886987448778}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0469
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0463
Epoch 12/30, Step 40/1,Classification Loss: 0.3279, Contrastive Loss: 0.0473
Epoch 12/30, Step 60/1,Classification Loss: 0.3233, Contrastive Loss: 0.0473
Epoch 12/30, Step 80/1,Classification Loss: 0.3236, Contrastive Loss: 0.0470
Epoch 12/30, Step 100/1,Classification Loss: 0.3167, Contrastive Loss: 0.0462
Epoch 12/30, Step 120/1,Classification Loss: 0.3145, Contrastive Loss: 0.0444
Accuracy: 0.9978, Precision: 0.9981, Recall: 0.9926, F1: 0.9953
Accuracy: 0.9941, Precision: 0.9905, Recall: 0.9840, F1: 0.9872
Epoch 12/30
Training - Loss: 51.6951
Training Metrics: {'accuracy': 0.9978080035971223, 'precision': 0.9981176368676369, 'recall': 0.9925875479714912, 'f1': 0.9953302988746546}
Validation Metrics: {'accuracy': 0.994066942796373, 'precision': 0.9905381595931425, 'recall': 0.9840233583703503, 'f1': 0.9872493853932238}
Epoch 13/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0446
Epoch 13/30, Step 20/1,Classification Loss: 0.3149, Contrastive Loss: 0.0434
Epoch 13/30, Step 40/1,Classification Loss: 0.3242, Contrastive Loss: 0.0438
Epoch 13/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0420
Epoch 13/30, Step 80/1,Classification Loss: 0.3150, Contrastive Loss: 0.0427
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0409
Epoch 13/30, Step 120/1,Classification Loss: 0.3293, Contrastive Loss: 0.0433
Accuracy: 0.9979, Precision: 0.9982, Recall: 0.9929, F1: 0.9955
Accuracy: 0.9946, Precision: 0.9895, Recall: 0.9875, F1: 0.9885
Epoch 13/30
Training - Loss: 51.0759
Training Metrics: {'accuracy': 0.9978923111510791, 'precision': 0.9981692438642584, 'recall': 0.9929273286692668, 'f1': 0.9955282170234696}
Validation Metrics: {'accuracy': 0.9946266651740736, 'precision': 0.9895324013756706, 'recall': 0.9874833999120369, 'f1': 0.9885047980318451}
Epoch 14/30, Step 0/1,Classification Loss: 0.3265, Contrastive Loss: 0.0416
Epoch 14/30, Step 20/1,Classification Loss: 0.3275, Contrastive Loss: 0.0414
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0386
Epoch 14/30, Step 60/1,Classification Loss: 0.3143, Contrastive Loss: 0.0402
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0378
Epoch 14/30, Step 100/1,Classification Loss: 0.3234, Contrastive Loss: 0.0397
Epoch 14/30, Step 120/1,Classification Loss: 0.3158, Contrastive Loss: 0.0400
Accuracy: 0.9981, Precision: 0.9974, Recall: 0.9947, F1: 0.9960
Accuracy: 0.9952, Precision: 0.9916, Recall: 0.9878, F1: 0.9897
Epoch 14/30
Training - Loss: 50.4291
Training Metrics: {'accuracy': 0.9981452338129496, 'precision': 0.9974356963737054, 'recall': 0.9946605027301116, 'f1': 0.9960424993200506}
Validation Metrics: {'accuracy': 0.9951863875517744, 'precision': 0.9915822339666298, 'recall': 0.9878071083155071, 'f1': 0.9896841793566334}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0369
Epoch 15/30, Step 20/1,Classification Loss: 0.3184, Contrastive Loss: 0.0377
Epoch 15/30, Step 40/1,Classification Loss: 0.3159, Contrastive Loss: 0.0368
Epoch 15/30, Step 60/1,Classification Loss: 0.3166, Contrastive Loss: 0.0386
Epoch 15/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.0361
Epoch 15/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0415
Epoch 15/30, Step 120/1,Classification Loss: 0.3335, Contrastive Loss: 0.0398
Accuracy: 0.9972, Precision: 0.9977, Recall: 0.9902, F1: 0.9939
Accuracy: 0.9944, Precision: 0.9911, Recall: 0.9849, F1: 0.9880
Epoch 15/30
Training - Loss: 50.0486
Training Metrics: {'accuracy': 0.9971616456834532, 'precision': 0.997742006553515, 'recall': 0.990229183764116, 'f1': 0.9939443540645656}
Validation Metrics: {'accuracy': 0.9944027762229934, 'precision': 0.9910924919087678, 'recall': 0.9849145463320359, 'f1': 0.9879753486166254}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0340
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0337
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 16/30, Step 80/1,Classification Loss: 0.3141, Contrastive Loss: 0.0342
Epoch 16/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0333
Epoch 16/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0359
Accuracy: 0.9982, Precision: 0.9982, Recall: 0.9942, F1: 0.9962
Accuracy: 0.9951, Precision: 0.9915, Recall: 0.9874, F1: 0.9894
Epoch 16/30
Training - Loss: 49.6198
Training Metrics: {'accuracy': 0.9982014388489209, 'precision': 0.9981770658846207, 'recall': 0.994234246974271, 'f1': 0.9961943015015144}
Validation Metrics: {'accuracy': 0.9950744430762342, 'precision': 0.9915122489216568, 'recall': 0.9873938851750113, 'f1': 0.9894405760932313}
Epoch 17/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0326
Epoch 17/30, Step 20/1,Classification Loss: 0.3294, Contrastive Loss: 0.0679
Epoch 17/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0313
Epoch 17/30, Step 60/1,Classification Loss: 0.3146, Contrastive Loss: 0.0325
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0304
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0302
Epoch 17/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0442
Accuracy: 0.9981, Precision: 0.9982, Recall: 0.9937, F1: 0.9959
Accuracy: 0.9952, Precision: 0.9919, Recall: 0.9875, F1: 0.9897
Epoch 17/30
Training - Loss: 49.2389
Training Metrics: {'accuracy': 0.9980890287769785, 'precision': 0.9981912813773524, 'recall': 0.9936791951961659, 'f1': 0.9959204351046732}
Validation Metrics: {'accuracy': 0.9951863875517744, 'precision': 0.9919246150536631, 'recall': 0.9874586268557053, 'f1': 0.9896769435524978}
Epoch 18/30, Step 0/1,Classification Loss: 0.3163, Contrastive Loss: 0.0328
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 18/30, Step 40/1,Classification Loss: 0.3153, Contrastive Loss: 0.0313
Epoch 18/30, Step 60/1,Classification Loss: 0.3138, Contrastive Loss: 0.0287
Epoch 18/30, Step 80/1,Classification Loss: 0.3452, Contrastive Loss: 0.0394
Epoch 18/30, Step 100/1,Classification Loss: 0.3314, Contrastive Loss: 0.0313
Epoch 18/30, Step 120/1,Classification Loss: 0.3222, Contrastive Loss: 0.0290
Accuracy: 0.9983, Precision: 0.9983, Recall: 0.9946, F1: 0.9965
Accuracy: 0.9955, Precision: 0.9925, Recall: 0.9883, F1: 0.9904
Epoch 18/30
Training - Loss: 49.2490
Training Metrics: {'accuracy': 0.998341951438849, 'precision': 0.9983409429638099, 'recall': 0.9946239701905868, 'f1': 0.9964724038722133}
Validation Metrics: {'accuracy': 0.9955222209783947, 'precision': 0.992476255944782, 'recall': 0.988349814817391, 'f1': 0.9904005237211193}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 19/30, Step 20/1,Classification Loss: 0.3205, Contrastive Loss: 0.0303
Epoch 19/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0276
Epoch 19/30, Step 60/1,Classification Loss: 0.3285, Contrastive Loss: 0.0308
Epoch 19/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0412
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 19/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0306
Accuracy: 0.9978, Precision: 0.9981, Recall: 0.9926, F1: 0.9953
Accuracy: 0.9946, Precision: 0.9916, Recall: 0.9854, F1: 0.9885
Epoch 19/30
Training - Loss: 48.7275
Training Metrics: {'accuracy': 0.9978080035971223, 'precision': 0.9981156817074975, 'recall': 0.9925620127107904, 'f1': 0.9953164010100792}
Validation Metrics: {'accuracy': 0.9946266651740736, 'precision': 0.991576546134112, 'recall': 0.9853925111532259, 'f1': 0.9884563346719604}
Epoch 20/30, Step 0/1,Classification Loss: 0.3281, Contrastive Loss: 0.0296
Epoch 20/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0255
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 20/30, Step 80/1,Classification Loss: 0.3240, Contrastive Loss: 0.0273
Epoch 20/30, Step 100/1,Classification Loss: 0.3267, Contrastive Loss: 0.0286
Epoch 20/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0253
Accuracy: 0.9979, Precision: 0.9981, Recall: 0.9927, F1: 0.9954
Accuracy: 0.9949, Precision: 0.9914, Recall: 0.9866, F1: 0.9890
Epoch 20/30
Training - Loss: 48.7028
Training Metrics: {'accuracy': 0.9978642086330936, 'precision': 0.9981466264279394, 'recall': 0.9927462856020564, 'f1': 0.9954252673553247}
Validation Metrics: {'accuracy': 0.9948505541251539, 'precision': 0.9913723008451333, 'recall': 0.9865674388940194, 'f1': 0.9889528550336104}
Epoch 21/30, Step 0/1,Classification Loss: 0.3267, Contrastive Loss: 0.0302
Epoch 21/30, Step 20/1,Classification Loss: 0.3212, Contrastive Loss: 0.0270
Epoch 21/30, Step 40/1,Classification Loss: 0.3275, Contrastive Loss: 0.0260
Epoch 21/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0238
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 21/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0255
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Accuracy: 0.9977, Precision: 0.9981, Recall: 0.9923, F1: 0.9952
Accuracy: 0.9941, Precision: 0.9912, Recall: 0.9833, F1: 0.9872
Epoch 21/30
Training - Loss: 48.4061
Training Metrics: {'accuracy': 0.9977236960431655, 'precision': 0.9980709312169767, 'recall': 0.9923117830162802, 'f1': 0.9951671216099192}
Validation Metrics: {'accuracy': 0.994066942796373, 'precision': 0.9912286712211276, 'recall': 0.9833263954507465, 'f1': 0.987231410349195}
Epoch 22/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0291
Epoch 22/30, Step 20/1,Classification Loss: 0.3164, Contrastive Loss: 0.0246
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 22/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0230
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Accuracy: 0.9984, Precision: 0.9976, Recall: 0.9957, F1: 0.9967
Accuracy: 0.9953, Precision: 0.9923, Recall: 0.9875, F1: 0.9899
Epoch 22/30
Training - Loss: 48.0772
Training Metrics: {'accuracy': 0.9984262589928058, 'precision': 0.9976088468083192, 'recall': 0.9957109976356602, 'f1': 0.9966573000130206}
Validation Metrics: {'accuracy': 0.9952983320273144, 'precision': 0.9923376703094153, 'recall': 0.9875233685363993, 'f1': 0.9899134763350357}
Epoch 23/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0365
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 23/30, Step 100/1,Classification Loss: 0.3439, Contrastive Loss: 0.0286
Epoch 23/30, Step 120/1,Classification Loss: 0.3202, Contrastive Loss: 0.0250
Accuracy: 0.9981, Precision: 0.9983, Recall: 0.9937, F1: 0.9960
Accuracy: 0.9944, Precision: 0.9911, Recall: 0.9849, F1: 0.9880
Epoch 23/30
Training - Loss: 48.1048
Training Metrics: {'accuracy': 0.998117131294964, 'precision': 0.9982964213287517, 'recall': 0.9937056350679007, 'f1': 0.9959856948554566}
Validation Metrics: {'accuracy': 0.9944027762229934, 'precision': 0.9910924919087678, 'recall': 0.9849145463320359, 'f1': 0.9879753486166254}
Epoch 24/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0208
Epoch 24/30, Step 20/1,Classification Loss: 0.3429, Contrastive Loss: 0.0754
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 24/30, Step 60/1,Classification Loss: 0.3409, Contrastive Loss: 0.0338
Epoch 24/30, Step 80/1,Classification Loss: 0.3148, Contrastive Loss: 0.0210
Epoch 24/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0351
Epoch 24/30, Step 120/1,Classification Loss: 0.3166, Contrastive Loss: 0.0217
Accuracy: 0.9970, Precision: 0.9977, Recall: 0.9898, F1: 0.9937
Accuracy: 0.9938, Precision: 0.9904, Recall: 0.9832, F1: 0.9868
Epoch 24/30
Training - Loss: 47.8411
Training Metrics: {'accuracy': 0.9970492356115108, 'precision': 0.9976746233449368, 'recall': 0.9897767847347226, 'f1': 0.9936802012020476}
Validation Metrics: {'accuracy': 0.9938430538452927, 'precision': 0.9903976230112116, 'recall': 0.9831969120893584, 'f1': 0.9867589114481199}
Epoch 25/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0204
Epoch 25/30, Step 20/1,Classification Loss: 0.3180, Contrastive Loss: 0.0233
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 25/30, Step 60/1,Classification Loss: 0.3338, Contrastive Loss: 0.0240
Epoch 25/30, Step 80/1,Classification Loss: 0.3137, Contrastive Loss: 0.0204
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 25/30, Step 120/1,Classification Loss: 0.3442, Contrastive Loss: 0.0652
Accuracy: 0.9985, Precision: 0.9977, Recall: 0.9961, F1: 0.9969
Accuracy: 0.9950, Precision: 0.9901, Recall: 0.9884, F1: 0.9892
Epoch 25/30
Training - Loss: 47.7261
Training Metrics: {'accuracy': 0.9985386690647482, 'precision': 0.9976634882422373, 'recall': 0.9960974576690239, 'f1': 0.9968786941952607}
Validation Metrics: {'accuracy': 0.9949624986006941, 'precision': 0.9900837499892614, 'recall': 0.9883745878737227, 'f1': 0.9892270133875434}
Epoch 26/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0292
Epoch 26/30, Step 20/1,Classification Loss: 0.3420, Contrastive Loss: 0.0265
Epoch 26/30, Step 40/1,Classification Loss: 0.3140, Contrastive Loss: 0.0201
Epoch 26/30, Step 60/1,Classification Loss: 0.3515, Contrastive Loss: 0.0692
Epoch 26/30, Step 80/1,Classification Loss: 0.3236, Contrastive Loss: 0.0205
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 26/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0189
Accuracy: 0.9985, Precision: 0.9975, Recall: 0.9962, F1: 0.9968
Accuracy: 0.9951, Precision: 0.9905, Recall: 0.9884, F1: 0.9895
Epoch 26/30
Training - Loss: 47.8475
Training Metrics: {'accuracy': 0.9985105665467626, 'precision': 0.9974896459198911, 'recall': 0.99619922817807, 'f1': 0.9968432237474756}
Validation Metrics: {'accuracy': 0.9950744430762342, 'precision': 0.9904923490035586, 'recall': 0.9884393295544167, 'f1': 0.9894627315291913}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 40/1,Classification Loss: 0.3180, Contrastive Loss: 0.0209
Epoch 27/30, Step 60/1,Classification Loss: 0.3143, Contrastive Loss: 0.0198
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 100/1,Classification Loss: 0.3292, Contrastive Loss: 0.0229
Epoch 27/30, Step 120/1,Classification Loss: 0.3284, Contrastive Loss: 0.0201
Accuracy: 0.9986, Precision: 0.9976, Recall: 0.9965, F1: 0.9971
Accuracy: 0.9955, Precision: 0.9911, Recall: 0.9897, F1: 0.9904
Epoch 27/30
Training - Loss: 47.4544
Training Metrics: {'accuracy': 0.998622976618705, 'precision': 0.9976370677268713, 'recall': 0.9965145320915955, 'f1': 0.9970748834719745}
Validation Metrics: {'accuracy': 0.9955222209783947, 'precision': 0.9911137337770832, 'recall': 0.9897437406565983, 'f1': 0.9904273559227588}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 40/1,Classification Loss: 0.3265, Contrastive Loss: 0.0201
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 28/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0186
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 120/1,Classification Loss: 0.3141, Contrastive Loss: 0.0184
Accuracy: 0.9978, Precision: 0.9981, Recall: 0.9927, F1: 0.9954
Accuracy: 0.9943, Precision: 0.9917, Recall: 0.9838, F1: 0.9877
Epoch 28/30
Training - Loss: 47.4677
Training Metrics: {'accuracy': 0.9978361061151079, 'precision': 0.9981319149466781, 'recall': 0.9926636829200458, 'f1': 0.9953760421212785}
Validation Metrics: {'accuracy': 0.9942908317474533, 'precision': 0.9917144506575777, 'recall': 0.9838043602719364, 'f1': 0.9877132439209235}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 29/30, Step 20/1,Classification Loss: 0.3144, Contrastive Loss: 0.0197
Epoch 29/30, Step 40/1,Classification Loss: 0.3220, Contrastive Loss: 0.0196
Epoch 29/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0194
Epoch 29/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0182
Epoch 29/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0184
Epoch 29/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0183
Accuracy: 0.9983, Precision: 0.9974, Recall: 0.9953, F1: 0.9964
Accuracy: 0.9944, Precision: 0.9897, Recall: 0.9863, F1: 0.9880
Epoch 29/30
Training - Loss: 47.3840
Training Metrics: {'accuracy': 0.9982857464028777, 'precision': 0.9974357326142549, 'recall': 0.995274175012864, 'f1': 0.9963515538059814}
Validation Metrics: {'accuracy': 0.9944027762229934, 'precision': 0.9897269278848226, 'recall': 0.9863084721712434, 'f1': 0.9880090611925809}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 40/1,Classification Loss: 0.3357, Contrastive Loss: 0.0212
Epoch 30/30, Step 60/1,Classification Loss: 0.3139, Contrastive Loss: 0.0180
Epoch 30/30, Step 80/1,Classification Loss: 0.3367, Contrastive Loss: 0.0250
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0188
Accuracy: 0.9981, Precision: 0.9983, Recall: 0.9939, F1: 0.9961
Accuracy: 0.9945, Precision: 0.9908, Recall: 0.9857, F1: 0.9882
Epoch 30/30
Training - Loss: 47.2557
Training Metrics: {'accuracy': 0.9981452338129496, 'precision': 0.9983168493787595, 'recall': 0.9938507904130981, 'f1': 0.9960692604324108}
Validation Metrics: {'accuracy': 0.9945147206985335, 'precision': 0.9908193115321766, 'recall': 0.9856762509323338, 'f1': 0.9882282575122625}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1939, 5814), y shape: (1939,), y distribution: Counter({np.float64(0.0): 1742, np.float64(1.0): 197}), env shape: (1939,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9763, Precision: 0.9583, Recall: 0.9080, F1: 0.9313
month: 2020-05, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1927, 5814), y shape: (1927,), y distribution: Counter({np.float64(0.0): 1728, np.float64(1.0): 199}), env shape: (1927,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9772, Precision: 0.9595, Recall: 0.9139, F1: 0.9352
month: 2020-06, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1924, 5814), y shape: (1924,), y distribution: Counter({np.float64(0.0): 1726, np.float64(1.0): 198}), env shape: (1924,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9537, Precision: 0.9488, Recall: 0.7909, F1: 0.8488
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10615]))
original train data shape: torch.Size([44762]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1924, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44762]), new train data shape: torch.Size([44762])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10615]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3153, Contrastive Loss: 1.5332
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.7544
Epoch 1/30, Step 40/1,Classification Loss: 0.3147, Contrastive Loss: 0.3532
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2331
Epoch 1/30, Step 80/1,Classification Loss: 0.3447, Contrastive Loss: 0.2064
Epoch 1/30, Step 100/1,Classification Loss: 0.3605, Contrastive Loss: 0.2154
Epoch 1/30, Step 120/1,Classification Loss: 0.3145, Contrastive Loss: 0.1579
Accuracy: 0.9983, Precision: 0.9976, Recall: 0.9953, F1: 0.9964
Accuracy: 0.9953, Precision: 0.9904, Recall: 0.9897, F1: 0.9900
Epoch 1/30
Training - Loss: 99.5384
Training Metrics: {'accuracy': 0.9983138489208633, 'precision': 0.9975525973135966, 'recall': 0.995326344896913, 'f1': 0.9964358507659145}
Validation Metrics: {'accuracy': 0.9953088350273651, 'precision': 0.9903873327308402, 'recall': 0.989712062569615, 'f1': 0.990049360228688}
Epoch 2/30, Step 0/1,Classification Loss: 0.3232, Contrastive Loss: 0.1571
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1377
Epoch 2/30, Step 40/1,Classification Loss: 0.3441, Contrastive Loss: 0.1464
Epoch 2/30, Step 60/1,Classification Loss: 0.3230, Contrastive Loss: 0.1341
Epoch 2/30, Step 80/1,Classification Loss: 0.3283, Contrastive Loss: 0.1324
Epoch 2/30, Step 100/1,Classification Loss: 0.3235, Contrastive Loss: 0.1233
Epoch 2/30, Step 120/1,Classification Loss: 0.3268, Contrastive Loss: 0.1284
Accuracy: 0.9983, Precision: 0.9977, Recall: 0.9954, F1: 0.9965
Accuracy: 0.9952, Precision: 0.9903, Recall: 0.9893, F1: 0.9898
Epoch 2/30
Training - Loss: 63.1607
Training Metrics: {'accuracy': 0.998341951438849, 'precision': 0.9976613599904152, 'recall': 0.9953603740644505, 'f1': 0.9965069925045176}
Validation Metrics: {'accuracy': 0.9951971406232548, 'precision': 0.9903161456224441, 'recall': 0.989303231825543, 'f1': 0.9898089292362007}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1143
Epoch 3/30, Step 20/1,Classification Loss: 0.3194, Contrastive Loss: 0.1136
Epoch 3/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.1129
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1064
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1043
Epoch 3/30, Step 100/1,Classification Loss: 0.3391, Contrastive Loss: 0.1103
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1008
Accuracy: 0.9982, Precision: 0.9983, Recall: 0.9940, F1: 0.9962
Accuracy: 0.9948, Precision: 0.9897, Recall: 0.9880, F1: 0.9889
Epoch 3/30
Training - Loss: 60.2568
Training Metrics: {'accuracy': 0.9982014388489209, 'precision': 0.9983487734615448, 'recall': 0.9940470372002471, 'f1': 0.996184409349055}
Validation Metrics: {'accuracy': 0.9947503630068134, 'precision': 0.9896986380759201, 'recall': 0.988012056540287, 'f1': 0.988853237736147}
Epoch 4/30, Step 0/1,Classification Loss: 0.3284, Contrastive Loss: 0.1056
Epoch 4/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1063
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0947
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0929
Epoch 4/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.1008
Epoch 4/30, Step 100/1,Classification Loss: 0.3577, Contrastive Loss: 0.1153
Epoch 4/30, Step 120/1,Classification Loss: 0.3143, Contrastive Loss: 0.0923
Accuracy: 0.9984, Precision: 0.9976, Recall: 0.9956, F1: 0.9966
Accuracy: 0.9955, Precision: 0.9902, Recall: 0.9909, F1: 0.9905
Epoch 4/30
Training - Loss: 58.2437
Training Metrics: {'accuracy': 0.9983700539568345, 'precision': 0.997597537656311, 'recall': 0.9955603202279273, 'f1': 0.9965758871641845}
Validation Metrics: {'accuracy': 0.9955322238355858, 'precision': 0.9901992753623188, 'recall': 0.9908738717487907, 'f1': 0.990536236921128}
Epoch 5/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0879
Epoch 5/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0879
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0849
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0832
Epoch 5/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0823
Epoch 5/30, Step 100/1,Classification Loss: 0.3400, Contrastive Loss: 0.0882
Epoch 5/30, Step 120/1,Classification Loss: 0.3261, Contrastive Loss: 0.0813
Accuracy: 0.9980, Precision: 0.9974, Recall: 0.9940, F1: 0.9957
Accuracy: 0.9946, Precision: 0.9903, Recall: 0.9869, F1: 0.9886
Epoch 5/30
Training - Loss: 56.8049
Training Metrics: {'accuracy': 0.997976618705036, 'precision': 0.9974474963997058, 'recall': 0.9940434542255902, 'f1': 0.9957369809237564}
Validation Metrics: {'accuracy': 0.994638668602703, 'precision': 0.9902947930579786, 'recall': 0.9869149304141513, 'f1': 0.9885963934645476}
Epoch 6/30, Step 0/1,Classification Loss: 0.3256, Contrastive Loss: 0.0791
Epoch 6/30, Step 20/1,Classification Loss: 0.3165, Contrastive Loss: 0.0795
Epoch 6/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0772
Epoch 6/30, Step 60/1,Classification Loss: 0.3449, Contrastive Loss: 0.0954
Epoch 6/30, Step 80/1,Classification Loss: 0.3206, Contrastive Loss: 0.0763
Epoch 6/30, Step 100/1,Classification Loss: 0.3236, Contrastive Loss: 0.0760
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0717
Accuracy: 0.9982, Precision: 0.9983, Recall: 0.9941, F1: 0.9962
Accuracy: 0.9950, Precision: 0.9892, Recall: 0.9895, F1: 0.9893
Epoch 6/30
Training - Loss: 55.4678
Training Metrics: {'accuracy': 0.9982014388489209, 'precision': 0.998262383190834, 'recall': 0.9941378704569741, 'f1': 0.9961877137185291}
Validation Metrics: {'accuracy': 0.9949737518150341, 'precision': 0.9891813638812147, 'recall': 0.9895180134104946, 'f1': 0.9893496045923234}
Epoch 7/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0813
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0695
Epoch 7/30, Step 40/1,Classification Loss: 0.3384, Contrastive Loss: 0.0740
Epoch 7/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0687
Epoch 7/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0943
Epoch 7/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0663
Epoch 7/30, Step 120/1,Classification Loss: 0.3294, Contrastive Loss: 0.0717
Accuracy: 0.9983, Precision: 0.9976, Recall: 0.9954, F1: 0.9965
Accuracy: 0.9952, Precision: 0.9893, Recall: 0.9903, F1: 0.9898
Epoch 7/30
Training - Loss: 54.3314
Training Metrics: {'accuracy': 0.998341951438849, 'precision': 0.9975705566252552, 'recall': 0.9954320682869136, 'f1': 0.9964979708864772}
Validation Metrics: {'accuracy': 0.9951971406232548, 'precision': 0.9893257387973063, 'recall': 0.9903356748986385, 'f1': 0.9898299509383279}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0646
Epoch 8/30, Step 20/1,Classification Loss: 0.3305, Contrastive Loss: 0.0692
Epoch 8/30, Step 40/1,Classification Loss: 0.3138, Contrastive Loss: 0.0634
Epoch 8/30, Step 60/1,Classification Loss: 0.3175, Contrastive Loss: 0.0654
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0609
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0605
Epoch 8/30, Step 120/1,Classification Loss: 0.3176, Contrastive Loss: 0.0605
Accuracy: 0.9984, Precision: 0.9984, Recall: 0.9947, F1: 0.9965
Accuracy: 0.9953, Precision: 0.9894, Recall: 0.9907, F1: 0.9901
Epoch 8/30
Training - Loss: 53.6845
Training Metrics: {'accuracy': 0.9983700539568345, 'precision': 0.9983592301755209, 'recall': 0.9947404919837943, 'f1': 0.996540321171846}
Validation Metrics: {'accuracy': 0.9953088350273651, 'precision': 0.9893979325728532, 'recall': 0.9907445056427104, 'f1': 0.9900698757763975}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0587
Epoch 9/30, Step 20/1,Classification Loss: 0.3393, Contrastive Loss: 0.0621
Epoch 9/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0585
Epoch 9/30, Step 60/1,Classification Loss: 0.3439, Contrastive Loss: 0.0735
Epoch 9/30, Step 80/1,Classification Loss: 0.3421, Contrastive Loss: 0.0635
Epoch 9/30, Step 100/1,Classification Loss: 0.3223, Contrastive Loss: 0.0560
Epoch 9/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0593
Accuracy: 0.9983, Precision: 0.9978, Recall: 0.9951, F1: 0.9965
Accuracy: 0.9954, Precision: 0.9908, Recall: 0.9898, F1: 0.9903
Epoch 9/30
Training - Loss: 52.8972
Training Metrics: {'accuracy': 0.9983138489208633, 'precision': 0.9978189066539267, 'recall': 0.9950978650560007, 'f1': 0.9964529622261011}
Validation Metrics: {'accuracy': 0.9954205294314755, 'precision': 0.9907906396474127, 'recall': 0.989776745622655, 'f1': 0.9902829325275402}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0534
Epoch 10/30, Step 20/1,Classification Loss: 0.3251, Contrastive Loss: 0.0549
Epoch 10/30, Step 40/1,Classification Loss: 0.3213, Contrastive Loss: 0.0546
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0517
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0508
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0504
Epoch 10/30, Step 120/1,Classification Loss: 0.3145, Contrastive Loss: 0.0516
Accuracy: 0.9979, Precision: 0.9983, Recall: 0.9927, F1: 0.9955
Accuracy: 0.9949, Precision: 0.9911, Recall: 0.9870, F1: 0.9891
Epoch 10/30
Training - Loss: 52.3034
Training Metrics: {'accuracy': 0.9978923111510791, 'precision': 0.9983434223000267, 'recall': 0.9927493791262874, 'f1': 0.99552355841359}
Validation Metrics: {'accuracy': 0.9948620574109237, 'precision': 0.9911081063727167, 'recall': 0.9870442965202315, 'f1': 0.9890639777403707}
Epoch 11/30, Step 0/1,Classification Loss: 0.3284, Contrastive Loss: 0.0551
Epoch 11/30, Step 20/1,Classification Loss: 0.3600, Contrastive Loss: 0.0684
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0478
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0477
Epoch 11/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0481
Epoch 11/30, Step 100/1,Classification Loss: 0.3149, Contrastive Loss: 0.0479
Epoch 11/30, Step 120/1,Classification Loss: 0.3138, Contrastive Loss: 0.0470
Accuracy: 0.9985, Precision: 0.9979, Recall: 0.9958, F1: 0.9969
Accuracy: 0.9952, Precision: 0.9903, Recall: 0.9893, F1: 0.9898
Epoch 11/30
Training - Loss: 51.5980
Training Metrics: {'accuracy': 0.9985105665467626, 'precision': 0.9979453241911564, 'recall': 0.9958399694947249, 'f1': 0.9968893890806713}
Validation Metrics: {'accuracy': 0.9951971406232548, 'precision': 0.9903161456224441, 'recall': 0.989303231825543, 'f1': 0.9898089292362007}
Epoch 12/30, Step 0/1,Classification Loss: 0.3141, Contrastive Loss: 0.0461
Epoch 12/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0504
Epoch 12/30, Step 40/1,Classification Loss: 0.3143, Contrastive Loss: 0.0453
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0435
Epoch 12/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0440
Epoch 12/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0430
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0419
Accuracy: 0.9976, Precision: 0.9974, Recall: 0.9926, F1: 0.9950
Accuracy: 0.9944, Precision: 0.9912, Recall: 0.9851, F1: 0.9881
Epoch 12/30
Training - Loss: 51.0629
Training Metrics: {'accuracy': 0.9976112859712231, 'precision': 0.9974093726240614, 'recall': 0.9925809910719026, 'f1': 0.9949780399411627}
Validation Metrics: {'accuracy': 0.9944152797944823, 'precision': 0.9911668812404004, 'recall': 0.9850648258529119, 'f1': 0.9880882638758355}
Epoch 13/30, Step 0/1,Classification Loss: 0.3355, Contrastive Loss: 0.0466
Epoch 13/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0425
Epoch 13/30, Step 40/1,Classification Loss: 0.3258, Contrastive Loss: 0.0435
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0401
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0397
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0397
Epoch 13/30, Step 120/1,Classification Loss: 0.3164, Contrastive Loss: 0.0415
Accuracy: 0.9983, Precision: 0.9986, Recall: 0.9944, F1: 0.9965
Accuracy: 0.9953, Precision: 0.9921, Recall: 0.9880, F1: 0.9900
Epoch 13/30
Training - Loss: 50.4923
Training Metrics: {'accuracy': 0.998341951438849, 'precision': 0.9986047811740013, 'recall': 0.9943891817561925, 'f1': 0.9964840262834751}
Validation Metrics: {'accuracy': 0.9953088350273651, 'precision': 0.9920630357945476, 'recall': 0.9879913241144557, 'f1': 0.9900149361977297}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0384
Epoch 14/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0396
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0374
Epoch 14/30, Step 60/1,Classification Loss: 0.3225, Contrastive Loss: 0.0392
Epoch 14/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0369
Epoch 14/30, Step 100/1,Classification Loss: 0.3317, Contrastive Loss: 0.0390
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0359
Accuracy: 0.9985, Precision: 0.9979, Recall: 0.9960, F1: 0.9969
Accuracy: 0.9952, Precision: 0.9883, Recall: 0.9914, F1: 0.9899
Epoch 14/30
Training - Loss: 50.2351
Training Metrics: {'accuracy': 0.9985386690647482, 'precision': 0.9978582207240443, 'recall': 0.9959754817777149, 'f1': 0.9969142632563052}
Validation Metrics: {'accuracy': 0.9951971406232548, 'precision': 0.9883471582814285, 'recall': 0.9913681179717341, 'f1': 0.9898508668293868}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0355
Epoch 15/30, Step 20/1,Classification Loss: 0.3254, Contrastive Loss: 0.0385
Epoch 15/30, Step 40/1,Classification Loss: 0.3269, Contrastive Loss: 0.0369
Epoch 15/30, Step 60/1,Classification Loss: 0.3145, Contrastive Loss: 0.0372
Epoch 15/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0346
Epoch 15/30, Step 100/1,Classification Loss: 0.3220, Contrastive Loss: 0.0354
Epoch 15/30, Step 120/1,Classification Loss: 0.3284, Contrastive Loss: 0.0368
Accuracy: 0.9981, Precision: 0.9984, Recall: 0.9934, F1: 0.9959
Accuracy: 0.9950, Precision: 0.9915, Recall: 0.9871, F1: 0.9893
Epoch 15/30
Training - Loss: 49.7136
Training Metrics: {'accuracy': 0.9980609262589928, 'precision': 0.9984435609214777, 'recall': 0.9934038344556421, 'f1': 0.9959051120880452}
Validation Metrics: {'accuracy': 0.9949737518150341, 'precision': 0.9915157705760361, 'recall': 0.9871089795732717, 'f1': 0.9892980118982169}
Epoch 16/30, Step 0/1,Classification Loss: 0.3324, Contrastive Loss: 0.0362
Epoch 16/30, Step 20/1,Classification Loss: 0.3208, Contrastive Loss: 0.0343
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Epoch 16/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0321
Epoch 16/30, Step 80/1,Classification Loss: 0.3159, Contrastive Loss: 0.0333
Epoch 16/30, Step 100/1,Classification Loss: 0.3392, Contrastive Loss: 0.0413
Epoch 16/30, Step 120/1,Classification Loss: 0.3278, Contrastive Loss: 0.0336
Accuracy: 0.9986, Precision: 0.9978, Recall: 0.9961, F1: 0.9970
Accuracy: 0.9953, Precision: 0.9897, Recall: 0.9904, F1: 0.9901
Epoch 16/30
Training - Loss: 49.4244
Training Metrics: {'accuracy': 0.9985667715827338, 'precision': 0.9977814350010825, 'recall': 0.9961461033026562, 'f1': 0.9969618213035383}
Validation Metrics: {'accuracy': 0.9953088350273651, 'precision': 0.9897264123040521, 'recall': 0.9904003579516787, 'f1': 0.9900630487671844}
Epoch 17/30, Step 0/1,Classification Loss: 0.3140, Contrastive Loss: 0.0314
Epoch 17/30, Step 20/1,Classification Loss: 0.3142, Contrastive Loss: 0.0317
Epoch 17/30, Step 40/1,Classification Loss: 0.3219, Contrastive Loss: 0.0331
Epoch 17/30, Step 60/1,Classification Loss: 0.3140, Contrastive Loss: 0.0311
Epoch 17/30, Step 80/1,Classification Loss: 0.3141, Contrastive Loss: 0.0322
Epoch 17/30, Step 100/1,Classification Loss: 0.3213, Contrastive Loss: 0.0352
Epoch 17/30, Step 120/1,Classification Loss: 0.3292, Contrastive Loss: 0.0345
Accuracy: 0.9985, Precision: 0.9976, Recall: 0.9959, F1: 0.9968
Accuracy: 0.9951, Precision: 0.9893, Recall: 0.9899, F1: 0.9896
Epoch 17/30
Training - Loss: 49.1277
Training Metrics: {'accuracy': 0.9984543615107914, 'precision': 0.9976490895504373, 'recall': 0.995868756179519, 'f1': 0.9967565992624415}
Validation Metrics: {'accuracy': 0.9950854462191444, 'precision': 0.9892535492457852, 'recall': 0.9899268441545666, 'f1': 0.9895898606132408}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 20/1,Classification Loss: 0.3146, Contrastive Loss: 0.0313
Epoch 18/30, Step 40/1,Classification Loss: 0.3183, Contrastive Loss: 0.0288
Epoch 18/30, Step 60/1,Classification Loss: 0.3144, Contrastive Loss: 0.0280
Epoch 18/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0284
Epoch 18/30, Step 100/1,Classification Loss: 0.3252, Contrastive Loss: 0.0291
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0265
Accuracy: 0.9977, Precision: 0.9984, Recall: 0.9921, F1: 0.9952
Accuracy: 0.9941, Precision: 0.9910, Recall: 0.9838, F1: 0.9874
Epoch 18/30
Training - Loss: 48.6073
Training Metrics: {'accuracy': 0.9977236960431655, 'precision': 0.9984225807714057, 'recall': 0.9920912816314578, 'f1': 0.9952274269634034}
Validation Metrics: {'accuracy': 0.9940801965821512, 'precision': 0.9909576371552937, 'recall': 0.9838383336206961, 'f1': 0.9873603892233713}
Epoch 19/30, Step 0/1,Classification Loss: 0.3501, Contrastive Loss: 0.0398
Epoch 19/30, Step 20/1,Classification Loss: 0.3166, Contrastive Loss: 0.0278
Epoch 19/30, Step 40/1,Classification Loss: 0.3417, Contrastive Loss: 0.0349
Epoch 19/30, Step 60/1,Classification Loss: 0.3271, Contrastive Loss: 0.0272
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 19/30, Step 100/1,Classification Loss: 0.3303, Contrastive Loss: 0.0381
Epoch 19/30, Step 120/1,Classification Loss: 0.3160, Contrastive Loss: 0.0264
Accuracy: 0.9985, Precision: 0.9979, Recall: 0.9956, F1: 0.9967
Accuracy: 0.9951, Precision: 0.9896, Recall: 0.9896, F1: 0.9896
Epoch 19/30
Training - Loss: 48.4938
Training Metrics: {'accuracy': 0.9984543615107914, 'precision': 0.9978981804533809, 'recall': 0.9955949544642679, 'f1': 0.9967426883091421}
Validation Metrics: {'accuracy': 0.9950854462191444, 'precision': 0.9895826964635348, 'recall': 0.9895826964635348, 'f1': 0.9895826964635348}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0244
Epoch 20/30, Step 40/1,Classification Loss: 0.3368, Contrastive Loss: 0.0310
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 20/30, Step 80/1,Classification Loss: 0.3178, Contrastive Loss: 0.0257
Epoch 20/30, Step 100/1,Classification Loss: 0.3293, Contrastive Loss: 0.0410
Epoch 20/30, Step 120/1,Classification Loss: 0.3255, Contrastive Loss: 0.0278
Accuracy: 0.9985, Precision: 0.9976, Recall: 0.9960, F1: 0.9968
Accuracy: 0.9954, Precision: 0.9911, Recall: 0.9894, F1: 0.9903
Epoch 20/30
Training - Loss: 48.4338
Training Metrics: {'accuracy': 0.9984824640287769, 'precision': 0.9975612003076446, 'recall': 0.9960146186159407, 'f1': 0.9967861656118597}
Validation Metrics: {'accuracy': 0.9954205294314755, 'precision': 0.9911240888928516, 'recall': 0.9894325979316232, 'f1': 0.9902762286634473}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 20/1,Classification Loss: 0.3148, Contrastive Loss: 0.0255
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 60/1,Classification Loss: 0.3145, Contrastive Loss: 0.0252
Epoch 21/30, Step 80/1,Classification Loss: 0.3287, Contrastive Loss: 0.0258
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Accuracy: 0.9980, Precision: 0.9974, Recall: 0.9940, F1: 0.9957
Accuracy: 0.9950, Precision: 0.9908, Recall: 0.9878, F1: 0.9893
Epoch 21/30
Training - Loss: 48.3111
Training Metrics: {'accuracy': 0.997976618705036, 'precision': 0.9974453454394105, 'recall': 0.9940353919741911, 'f1': 0.9957318507684407}
Validation Metrics: {'accuracy': 0.9949737518150341, 'precision': 0.9908420795163801, 'recall': 0.9877972749553354, 'f1': 0.9893128149424983}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 22/30, Step 40/1,Classification Loss: 0.3166, Contrastive Loss: 0.0234
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 22/30, Step 80/1,Classification Loss: 0.3259, Contrastive Loss: 0.0241
Epoch 22/30, Step 100/1,Classification Loss: 0.3572, Contrastive Loss: 0.0253
Epoch 22/30, Step 120/1,Classification Loss: 0.3138, Contrastive Loss: 0.0213
Accuracy: 0.9986, Precision: 0.9979, Recall: 0.9962, F1: 0.9971
Accuracy: 0.9952, Precision: 0.9887, Recall: 0.9910, F1: 0.9898
Epoch 22/30
Training - Loss: 47.9771
Training Metrics: {'accuracy': 0.9985948741007195, 'precision': 0.9979025740885171, 'recall': 0.9962070614751857, 'f1': 0.9970527112260507}
Validation Metrics: {'accuracy': 0.9951971406232548, 'precision': 0.9886720481214912, 'recall': 0.9910239702807022, 'f1': 0.9898439065747777}
Epoch 23/30, Step 0/1,Classification Loss: 0.3284, Contrastive Loss: 0.0236
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 23/30, Step 80/1,Classification Loss: 0.3237, Contrastive Loss: 0.0215
Epoch 23/30, Step 100/1,Classification Loss: 0.3231, Contrastive Loss: 0.0236
Epoch 23/30, Step 120/1,Classification Loss: 0.3224, Contrastive Loss: 0.0234
Accuracy: 0.9983, Precision: 0.9986, Recall: 0.9942, F1: 0.9964
Accuracy: 0.9946, Precision: 0.9896, Recall: 0.9876, F1: 0.9886
Epoch 23/30
Training - Loss: 47.9742
Training Metrics: {'accuracy': 0.9982857464028777, 'precision': 0.9985734162768144, 'recall': 0.9942042385980594, 'f1': 0.9963748849939302}
Validation Metrics: {'accuracy': 0.994638668602703, 'precision': 0.9896271388864577, 'recall': 0.9876032257962151, 'f1': 0.9886121434007542}
Epoch 24/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0206
Epoch 24/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0218
Epoch 24/30, Step 40/1,Classification Loss: 0.3222, Contrastive Loss: 0.0224
Epoch 24/30, Step 60/1,Classification Loss: 0.3565, Contrastive Loss: 0.0271
Epoch 24/30, Step 80/1,Classification Loss: 0.3249, Contrastive Loss: 0.0208
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0200
Accuracy: 0.9985, Precision: 0.9980, Recall: 0.9958, F1: 0.9969
Accuracy: 0.9951, Precision: 0.9912, Recall: 0.9879, F1: 0.9895
Epoch 24/30
Training - Loss: 47.7086
Training Metrics: {'accuracy': 0.9985386690647482, 'precision': 0.9980291397134393, 'recall': 0.995801310586889, 'f1': 0.9969116033243313}
Validation Metrics: {'accuracy': 0.9950854462191444, 'precision': 0.9912483943327135, 'recall': 0.9878619580083754, 'f1': 0.9895466940091686}
Epoch 25/30, Step 0/1,Classification Loss: 0.3147, Contrastive Loss: 0.0207
Epoch 25/30, Step 20/1,Classification Loss: 0.3298, Contrastive Loss: 0.0257
Epoch 25/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0202
Epoch 25/30, Step 60/1,Classification Loss: 0.3283, Contrastive Loss: 0.0247
Epoch 25/30, Step 80/1,Classification Loss: 0.3273, Contrastive Loss: 0.0262
Epoch 25/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0203
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Accuracy: 0.9982, Precision: 0.9978, Recall: 0.9947, F1: 0.9962
Accuracy: 0.9953, Precision: 0.9914, Recall: 0.9887, F1: 0.9900
Epoch 25/30
Training - Loss: 47.5924
Training Metrics: {'accuracy': 0.9982014388489209, 'precision': 0.9977510801286926, 'recall': 0.9946852865069613, 'f1': 0.9962113000618822}
Validation Metrics: {'accuracy': 0.9953088350273651, 'precision': 0.9913887107290513, 'recall': 0.9886796194965193, 'f1': 0.9900287406979356}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0203
Epoch 26/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0220
Epoch 26/30, Step 60/1,Classification Loss: 0.3301, Contrastive Loss: 0.0367
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 26/30, Step 100/1,Classification Loss: 0.3312, Contrastive Loss: 0.0247
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Accuracy: 0.9985, Precision: 0.9978, Recall: 0.9959, F1: 0.9969
Accuracy: 0.9952, Precision: 0.9897, Recall: 0.9900, F1: 0.9898
Epoch 26/30
Training - Loss: 47.5077
Training Metrics: {'accuracy': 0.9985105665467626, 'precision': 0.9978466569584548, 'recall': 0.9958866194687701, 'f1': 0.9968638283043909}
Validation Metrics: {'accuracy': 0.9951971406232548, 'precision': 0.9896545520351583, 'recall': 0.9899915272076067, 'f1': 0.9898229554993312}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 20/1,Classification Loss: 0.3187, Contrastive Loss: 0.0201
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 100/1,Classification Loss: 0.3202, Contrastive Loss: 0.0200
Epoch 27/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Accuracy: 0.9984, Precision: 0.9979, Recall: 0.9953, F1: 0.9966
Accuracy: 0.9952, Precision: 0.9900, Recall: 0.9896, F1: 0.9898
Epoch 27/30
Training - Loss: 47.5461
Training Metrics: {'accuracy': 0.9983700539568345, 'precision': 0.9978573852072182, 'recall': 0.9953190228648712, 'f1': 0.9965834754920809}
Validation Metrics: {'accuracy': 0.9951971406232548, 'precision': 0.9899846855423602, 'recall': 0.9896473795165748, 'f1': 0.9898159482748928}
Epoch 28/30, Step 0/1,Classification Loss: 0.3325, Contrastive Loss: 0.0217
Epoch 28/30, Step 20/1,Classification Loss: 0.3391, Contrastive Loss: 0.0673
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 100/1,Classification Loss: 0.3143, Contrastive Loss: 0.0193
Epoch 28/30, Step 120/1,Classification Loss: 0.3287, Contrastive Loss: 0.0220
Accuracy: 0.9984, Precision: 0.9978, Recall: 0.9956, F1: 0.9967
Accuracy: 0.9952, Precision: 0.9897, Recall: 0.9900, F1: 0.9898
Epoch 28/30
Training - Loss: 47.3448
Training Metrics: {'accuracy': 0.9984262589928058, 'precision': 0.9977925108629538, 'recall': 0.9955685132933952, 'f1': 0.9966768988914056}
Validation Metrics: {'accuracy': 0.9951971406232548, 'precision': 0.9896545520351583, 'recall': 0.9899915272076067, 'f1': 0.9898229554993312}
Epoch 29/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0219
Epoch 29/30, Step 20/1,Classification Loss: 0.3266, Contrastive Loss: 0.0206
Epoch 29/30, Step 40/1,Classification Loss: 0.3282, Contrastive Loss: 0.0191
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 29/30, Step 100/1,Classification Loss: 0.3143, Contrastive Loss: 0.0185
Epoch 29/30, Step 120/1,Classification Loss: 0.3261, Contrastive Loss: 0.0201
Accuracy: 0.9981, Precision: 0.9978, Recall: 0.9942, F1: 0.9960
Accuracy: 0.9952, Precision: 0.9906, Recall: 0.9890, F1: 0.9898
Epoch 29/30
Training - Loss: 47.3014
Training Metrics: {'accuracy': 0.9980890287769785, 'precision': 0.9977692053156062, 'recall': 0.9941861454677245, 'f1': 0.995968276839303}
Validation Metrics: {'accuracy': 0.9951971406232548, 'precision': 0.990648938620541, 'recall': 0.9889590841345112, 'f1': 0.9898018983543473}
Epoch 30/30, Step 0/1,Classification Loss: 0.3145, Contrastive Loss: 0.0185
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 40/1,Classification Loss: 0.3384, Contrastive Loss: 0.0337
Epoch 30/30, Step 60/1,Classification Loss: 0.3454, Contrastive Loss: 0.0280
Epoch 30/30, Step 80/1,Classification Loss: 0.3146, Contrastive Loss: 0.0181
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 30/30, Step 120/1,Classification Loss: 0.3409, Contrastive Loss: 0.0222
Accuracy: 0.9985, Precision: 0.9979, Recall: 0.9957, F1: 0.9968
Accuracy: 0.9949, Precision: 0.9908, Recall: 0.9874, F1: 0.9891
Epoch 30/30
Training - Loss: 47.1807
Training Metrics: {'accuracy': 0.9984824640287769, 'precision': 0.9979155549460784, 'recall': 0.9956992959336974, 'f1': 0.9968038329307564}
Validation Metrics: {'accuracy': 0.9948620574109237, 'precision': 0.9907715936953461, 'recall': 0.9873884442112635, 'f1': 0.9890715437368581}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1911, 5814), y shape: (1911,), y distribution: Counter({np.float64(0.0): 1720, np.float64(1.0): 191}), env shape: (1911,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9608, Precision: 0.9540, Recall: 0.8200, F1: 0.8725
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10715]))
original train data shape: torch.Size([44862]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1911, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44862]), new train data shape: torch.Size([44862])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10715]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3299, Contrastive Loss: 1.5844
Epoch 1/30, Step 20/1,Classification Loss: 0.3414, Contrastive Loss: 1.0584
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4653
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2527
Epoch 1/30, Step 80/1,Classification Loss: 0.3297, Contrastive Loss: 0.2091
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1665
Epoch 1/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1588
Accuracy: 0.9978, Precision: 0.9981, Recall: 0.9928, F1: 0.9954
Accuracy: 0.9947, Precision: 0.9920, Recall: 0.9853, F1: 0.9887
Epoch 1/30
Training - Loss: 109.2096
Training Metrics: {'accuracy': 0.9978236607142857, 'precision': 0.9980531010485798, 'recall': 0.9928239300055388, 'f1': 0.9954184464589668}
Validation Metrics: {'accuracy': 0.9946506185222334, 'precision': 0.9920473967135478, 'recall': 0.985330191295285, 'f1': 0.9886552948489669}
Epoch 2/30, Step 0/1,Classification Loss: 0.3299, Contrastive Loss: 0.1500
Epoch 2/30, Step 20/1,Classification Loss: 0.3434, Contrastive Loss: 0.1524
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1289
Epoch 2/30, Step 60/1,Classification Loss: 0.3556, Contrastive Loss: 0.1494
Epoch 2/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.1257
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1166
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1135
Accuracy: 0.9983, Precision: 0.9976, Recall: 0.9952, F1: 0.9964
Accuracy: 0.9948, Precision: 0.9901, Recall: 0.9878, F1: 0.9889
Epoch 2/30
Training - Loss: 63.2350
Training Metrics: {'accuracy': 0.9982700892857143, 'precision': 0.9975573413985876, 'recall': 0.9952127695493195, 'f1': 0.9963810147088312}
Validation Metrics: {'accuracy': 0.9947620639696868, 'precision': 0.9901136174856953, 'recall': 0.9877765023131022, 'f1': 0.9889409963841526}
Epoch 3/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.1118
Epoch 3/30, Step 20/1,Classification Loss: 0.3264, Contrastive Loss: 0.1138
Epoch 3/30, Step 40/1,Classification Loss: 0.3492, Contrastive Loss: 0.1245
Epoch 3/30, Step 60/1,Classification Loss: 0.3283, Contrastive Loss: 0.1106
Epoch 3/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.1030
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0996
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0971
Accuracy: 0.9978, Precision: 0.9981, Recall: 0.9926, F1: 0.9954
Accuracy: 0.9949, Precision: 0.9929, Recall: 0.9855, F1: 0.9891
Epoch 3/30
Training - Loss: 60.1611
Training Metrics: {'accuracy': 0.9977957589285714, 'precision': 0.9981213046313755, 'recall': 0.9926242119098907, 'f1': 0.9953506024290688}
Validation Metrics: {'accuracy': 0.9948735094171403, 'precision': 0.9928628645005567, 'recall': 0.9854594236550679, 'f1': 0.9891205127037265}
Epoch 4/30, Step 0/1,Classification Loss: 0.3257, Contrastive Loss: 0.1052
Epoch 4/30, Step 20/1,Classification Loss: 0.3170, Contrastive Loss: 0.0964
Epoch 4/30, Step 40/1,Classification Loss: 0.3273, Contrastive Loss: 0.0972
Epoch 4/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0924
Epoch 4/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.0953
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0870
Epoch 4/30, Step 120/1,Classification Loss: 0.3247, Contrastive Loss: 0.0883
Accuracy: 0.9983, Precision: 0.9975, Recall: 0.9953, F1: 0.9964
Accuracy: 0.9951, Precision: 0.9907, Recall: 0.9887, F1: 0.9897
Epoch 4/30
Training - Loss: 58.3154
Training Metrics: {'accuracy': 0.9982700892857143, 'precision': 0.9974852920853088, 'recall': 0.9953272380680047, 'f1': 0.9964028292260982}
Validation Metrics: {'accuracy': 0.9950964003120473, 'precision': 0.9906559854312785, 'recall': 0.9886508350921841, 'f1': 0.9896504235333198}
Epoch 5/30, Step 0/1,Classification Loss: 0.3368, Contrastive Loss: 0.0928
Epoch 5/30, Step 20/1,Classification Loss: 0.3284, Contrastive Loss: 0.0860
Epoch 5/30, Step 40/1,Classification Loss: 0.3489, Contrastive Loss: 0.0923
Epoch 5/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0845
Epoch 5/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.0824
Epoch 5/30, Step 100/1,Classification Loss: 0.3267, Contrastive Loss: 0.0826
Epoch 5/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0775
Accuracy: 0.9981, Precision: 0.9974, Recall: 0.9948, F1: 0.9961
Accuracy: 0.9945, Precision: 0.9900, Recall: 0.9870, F1: 0.9885
Epoch 5/30
Training - Loss: 56.8089
Training Metrics: {'accuracy': 0.9981305803571429, 'precision': 0.9973866287400763, 'recall': 0.9947837844658249, 'f1': 0.9960802299144434}
Validation Metrics: {'accuracy': 0.9945391730747799, 'precision': 0.9899717008804756, 'recall': 0.9869667857139119, 'f1': 0.9884625209778847}
Epoch 6/30, Step 0/1,Classification Loss: 0.3174, Contrastive Loss: 0.0782
Epoch 6/30, Step 20/1,Classification Loss: 0.3283, Contrastive Loss: 0.0768
Epoch 6/30, Step 40/1,Classification Loss: 0.3274, Contrastive Loss: 0.0741
Epoch 6/30, Step 60/1,Classification Loss: 0.3314, Contrastive Loss: 0.0854
Epoch 6/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0711
Epoch 6/30, Step 100/1,Classification Loss: 0.3182, Contrastive Loss: 0.0750
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0687
Accuracy: 0.9981, Precision: 0.9982, Recall: 0.9938, F1: 0.9960
Accuracy: 0.9949, Precision: 0.9915, Recall: 0.9868, F1: 0.9892
Epoch 6/30
Training - Loss: 55.4986
Training Metrics: {'accuracy': 0.9981026785714285, 'precision': 0.9982145953272578, 'recall': 0.9938172143329111, 'f1': 0.9960017403139259}
Validation Metrics: {'accuracy': 0.9948735094171403, 'precision': 0.9915130089278696, 'recall': 0.9868203921338826, 'f1': 0.9891503502312093}
Epoch 7/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0735
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0662
Epoch 7/30, Step 40/1,Classification Loss: 0.3143, Contrastive Loss: 0.0674
Epoch 7/30, Step 60/1,Classification Loss: 0.3229, Contrastive Loss: 0.0672
Epoch 7/30, Step 80/1,Classification Loss: 0.3257, Contrastive Loss: 0.0655
Epoch 7/30, Step 100/1,Classification Loss: 0.3146, Contrastive Loss: 0.0685
Epoch 7/30, Step 120/1,Classification Loss: 0.3278, Contrastive Loss: 0.0654
Accuracy: 0.9982, Precision: 0.9983, Recall: 0.9941, F1: 0.9962
Accuracy: 0.9948, Precision: 0.9898, Recall: 0.9881, F1: 0.9889
Epoch 7/30
Training - Loss: 54.6237
Training Metrics: {'accuracy': 0.9981863839285714, 'precision': 0.9982644445070883, 'recall': 0.9941279592767939, 'f1': 0.9961836627441302}
Validation Metrics: {'accuracy': 0.9947620639696868, 'precision': 0.989784478821154, 'recall': 0.9881167444328061, 'f1': 0.9889485416462214}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0613
Epoch 8/30, Step 20/1,Classification Loss: 0.3476, Contrastive Loss: 0.0674
Epoch 8/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0678
Epoch 8/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0596
Epoch 8/30, Step 80/1,Classification Loss: 0.3259, Contrastive Loss: 0.0620
Epoch 8/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0663
Epoch 8/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0588
Accuracy: 0.9979, Precision: 0.9972, Recall: 0.9939, F1: 0.9956
Accuracy: 0.9944, Precision: 0.9909, Recall: 0.9855, F1: 0.9882
Epoch 8/30
Training - Loss: 53.6076
Training Metrics: {'accuracy': 0.9979073660714286, 'precision': 0.9972410917064888, 'recall': 0.9939348695662753, 'f1': 0.9955799764124322}
Validation Metrics: {'accuracy': 0.9944277276273265, 'precision': 0.9908991374004112, 'recall': 0.9855412010552058, 'f1': 0.988198814815376}
Epoch 9/30, Step 0/1,Classification Loss: 0.3140, Contrastive Loss: 0.0580
Epoch 9/30, Step 20/1,Classification Loss: 0.3141, Contrastive Loss: 0.0573
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0553
Epoch 9/30, Step 60/1,Classification Loss: 0.3224, Contrastive Loss: 0.0586
Epoch 9/30, Step 80/1,Classification Loss: 0.3312, Contrastive Loss: 0.1286
Epoch 9/30, Step 100/1,Classification Loss: 0.3374, Contrastive Loss: 0.0571
Epoch 9/30, Step 120/1,Classification Loss: 0.3145, Contrastive Loss: 0.0532
Accuracy: 0.9979, Precision: 0.9973, Recall: 0.9938, F1: 0.9956
Accuracy: 0.9947, Precision: 0.9910, Recall: 0.9864, F1: 0.9887
Epoch 9/30
Training - Loss: 53.0980
Training Metrics: {'accuracy': 0.9978794642857143, 'precision': 0.9973331779724479, 'recall': 0.9938349043791495, 'f1': 0.9955750146780382}
Validation Metrics: {'accuracy': 0.9946506185222334, 'precision': 0.991039009034365, 'recall': 0.9863509176543961, 'f1': 0.9886786263282185}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0522
Epoch 10/30, Step 20/1,Classification Loss: 0.3295, Contrastive Loss: 0.0556
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0503
Epoch 10/30, Step 60/1,Classification Loss: 0.3149, Contrastive Loss: 0.0512
Epoch 10/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0502
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0489
Epoch 10/30, Step 120/1,Classification Loss: 0.3261, Contrastive Loss: 0.0495
Accuracy: 0.9983, Precision: 0.9976, Recall: 0.9954, F1: 0.9965
Accuracy: 0.9947, Precision: 0.9900, Recall: 0.9874, F1: 0.9887
Epoch 10/30
Training - Loss: 52.4131
Training Metrics: {'accuracy': 0.9983258928571429, 'precision': 0.9975942334043951, 'recall': 0.9954235326816344, 'f1': 0.9965054157864878}
Validation Metrics: {'accuracy': 0.9946506185222334, 'precision': 0.9900426562933026, 'recall': 0.9873716440135072, 'f1': 0.9887018406988499}
Epoch 11/30, Step 0/1,Classification Loss: 0.3259, Contrastive Loss: 0.0499
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0468
Epoch 11/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0471
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0459
Epoch 11/30, Step 80/1,Classification Loss: 0.3173, Contrastive Loss: 0.0478
Epoch 11/30, Step 100/1,Classification Loss: 0.3363, Contrastive Loss: 0.0958
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0447
Accuracy: 0.9965, Precision: 0.9966, Recall: 0.9885, F1: 0.9925
Accuracy: 0.9925, Precision: 0.9890, Recall: 0.9793, F1: 0.9841
Epoch 11/30
Training - Loss: 51.8763
Training Metrics: {'accuracy': 0.9964564732142858, 'precision': 0.9966481344891406, 'recall': 0.988450900373048, 'f1': 0.9925000243741628}
Validation Metrics: {'accuracy': 0.9925331550206175, 'precision': 0.9890327235971552, 'recall': 0.9793390942014958, 'f1': 0.9841155229887784}
Epoch 12/30, Step 0/1,Classification Loss: 0.3276, Contrastive Loss: 0.0475
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0431
Epoch 12/30, Step 40/1,Classification Loss: 0.3208, Contrastive Loss: 0.0448
Epoch 12/30, Step 60/1,Classification Loss: 0.3202, Contrastive Loss: 0.0437
Epoch 12/30, Step 80/1,Classification Loss: 0.3187, Contrastive Loss: 0.0437
Epoch 12/30, Step 100/1,Classification Loss: 0.3330, Contrastive Loss: 0.0588
Epoch 12/30, Step 120/1,Classification Loss: 0.3141, Contrastive Loss: 0.0422
Accuracy: 0.9982, Precision: 0.9977, Recall: 0.9947, F1: 0.9962
Accuracy: 0.9944, Precision: 0.9896, Recall: 0.9869, F1: 0.9882
Epoch 12/30
Training - Loss: 51.3003
Training Metrics: {'accuracy': 0.9981863839285714, 'precision': 0.9976749650462964, 'recall': 0.9947398853219915, 'f1': 0.9962010948794834}
Validation Metrics: {'accuracy': 0.9944277276273265, 'precision': 0.9895706088859175, 'recall': 0.9869021695340205, 'f1': 0.988231084061302}
Epoch 13/30, Step 0/1,Classification Loss: 0.3227, Contrastive Loss: 0.0429
Epoch 13/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0412
Epoch 13/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0400
Epoch 13/30, Step 60/1,Classification Loss: 0.3487, Contrastive Loss: 0.0458
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0387
Epoch 13/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0398
Epoch 13/30, Step 120/1,Classification Loss: 0.3204, Contrastive Loss: 0.0391
Accuracy: 0.9983, Precision: 0.9976, Recall: 0.9951, F1: 0.9964
Accuracy: 0.9951, Precision: 0.9920, Recall: 0.9873, F1: 0.9896
Epoch 13/30
Training - Loss: 50.7556
Training Metrics: {'accuracy': 0.9982700892857143, 'precision': 0.9976437817760763, 'recall': 0.9951360340726527, 'f1': 0.9963852818923133}
Validation Metrics: {'accuracy': 0.9950964003120473, 'precision': 0.9919870088213741, 'recall': 0.9872898666133691, 'f1': 0.9896220741342003}
Epoch 14/30, Step 0/1,Classification Loss: 0.3245, Contrastive Loss: 0.0413
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0368
Epoch 14/30, Step 40/1,Classification Loss: 0.3279, Contrastive Loss: 0.0390
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0359
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0357
Epoch 14/30, Step 100/1,Classification Loss: 0.3367, Contrastive Loss: 0.0414
Epoch 14/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0368
Accuracy: 0.9978, Precision: 0.9981, Recall: 0.9927, F1: 0.9954
Accuracy: 0.9947, Precision: 0.9920, Recall: 0.9853, F1: 0.9887
Epoch 14/30
Training - Loss: 50.4061
Training Metrics: {'accuracy': 0.9978236607142857, 'precision': 0.9981339348099265, 'recall': 0.9926772043089637, 'f1': 0.995383811063445}
Validation Metrics: {'accuracy': 0.9946506185222334, 'precision': 0.9920473967135478, 'recall': 0.985330191295285, 'f1': 0.9886552948489669}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0346
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 15/30, Step 40/1,Classification Loss: 0.3154, Contrastive Loss: 0.0354
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Epoch 15/30, Step 80/1,Classification Loss: 0.3209, Contrastive Loss: 0.0356
Epoch 15/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0387
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Accuracy: 0.9980, Precision: 0.9983, Recall: 0.9935, F1: 0.9959
Accuracy: 0.9941, Precision: 0.9904, Recall: 0.9847, F1: 0.9875
Epoch 15/30
Training - Loss: 50.0749
Training Metrics: {'accuracy': 0.998046875, 'precision': 0.9982693008303651, 'recall': 0.9935498644739182, 'f1': 0.9958932418626294}
Validation Metrics: {'accuracy': 0.994093391284966, 'precision': 0.9903542287988363, 'recall': 0.9846668682761239, 'f1': 0.9874864518723643}
Epoch 16/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 0.0362
Epoch 16/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0333
Epoch 16/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0324
Epoch 16/30, Step 60/1,Classification Loss: 0.3235, Contrastive Loss: 0.0360
Epoch 16/30, Step 80/1,Classification Loss: 0.3378, Contrastive Loss: 0.0356
Epoch 16/30, Step 100/1,Classification Loss: 0.3391, Contrastive Loss: 0.0360
Epoch 16/30, Step 120/1,Classification Loss: 0.3283, Contrastive Loss: 0.0332
Accuracy: 0.9983, Precision: 0.9977, Recall: 0.9952, F1: 0.9964
Accuracy: 0.9950, Precision: 0.9896, Recall: 0.9893, F1: 0.9894
Epoch 16/30
Training - Loss: 49.7253
Training Metrics: {'accuracy': 0.9982979910714286, 'precision': 0.9976569602380629, 'recall': 0.9952262849102609, 'f1': 0.9964372816875804}
Validation Metrics: {'accuracy': 0.9949849548645938, 'precision': 0.9895999194129881, 'recall': 0.9892667031517, 'f1': 0.9894332286744467}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Epoch 17/30, Step 20/1,Classification Loss: 0.3261, Contrastive Loss: 0.0307
Epoch 17/30, Step 40/1,Classification Loss: 0.3267, Contrastive Loss: 0.0325
Epoch 17/30, Step 60/1,Classification Loss: 0.3142, Contrastive Loss: 0.0300
Epoch 17/30, Step 80/1,Classification Loss: 0.3165, Contrastive Loss: 0.0295
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0282
Epoch 17/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0288
Accuracy: 0.9984, Precision: 0.9977, Recall: 0.9955, F1: 0.9966
Accuracy: 0.9947, Precision: 0.9894, Recall: 0.9881, F1: 0.9887
Epoch 17/30
Training - Loss: 49.3100
Training Metrics: {'accuracy': 0.9983816964285714, 'precision': 0.9976898578383789, 'recall': 0.9954815491943829, 'f1': 0.9965821407475466}
Validation Metrics: {'accuracy': 0.9946506185222334, 'precision': 0.9893850227933723, 'recall': 0.9880521282529146, 'f1': 0.9887172523057772}
Epoch 18/30, Step 0/1,Classification Loss: 0.3204, Contrastive Loss: 0.0308
Epoch 18/30, Step 20/1,Classification Loss: 0.3162, Contrastive Loss: 0.0297
Epoch 18/30, Step 40/1,Classification Loss: 0.3341, Contrastive Loss: 0.0840
Epoch 18/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0283
Epoch 18/30, Step 80/1,Classification Loss: 0.3151, Contrastive Loss: 0.0276
Epoch 18/30, Step 100/1,Classification Loss: 0.3443, Contrastive Loss: 0.0368
Epoch 18/30, Step 120/1,Classification Loss: 0.3284, Contrastive Loss: 0.0312
Accuracy: 0.9983, Precision: 0.9975, Recall: 0.9953, F1: 0.9964
Accuracy: 0.9949, Precision: 0.9905, Recall: 0.9878, F1: 0.9892
Epoch 18/30
Training - Loss: 49.0680
Training Metrics: {'accuracy': 0.9982700892857143, 'precision': 0.9974668547539314, 'recall': 0.9952801323129861, 'f1': 0.9963699848743924}
Validation Metrics: {'accuracy': 0.9948735094171403, 'precision': 0.9905147037006875, 'recall': 0.9878411184929937, 'f1': 0.9891725973363978}
Epoch 19/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0417
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0257
Epoch 19/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0265
Epoch 19/30, Step 60/1,Classification Loss: 0.3145, Contrastive Loss: 0.0259
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 19/30, Step 120/1,Classification Loss: 0.3152, Contrastive Loss: 0.0264
Accuracy: 0.9982, Precision: 0.9976, Recall: 0.9949, F1: 0.9962
Accuracy: 0.9943, Precision: 0.9902, Recall: 0.9858, F1: 0.9880
Epoch 19/30
Training - Loss: 48.8924
Training Metrics: {'accuracy': 0.9982142857142857, 'precision': 0.9976005300960284, 'recall': 0.9949031899249718, 'f1': 0.9962465253408139}
Validation Metrics: {'accuracy': 0.994316282179873, 'precision': 0.9901616094729131, 'recall': 0.985816826995018, 'f1': 0.9879751599681872}
Epoch 20/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0252
Epoch 20/30, Step 20/1,Classification Loss: 0.3408, Contrastive Loss: 0.0309
Epoch 20/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0247
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 20/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0244
Epoch 20/30, Step 100/1,Classification Loss: 0.3276, Contrastive Loss: 0.0268
Epoch 20/30, Step 120/1,Classification Loss: 0.3171, Contrastive Loss: 0.0271
Accuracy: 0.9980, Precision: 0.9975, Recall: 0.9942, F1: 0.9958
Accuracy: 0.9945, Precision: 0.9906, Recall: 0.9863, F1: 0.9884
Epoch 20/30
Training - Loss: 48.7459
Training Metrics: {'accuracy': 0.9980189732142857, 'precision': 0.9974763952196086, 'recall': 0.9941653360295594, 'f1': 0.9958128455636726}
Validation Metrics: {'accuracy': 0.9945391730747799, 'precision': 0.99063528258114, 'recall': 0.9862863014745046, 'f1': 0.9884467223223761}
Epoch 21/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 21/30, Step 20/1,Classification Loss: 0.3146, Contrastive Loss: 0.0248
Epoch 21/30, Step 40/1,Classification Loss: 0.3193, Contrastive Loss: 0.0260
Epoch 21/30, Step 60/1,Classification Loss: 0.3287, Contrastive Loss: 0.0291
Epoch 21/30, Step 80/1,Classification Loss: 0.3144, Contrastive Loss: 0.0229
Epoch 21/30, Step 100/1,Classification Loss: 0.3252, Contrastive Loss: 0.0270
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Accuracy: 0.9984, Precision: 0.9977, Recall: 0.9955, F1: 0.9966
Accuracy: 0.9943, Precision: 0.9869, Recall: 0.9892, F1: 0.9881
Epoch 21/30
Training - Loss: 48.3733
Training Metrics: {'accuracy': 0.9983816964285714, 'precision': 0.9976969680408397, 'recall': 0.995501136722031, 'f1': 0.9965955216645048}
Validation Metrics: {'accuracy': 0.994316282179873, 'precision': 0.9869024387043317, 'recall': 0.989219248192055, 'f1': 0.9880568304488957}
Epoch 22/30, Step 0/1,Classification Loss: 0.3218, Contrastive Loss: 0.0228
Epoch 22/30, Step 20/1,Classification Loss: 0.3173, Contrastive Loss: 0.0251
Epoch 22/30, Step 40/1,Classification Loss: 0.3146, Contrastive Loss: 0.0232
Epoch 22/30, Step 60/1,Classification Loss: 0.3150, Contrastive Loss: 0.0273
Epoch 22/30, Step 80/1,Classification Loss: 0.3156, Contrastive Loss: 0.0223
Epoch 22/30, Step 100/1,Classification Loss: 0.3155, Contrastive Loss: 0.0224
Epoch 22/30, Step 120/1,Classification Loss: 0.3268, Contrastive Loss: 0.0236
Accuracy: 0.9984, Precision: 0.9958, Recall: 0.9977, F1: 0.9967
Accuracy: 0.9948, Precision: 0.9869, Recall: 0.9912, F1: 0.9890
Epoch 22/30
Training - Loss: 48.4361
Training Metrics: {'accuracy': 0.9984095982142858, 'precision': 0.9957549934574472, 'recall': 0.9976565775917272, 'f1': 0.9967031146140447}
Validation Metrics: {'accuracy': 0.9947620639696868, 'precision': 0.9868804456061737, 'recall': 0.9911789235101393, 'f1': 0.9890158855291973}
Epoch 23/30, Step 0/1,Classification Loss: 0.3315, Contrastive Loss: 0.0257
Epoch 23/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0219
Epoch 23/30, Step 40/1,Classification Loss: 0.3193, Contrastive Loss: 0.0215
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 80/1,Classification Loss: 0.3219, Contrastive Loss: 0.0221
Epoch 23/30, Step 100/1,Classification Loss: 0.3160, Contrastive Loss: 0.0213
Epoch 23/30, Step 120/1,Classification Loss: 0.3257, Contrastive Loss: 0.0228
Accuracy: 0.9980, Precision: 0.9974, Recall: 0.9944, F1: 0.9959
Accuracy: 0.9942, Precision: 0.9901, Recall: 0.9854, F1: 0.9877
Epoch 23/30
Training - Loss: 48.2811
Training Metrics: {'accuracy': 0.998046875, 'precision': 0.9974204636851046, 'recall': 0.994394786781094, 'f1': 0.9959009012553517}
Validation Metrics: {'accuracy': 0.9942048367324194, 'precision': 0.990091009247356, 'recall': 0.9854119686954229, 'f1': 0.9877351785222367}
Epoch 24/30, Step 0/1,Classification Loss: 0.3322, Contrastive Loss: 0.0264
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 60/1,Classification Loss: 0.3145, Contrastive Loss: 0.0210
Epoch 24/30, Step 80/1,Classification Loss: 0.3287, Contrastive Loss: 0.0234
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Accuracy: 0.9984, Precision: 0.9977, Recall: 0.9956, F1: 0.9966
Accuracy: 0.9947, Precision: 0.9897, Recall: 0.9877, F1: 0.9887
Epoch 24/30
Training - Loss: 48.0197
Training Metrics: {'accuracy': 0.9984095982142858, 'precision': 0.9977047742173792, 'recall': 0.9955787893938759, 'f1': 0.9966384816497089}
Validation Metrics: {'accuracy': 0.9946506185222334, 'precision': 0.9897131835497515, 'recall': 0.9877118861332108, 'f1': 0.9887095529454398}
Epoch 25/30, Step 0/1,Classification Loss: 0.3162, Contrastive Loss: 0.0210
Epoch 25/30, Step 20/1,Classification Loss: 0.3285, Contrastive Loss: 0.0243
Epoch 25/30, Step 40/1,Classification Loss: 0.3215, Contrastive Loss: 0.0207
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 25/30, Step 80/1,Classification Loss: 0.3287, Contrastive Loss: 0.0240
Epoch 25/30, Step 100/1,Classification Loss: 0.3188, Contrastive Loss: 0.0218
Epoch 25/30, Step 120/1,Classification Loss: 0.3265, Contrastive Loss: 0.0218
Accuracy: 0.9984, Precision: 0.9976, Recall: 0.9955, F1: 0.9965
Accuracy: 0.9944, Precision: 0.9906, Recall: 0.9859, F1: 0.9882
Epoch 25/30
Training - Loss: 47.9704
Training Metrics: {'accuracy': 0.9983537946428571, 'precision': 0.9975888940954849, 'recall': 0.995467082751196, 'f1': 0.9965246980156329}
Validation Metrics: {'accuracy': 0.9944277276273265, 'precision': 0.9905650091408605, 'recall': 0.9858814431749094, 'f1': 0.9882069024252276}
Epoch 26/30, Step 0/1,Classification Loss: 0.3390, Contrastive Loss: 0.0234
Epoch 26/30, Step 20/1,Classification Loss: 0.3217, Contrastive Loss: 0.0203
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 26/30, Step 60/1,Classification Loss: 0.3627, Contrastive Loss: 0.1019
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 26/30, Step 100/1,Classification Loss: 0.3217, Contrastive Loss: 0.0225
Epoch 26/30, Step 120/1,Classification Loss: 0.3294, Contrastive Loss: 0.0364
Accuracy: 0.9983, Precision: 0.9977, Recall: 0.9952, F1: 0.9964
Accuracy: 0.9944, Precision: 0.9876, Recall: 0.9889, F1: 0.9883
Epoch 26/30
Training - Loss: 47.7911
Training Metrics: {'accuracy': 0.9982979910714286, 'precision': 0.9976527156502918, 'recall': 0.9952136857425733, 'f1': 0.9964288360453595}
Validation Metrics: {'accuracy': 0.9944277276273265, 'precision': 0.9876171754417931, 'recall': 0.9889436222522427, 'f1': 0.9882790849028449}
Epoch 27/30, Step 0/1,Classification Loss: 0.3180, Contrastive Loss: 0.0212
Epoch 27/30, Step 20/1,Classification Loss: 0.3140, Contrastive Loss: 0.0200
Epoch 27/30, Step 40/1,Classification Loss: 0.3196, Contrastive Loss: 0.0210
Epoch 27/30, Step 60/1,Classification Loss: 0.3172, Contrastive Loss: 0.0205
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 100/1,Classification Loss: 0.3262, Contrastive Loss: 0.0201
Epoch 27/30, Step 120/1,Classification Loss: 0.3389, Contrastive Loss: 0.0230
Accuracy: 0.9982, Precision: 0.9975, Recall: 0.9949, F1: 0.9962
Accuracy: 0.9940, Precision: 0.9893, Recall: 0.9853, F1: 0.9873
Epoch 27/30
Training - Loss: 47.9408
Training Metrics: {'accuracy': 0.9981863839285714, 'precision': 0.997506842429368, 'recall': 0.9949091175245359, 'f1': 0.9962030197301288}
Validation Metrics: {'accuracy': 0.9939819458375125, 'precision': 0.9892855221164245, 'recall': 0.98528273633564, 'f1': 0.9872721745993853}
Epoch 28/30, Step 0/1,Classification Loss: 0.3314, Contrastive Loss: 0.0280
Epoch 28/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0188
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 60/1,Classification Loss: 0.3194, Contrastive Loss: 0.0184
Epoch 28/30, Step 80/1,Classification Loss: 0.3143, Contrastive Loss: 0.0205
Epoch 28/30, Step 100/1,Classification Loss: 0.3146, Contrastive Loss: 0.0183
Epoch 28/30, Step 120/1,Classification Loss: 0.3235, Contrastive Loss: 0.0192
Accuracy: 0.9982, Precision: 0.9976, Recall: 0.9947, F1: 0.9961
Accuracy: 0.9947, Precision: 0.9900, Recall: 0.9874, F1: 0.9887
Epoch 28/30
Training - Loss: 47.8705
Training Metrics: {'accuracy': 0.9981584821428572, 'precision': 0.9975663579902896, 'recall': 0.9946975848006354, 'f1': 0.9961259384458158}
Validation Metrics: {'accuracy': 0.9946506185222334, 'precision': 0.9900426562933026, 'recall': 0.9873716440135072, 'f1': 0.9887018406988499}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 20/1,Classification Loss: 0.3200, Contrastive Loss: 0.0202
Epoch 29/30, Step 40/1,Classification Loss: 0.3223, Contrastive Loss: 0.0209
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0179
Epoch 29/30, Step 120/1,Classification Loss: 0.3298, Contrastive Loss: 0.0232
Accuracy: 0.9981, Precision: 0.9976, Recall: 0.9943, F1: 0.9959
Accuracy: 0.9949, Precision: 0.9922, Recall: 0.9861, F1: 0.9891
Epoch 29/30
Training - Loss: 47.6970
Training Metrics: {'accuracy': 0.9980747767857143, 'precision': 0.99759559330454, 'recall': 0.9942861962018127, 'f1': 0.995932882556216}
Validation Metrics: {'accuracy': 0.9948735094171403, 'precision': 0.9921852321610263, 'recall': 0.9861399078944753, 'f1': 0.9891354565288757}
Epoch 30/30, Step 0/1,Classification Loss: 0.3272, Contrastive Loss: 0.0213
Epoch 30/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0174
Epoch 30/30, Step 40/1,Classification Loss: 0.3244, Contrastive Loss: 0.0189
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 80/1,Classification Loss: 0.3305, Contrastive Loss: 0.0210
Epoch 30/30, Step 100/1,Classification Loss: 0.3148, Contrastive Loss: 0.0182
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Accuracy: 0.9983, Precision: 0.9977, Recall: 0.9953, F1: 0.9965
Accuracy: 0.9948, Precision: 0.9901, Recall: 0.9878, F1: 0.9889
Epoch 30/30
Training - Loss: 47.6339
Training Metrics: {'accuracy': 0.9983258928571429, 'precision': 0.9976688974037466, 'recall': 0.9953134069239065, 'f1': 0.9964870821365088}
Validation Metrics: {'accuracy': 0.9947620639696868, 'precision': 0.9901136174856953, 'recall': 0.9877765023131022, 'f1': 0.9889409963841526}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1931, 5814), y shape: (1931,), y distribution: Counter({np.float64(0.0): 1734, np.float64(1.0): 197}), env shape: (1931,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9689, Precision: 0.9566, Recall: 0.8680, F1: 0.9062
month: 2020-09, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1902, 5814), y shape: (1902,), y distribution: Counter({np.float64(0.0): 1704, np.float64(1.0): 198}), env shape: (1902,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9742, Precision: 0.9524, Recall: 0.9053, F1: 0.9272
month: 2020-10, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1788, 5814), y shape: (1788,), y distribution: Counter({np.float64(0.0): 1593, np.float64(1.0): 195}), env shape: (1788,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9804, Precision: 0.9689, Recall: 0.9283, F1: 0.9474
month: 2020-11, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1855, 5814), y shape: (1855,), y distribution: Counter({np.float64(0.0): 1657, np.float64(1.0): 198}), env shape: (1855,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9644, Precision: 0.9533, Recall: 0.8533, F1: 0.8954
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10815]))
original train data shape: torch.Size([44962]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1855, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([44962]), new train data shape: torch.Size([44962])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10815]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.5848
Epoch 1/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 1.1054
Epoch 1/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.5293
Epoch 1/30, Step 60/1,Classification Loss: 0.3293, Contrastive Loss: 0.3158
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2262
Epoch 1/30, Step 100/1,Classification Loss: 0.3446, Contrastive Loss: 0.2166
Epoch 1/30, Step 120/1,Classification Loss: 0.3529, Contrastive Loss: 0.2068
Accuracy: 0.9978, Precision: 0.9953, Recall: 0.9956, F1: 0.9955
Accuracy: 0.9940, Precision: 0.9878, Recall: 0.9871, F1: 0.9874
Epoch 1/30
Training - Loss: 114.2303
Training Metrics: {'accuracy': 0.9978236607142857, 'precision': 0.9952953204741755, 'recall': 0.9956280794977312, 'f1': 0.9954616182572614}
Validation Metrics: {'accuracy': 0.9939953297008784, 'precision': 0.9877675954953908, 'recall': 0.9871123138179966, 'f1': 0.9874396322689576}
Epoch 2/30, Step 0/1,Classification Loss: 0.3285, Contrastive Loss: 0.1739
Epoch 2/30, Step 20/1,Classification Loss: 0.3276, Contrastive Loss: 0.1605
Epoch 2/30, Step 40/1,Classification Loss: 0.3140, Contrastive Loss: 0.1474
Epoch 2/30, Step 60/1,Classification Loss: 0.3209, Contrastive Loss: 0.1412
Epoch 2/30, Step 80/1,Classification Loss: 0.3419, Contrastive Loss: 0.1473
Epoch 2/30, Step 100/1,Classification Loss: 0.3265, Contrastive Loss: 0.1384
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1246
Accuracy: 0.9983, Precision: 0.9954, Recall: 0.9976, F1: 0.9965
Accuracy: 0.9946, Precision: 0.9869, Recall: 0.9905, F1: 0.9887
Epoch 2/30
Training - Loss: 65.5376
Training Metrics: {'accuracy': 0.9982979910714286, 'precision': 0.9953692074042277, 'recall': 0.9975945196942433, 'f1': 0.9964781997894494}
Validation Metrics: {'accuracy': 0.9945513176915378, 'precision': 0.9868667368667369, 'recall': 0.9904569316610312, 'f1': 0.9886521593272811}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1217
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1182
Epoch 3/30, Step 40/1,Classification Loss: 0.3143, Contrastive Loss: 0.1243
Epoch 3/30, Step 60/1,Classification Loss: 0.3411, Contrastive Loss: 0.1249
Epoch 3/30, Step 80/1,Classification Loss: 0.3298, Contrastive Loss: 0.1236
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1086
Epoch 3/30, Step 120/1,Classification Loss: 0.3159, Contrastive Loss: 0.1074
Accuracy: 0.9983, Precision: 0.9978, Recall: 0.9952, F1: 0.9965
Accuracy: 0.9944, Precision: 0.9897, Recall: 0.9870, F1: 0.9883
Epoch 3/30
Training - Loss: 61.7549
Training Metrics: {'accuracy': 0.9983258928571429, 'precision': 0.9977575864632073, 'recall': 0.9952424892141241, 'f1': 0.9964953910513527}
Validation Metrics: {'accuracy': 0.994440120093406, 'precision': 0.9896685963498594, 'recall': 0.987034824140304, 'f1': 0.98834651979109}
Epoch 4/30, Step 0/1,Classification Loss: 0.3193, Contrastive Loss: 0.1138
Epoch 4/30, Step 20/1,Classification Loss: 0.3209, Contrastive Loss: 0.1033
Epoch 4/30, Step 40/1,Classification Loss: 0.3194, Contrastive Loss: 0.1020
Epoch 4/30, Step 60/1,Classification Loss: 0.3286, Contrastive Loss: 0.1049
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0960
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0954
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0940
Accuracy: 0.9983, Precision: 0.9976, Recall: 0.9951, F1: 0.9964
Accuracy: 0.9947, Precision: 0.9898, Recall: 0.9878, F1: 0.9888
Epoch 4/30
Training - Loss: 59.3047
Training Metrics: {'accuracy': 0.9982700892857143, 'precision': 0.9976356224995262, 'recall': 0.9951112358795696, 'f1': 0.9963687542362055}
Validation Metrics: {'accuracy': 0.9946625152896698, 'precision': 0.9898107596086472, 'recall': 0.9878354646527139, 'f1': 0.9888201946758866}
Epoch 5/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1009
Epoch 5/30, Step 20/1,Classification Loss: 0.3197, Contrastive Loss: 0.0917
Epoch 5/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0898
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0871
Epoch 5/30, Step 80/1,Classification Loss: 0.3285, Contrastive Loss: 0.0940
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0841
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0827
Accuracy: 0.9973, Precision: 0.9979, Recall: 0.9909, F1: 0.9944
Accuracy: 0.9939, Precision: 0.9910, Recall: 0.9834, F1: 0.9871
Epoch 5/30
Training - Loss: 57.8851
Training Metrics: {'accuracy': 0.9973214285714286, 'precision': 0.9979334050899362, 'recall': 0.9908756897820346, 'f1': 0.9943678745544631}
Validation Metrics: {'accuracy': 0.9938841321027466, 'precision': 0.9909640926570376, 'recall': 0.9833544521567668, 'f1': 0.9871159535526759}
Epoch 6/30, Step 0/1,Classification Loss: 0.3456, Contrastive Loss: 0.0980
Epoch 6/30, Step 20/1,Classification Loss: 0.3224, Contrastive Loss: 0.0824
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0790
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0783
Epoch 6/30, Step 80/1,Classification Loss: 0.3252, Contrastive Loss: 0.0817
Epoch 6/30, Step 100/1,Classification Loss: 0.3232, Contrastive Loss: 0.0776
Epoch 6/30, Step 120/1,Classification Loss: 0.3477, Contrastive Loss: 0.0968
Accuracy: 0.9984, Precision: 0.9957, Recall: 0.9976, F1: 0.9967
Accuracy: 0.9947, Precision: 0.9876, Recall: 0.9902, F1: 0.9889
Epoch 6/30
Training - Loss: 56.4404
Training Metrics: {'accuracy': 0.9984095982142858, 'precision': 0.9957180451377806, 'recall': 0.9976415370320444, 'f1': 0.9966770712003421}
Validation Metrics: {'accuracy': 0.9946625152896698, 'precision': 0.987569713019706, 'recall': 0.9901857436362314, 'f1': 0.9888725972394934}
Epoch 7/30, Step 0/1,Classification Loss: 0.3171, Contrastive Loss: 0.0774
Epoch 7/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0750
Epoch 7/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0871
Epoch 7/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0719
Epoch 7/30, Step 80/1,Classification Loss: 0.3273, Contrastive Loss: 0.0739
Epoch 7/30, Step 100/1,Classification Loss: 0.3160, Contrastive Loss: 0.0723
Epoch 7/30, Step 120/1,Classification Loss: 0.3309, Contrastive Loss: 0.0762
Accuracy: 0.9984, Precision: 0.9957, Recall: 0.9977, F1: 0.9967
Accuracy: 0.9942, Precision: 0.9854, Recall: 0.9906, F1: 0.9880
Epoch 7/30
Training - Loss: 55.2788
Training Metrics: {'accuracy': 0.9984095982142858, 'precision': 0.9957401413166284, 'recall': 0.9976505340353646, 'f1': 0.9966926471337698}
Validation Metrics: {'accuracy': 0.9942177248971422, 'precision': 0.9853966685488424, 'recall': 0.9905989874544263, 'f1': 0.9879774606567235}
Epoch 8/30, Step 0/1,Classification Loss: 0.3305, Contrastive Loss: 0.0745
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0662
Epoch 8/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0730
Epoch 8/30, Step 60/1,Classification Loss: 0.3240, Contrastive Loss: 0.0679
Epoch 8/30, Step 80/1,Classification Loss: 0.3224, Contrastive Loss: 0.0675
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0626
Epoch 8/30, Step 120/1,Classification Loss: 0.3457, Contrastive Loss: 0.0757
Accuracy: 0.9980, Precision: 0.9983, Recall: 0.9934, F1: 0.9958
Accuracy: 0.9943, Precision: 0.9909, Recall: 0.9853, F1: 0.9881
Epoch 8/30
Training - Loss: 54.5792
Training Metrics: {'accuracy': 0.9980189732142857, 'precision': 0.9983382422565111, 'recall': 0.993362269999363, 'f1': 0.9958320945163637}
Validation Metrics: {'accuracy': 0.994328922495274, 'precision': 0.9909102099742804, 'recall': 0.985291487322089, 'f1': 0.9880772555718852}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0614
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0612
Epoch 9/30, Step 40/1,Classification Loss: 0.3753, Contrastive Loss: 0.0968
Epoch 9/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0597
Epoch 9/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0704
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0585
Epoch 9/30, Step 120/1,Classification Loss: 0.3158, Contrastive Loss: 0.0581
Accuracy: 0.9980, Precision: 0.9984, Recall: 0.9932, F1: 0.9958
Accuracy: 0.9943, Precision: 0.9912, Recall: 0.9850, F1: 0.9881
Epoch 9/30
Training - Loss: 53.8778
Training Metrics: {'accuracy': 0.9979910714285715, 'precision': 0.99841085688236, 'recall': 0.9932429225846585, 'f1': 0.9958072039388106}
Validation Metrics: {'accuracy': 0.994328922495274, 'precision': 0.9912416518213875, 'recall': 0.9849557331815866, 'f1': 0.988069175541564}
Epoch 10/30, Step 0/1,Classification Loss: 0.3430, Contrastive Loss: 0.0631
Epoch 10/30, Step 20/1,Classification Loss: 0.3285, Contrastive Loss: 0.0627
Epoch 10/30, Step 40/1,Classification Loss: 0.3235, Contrastive Loss: 0.0576
Epoch 10/30, Step 60/1,Classification Loss: 0.3236, Contrastive Loss: 0.0590
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0536
Epoch 10/30, Step 100/1,Classification Loss: 0.3172, Contrastive Loss: 0.0550
Epoch 10/30, Step 120/1,Classification Loss: 0.3201, Contrastive Loss: 0.0551
Accuracy: 0.9984, Precision: 0.9978, Recall: 0.9956, F1: 0.9967
Accuracy: 0.9949, Precision: 0.9887, Recall: 0.9900, F1: 0.9893
Epoch 10/30
Training - Loss: 52.7849
Training Metrics: {'accuracy': 0.9984095982142858, 'precision': 0.9978173964368992, 'recall': 0.9955742098507984, 'f1': 0.9966920939437354}
Validation Metrics: {'accuracy': 0.9948849104859335, 'precision': 0.9886673533906223, 'recall': 0.9899791217271338, 'f1': 0.989321949828409}
Epoch 11/30, Step 0/1,Classification Loss: 0.3154, Contrastive Loss: 0.0533
Epoch 11/30, Step 20/1,Classification Loss: 0.3164, Contrastive Loss: 0.0524
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0500
Epoch 11/30, Step 60/1,Classification Loss: 0.3389, Contrastive Loss: 0.0689
Epoch 11/30, Step 80/1,Classification Loss: 0.3148, Contrastive Loss: 0.0498
Epoch 11/30, Step 100/1,Classification Loss: 0.3151, Contrastive Loss: 0.0516
Epoch 11/30, Step 120/1,Classification Loss: 0.3473, Contrastive Loss: 0.0731
Accuracy: 0.9974, Precision: 0.9981, Recall: 0.9910, F1: 0.9945
Accuracy: 0.9936, Precision: 0.9914, Recall: 0.9815, F1: 0.9864
Epoch 11/30
Training - Loss: 52.3742
Training Metrics: {'accuracy': 0.9974051339285714, 'precision': 0.9980663980465785, 'recall': 0.9910498592280907, 'f1': 0.9945219816178621}
Validation Metrics: {'accuracy': 0.9935505393083509, 'precision': 0.99142764221328, 'recall': 0.9814819831071468, 'f1': 0.98638079728816}
Epoch 12/30, Step 0/1,Classification Loss: 0.3217, Contrastive Loss: 0.0516
Epoch 12/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0477
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0461
Epoch 12/30, Step 60/1,Classification Loss: 0.3440, Contrastive Loss: 0.0617
Epoch 12/30, Step 80/1,Classification Loss: 0.3291, Contrastive Loss: 0.0541
Epoch 12/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0449
Epoch 12/30, Step 120/1,Classification Loss: 0.3293, Contrastive Loss: 0.0465
Accuracy: 0.9982, Precision: 0.9978, Recall: 0.9947, F1: 0.9963
Accuracy: 0.9942, Precision: 0.9895, Recall: 0.9862, F1: 0.9879
Epoch 12/30
Training - Loss: 51.7128
Training Metrics: {'accuracy': 0.9982142857142857, 'precision': 0.9977736737441143, 'recall': 0.994748080268506, 'f1': 0.9962541568919708}
Validation Metrics: {'accuracy': 0.9942177248971422, 'precision': 0.9895264554543746, 'recall': 0.9862341836278941, 'f1': 0.9878722034043186}
Epoch 13/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 0.0444
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0429
Epoch 13/30, Step 40/1,Classification Loss: 0.3179, Contrastive Loss: 0.0439
Epoch 13/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0429
Epoch 13/30, Step 80/1,Classification Loss: 0.3157, Contrastive Loss: 0.0423
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0407
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0408
Accuracy: 0.9982, Precision: 0.9985, Recall: 0.9938, F1: 0.9961
Accuracy: 0.9948, Precision: 0.9905, Recall: 0.9876, F1: 0.9890
Epoch 13/30
Training - Loss: 51.2885
Training Metrics: {'accuracy': 0.9981584821428572, 'precision': 0.9985072240674282, 'recall': 0.9938201535736175, 'f1': 0.9961475317868204}
Validation Metrics: {'accuracy': 0.9947737128878016, 'precision': 0.9905329570655271, 'recall': 0.9875642766279139, 'f1': 0.9890420346783381}
Epoch 14/30, Step 0/1,Classification Loss: 0.3377, Contrastive Loss: 0.0454
Epoch 14/30, Step 20/1,Classification Loss: 0.3261, Contrastive Loss: 0.0442
Epoch 14/30, Step 40/1,Classification Loss: 0.3299, Contrastive Loss: 0.0440
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0387
Epoch 14/30, Step 80/1,Classification Loss: 0.3271, Contrastive Loss: 0.0413
Epoch 14/30, Step 100/1,Classification Loss: 0.3140, Contrastive Loss: 0.0386
Epoch 14/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0375
Accuracy: 0.9981, Precision: 0.9978, Recall: 0.9944, F1: 0.9961
Accuracy: 0.9933, Precision: 0.9899, Recall: 0.9820, F1: 0.9859
Epoch 14/30
Training - Loss: 50.8341
Training Metrics: {'accuracy': 0.9981305803571429, 'precision': 0.9978198601274834, 'recall': 0.9944116762874748, 'f1': 0.9961072003501834}
Validation Metrics: {'accuracy': 0.9933281441120871, 'precision': 0.9899496626663025, 'recall': 0.9820243591567469, 'f1': 0.9859399018487474}
Epoch 15/30, Step 0/1,Classification Loss: 0.3144, Contrastive Loss: 0.0384
Epoch 15/30, Step 20/1,Classification Loss: 0.3193, Contrastive Loss: 0.0378
Epoch 15/30, Step 40/1,Classification Loss: 0.3138, Contrastive Loss: 0.0369
Epoch 15/30, Step 60/1,Classification Loss: 0.3150, Contrastive Loss: 0.0371
Epoch 15/30, Step 80/1,Classification Loss: 0.3224, Contrastive Loss: 0.0376
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Epoch 15/30, Step 120/1,Classification Loss: 0.3138, Contrastive Loss: 0.0351
Accuracy: 0.9980, Precision: 0.9977, Recall: 0.9939, F1: 0.9958
Accuracy: 0.9944, Precision: 0.9893, Recall: 0.9874, F1: 0.9884
Epoch 15/30
Training - Loss: 50.5349
Training Metrics: {'accuracy': 0.9979910714285715, 'precision': 0.9977316326507719, 'recall': 0.9938833630193656, 'f1': 0.9957965983096112}
Validation Metrics: {'accuracy': 0.994440120093406, 'precision': 0.9893439908649728, 'recall': 0.9873705782808064, 'f1': 0.9883543694540484}
Epoch 16/30, Step 0/1,Classification Loss: 0.3172, Contrastive Loss: 0.0369
Epoch 16/30, Step 20/1,Classification Loss: 0.3152, Contrastive Loss: 0.0355
Epoch 16/30, Step 40/1,Classification Loss: 0.3166, Contrastive Loss: 0.0371
Epoch 16/30, Step 60/1,Classification Loss: 0.3319, Contrastive Loss: 0.0394
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0319
Accuracy: 0.9982, Precision: 0.9978, Recall: 0.9947, F1: 0.9962
Accuracy: 0.9937, Precision: 0.9885, Recall: 0.9849, F1: 0.9867
Epoch 16/30
Training - Loss: 49.8662
Training Metrics: {'accuracy': 0.9981863839285714, 'precision': 0.9977616420538611, 'recall': 0.99466490783594, 'f1': 0.9962062224950419}
Validation Metrics: {'accuracy': 0.9936617369064829, 'precision': 0.9885186898025038, 'recall': 0.9849040906278742, 'f1': 0.9867015818211861}
Epoch 17/30, Step 0/1,Classification Loss: 0.3167, Contrastive Loss: 0.0355
Epoch 17/30, Step 20/1,Classification Loss: 0.3274, Contrastive Loss: 0.0362
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0310
Epoch 17/30, Step 60/1,Classification Loss: 0.3345, Contrastive Loss: 0.0385
Epoch 17/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0526
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Epoch 17/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0313
Accuracy: 0.9983, Precision: 0.9987, Recall: 0.9941, F1: 0.9964
Accuracy: 0.9948, Precision: 0.9905, Recall: 0.9876, F1: 0.9890
Epoch 17/30
Training - Loss: 49.6098
Training Metrics: {'accuracy': 0.9982700892857143, 'precision': 0.9986574001696016, 'recall': 0.994145551467836, 'f1': 0.9963864988168307}
Validation Metrics: {'accuracy': 0.9947737128878016, 'precision': 0.9905329570655271, 'recall': 0.9875642766279139, 'f1': 0.9890420346783381}
Epoch 18/30, Step 0/1,Classification Loss: 0.3363, Contrastive Loss: 0.0331
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0288
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0280
Epoch 18/30, Step 120/1,Classification Loss: 0.3170, Contrastive Loss: 0.0286
Accuracy: 0.9982, Precision: 0.9986, Recall: 0.9940, F1: 0.9963
Accuracy: 0.9944, Precision: 0.9903, Recall: 0.9864, F1: 0.9883
Epoch 18/30
Training - Loss: 49.5705
Training Metrics: {'accuracy': 0.9982421875, 'precision': 0.998639627684313, 'recall': 0.9940103087710616, 'f1': 0.9963092472075037}
Validation Metrics: {'accuracy': 0.994440120093406, 'precision': 0.9903216765344628, 'recall': 0.986363315859299, 'f1': 0.9883307814081437}
Epoch 19/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0341
Epoch 19/30, Step 20/1,Classification Loss: 0.3284, Contrastive Loss: 0.0329
Epoch 19/30, Step 40/1,Classification Loss: 0.3246, Contrastive Loss: 0.0363
Epoch 19/30, Step 60/1,Classification Loss: 0.3200, Contrastive Loss: 0.0302
Epoch 19/30, Step 80/1,Classification Loss: 0.3168, Contrastive Loss: 0.0279
Epoch 19/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0266
Epoch 19/30, Step 120/1,Classification Loss: 0.3216, Contrastive Loss: 0.0278
Accuracy: 0.9967, Precision: 0.9967, Recall: 0.9897, F1: 0.9932
Accuracy: 0.9928, Precision: 0.9896, Recall: 0.9800, F1: 0.9847
Epoch 19/30
Training - Loss: 49.1472
Training Metrics: {'accuracy': 0.9967354910714286, 'precision': 0.9967410142511128, 'recall': 0.9896526516237854, 'f1': 0.993159658563723}
Validation Metrics: {'accuracy': 0.9927721561214278, 'precision': 0.9895996650870078, 'recall': 0.9800227578757221, 'f1': 0.9847422989974831}
Epoch 20/30, Step 0/1,Classification Loss: 0.3284, Contrastive Loss: 0.0275
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Epoch 20/30, Step 40/1,Classification Loss: 0.3241, Contrastive Loss: 0.0269
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 20/30, Step 80/1,Classification Loss: 0.3183, Contrastive Loss: 0.0264
Epoch 20/30, Step 100/1,Classification Loss: 0.3224, Contrastive Loss: 0.0272
Epoch 20/30, Step 120/1,Classification Loss: 0.3252, Contrastive Loss: 0.0273
Accuracy: 0.9983, Precision: 0.9979, Recall: 0.9951, F1: 0.9965
Accuracy: 0.9948, Precision: 0.9886, Recall: 0.9896, F1: 0.9891
Epoch 20/30
Training - Loss: 48.7524
Training Metrics: {'accuracy': 0.9983258928571429, 'precision': 0.9979277865804321, 'recall': 0.9950808209940134, 'f1': 0.9964983468367137}
Validation Metrics: {'accuracy': 0.9947737128878016, 'precision': 0.9885949694027858, 'recall': 0.9895788014709288, 'f1': 0.9890861608214319}
Epoch 21/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0252
Epoch 21/30, Step 20/1,Classification Loss: 0.3277, Contrastive Loss: 0.0282
Epoch 21/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0248
Epoch 21/30, Step 60/1,Classification Loss: 0.3446, Contrastive Loss: 0.0857
Epoch 21/30, Step 80/1,Classification Loss: 0.3159, Contrastive Loss: 0.0241
Epoch 21/30, Step 100/1,Classification Loss: 0.3294, Contrastive Loss: 0.0717
Epoch 21/30, Step 120/1,Classification Loss: 0.3138, Contrastive Loss: 0.0254
Accuracy: 0.9975, Precision: 0.9974, Recall: 0.9922, F1: 0.9948
Accuracy: 0.9928, Precision: 0.9899, Recall: 0.9797, F1: 0.9847
Epoch 21/30
Training - Loss: 48.5031
Training Metrics: {'accuracy': 0.9975167410714286, 'precision': 0.9974498837808559, 'recall': 0.9921634227208949, 'f1': 0.9947860793883783}
Validation Metrics: {'accuracy': 0.9927721561214278, 'precision': 0.9899345297493651, 'recall': 0.9796870037352197, 'f1': 0.9847318974794891}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 22/30, Step 20/1,Classification Loss: 0.3209, Contrastive Loss: 0.0251
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 22/30, Step 60/1,Classification Loss: 0.3208, Contrastive Loss: 0.0239
Epoch 22/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0234
Epoch 22/30, Step 100/1,Classification Loss: 0.3231, Contrastive Loss: 0.0238
Epoch 22/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0221
Accuracy: 0.9985, Precision: 0.9980, Recall: 0.9958, F1: 0.9969
Accuracy: 0.9950, Precision: 0.9897, Recall: 0.9894, F1: 0.9895
Epoch 22/30
Training - Loss: 48.4926
Training Metrics: {'accuracy': 0.9985212053571428, 'precision': 0.9980430625716045, 'recall': 0.9957828791626768, 'f1': 0.9969092182657969}
Validation Metrics: {'accuracy': 0.9949961080840654, 'precision': 0.9897010685140124, 'recall': 0.9893721795618313, 'f1': 0.9895365432126919}
Epoch 23/30, Step 0/1,Classification Loss: 0.3223, Contrastive Loss: 0.0248
Epoch 23/30, Step 20/1,Classification Loss: 0.3163, Contrastive Loss: 0.0230
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 23/30, Step 60/1,Classification Loss: 0.3286, Contrastive Loss: 0.0242
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 23/30, Step 120/1,Classification Loss: 0.3211, Contrastive Loss: 0.0217
Accuracy: 0.9984, Precision: 0.9979, Recall: 0.9955, F1: 0.9967
Accuracy: 0.9949, Precision: 0.9900, Recall: 0.9886, F1: 0.9893
Epoch 23/30
Training - Loss: 48.2589
Training Metrics: {'accuracy': 0.9984095982142858, 'precision': 0.9978929898969979, 'recall': 0.9954653343115407, 'f1': 0.9966748313115514}
Validation Metrics: {'accuracy': 0.9948849104859335, 'precision': 0.9899529454939013, 'recall': 0.9886361051651238, 'f1': 0.9892932296483934}
Epoch 24/30, Step 0/1,Classification Loss: 0.3245, Contrastive Loss: 0.0242
Epoch 24/30, Step 20/1,Classification Loss: 0.3146, Contrastive Loss: 0.0219
Epoch 24/30, Step 40/1,Classification Loss: 0.3239, Contrastive Loss: 0.0222
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 80/1,Classification Loss: 0.3211, Contrastive Loss: 0.0232
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 120/1,Classification Loss: 0.3170, Contrastive Loss: 0.0212
Accuracy: 0.9980, Precision: 0.9977, Recall: 0.9940, F1: 0.9958
Accuracy: 0.9940, Precision: 0.9910, Recall: 0.9838, F1: 0.9874
Epoch 24/30
Training - Loss: 48.1630
Training Metrics: {'accuracy': 0.9979910714285715, 'precision': 0.9976543978471937, 'recall': 0.9939994104802304, 'f1': 0.9958170433425232}
Validation Metrics: {'accuracy': 0.9939953297008784, 'precision': 0.99103347066319, 'recall': 0.9837547724129716, 'f1': 0.9873545026451224}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 25/30, Step 20/1,Classification Loss: 0.3276, Contrastive Loss: 0.0218
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 60/1,Classification Loss: 0.3322, Contrastive Loss: 0.0254
Epoch 25/30, Step 80/1,Classification Loss: 0.3200, Contrastive Loss: 0.0223
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 25/30, Step 120/1,Classification Loss: 0.3154, Contrastive Loss: 0.0198
Accuracy: 0.9983, Precision: 0.9978, Recall: 0.9952, F1: 0.9965
Accuracy: 0.9951, Precision: 0.9921, Recall: 0.9874, F1: 0.9897
Epoch 25/30
Training - Loss: 48.1672
Training Metrics: {'accuracy': 0.9983258928571429, 'precision': 0.9977598385595674, 'recall': 0.9952496608681775, 'f1': 0.9965001173691108}
Validation Metrics: {'accuracy': 0.9951073056821973, 'precision': 0.992058087094111, 'recall': 0.9874222208345189, 'f1': 0.9897241455104957}
Epoch 26/30, Step 0/1,Classification Loss: 0.3518, Contrastive Loss: 0.0266
Epoch 26/30, Step 20/1,Classification Loss: 0.3234, Contrastive Loss: 0.0216
Epoch 26/30, Step 40/1,Classification Loss: 0.3306, Contrastive Loss: 0.0214
Epoch 26/30, Step 60/1,Classification Loss: 0.3197, Contrastive Loss: 0.0216
Epoch 26/30, Step 80/1,Classification Loss: 0.3140, Contrastive Loss: 0.0205
Epoch 26/30, Step 100/1,Classification Loss: 0.3293, Contrastive Loss: 0.0336
Epoch 26/30, Step 120/1,Classification Loss: 0.3224, Contrastive Loss: 0.0226
Accuracy: 0.9981, Precision: 0.9976, Recall: 0.9944, F1: 0.9960
Accuracy: 0.9941, Precision: 0.9891, Recall: 0.9862, F1: 0.9876
Epoch 26/30
Training - Loss: 47.9242
Training Metrics: {'accuracy': 0.9980747767857143, 'precision': 0.9976124437205157, 'recall': 0.9943514433545233, 'f1': 0.9959741172347786}
Validation Metrics: {'accuracy': 0.9941065272990104, 'precision': 0.989129806152041, 'recall': 0.9861696175121916, 'f1': 0.9876431454883388}
Epoch 27/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0442
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 27/30, Step 40/1,Classification Loss: 0.3236, Contrastive Loss: 0.0203
Epoch 27/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0186
Epoch 27/30, Step 80/1,Classification Loss: 0.3259, Contrastive Loss: 0.0214
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 27/30, Step 120/1,Classification Loss: 0.3348, Contrastive Loss: 0.0236
Accuracy: 0.9983, Precision: 0.9979, Recall: 0.9950, F1: 0.9965
Accuracy: 0.9944, Precision: 0.9907, Recall: 0.9860, F1: 0.9883
Epoch 27/30
Training - Loss: 47.9832
Training Metrics: {'accuracy': 0.9982979910714286, 'precision': 0.9979170733484815, 'recall': 0.9950034891271037, 'f1': 0.9964540266404581}
Validation Metrics: {'accuracy': 0.994440120093406, 'precision': 0.9906501633940882, 'recall': 0.9860275617187966, 'f1': 0.9883228926255633}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 40/1,Classification Loss: 0.3138, Contrastive Loss: 0.0190
Epoch 28/30, Step 60/1,Classification Loss: 0.3312, Contrastive Loss: 0.0348
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 100/1,Classification Loss: 0.3141, Contrastive Loss: 0.0182
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Accuracy: 0.9983, Precision: 0.9958, Recall: 0.9973, F1: 0.9965
Accuracy: 0.9951, Precision: 0.9895, Recall: 0.9901, F1: 0.9898
Epoch 28/30
Training - Loss: 47.8587
Training Metrics: {'accuracy': 0.9983258928571429, 'precision': 0.995773323879081, 'recall': 0.9972677042801557, 'f1': 0.9965188669929983}
Validation Metrics: {'accuracy': 0.9951073056821973, 'precision': 0.9894511154186958, 'recall': 0.9901082539585387, 'f1': 0.9897793620043911}
Epoch 29/30, Step 0/1,Classification Loss: 0.3277, Contrastive Loss: 0.0222
Epoch 29/30, Step 20/1,Classification Loss: 0.3167, Contrastive Loss: 0.0188
Epoch 29/30, Step 40/1,Classification Loss: 0.3153, Contrastive Loss: 0.0194
Epoch 29/30, Step 60/1,Classification Loss: 0.3351, Contrastive Loss: 0.0218
Epoch 29/30, Step 80/1,Classification Loss: 0.3216, Contrastive Loss: 0.0186
Epoch 29/30, Step 100/1,Classification Loss: 0.3358, Contrastive Loss: 0.0240
Epoch 29/30, Step 120/1,Classification Loss: 0.3256, Contrastive Loss: 0.0190
Accuracy: 0.9982, Precision: 0.9978, Recall: 0.9947, F1: 0.9962
Accuracy: 0.9943, Precision: 0.9916, Recall: 0.9846, F1: 0.9881
Epoch 29/30
Training - Loss: 47.9200
Training Metrics: {'accuracy': 0.9981863839285714, 'precision': 0.9977736579017786, 'recall': 0.994712206768956, 'f1': 0.9962360070074576}
Validation Metrics: {'accuracy': 0.994328922495274, 'precision': 0.991574414131732, 'recall': 0.9846199790410841, 'f1': 0.9880610820659097}
Epoch 30/30, Step 0/1,Classification Loss: 0.3213, Contrastive Loss: 0.0192
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 40/1,Classification Loss: 0.3286, Contrastive Loss: 0.0210
Epoch 30/30, Step 60/1,Classification Loss: 0.3205, Contrastive Loss: 0.0200
Epoch 30/30, Step 80/1,Classification Loss: 0.3137, Contrastive Loss: 0.0178
Epoch 30/30, Step 100/1,Classification Loss: 0.3162, Contrastive Loss: 0.0185
Epoch 30/30, Step 120/1,Classification Loss: 0.3324, Contrastive Loss: 0.0330
Accuracy: 0.9984, Precision: 0.9980, Recall: 0.9955, F1: 0.9967
Accuracy: 0.9954, Precision: 0.9919, Recall: 0.9890, F1: 0.9904
Epoch 30/30
Training - Loss: 47.6798
Training Metrics: {'accuracy': 0.9984375, 'precision': 0.9979966453433184, 'recall': 0.9954926446700987, 'f1': 0.9967400323757873}
Validation Metrics: {'accuracy': 0.9954408984765929, 'precision': 0.9919361079790133, 'recall': 0.9889589357436361, 'f1': 0.9904409238683375}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1862, 5814), y shape: (1862,), y distribution: Counter({np.float64(0.0): 1668, np.float64(1.0): 194}), env shape: (1862,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9544, Precision: 0.9232, Recall: 0.8174, F1: 0.8606
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10915]))
original train data shape: torch.Size([45062]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1862, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45062]), new train data shape: torch.Size([45062])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 10915]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3303, Contrastive Loss: 1.6291
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 1.0465
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4530
Epoch 1/30, Step 60/1,Classification Loss: 0.3294, Contrastive Loss: 0.2624
Epoch 1/30, Step 80/1,Classification Loss: 0.3229, Contrastive Loss: 0.2003
Epoch 1/30, Step 100/1,Classification Loss: 0.3211, Contrastive Loss: 0.1699
Epoch 1/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.1534
Accuracy: 0.9982, Precision: 0.9952, Recall: 0.9972, F1: 0.9962
Accuracy: 0.9955, Precision: 0.9891, Recall: 0.9920, F1: 0.9906
Epoch 1/30
Training - Loss: 110.0330
Training Metrics: {'accuracy': 0.9981584821428572, 'precision': 0.9952052763253845, 'recall': 0.9971814595373529, 'f1': 0.9961904761904762}
Validation Metrics: {'accuracy': 0.9954510152002662, 'precision': 0.9891318995105935, 'recall': 0.9920481606483577, 'f1': 0.9905836516365183}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1409
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1330
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1282
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1239
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1209
Epoch 2/30, Step 100/1,Classification Loss: 0.3212, Contrastive Loss: 0.1229
Epoch 2/30, Step 120/1,Classification Loss: 0.3282, Contrastive Loss: 0.1223
Accuracy: 0.9980, Precision: 0.9979, Recall: 0.9938, F1: 0.9959
Accuracy: 0.9949, Precision: 0.9910, Recall: 0.9877, F1: 0.9894
Epoch 2/30
Training - Loss: 63.4797
Training Metrics: {'accuracy': 0.9980189732142857, 'precision': 0.9979192420529064, 'recall': 0.993830007949627, 'f1': 0.9958623065359724}
Validation Metrics: {'accuracy': 0.9948962609563963, 'precision': 0.9910076103463166, 'recall': 0.9877453571248207, 'f1': 0.9893685100415497}
Epoch 3/30, Step 0/1,Classification Loss: 0.3253, Contrastive Loss: 0.1183
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1088
Epoch 3/30, Step 40/1,Classification Loss: 0.3152, Contrastive Loss: 0.1096
Epoch 3/30, Step 60/1,Classification Loss: 0.3256, Contrastive Loss: 0.1103
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1029
Epoch 3/30, Step 100/1,Classification Loss: 0.3234, Contrastive Loss: 0.1053
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0988
Accuracy: 0.9982, Precision: 0.9953, Recall: 0.9974, F1: 0.9964
Accuracy: 0.9957, Precision: 0.9899, Recall: 0.9922, F1: 0.9910
Epoch 3/30
Training - Loss: 60.3621
Training Metrics: {'accuracy': 0.9982421875, 'precision': 0.9953426825407496, 'recall': 0.9973986861425665, 'f1': 0.9963675534900842}
Validation Metrics: {'accuracy': 0.9956729168978142, 'precision': 0.9899046884056555, 'recall': 0.9921771762592466, 'f1': 0.9910370648871707}
Epoch 4/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0991
Epoch 4/30, Step 20/1,Classification Loss: 0.3331, Contrastive Loss: 0.1344
Epoch 4/30, Step 40/1,Classification Loss: 0.3252, Contrastive Loss: 0.0970
Epoch 4/30, Step 60/1,Classification Loss: 0.3461, Contrastive Loss: 0.1045
Epoch 4/30, Step 80/1,Classification Loss: 0.3186, Contrastive Loss: 0.0933
Epoch 4/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0904
Epoch 4/30, Step 120/1,Classification Loss: 0.3141, Contrastive Loss: 0.0899
Accuracy: 0.9979, Precision: 0.9973, Recall: 0.9940, F1: 0.9956
Accuracy: 0.9942, Precision: 0.9906, Recall: 0.9854, F1: 0.9880
Epoch 4/30
Training - Loss: 58.7205
Training Metrics: {'accuracy': 0.9979073660714286, 'precision': 0.9972705761886311, 'recall': 0.9940340533426175, 'f1': 0.99564457750361}
Validation Metrics: {'accuracy': 0.9942305558637523, 'precision': 0.9905881387712471, 'recall': 0.9853681780439966, 'f1': 0.9879577002001894}
Epoch 5/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0876
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0851
Epoch 5/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0849
Epoch 5/30, Step 60/1,Classification Loss: 0.3251, Contrastive Loss: 0.0902
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0818
Epoch 5/30, Step 100/1,Classification Loss: 0.3215, Contrastive Loss: 0.0836
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0799
Accuracy: 0.9983, Precision: 0.9982, Recall: 0.9945, F1: 0.9964
Accuracy: 0.9949, Precision: 0.9917, Recall: 0.9871, F1: 0.9894
Epoch 5/30
Training - Loss: 56.9172
Training Metrics: {'accuracy': 0.9982700892857143, 'precision': 0.9982308364565795, 'recall': 0.9945328950279406, 'f1': 0.9963718289130281}
Validation Metrics: {'accuracy': 0.9948962609563963, 'precision': 0.9916579985800849, 'recall': 0.9870819797087682, 'f1': 0.9893543125769672}
Epoch 6/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0788
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0768
Epoch 6/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0770
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0750
Epoch 6/30, Step 80/1,Classification Loss: 0.3357, Contrastive Loss: 0.1218
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0727
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0718
Accuracy: 0.9983, Precision: 0.9973, Recall: 0.9956, F1: 0.9965
Accuracy: 0.9948, Precision: 0.9900, Recall: 0.9883, F1: 0.9892
Epoch 6/30
Training - Loss: 55.9101
Training Metrics: {'accuracy': 0.9982979910714286, 'precision': 0.9973487990738852, 'recall': 0.9956213585423094, 'f1': 0.9964828692523038}
Validation Metrics: {'accuracy': 0.9947853101076223, 'precision': 0.9899706563307367, 'recall': 0.9883442267354287, 'f1': 0.989155456513345}
Epoch 7/30, Step 0/1,Classification Loss: 0.3297, Contrastive Loss: 0.0769
Epoch 7/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.0859
Epoch 7/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0706
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0683
Epoch 7/30, Step 80/1,Classification Loss: 0.3177, Contrastive Loss: 0.0696
Epoch 7/30, Step 100/1,Classification Loss: 0.3196, Contrastive Loss: 0.0678
Epoch 7/30, Step 120/1,Classification Loss: 0.3215, Contrastive Loss: 0.0670
Accuracy: 0.9983, Precision: 0.9975, Recall: 0.9954, F1: 0.9965
Accuracy: 0.9953, Precision: 0.9923, Recall: 0.9883, F1: 0.9903
Epoch 7/30
Training - Loss: 55.1159
Training Metrics: {'accuracy': 0.9982979910714286, 'precision': 0.9975085681980427, 'recall': 0.9954435923514251, 'f1': 0.996472928318852}
Validation Metrics: {'accuracy': 0.9953400643514922, 'precision': 0.9922609815792863, 'recall': 0.9883350770546248, 'f1': 0.9902865112998409}
Epoch 8/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0655
Epoch 8/30, Step 20/1,Classification Loss: 0.3365, Contrastive Loss: 0.0710
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0632
Epoch 8/30, Step 60/1,Classification Loss: 0.3194, Contrastive Loss: 0.0642
Epoch 8/30, Step 80/1,Classification Loss: 0.3158, Contrastive Loss: 0.0639
Epoch 8/30, Step 100/1,Classification Loss: 0.3167, Contrastive Loss: 0.0620
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0599
Accuracy: 0.9983, Precision: 0.9975, Recall: 0.9955, F1: 0.9965
Accuracy: 0.9949, Precision: 0.9904, Recall: 0.9884, F1: 0.9894
Epoch 8/30
Training - Loss: 54.2212
Training Metrics: {'accuracy': 0.9982979910714286, 'precision': 0.997513576057919, 'recall': 0.9954560983060338, 'f1': 0.9964817033195841}
Validation Metrics: {'accuracy': 0.9948962609563963, 'precision': 0.9903623109268883, 'recall': 0.9884087345408732, 'f1': 0.9893826609873958}
Epoch 9/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0610
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0584
Epoch 9/30, Step 40/1,Classification Loss: 0.3360, Contrastive Loss: 0.0714
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0578
Epoch 9/30, Step 80/1,Classification Loss: 0.3291, Contrastive Loss: 0.0726
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0559
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0551
Accuracy: 0.9983, Precision: 0.9974, Recall: 0.9955, F1: 0.9965
Accuracy: 0.9951, Precision: 0.9915, Recall: 0.9882, F1: 0.9898
Epoch 9/30
Training - Loss: 53.3911
Training Metrics: {'accuracy': 0.9982979910714286, 'precision': 0.9974176332377016, 'recall': 0.9955076681809216, 'f1': 0.996459960185401}
Validation Metrics: {'accuracy': 0.9951181626539443, 'precision': 0.9914713960562211, 'recall': 0.9882060614437358, 'f1': 0.9898307487353953}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0542
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0537
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0529
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0524
Epoch 10/30, Step 80/1,Classification Loss: 0.3360, Contrastive Loss: 0.0575
Epoch 10/30, Step 100/1,Classification Loss: 0.3138, Contrastive Loss: 0.0528
Epoch 10/30, Step 120/1,Classification Loss: 0.3154, Contrastive Loss: 0.0516
Accuracy: 0.9980, Precision: 0.9974, Recall: 0.9945, F1: 0.9959
Accuracy: 0.9939, Precision: 0.9907, Recall: 0.9838, F1: 0.9872
Epoch 10/30
Training - Loss: 52.5853
Training Metrics: {'accuracy': 0.998046875, 'precision': 0.9973546068200866, 'recall': 0.9945358446726301, 'f1': 0.9959393570950865}
Validation Metrics: {'accuracy': 0.9938977033174303, 'precision': 0.9907060117457116, 'recall': 0.9838478997955583, 'f1': 0.9872416194041349}
Epoch 11/30, Step 0/1,Classification Loss: 0.3190, Contrastive Loss: 0.0521
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0495
Epoch 11/30, Step 40/1,Classification Loss: 0.3260, Contrastive Loss: 0.0510
Epoch 11/30, Step 60/1,Classification Loss: 0.3181, Contrastive Loss: 0.0503
Epoch 11/30, Step 80/1,Classification Loss: 0.3215, Contrastive Loss: 0.0485
Epoch 11/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0526
Epoch 11/30, Step 120/1,Classification Loss: 0.3145, Contrastive Loss: 0.0470
Accuracy: 0.9982, Precision: 0.9974, Recall: 0.9952, F1: 0.9963
Accuracy: 0.9945, Precision: 0.9911, Recall: 0.9858, F1: 0.9884
Epoch 11/30
Training - Loss: 52.1626
Training Metrics: {'accuracy': 0.9982142857142857, 'precision': 0.9973672146964605, 'recall': 0.9952070367556911, 'f1': 0.9962836839103111}
Validation Metrics: {'accuracy': 0.9944524575613003, 'precision': 0.9910537977999277, 'recall': 0.9858288823629118, 'f1': 0.9884208655771052}
Epoch 12/30, Step 0/1,Classification Loss: 0.3220, Contrastive Loss: 0.0478
Epoch 12/30, Step 20/1,Classification Loss: 0.3265, Contrastive Loss: 0.0481
Epoch 12/30, Step 40/1,Classification Loss: 0.3165, Contrastive Loss: 0.0466
Epoch 12/30, Step 60/1,Classification Loss: 0.3165, Contrastive Loss: 0.0465
Epoch 12/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0444
Epoch 12/30, Step 100/1,Classification Loss: 0.3381, Contrastive Loss: 0.0470
Epoch 12/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0576
Accuracy: 0.9984, Precision: 0.9976, Recall: 0.9957, F1: 0.9966
Accuracy: 0.9947, Precision: 0.9893, Recall: 0.9886, F1: 0.9889
Epoch 12/30
Training - Loss: 51.5771
Training Metrics: {'accuracy': 0.9983816964285714, 'precision': 0.997552507831164, 'recall': 0.9957278349450218, 'f1': 0.9966377151825405}
Validation Metrics: {'accuracy': 0.9946743592588483, 'precision': 0.989260736755255, 'recall': 0.9886114076380104, 'f1': 0.9889357554449636}
Epoch 13/30, Step 0/1,Classification Loss: 0.3343, Contrastive Loss: 0.0500
Epoch 13/30, Step 20/1,Classification Loss: 0.3198, Contrastive Loss: 0.0444
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0413
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0407
Epoch 13/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0523
Epoch 13/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0402
Epoch 13/30, Step 120/1,Classification Loss: 0.3402, Contrastive Loss: 0.0453
Accuracy: 0.9982, Precision: 0.9975, Recall: 0.9952, F1: 0.9963
Accuracy: 0.9942, Precision: 0.9906, Recall: 0.9854, F1: 0.9880
Epoch 13/30
Training - Loss: 51.1301
Training Metrics: {'accuracy': 0.9982421875, 'precision': 0.9974687444779842, 'recall': 0.9952276761404858, 'f1': 0.9963445047267981}
Validation Metrics: {'accuracy': 0.9942305558637523, 'precision': 0.9905881387712471, 'recall': 0.9853681780439966, 'f1': 0.9879577002001894}
Epoch 14/30, Step 0/1,Classification Loss: 0.3144, Contrastive Loss: 0.0401
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0383
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0385
Epoch 14/30, Step 60/1,Classification Loss: 0.3316, Contrastive Loss: 0.0445
Epoch 14/30, Step 80/1,Classification Loss: 0.3192, Contrastive Loss: 0.0387
Epoch 14/30, Step 100/1,Classification Loss: 0.3363, Contrastive Loss: 0.0531
Epoch 14/30, Step 120/1,Classification Loss: 0.3155, Contrastive Loss: 0.0403
Accuracy: 0.9982, Precision: 0.9975, Recall: 0.9953, F1: 0.9964
Accuracy: 0.9951, Precision: 0.9908, Recall: 0.9889, F1: 0.9898
Epoch 14/30
Training - Loss: 50.5316
Training Metrics: {'accuracy': 0.9982421875, 'precision': 0.9974774592675912, 'recall': 0.9952505055134002, 'f1': 0.9963603137184802}
Validation Metrics: {'accuracy': 0.9951181626539443, 'precision': 0.9908248580078483, 'recall': 0.9888694388597883, 'f1': 0.9898442844227264}
Epoch 15/30, Step 0/1,Classification Loss: 0.3144, Contrastive Loss: 0.0369
Epoch 15/30, Step 20/1,Classification Loss: 0.3200, Contrastive Loss: 0.0382
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0351
Epoch 15/30, Step 60/1,Classification Loss: 0.3163, Contrastive Loss: 0.0367
Epoch 15/30, Step 80/1,Classification Loss: 0.3276, Contrastive Loss: 0.0371
Epoch 15/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0345
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Accuracy: 0.9982, Precision: 0.9974, Recall: 0.9953, F1: 0.9963
Accuracy: 0.9946, Precision: 0.9902, Recall: 0.9872, F1: 0.9887
Epoch 15/30
Training - Loss: 50.2626
Training Metrics: {'accuracy': 0.9982421875, 'precision': 0.9973877106430632, 'recall': 0.9953161813511995, 'f1': 0.9963487776289098}
Validation Metrics: {'accuracy': 0.9945634084100743, 'precision': 0.9901505973292963, 'recall': 0.9872201450004611, 'f1': 0.9886789250955488}
Epoch 16/30, Step 0/1,Classification Loss: 0.3361, Contrastive Loss: 0.0396
Epoch 16/30, Step 20/1,Classification Loss: 0.3157, Contrastive Loss: 0.0343
Epoch 16/30, Step 40/1,Classification Loss: 0.3197, Contrastive Loss: 0.0341
Epoch 16/30, Step 60/1,Classification Loss: 0.3222, Contrastive Loss: 0.0347
Epoch 16/30, Step 80/1,Classification Loss: 0.3235, Contrastive Loss: 0.0337
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0311
Accuracy: 0.9981, Precision: 0.9975, Recall: 0.9948, F1: 0.9961
Accuracy: 0.9941, Precision: 0.9899, Recall: 0.9856, F1: 0.9877
Epoch 16/30
Training - Loss: 50.0161
Training Metrics: {'accuracy': 0.9981305803571429, 'precision': 0.9974896781077003, 'recall': 0.9947578500862704, 'f1': 0.9961182499260537}
Validation Metrics: {'accuracy': 0.9941196050149783, 'precision': 0.9898684016765189, 'recall': 0.9856353589465783, 'f1': 0.9877384111905682}
Epoch 17/30, Step 0/1,Classification Loss: 0.3230, Contrastive Loss: 0.0319
Epoch 17/30, Step 20/1,Classification Loss: 0.3249, Contrastive Loss: 0.0333
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0300
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 17/30, Step 80/1,Classification Loss: 0.3181, Contrastive Loss: 0.0308
Epoch 17/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0298
Epoch 17/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0305
Accuracy: 0.9984, Precision: 0.9975, Recall: 0.9957, F1: 0.9966
Accuracy: 0.9949, Precision: 0.9900, Recall: 0.9887, F1: 0.9894
Epoch 17/30
Training - Loss: 49.4987
Training Metrics: {'accuracy': 0.9983537946428571, 'precision': 0.99746325467547, 'recall': 0.9957341566021034, 'f1': 0.9965964931102365}
Validation Metrics: {'accuracy': 0.9948962609563963, 'precision': 0.9900415548100154, 'recall': 0.9887404232488993, 'f1': 0.9893897190846759}
Epoch 18/30, Step 0/1,Classification Loss: 0.3175, Contrastive Loss: 0.0304
Epoch 18/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0284
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 18/30, Step 60/1,Classification Loss: 0.3237, Contrastive Loss: 0.0311
Epoch 18/30, Step 80/1,Classification Loss: 0.3175, Contrastive Loss: 0.0286
Epoch 18/30, Step 100/1,Classification Loss: 0.3160, Contrastive Loss: 0.0304
Epoch 18/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0294
Accuracy: 0.9983, Precision: 0.9975, Recall: 0.9955, F1: 0.9965
Accuracy: 0.9948, Precision: 0.9900, Recall: 0.9883, F1: 0.9892
Epoch 18/30
Training - Loss: 49.1896
Training Metrics: {'accuracy': 0.9983258928571429, 'precision': 0.9975247898507046, 'recall': 0.9955419426091292, 'f1': 0.9965304605460605}
Validation Metrics: {'accuracy': 0.9947853101076223, 'precision': 0.9899706563307367, 'recall': 0.9883442267354287, 'f1': 0.989155456513345}
Epoch 19/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0273
Epoch 19/30, Step 20/1,Classification Loss: 0.3292, Contrastive Loss: 0.0377
Epoch 19/30, Step 40/1,Classification Loss: 0.3226, Contrastive Loss: 0.0273
Epoch 19/30, Step 60/1,Classification Loss: 0.3163, Contrastive Loss: 0.0272
Epoch 19/30, Step 80/1,Classification Loss: 0.3152, Contrastive Loss: 0.0273
Epoch 19/30, Step 100/1,Classification Loss: 0.3150, Contrastive Loss: 0.0281
Epoch 19/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0263
Accuracy: 0.9982, Precision: 0.9982, Recall: 0.9945, F1: 0.9964
Accuracy: 0.9946, Precision: 0.9905, Recall: 0.9869, F1: 0.9887
Epoch 19/30
Training - Loss: 48.9857
Training Metrics: {'accuracy': 0.9982421875, 'precision': 0.9982239065795497, 'recall': 0.9944978112172803, 'f1': 0.9963506051084859}
Validation Metrics: {'accuracy': 0.9945634084100743, 'precision': 0.9904735835140185, 'recall': 0.9868884562924348, 'f1': 0.9886713758089853}
Epoch 20/30, Step 0/1,Classification Loss: 0.3141, Contrastive Loss: 0.0265
Epoch 20/30, Step 20/1,Classification Loss: 0.3196, Contrastive Loss: 0.0276
Epoch 20/30, Step 40/1,Classification Loss: 0.3299, Contrastive Loss: 0.0290
Epoch 20/30, Step 60/1,Classification Loss: 0.3282, Contrastive Loss: 0.0265
Epoch 20/30, Step 80/1,Classification Loss: 0.3256, Contrastive Loss: 0.0269
Epoch 20/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0290
Epoch 20/30, Step 120/1,Classification Loss: 0.3236, Contrastive Loss: 0.0284
Accuracy: 0.9982, Precision: 0.9975, Recall: 0.9952, F1: 0.9963
Accuracy: 0.9941, Precision: 0.9905, Recall: 0.9850, F1: 0.9877
Epoch 20/30
Training - Loss: 48.8132
Training Metrics: {'accuracy': 0.9982142857142857, 'precision': 0.997461568217243, 'recall': 0.995153241858775, 'f1': 0.996303462234617}
Validation Metrics: {'accuracy': 0.9941196050149783, 'precision': 0.9905182522055265, 'recall': 0.9849719815305259, 'f1': 0.9877220128764789}
Epoch 21/30, Step 0/1,Classification Loss: 0.3185, Contrastive Loss: 0.0247
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 21/30, Step 40/1,Classification Loss: 0.3153, Contrastive Loss: 0.0241
Epoch 21/30, Step 60/1,Classification Loss: 0.3152, Contrastive Loss: 0.0244
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 21/30, Step 120/1,Classification Loss: 0.3238, Contrastive Loss: 0.0243
Accuracy: 0.9984, Precision: 0.9975, Recall: 0.9956, F1: 0.9966
Accuracy: 0.9941, Precision: 0.9873, Recall: 0.9883, F1: 0.9878
Epoch 21/30
Training - Loss: 48.9062
Training Metrics: {'accuracy': 0.9983537946428571, 'precision': 0.9975349403397751, 'recall': 0.9956259238505615, 'f1': 0.9965777441579207}
Validation Metrics: {'accuracy': 0.9941196050149783, 'precision': 0.987319486757771, 'recall': 0.9882888686107881, 'f1': 0.9878034690980357}
Epoch 22/30, Step 0/1,Classification Loss: 0.3229, Contrastive Loss: 0.0247
Epoch 22/30, Step 20/1,Classification Loss: 0.3151, Contrastive Loss: 0.0234
Epoch 22/30, Step 40/1,Classification Loss: 0.3199, Contrastive Loss: 0.0241
Epoch 22/30, Step 60/1,Classification Loss: 0.3138, Contrastive Loss: 0.0227
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 22/30, Step 100/1,Classification Loss: 0.3187, Contrastive Loss: 0.0221
Epoch 22/30, Step 120/1,Classification Loss: 0.3284, Contrastive Loss: 0.0277
Accuracy: 0.9982, Precision: 0.9983, Recall: 0.9942, F1: 0.9962
Accuracy: 0.9946, Precision: 0.9915, Recall: 0.9859, F1: 0.9886
Epoch 22/30
Training - Loss: 48.3812
Training Metrics: {'accuracy': 0.9981584821428572, 'precision': 0.9982635185317823, 'recall': 0.9941612995709737, 'f1': 0.9961999297318581}
Validation Metrics: {'accuracy': 0.9945634084100743, 'precision': 0.9914501983216077, 'recall': 0.9858933901683562, 'f1': 0.9886486534141031}
Epoch 23/30, Step 0/1,Classification Loss: 0.3162, Contrastive Loss: 0.0235
Epoch 23/30, Step 20/1,Classification Loss: 0.3307, Contrastive Loss: 0.0231
Epoch 23/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0372
Epoch 23/30, Step 60/1,Classification Loss: 0.3251, Contrastive Loss: 0.0229
Epoch 23/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0211
Epoch 23/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0218
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Accuracy: 0.9977, Precision: 0.9971, Recall: 0.9933, F1: 0.9952
Accuracy: 0.9940, Precision: 0.9911, Recall: 0.9839, F1: 0.9875
Epoch 23/30
Training - Loss: 48.2643
Training Metrics: {'accuracy': 0.9976841517857142, 'precision': 0.9970536792174056, 'recall': 0.9933172566062809, 'f1': 0.9951751510025906}
Validation Metrics: {'accuracy': 0.9940086541662043, 'precision': 0.9911040284193009, 'recall': 0.9839124076010027, 'f1': 0.9874693906302425}
Epoch 24/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0212
Epoch 24/30, Step 20/1,Classification Loss: 0.3253, Contrastive Loss: 0.0211
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 24/30, Step 100/1,Classification Loss: 0.3352, Contrastive Loss: 0.0247
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Accuracy: 0.9982, Precision: 0.9975, Recall: 0.9949, F1: 0.9962
Accuracy: 0.9950, Precision: 0.9914, Recall: 0.9878, F1: 0.9896
Epoch 24/30
Training - Loss: 48.1055
Training Metrics: {'accuracy': 0.9981863839285714, 'precision': 0.9975052340273063, 'recall': 0.9949043264364815, 'f1': 0.9961998103131794}
Validation Metrics: {'accuracy': 0.9950072118051703, 'precision': 0.9914017768006672, 'recall': 0.9878098649302651, 'f1': 0.9895961614572315}
Epoch 25/30, Step 0/1,Classification Loss: 0.3217, Contrastive Loss: 0.0208
Epoch 25/30, Step 20/1,Classification Loss: 0.3208, Contrastive Loss: 0.0215
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0223
Epoch 25/30, Step 100/1,Classification Loss: 0.3151, Contrastive Loss: 0.0198
Epoch 25/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0242
Accuracy: 0.9981, Precision: 0.9975, Recall: 0.9946, F1: 0.9960
Accuracy: 0.9943, Precision: 0.9900, Recall: 0.9864, F1: 0.9882
Epoch 25/30
Training - Loss: 47.8873
Training Metrics: {'accuracy': 0.9981026785714285, 'precision': 0.9974621051816155, 'recall': 0.9946233726496281, 'f1': 0.9960368051539434}
Validation Metrics: {'accuracy': 0.9943415067125263, 'precision': 0.9900094868706941, 'recall': 0.9864277519735197, 'f1': 0.9882089829848624}
Epoch 26/30, Step 0/1,Classification Loss: 0.3146, Contrastive Loss: 0.0199
Epoch 26/30, Step 20/1,Classification Loss: 0.3146, Contrastive Loss: 0.0199
Epoch 26/30, Step 40/1,Classification Loss: 0.3318, Contrastive Loss: 0.0365
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 26/30, Step 80/1,Classification Loss: 0.3264, Contrastive Loss: 0.0222
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Accuracy: 0.9981, Precision: 0.9972, Recall: 0.9949, F1: 0.9961
Accuracy: 0.9949, Precision: 0.9910, Recall: 0.9877, F1: 0.9894
Epoch 26/30
Training - Loss: 47.9291
Training Metrics: {'accuracy': 0.9981026785714285, 'precision': 0.9972340697273929, 'recall': 0.9949329573337644, 'f1': 0.9960795888504841}
Validation Metrics: {'accuracy': 0.9948962609563963, 'precision': 0.9910076103463166, 'recall': 0.9877453571248207, 'f1': 0.9893685100415497}
Epoch 27/30, Step 0/1,Classification Loss: 0.3150, Contrastive Loss: 0.0190
Epoch 27/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0184
Epoch 27/30, Step 40/1,Classification Loss: 0.3274, Contrastive Loss: 0.0207
Epoch 27/30, Step 60/1,Classification Loss: 0.3144, Contrastive Loss: 0.0185
Epoch 27/30, Step 80/1,Classification Loss: 0.3270, Contrastive Loss: 0.0204
Epoch 27/30, Step 100/1,Classification Loss: 0.3199, Contrastive Loss: 0.0192
Epoch 27/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.0200
Accuracy: 0.9984, Precision: 0.9976, Recall: 0.9957, F1: 0.9966
Accuracy: 0.9951, Precision: 0.9918, Recall: 0.9879, F1: 0.9898
Epoch 27/30
Training - Loss: 47.8778
Training Metrics: {'accuracy': 0.9983537946428571, 'precision': 0.9975530144106473, 'recall': 0.995668837185379, 'f1': 0.9966082929953402}
Validation Metrics: {'accuracy': 0.9951181626539443, 'precision': 0.9917965734896304, 'recall': 0.9878743727357095, 'f1': 0.989823964218881}
Epoch 28/30, Step 0/1,Classification Loss: 0.3165, Contrastive Loss: 0.0197
Epoch 28/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0347
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 28/30, Step 60/1,Classification Loss: 0.3309, Contrastive Loss: 0.0271
Epoch 28/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0180
Epoch 28/30, Step 100/1,Classification Loss: 0.3204, Contrastive Loss: 0.0200
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9984, Precision: 0.9976, Recall: 0.9958, F1: 0.9967
Accuracy: 0.9947, Precision: 0.9896, Recall: 0.9883, F1: 0.9889
Epoch 28/30
Training - Loss: 47.8640
Training Metrics: {'accuracy': 0.9984095982142858, 'precision': 0.9975741285997606, 'recall': 0.9958387445887447, 'f1': 0.9967042117077797}
Validation Metrics: {'accuracy': 0.9946743592588483, 'precision': 0.9895796239976464, 'recall': 0.9882797189299842, 'f1': 0.98892840252314}
Epoch 29/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0330
Epoch 29/30, Step 20/1,Classification Loss: 0.3195, Contrastive Loss: 0.0192
Epoch 29/30, Step 40/1,Classification Loss: 0.3239, Contrastive Loss: 0.0208
Epoch 29/30, Step 60/1,Classification Loss: 0.3160, Contrastive Loss: 0.0186
Epoch 29/30, Step 80/1,Classification Loss: 0.3263, Contrastive Loss: 0.0202
Epoch 29/30, Step 100/1,Classification Loss: 0.3365, Contrastive Loss: 0.0219
Epoch 29/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0216
Accuracy: 0.9984, Precision: 0.9975, Recall: 0.9957, F1: 0.9966
Accuracy: 0.9947, Precision: 0.9902, Recall: 0.9876, F1: 0.9889
Epoch 29/30
Training - Loss: 47.6665
Training Metrics: {'accuracy': 0.9983537946428571, 'precision': 0.9974667867702502, 'recall': 0.9957418708326506, 'f1': 0.9966021247284174}
Validation Metrics: {'accuracy': 0.9946743592588483, 'precision': 0.9902211621098347, 'recall': 0.9876163415139317, 'f1': 0.9889136605031473}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 20/1,Classification Loss: 0.3188, Contrastive Loss: 0.0199
Epoch 30/30, Step 40/1,Classification Loss: 0.3279, Contrastive Loss: 0.0193
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 30/30, Step 80/1,Classification Loss: 0.3322, Contrastive Loss: 0.0204
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0166
Epoch 30/30, Step 120/1,Classification Loss: 0.3162, Contrastive Loss: 0.0190
Accuracy: 0.9979, Precision: 0.9981, Recall: 0.9932, F1: 0.9957
Accuracy: 0.9940, Precision: 0.9898, Recall: 0.9852, F1: 0.9875
Epoch 30/30
Training - Loss: 47.6690
Training Metrics: {'accuracy': 0.9979073660714286, 'precision': 0.9981126226890726, 'recall': 0.993236424324472, 'f1': 0.995656931162451}
Validation Metrics: {'accuracy': 0.9940086541662043, 'precision': 0.989797868476233, 'recall': 0.9852391624331076, 'f1': 0.9875028886773093}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1864, 5814), y shape: (1864,), y distribution: Counter({np.float64(0.0): 1667, np.float64(1.0): 197}), env shape: (1864,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9737, Precision: 0.9542, Recall: 0.9025, F1: 0.9263
month: 2021-02, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1835, 5814), y shape: (1835,), y distribution: Counter({np.float64(0.0): 1639, np.float64(1.0): 196}), env shape: (1835,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9668, Precision: 0.9325, Recall: 0.8871, F1: 0.9081
month: 2021-03, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1862, 5814), y shape: (1862,), y distribution: Counter({np.float64(0.0): 1665, np.float64(1.0): 197}), env shape: (1862,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9656, Precision: 0.9441, Recall: 0.8667, F1: 0.9006
month: 2021-04, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1871, 5814), y shape: (1871,), y distribution: Counter({np.float64(0.0): 1678, np.float64(1.0): 193}), env shape: (1871,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9690, Precision: 0.9442, Recall: 0.8818, F1: 0.9100
month: 2021-05, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1837, 5814), y shape: (1837,), y distribution: Counter({np.float64(0.0): 1644, np.float64(1.0): 193}), env shape: (1837,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9695, Precision: 0.9308, Recall: 0.9029, F1: 0.9163
month: 2021-06, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1827, 5814), y shape: (1827,), y distribution: Counter({np.float64(0.0): 1634, np.float64(1.0): 193}), env shape: (1827,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9672, Precision: 0.9131, Recall: 0.9131, F1: 0.9131
month: 2021-07, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1843, 5814), y shape: (1843,), y distribution: Counter({np.float64(0.0): 1651, np.float64(1.0): 192}), env shape: (1843,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9604, Precision: 0.8727, Recall: 0.9411, F1: 0.9029
month: 2021-08, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1771, 5814), y shape: (1771,), y distribution: Counter({np.float64(0.0): 1576, np.float64(1.0): 195}), env shape: (1771,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9385, Precision: 0.8232, Recall: 0.9340, F1: 0.8665
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11015]))
original train data shape: torch.Size([45162]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1771, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45162]), new train data shape: torch.Size([45162])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11015]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 1.6274
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.9048
Epoch 1/30, Step 40/1,Classification Loss: 0.3293, Contrastive Loss: 0.4071
Epoch 1/30, Step 60/1,Classification Loss: 0.3410, Contrastive Loss: 0.2797
Epoch 1/30, Step 80/1,Classification Loss: 0.3417, Contrastive Loss: 0.2346
Epoch 1/30, Step 100/1,Classification Loss: 0.3280, Contrastive Loss: 0.1965
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1670
Epoch 1/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.1566
Accuracy: 0.9977, Precision: 0.9936, Recall: 0.9968, F1: 0.9952
Accuracy: 0.9940, Precision: 0.9858, Recall: 0.9896, F1: 0.9877
Epoch 1/30
Training - Loss: 107.8707
Training Metrics: {'accuracy': 0.9976728723404256, 'precision': 0.9936042187326786, 'recall': 0.9968398776409055, 'f1': 0.9952142496081576}
Validation Metrics: {'accuracy': 0.9940219196280305, 'precision': 0.9857649487750233, 'recall': 0.9896005751221313, 'f1': 0.9876716254947455}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1533
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1452
Epoch 2/30, Step 40/1,Classification Loss: 0.3307, Contrastive Loss: 0.1572
Epoch 2/30, Step 60/1,Classification Loss: 0.3297, Contrastive Loss: 0.1445
Epoch 2/30, Step 80/1,Classification Loss: 0.3388, Contrastive Loss: 0.1530
Epoch 2/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.1303
Epoch 2/30, Step 120/1,Classification Loss: 0.3199, Contrastive Loss: 0.1299
Epoch 2/30, Step 140/1,Classification Loss: 0.3210, Contrastive Loss: 0.1246
Accuracy: 0.9976, Precision: 0.9943, Recall: 0.9960, F1: 0.9952
Accuracy: 0.9938, Precision: 0.9862, Recall: 0.9882, F1: 0.9872
Epoch 2/30
Training - Loss: 65.6744
Training Metrics: {'accuracy': 0.9976451684397163, 'precision': 0.9943156309305847, 'recall': 0.9960119030848209, 'f1': 0.9951616222099102}
Validation Metrics: {'accuracy': 0.9938005092438835, 'precision': 0.98623189724459, 'recall': 0.9881533305807368, 'f1': 0.9871898194406965}
Epoch 3/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.1208
Epoch 3/30, Step 20/1,Classification Loss: 0.3145, Contrastive Loss: 0.1204
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1132
Epoch 3/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1278
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1092
Epoch 3/30, Step 100/1,Classification Loss: 0.3146, Contrastive Loss: 0.1088
Epoch 3/30, Step 120/1,Classification Loss: 0.3225, Contrastive Loss: 0.1094
Epoch 3/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.1033
Accuracy: 0.9967, Precision: 0.9957, Recall: 0.9905, F1: 0.9931
Accuracy: 0.9920, Precision: 0.9883, Recall: 0.9786, F1: 0.9833
Epoch 3/30
Training - Loss: 62.1757
Training Metrics: {'accuracy': 0.9966755319148937, 'precision': 0.9957242915018848, 'recall': 0.9904775618926791, 'f1': 0.9930804719804643}
Validation Metrics: {'accuracy': 0.9920292261707074, 'precision': 0.9882536762307381, 'recall': 0.978553041679912, 'f1': 0.983332010916398}
Epoch 4/30, Step 0/1,Classification Loss: 0.3307, Contrastive Loss: 0.1105
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0999
Epoch 4/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0994
Epoch 4/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1096
Epoch 4/30, Step 80/1,Classification Loss: 0.3241, Contrastive Loss: 0.0988
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0930
Epoch 4/30, Step 120/1,Classification Loss: 0.3329, Contrastive Loss: 0.1074
Epoch 4/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0900
Accuracy: 0.9978, Precision: 0.9962, Recall: 0.9945, F1: 0.9953
Accuracy: 0.9932, Precision: 0.9868, Recall: 0.9852, F1: 0.9860
Epoch 4/30
Training - Loss: 59.9911
Training Metrics: {'accuracy': 0.9977559840425532, 'precision': 0.9961936566478842, 'recall': 0.9944624143553084, 'f1': 0.9953258210442661}
Validation Metrics: {'accuracy': 0.993246983283516, 'precision': 0.9868002251727492, 'recall': 0.9851944417040277, 'f1': 0.9859953805162316}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0895
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0891
Epoch 5/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1025
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0860
Epoch 5/30, Step 80/1,Classification Loss: 0.3252, Contrastive Loss: 0.0876
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0827
Epoch 5/30, Step 120/1,Classification Loss: 0.3312, Contrastive Loss: 0.0987
Epoch 5/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0808
Accuracy: 0.9974, Precision: 0.9966, Recall: 0.9927, F1: 0.9946
Accuracy: 0.9926, Precision: 0.9867, Recall: 0.9825, F1: 0.9846
Epoch 5/30
Training - Loss: 58.4930
Training Metrics: {'accuracy': 0.9974235372340425, 'precision': 0.9965778377858422, 'recall': 0.9927056844604012, 'f1': 0.9946306688407385}
Validation Metrics: {'accuracy': 0.9925827521310749, 'precision': 0.9866799066166854, 'recall': 0.982500764271786, 'f1': 0.9845770848238546}
Epoch 6/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0943
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0794
Epoch 6/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0790
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0768
Epoch 6/30, Step 80/1,Classification Loss: 0.3261, Contrastive Loss: 0.0788
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0744
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0740
Epoch 6/30, Step 140/1,Classification Loss: 0.3153, Contrastive Loss: 0.0758
Accuracy: 0.9982, Precision: 0.9970, Recall: 0.9955, F1: 0.9962
Accuracy: 0.9938, Precision: 0.9891, Recall: 0.9852, F1: 0.9871
Epoch 6/30
Training - Loss: 57.1789
Training Metrics: {'accuracy': 0.9981715425531915, 'precision': 0.9969500358867285, 'recall': 0.9954744311937818, 'f1': 0.9962106231188803}
Validation Metrics: {'accuracy': 0.9938005092438835, 'precision': 0.9890627915770451, 'recall': 0.9851868294352427, 'f1': 0.9871134792749995}
Epoch 7/30, Step 0/1,Classification Loss: 0.3376, Contrastive Loss: 0.0855
Epoch 7/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0807
Epoch 7/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0777
Epoch 7/30, Step 60/1,Classification Loss: 0.3179, Contrastive Loss: 0.0736
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0684
Epoch 7/30, Step 100/1,Classification Loss: 0.3248, Contrastive Loss: 0.0731
Epoch 7/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0681
Epoch 7/30, Step 140/1,Classification Loss: 0.3227, Contrastive Loss: 0.0689
Accuracy: 0.9971, Precision: 0.9965, Recall: 0.9913, F1: 0.9939
Accuracy: 0.9925, Precision: 0.9889, Recall: 0.9798, F1: 0.9843
Epoch 7/30
Training - Loss: 55.9123
Training Metrics: {'accuracy': 0.9970633865248227, 'precision': 0.9965370166827126, 'recall': 0.9912854958400852, 'f1': 0.9938907969220077}
Validation Metrics: {'accuracy': 0.9924720469390015, 'precision': 0.9888619001368374, 'recall': 0.9797994745707594, 'f1': 0.9842685314284134}
Epoch 8/30, Step 0/1,Classification Loss: 0.3167, Contrastive Loss: 0.0674
Epoch 8/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0672
Epoch 8/30, Step 40/1,Classification Loss: 0.3442, Contrastive Loss: 0.0783
Epoch 8/30, Step 60/1,Classification Loss: 0.3257, Contrastive Loss: 0.0689
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0626
Epoch 8/30, Step 100/1,Classification Loss: 0.3297, Contrastive Loss: 0.0789
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0613
Epoch 8/30, Step 140/1,Classification Loss: 0.3376, Contrastive Loss: 0.0809
Accuracy: 0.9982, Precision: 0.9967, Recall: 0.9957, F1: 0.9962
Accuracy: 0.9939, Precision: 0.9885, Recall: 0.9862, F1: 0.9874
Epoch 8/30
Training - Loss: 55.1363
Training Metrics: {'accuracy': 0.9981715425531915, 'precision': 0.9966950633593699, 'recall': 0.9957075245652419, 'f1': 0.9962005738295576}
Validation Metrics: {'accuracy': 0.9939112144359571, 'precision': 0.9884966883865223, 'recall': 0.9862400629443281, 'f1': 0.98736453302512}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0601
Epoch 9/30, Step 20/1,Classification Loss: 0.3314, Contrastive Loss: 0.0752
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0591
Epoch 9/30, Step 60/1,Classification Loss: 0.3229, Contrastive Loss: 0.0600
Epoch 9/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0587
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0568
Epoch 9/30, Step 120/1,Classification Loss: 0.3154, Contrastive Loss: 0.0579
Epoch 9/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0553
Accuracy: 0.9981, Precision: 0.9967, Recall: 0.9955, F1: 0.9961
Accuracy: 0.9935, Precision: 0.9885, Recall: 0.9843, F1: 0.9864
Epoch 9/30
Training - Loss: 54.2504
Training Metrics: {'accuracy': 0.9981161347517731, 'precision': 0.9966719984292167, 'recall': 0.9955254020675331, 'f1': 0.9960977273474202}
Validation Metrics: {'accuracy': 0.993468393667663, 'precision': 0.9885294318785837, 'recall': 0.9843344075767042, 'f1': 0.9864186269344392}
Epoch 10/30, Step 0/1,Classification Loss: 0.3240, Contrastive Loss: 0.0595
Epoch 10/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0553
Epoch 10/30, Step 40/1,Classification Loss: 0.3332, Contrastive Loss: 0.0600
Epoch 10/30, Step 60/1,Classification Loss: 0.3343, Contrastive Loss: 0.0707
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0527
Epoch 10/30, Step 100/1,Classification Loss: 0.3297, Contrastive Loss: 0.0573
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0513
Epoch 10/30, Step 140/1,Classification Loss: 0.3199, Contrastive Loss: 0.0549
Accuracy: 0.9979, Precision: 0.9967, Recall: 0.9946, F1: 0.9956
Accuracy: 0.9935, Precision: 0.9876, Recall: 0.9853, F1: 0.9864
Epoch 10/30
Training - Loss: 53.3796
Training Metrics: {'accuracy': 0.9978945035460993, 'precision': 0.9967038542189366, 'recall': 0.9945743700086148, 'f1': 0.9956357540725427}
Validation Metrics: {'accuracy': 0.993468393667663, 'precision': 0.9875756117924723, 'recall': 0.985323241291869, 'f1': 0.9864455899724014}
Epoch 11/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0516
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0503
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0500
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0489
Epoch 11/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0547
Epoch 11/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0649
Epoch 11/30, Step 120/1,Classification Loss: 0.3286, Contrastive Loss: 0.0521
Epoch 11/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0467
Accuracy: 0.9980, Precision: 0.9967, Recall: 0.9950, F1: 0.9958
Accuracy: 0.9938, Precision: 0.9891, Recall: 0.9852, F1: 0.9871
Epoch 11/30
Training - Loss: 53.1206
Training Metrics: {'accuracy': 0.9979776152482269, 'precision': 0.9966818325553332, 'recall': 0.9949709672609258, 'f1': 0.9958242281115042}
Validation Metrics: {'accuracy': 0.9938005092438835, 'precision': 0.9890627915770451, 'recall': 0.9851868294352427, 'f1': 0.9871134792749995}
Epoch 12/30, Step 0/1,Classification Loss: 0.3292, Contrastive Loss: 0.0516
Epoch 12/30, Step 20/1,Classification Loss: 0.3461, Contrastive Loss: 0.0652
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0460
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0459
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0448
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0440
Epoch 12/30, Step 120/1,Classification Loss: 0.3291, Contrastive Loss: 0.0609
Epoch 12/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0434
Accuracy: 0.9981, Precision: 0.9969, Recall: 0.9954, F1: 0.9962
Accuracy: 0.9934, Precision: 0.9869, Recall: 0.9856, F1: 0.9862
Epoch 12/30
Training - Loss: 52.4328
Training Metrics: {'accuracy': 0.9981438386524822, 'precision': 0.9969472572558191, 'recall': 0.9954012335134674, 'f1': 0.9961724719254792}
Validation Metrics: {'accuracy': 0.9933576884755895, 'precision': 0.9868730740893012, 'recall': 0.9855884527363366, 'f1': 0.986229513994684}
Epoch 13/30, Step 0/1,Classification Loss: 0.3487, Contrastive Loss: 0.0543
Epoch 13/30, Step 20/1,Classification Loss: 0.3202, Contrastive Loss: 0.0453
Epoch 13/30, Step 40/1,Classification Loss: 0.3329, Contrastive Loss: 0.0526
Epoch 13/30, Step 60/1,Classification Loss: 0.3143, Contrastive Loss: 0.0432
Epoch 13/30, Step 80/1,Classification Loss: 0.3380, Contrastive Loss: 0.0622
Epoch 13/30, Step 100/1,Classification Loss: 0.3320, Contrastive Loss: 0.0603
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0404
Epoch 13/30, Step 140/1,Classification Loss: 0.3220, Contrastive Loss: 0.0427
Accuracy: 0.9983, Precision: 0.9967, Recall: 0.9961, F1: 0.9964
Accuracy: 0.9934, Precision: 0.9862, Recall: 0.9862, F1: 0.9862
Epoch 13/30
Training - Loss: 51.9888
Training Metrics: {'accuracy': 0.9982546542553191, 'precision': 0.9966693402586924, 'recall': 0.9960950890285203, 'f1': 0.9963819708823058}
Validation Metrics: {'accuracy': 0.9933576884755895, 'precision': 0.9862476752131131, 'recall': 0.9862476752131131, 'f1': 0.9862476752131131}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0401
Epoch 14/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0412
Epoch 14/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0463
Epoch 14/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0534
Epoch 14/30, Step 80/1,Classification Loss: 0.3149, Contrastive Loss: 0.0399
Epoch 14/30, Step 100/1,Classification Loss: 0.3220, Contrastive Loss: 0.0396
Epoch 14/30, Step 120/1,Classification Loss: 0.3342, Contrastive Loss: 0.0404
Epoch 14/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0368
Accuracy: 0.9981, Precision: 0.9972, Recall: 0.9949, F1: 0.9961
Accuracy: 0.9934, Precision: 0.9872, Recall: 0.9853, F1: 0.9862
Epoch 14/30
Training - Loss: 51.3408
Training Metrics: {'accuracy': 0.9981161347517731, 'precision': 0.9972404900729263, 'recall': 0.9949356373270747, 'f1': 0.9960841407143746}
Validation Metrics: {'accuracy': 0.9933576884755895, 'precision': 0.9871876117719348, 'recall': 0.9852588414979484, 'f1': 0.986220411181832}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0372
Epoch 15/30, Step 20/1,Classification Loss: 0.3239, Contrastive Loss: 0.0384
Epoch 15/30, Step 40/1,Classification Loss: 0.3152, Contrastive Loss: 0.0394
Epoch 15/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0431
Epoch 15/30, Step 80/1,Classification Loss: 0.3301, Contrastive Loss: 0.0443
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0347
Epoch 15/30, Step 120/1,Classification Loss: 0.3161, Contrastive Loss: 0.0377
Epoch 15/30, Step 140/1,Classification Loss: 0.3269, Contrastive Loss: 0.0382
Accuracy: 0.9981, Precision: 0.9971, Recall: 0.9951, F1: 0.9961
Accuracy: 0.9938, Precision: 0.9891, Recall: 0.9852, F1: 0.9871
Epoch 15/30
Training - Loss: 51.0647
Training Metrics: {'accuracy': 0.9981161347517731, 'precision': 0.9970801307193279, 'recall': 0.9951107354761877, 'f1': 0.9960925652066935}
Validation Metrics: {'accuracy': 0.9938005092438835, 'precision': 0.9890627915770451, 'recall': 0.9851868294352427, 'f1': 0.9871134792749995}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0339
Epoch 16/30, Step 20/1,Classification Loss: 0.3442, Contrastive Loss: 0.0544
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Epoch 16/30, Step 60/1,Classification Loss: 0.3199, Contrastive Loss: 0.0360
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 16/30, Step 100/1,Classification Loss: 0.3221, Contrastive Loss: 0.0349
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Epoch 16/30, Step 140/1,Classification Loss: 0.3196, Contrastive Loss: 0.0335
Accuracy: 0.9983, Precision: 0.9971, Recall: 0.9959, F1: 0.9965
Accuracy: 0.9930, Precision: 0.9867, Recall: 0.9844, F1: 0.9855
Epoch 16/30
Training - Loss: 50.6120
Training Metrics: {'accuracy': 0.9983100620567376, 'precision': 0.9971197933740561, 'recall': 0.9958934067036334, 'f1': 0.9965054868911916}
Validation Metrics: {'accuracy': 0.993025572899369, 'precision': 0.9866545351984225, 'recall': 0.9844064196394098, 'f1': 0.9855266469196828}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0313
Epoch 17/30, Step 40/1,Classification Loss: 0.3270, Contrastive Loss: 0.0347
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Epoch 17/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0314
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Epoch 17/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0309
Epoch 17/30, Step 140/1,Classification Loss: 0.3216, Contrastive Loss: 0.0309
Accuracy: 0.9983, Precision: 0.9971, Recall: 0.9959, F1: 0.9965
Accuracy: 0.9931, Precision: 0.9880, Recall: 0.9835, F1: 0.9857
Epoch 17/30
Training - Loss: 50.2642
Training Metrics: {'accuracy': 0.9983100620567376, 'precision': 0.9971206479586223, 'recall': 0.9958948512374166, 'f1': 0.9965066372972737}
Validation Metrics: {'accuracy': 0.9931362780914424, 'precision': 0.9879954596630194, 'recall': 0.9834819857181658, 'f1': 0.9857233127922275}
Epoch 18/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0451
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Epoch 18/30, Step 40/1,Classification Loss: 0.3280, Contrastive Loss: 0.0336
Epoch 18/30, Step 60/1,Classification Loss: 0.3378, Contrastive Loss: 0.0461
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Epoch 18/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0286
Epoch 18/30, Step 120/1,Classification Loss: 0.3506, Contrastive Loss: 0.0390
Epoch 18/30, Step 140/1,Classification Loss: 0.3139, Contrastive Loss: 0.0289
Accuracy: 0.9982, Precision: 0.9971, Recall: 0.9954, F1: 0.9963
Accuracy: 0.9930, Precision: 0.9889, Recall: 0.9821, F1: 0.9855
Epoch 18/30
Training - Loss: 50.1627
Training Metrics: {'accuracy': 0.9981992464539007, 'precision': 0.9971321203558596, 'recall': 0.9954114168319753, 'f1': 0.9962695785060474}
Validation Metrics: {'accuracy': 0.993025572899369, 'precision': 0.9888890432784941, 'recall': 0.9820991409706921, 'f1': 0.9854592475584317}
Epoch 19/30, Step 0/1,Classification Loss: 0.3318, Contrastive Loss: 0.0379
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 19/30, Step 40/1,Classification Loss: 0.3188, Contrastive Loss: 0.0310
Epoch 19/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0264
Epoch 19/30, Step 100/1,Classification Loss: 0.3220, Contrastive Loss: 0.0301
Epoch 19/30, Step 120/1,Classification Loss: 0.3143, Contrastive Loss: 0.0273
Epoch 19/30, Step 140/1,Classification Loss: 0.3254, Contrastive Loss: 0.0301
Accuracy: 0.9982, Precision: 0.9971, Recall: 0.9954, F1: 0.9963
Accuracy: 0.9935, Precision: 0.9882, Recall: 0.9847, F1: 0.9864
Epoch 19/30
Training - Loss: 49.7058
Training Metrics: {'accuracy': 0.9981992464539007, 'precision': 0.997133343046224, 'recall': 0.9954138824015641, 'f1': 0.9962714251399787}
Validation Metrics: {'accuracy': 0.993468393667663, 'precision': 0.9882102454260577, 'recall': 0.9846640188150925, 'f1': 0.9864276292901328}
Epoch 20/30, Step 0/1,Classification Loss: 0.3205, Contrastive Loss: 0.0281
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 20/30, Step 40/1,Classification Loss: 0.3170, Contrastive Loss: 0.0286
Epoch 20/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0268
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0247
Epoch 20/30, Step 100/1,Classification Loss: 0.3242, Contrastive Loss: 0.0291
Epoch 20/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0251
Epoch 20/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Accuracy: 0.9982, Precision: 0.9971, Recall: 0.9956, F1: 0.9964
Accuracy: 0.9936, Precision: 0.9880, Recall: 0.9854, F1: 0.9867
Epoch 20/30
Training - Loss: 49.7250
Training Metrics: {'accuracy': 0.99822695035461, 'precision': 0.9970833014902536, 'recall': 0.9956225271227284, 'f1': 0.9963513296732744}
Validation Metrics: {'accuracy': 0.9935790988597365, 'precision': 0.9879642266939251, 'recall': 0.9853876410857896, 'f1': 0.9866709170693185}
Epoch 21/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0247
Epoch 21/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0389
Epoch 21/30, Step 40/1,Classification Loss: 0.3340, Contrastive Loss: 0.0336
Epoch 21/30, Step 60/1,Classification Loss: 0.3291, Contrastive Loss: 0.0414
Epoch 21/30, Step 80/1,Classification Loss: 0.3161, Contrastive Loss: 0.0244
Epoch 21/30, Step 100/1,Classification Loss: 0.3237, Contrastive Loss: 0.0284
Epoch 21/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0395
Epoch 21/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0233
Accuracy: 0.9983, Precision: 0.9953, Recall: 0.9976, F1: 0.9965
Accuracy: 0.9939, Precision: 0.9851, Recall: 0.9899, F1: 0.9875
Epoch 21/30
Training - Loss: 49.1546
Training Metrics: {'accuracy': 0.9982823581560284, 'precision': 0.995324256408578, 'recall': 0.9976025625165985, 'f1': 0.9964595597367156}
Validation Metrics: {'accuracy': 0.9939112144359571, 'precision': 0.9850802274155362, 'recall': 0.9898657865665987, 'f1': 0.9874556520315056}
Epoch 22/30, Step 0/1,Classification Loss: 0.3168, Contrastive Loss: 0.0242
Epoch 22/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0231
Epoch 22/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0237
Epoch 22/30, Step 60/1,Classification Loss: 0.3276, Contrastive Loss: 0.0274
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 22/30, Step 100/1,Classification Loss: 0.3453, Contrastive Loss: 0.0385
Epoch 22/30, Step 120/1,Classification Loss: 0.3227, Contrastive Loss: 0.0252
Epoch 22/30, Step 140/1,Classification Loss: 0.3227, Contrastive Loss: 0.0266
Accuracy: 0.9981, Precision: 0.9978, Recall: 0.9945, F1: 0.9962
Accuracy: 0.9935, Precision: 0.9895, Recall: 0.9833, F1: 0.9864
Epoch 22/30
Training - Loss: 49.0021
Training Metrics: {'accuracy': 0.9981438386524822, 'precision': 0.9978470359314167, 'recall': 0.9945044152287106, 'f1': 0.9961674422393257}
Validation Metrics: {'accuracy': 0.993468393667663, 'precision': 0.9894945393807015, 'recall': 0.9833455738615395, 'f1': 0.9863915313917182}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 20/1,Classification Loss: 0.3427, Contrastive Loss: 0.0441
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 80/1,Classification Loss: 0.3148, Contrastive Loss: 0.0220
Epoch 23/30, Step 100/1,Classification Loss: 0.3170, Contrastive Loss: 0.0217
Epoch 23/30, Step 120/1,Classification Loss: 0.3284, Contrastive Loss: 0.0287
Epoch 23/30, Step 140/1,Classification Loss: 0.3145, Contrastive Loss: 0.0214
Accuracy: 0.9982, Precision: 0.9971, Recall: 0.9955, F1: 0.9963
Accuracy: 0.9938, Precision: 0.9884, Recall: 0.9858, F1: 0.9871
Epoch 23/30
Training - Loss: 49.0579
Training Metrics: {'accuracy': 0.99822695035461, 'precision': 0.9971494533697194, 'recall': 0.9955114860706894, 'f1': 0.9963284849469637}
Validation Metrics: {'accuracy': 0.9938005092438835, 'precision': 0.9884250709046035, 'recall': 0.9858460519120191, 'f1': 0.9871305406186524}
Epoch 24/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0222
Epoch 24/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0219
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 80/1,Classification Loss: 0.3206, Contrastive Loss: 0.0250
Epoch 24/30, Step 100/1,Classification Loss: 0.3466, Contrastive Loss: 0.0450
Epoch 24/30, Step 120/1,Classification Loss: 0.3319, Contrastive Loss: 0.0275
Epoch 24/30, Step 140/1,Classification Loss: 0.3403, Contrastive Loss: 0.0347
Accuracy: 0.9982, Precision: 0.9953, Recall: 0.9974, F1: 0.9963
Accuracy: 0.9940, Precision: 0.9855, Recall: 0.9899, F1: 0.9877
Epoch 24/30
Training - Loss: 48.7407
Training Metrics: {'accuracy': 0.99822695035461, 'precision': 0.995277464062304, 'recall': 0.9974006882416535, 'f1': 0.996335737168323}
Validation Metrics: {'accuracy': 0.9940219196280305, 'precision': 0.9854594825635481, 'recall': 0.9899301863605194, 'f1': 0.9876796991533181}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.0273
Epoch 25/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0207
Epoch 25/30, Step 60/1,Classification Loss: 0.3251, Contrastive Loss: 0.0227
Epoch 25/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0329
Epoch 25/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0204
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 25/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Accuracy: 0.9979, Precision: 0.9951, Recall: 0.9961, F1: 0.9956
Accuracy: 0.9938, Precision: 0.9872, Recall: 0.9872, F1: 0.9872
Epoch 25/30
Training - Loss: 48.5665
Training Metrics: {'accuracy': 0.9978945035460993, 'precision': 0.9951416932965678, 'recall': 0.9961254735181795, 'f1': 0.9956328669957164}
Validation Metrics: {'accuracy': 0.9938005092438835, 'precision': 0.9871644968655722, 'recall': 0.9871644968655722, 'f1': 0.9871644968655722}
Epoch 26/30, Step 0/1,Classification Loss: 0.3585, Contrastive Loss: 0.0489
Epoch 26/30, Step 20/1,Classification Loss: 0.3212, Contrastive Loss: 0.0205
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 80/1,Classification Loss: 0.3395, Contrastive Loss: 0.0317
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Accuracy: 0.9983, Precision: 0.9972, Recall: 0.9957, F1: 0.9965
Accuracy: 0.9936, Precision: 0.9883, Recall: 0.9851, F1: 0.9867
Epoch 26/30
Training - Loss: 48.5692
Training Metrics: {'accuracy': 0.9982823581560284, 'precision': 0.9971890059338933, 'recall': 0.9957205145085329, 'f1': 0.9964531626147359}
Validation Metrics: {'accuracy': 0.9935790988597365, 'precision': 0.9882818494592982, 'recall': 0.9850580298474014, 'f1': 0.9866620889416067}
Epoch 27/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0279
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 27/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0197
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 27/30, Step 80/1,Classification Loss: 0.3186, Contrastive Loss: 0.0196
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 27/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0212
Epoch 27/30, Step 140/1,Classification Loss: 0.3300, Contrastive Loss: 0.0303
Accuracy: 0.9984, Precision: 0.9972, Recall: 0.9961, F1: 0.9967
Accuracy: 0.9934, Precision: 0.9878, Recall: 0.9846, F1: 0.9862
Epoch 27/30
Training - Loss: 48.4004
Training Metrics: {'accuracy': 0.9983931737588653, 'precision': 0.9972473473616317, 'recall': 0.9960999778116386, 'f1': 0.9966726894831859}
Validation Metrics: {'accuracy': 0.9933576884755895, 'precision': 0.9878203919175812, 'recall': 0.9845996190211719, 'f1': 0.9862021609740759}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0234
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 100/1,Classification Loss: 0.3156, Contrastive Loss: 0.0202
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 140/1,Classification Loss: 0.3166, Contrastive Loss: 0.0197
Accuracy: 0.9982, Precision: 0.9971, Recall: 0.9953, F1: 0.9962
Accuracy: 0.9932, Precision: 0.9890, Recall: 0.9829, F1: 0.9859
Epoch 28/30
Training - Loss: 48.1737
Training Metrics: {'accuracy': 0.9981715425531915, 'precision': 0.9971277515923155, 'recall': 0.9953380544205406, 'f1': 0.9962305264133433}
Validation Metrics: {'accuracy': 0.993246983283516, 'precision': 0.9890302968007195, 'recall': 0.98288716303531, 'f1': 0.9859302273710984}
Epoch 29/30, Step 0/1,Classification Loss: 0.3295, Contrastive Loss: 0.0259
Epoch 29/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0326
Epoch 29/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0192
Epoch 29/30, Step 60/1,Classification Loss: 0.3144, Contrastive Loss: 0.0180
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0576
Accuracy: 0.9981, Precision: 0.9972, Recall: 0.9951, F1: 0.9962
Accuracy: 0.9935, Precision: 0.9885, Recall: 0.9843, F1: 0.9864
Epoch 29/30
Training - Loss: 48.2658
Training Metrics: {'accuracy': 0.9981438386524822, 'precision': 0.9971838263049871, 'recall': 0.9951383032892791, 'f1': 0.9961579674378862}
Validation Metrics: {'accuracy': 0.993468393667663, 'precision': 0.9885294318785837, 'recall': 0.9843344075767042, 'f1': 0.9864186269344392}
Epoch 30/30, Step 0/1,Classification Loss: 0.3227, Contrastive Loss: 0.0209
Epoch 30/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0329
Epoch 30/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0222
Epoch 30/30, Step 60/1,Classification Loss: 0.3178, Contrastive Loss: 0.0201
Epoch 30/30, Step 80/1,Classification Loss: 0.3276, Contrastive Loss: 0.0219
Epoch 30/30, Step 100/1,Classification Loss: 0.3147, Contrastive Loss: 0.0182
Epoch 30/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0176
Epoch 30/30, Step 140/1,Classification Loss: 0.3240, Contrastive Loss: 0.0208
Accuracy: 0.9982, Precision: 0.9971, Recall: 0.9953, F1: 0.9962
Accuracy: 0.9936, Precision: 0.9892, Recall: 0.9841, F1: 0.9866
Epoch 30/30
Training - Loss: 48.2304
Training Metrics: {'accuracy': 0.9981715425531915, 'precision': 0.9971102925046513, 'recall': 0.9953019817172923, 'f1': 0.9962037212842618}
Validation Metrics: {'accuracy': 0.9935790988597365, 'precision': 0.9892422197009952, 'recall': 0.9840691961322366, 'f1': 0.9866355178903263}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1814, 5814), y shape: (1814,), y distribution: Counter({np.float64(0.0): 1619, np.float64(1.0): 195}), env shape: (1814,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9537, Precision: 0.8618, Recall: 0.9222, F1: 0.8887
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11115]))
original train data shape: torch.Size([45262]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1814, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45262]), new train data shape: torch.Size([45262])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11115]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3180, Contrastive Loss: 1.5307
Epoch 1/30, Step 20/1,Classification Loss: 0.3171, Contrastive Loss: 0.9158
Epoch 1/30, Step 40/1,Classification Loss: 0.3149, Contrastive Loss: 0.4310
Epoch 1/30, Step 60/1,Classification Loss: 0.3276, Contrastive Loss: 0.2508
Epoch 1/30, Step 80/1,Classification Loss: 0.3181, Contrastive Loss: 0.1979
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1622
Epoch 1/30, Step 120/1,Classification Loss: 0.3359, Contrastive Loss: 0.1594
Epoch 1/30, Step 140/1,Classification Loss: 0.3184, Contrastive Loss: 0.1428
Accuracy: 0.9975, Precision: 0.9937, Recall: 0.9960, F1: 0.9949
Accuracy: 0.9937, Precision: 0.9854, Recall: 0.9888, F1: 0.9871
Epoch 1/30
Training - Loss: 105.4178
Training Metrics: {'accuracy': 0.9975066489361702, 'precision': 0.9937245518739211, 'recall': 0.9959976968960902, 'f1': 0.9948572792408469}
Validation Metrics: {'accuracy': 0.9937037446150447, 'precision': 0.9853603374497317, 'recall': 0.9888352993973843, 'f1': 0.987088632356237}
Epoch 2/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.1365
Epoch 2/30, Step 20/1,Classification Loss: 0.3194, Contrastive Loss: 0.1321
Epoch 2/30, Step 40/1,Classification Loss: 0.3479, Contrastive Loss: 0.1768
Epoch 2/30, Step 60/1,Classification Loss: 0.3300, Contrastive Loss: 0.1267
Epoch 2/30, Step 80/1,Classification Loss: 0.3390, Contrastive Loss: 0.1298
Epoch 2/30, Step 100/1,Classification Loss: 0.3441, Contrastive Loss: 0.1260
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1064
Epoch 2/30, Step 140/1,Classification Loss: 0.3264, Contrastive Loss: 0.1079
Accuracy: 0.9976, Precision: 0.9938, Recall: 0.9962, F1: 0.9950
Accuracy: 0.9943, Precision: 0.9866, Recall: 0.9898, F1: 0.9882
Epoch 2/30
Training - Loss: 63.5638
Training Metrics: {'accuracy': 0.9975620567375887, 'precision': 0.993751239233194, 'recall': 0.9961908233400323, 'f1': 0.9949666063048854}
Validation Metrics: {'accuracy': 0.9942560477189882, 'precision': 0.9866410591151833, 'recall': 0.9898089400369549, 'f1': 0.9882173873954508}
Epoch 3/30, Step 0/1,Classification Loss: 0.3185, Contrastive Loss: 0.1102
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1024
Epoch 3/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.1082
Epoch 3/30, Step 60/1,Classification Loss: 0.3416, Contrastive Loss: 0.1077
Epoch 3/30, Step 80/1,Classification Loss: 0.3193, Contrastive Loss: 0.0965
Epoch 3/30, Step 100/1,Classification Loss: 0.3425, Contrastive Loss: 0.1165
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0923
Epoch 3/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.1300
Accuracy: 0.9978, Precision: 0.9961, Recall: 0.9947, F1: 0.9954
Accuracy: 0.9933, Precision: 0.9872, Recall: 0.9850, F1: 0.9861
Epoch 3/30
Training - Loss: 60.3277
Training Metrics: {'accuracy': 0.9977559840425532, 'precision': 0.9960610732285611, 'recall': 0.994678031468437, 'f1': 0.9953681312906881}
Validation Metrics: {'accuracy': 0.99326190213189, 'precision': 0.9872180828188761, 'recall': 0.9849921132446464, 'f1': 0.9861013336460892}
Epoch 4/30, Step 0/1,Classification Loss: 0.3150, Contrastive Loss: 0.0923
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0890
Epoch 4/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0878
Epoch 4/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0905
Epoch 4/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0902
Epoch 4/30, Step 100/1,Classification Loss: 0.3583, Contrastive Loss: 0.1168
Epoch 4/30, Step 120/1,Classification Loss: 0.3314, Contrastive Loss: 0.0905
Epoch 4/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0862
Accuracy: 0.9976, Precision: 0.9961, Recall: 0.9940, F1: 0.9951
Accuracy: 0.9927, Precision: 0.9875, Recall: 0.9824, F1: 0.9849
Epoch 4/30
Training - Loss: 58.8841
Training Metrics: {'accuracy': 0.9976174645390071, 'precision': 0.9961317235966568, 'recall': 0.9940077739226071, 'f1': 0.9950664016474825}
Validation Metrics: {'accuracy': 0.9927095990279465, 'precision': 0.9874863223242, 'recall': 0.9823885398172667, 'f1': 0.9849176691296595}
Epoch 5/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0819
Epoch 5/30, Step 20/1,Classification Loss: 0.3193, Contrastive Loss: 0.0822
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0775
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0773
Epoch 5/30, Step 80/1,Classification Loss: 0.3159, Contrastive Loss: 0.0808
Epoch 5/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0803
Epoch 5/30, Step 120/1,Classification Loss: 0.3143, Contrastive Loss: 0.0766
Epoch 5/30, Step 140/1,Classification Loss: 0.3190, Contrastive Loss: 0.0732
Accuracy: 0.9979, Precision: 0.9967, Recall: 0.9949, F1: 0.9958
Accuracy: 0.9935, Precision: 0.9880, Recall: 0.9851, F1: 0.9865
Epoch 5/30
Training - Loss: 57.0845
Training Metrics: {'accuracy': 0.9979499113475178, 'precision': 0.996674310325676, 'recall': 0.9948901126973347, 'f1': 0.9957798448307308}
Validation Metrics: {'accuracy': 0.9934828233734674, 'precision': 0.987988146824348, 'recall': 0.9851207802544252, 'f1': 0.9865482265270926}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0722
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0719
Epoch 6/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0704
Epoch 6/30, Step 60/1,Classification Loss: 0.3164, Contrastive Loss: 0.0703
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0680
Epoch 6/30, Step 100/1,Classification Loss: 0.3220, Contrastive Loss: 0.0729
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0662
Epoch 6/30, Step 140/1,Classification Loss: 0.3195, Contrastive Loss: 0.0686
Accuracy: 0.9977, Precision: 0.9967, Recall: 0.9938, F1: 0.9952
Accuracy: 0.9933, Precision: 0.9888, Recall: 0.9834, F1: 0.9861
Epoch 6/30
Training - Loss: 55.8735
Training Metrics: {'accuracy': 0.9977005762411347, 'precision': 0.9966744389466671, 'recall': 0.9938139198418986, 'f1': 0.9952381110340269}
Validation Metrics: {'accuracy': 0.99326190213189, 'precision': 0.9887939377343251, 'recall': 0.9833621804568371, 'f1': 0.9860556888165202}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0652
Epoch 7/30, Step 20/1,Classification Loss: 0.3208, Contrastive Loss: 0.0689
Epoch 7/30, Step 40/1,Classification Loss: 0.3195, Contrastive Loss: 0.0675
Epoch 7/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0650
Epoch 7/30, Step 80/1,Classification Loss: 0.3436, Contrastive Loss: 0.1227
Epoch 7/30, Step 100/1,Classification Loss: 0.3138, Contrastive Loss: 0.0627
Epoch 7/30, Step 120/1,Classification Loss: 0.3199, Contrastive Loss: 0.0658
Epoch 7/30, Step 140/1,Classification Loss: 0.3157, Contrastive Loss: 0.0618
Accuracy: 0.9977, Precision: 0.9968, Recall: 0.9938, F1: 0.9953
Accuracy: 0.9927, Precision: 0.9891, Recall: 0.9808, F1: 0.9849
Epoch 7/30
Training - Loss: 54.9011
Training Metrics: {'accuracy': 0.997728280141844, 'precision': 0.996779271591149, 'recall': 0.9938469141875867, 'f1': 0.995306707497202}
Validation Metrics: {'accuracy': 0.9927095990279465, 'precision': 0.9890823982858001, 'recall': 0.9807586070294574, 'f1': 0.9848679212025067}
Epoch 8/30, Step 0/1,Classification Loss: 0.3367, Contrastive Loss: 0.0657
Epoch 8/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0740
Epoch 8/30, Step 40/1,Classification Loss: 0.3140, Contrastive Loss: 0.0595
Epoch 8/30, Step 60/1,Classification Loss: 0.3169, Contrastive Loss: 0.0582
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0567
Epoch 8/30, Step 100/1,Classification Loss: 0.3162, Contrastive Loss: 0.0571
Epoch 8/30, Step 120/1,Classification Loss: 0.3446, Contrastive Loss: 0.0798
Epoch 8/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0553
Accuracy: 0.9979, Precision: 0.9969, Recall: 0.9945, F1: 0.9957
Accuracy: 0.9929, Precision: 0.9873, Recall: 0.9835, F1: 0.9854
Epoch 8/30
Training - Loss: 54.2295
Training Metrics: {'accuracy': 0.9979222074468085, 'precision': 0.9968987802971869, 'recall': 0.9945417855604926, 'f1': 0.9957161561457097}
Validation Metrics: {'accuracy': 0.9929305202695239, 'precision': 0.9873148087406467, 'recall': 0.983495166499731, 'f1': 0.9853938963088449}
Epoch 9/30, Step 0/1,Classification Loss: 0.3282, Contrastive Loss: 0.0575
Epoch 9/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0548
Epoch 9/30, Step 40/1,Classification Loss: 0.3180, Contrastive Loss: 0.0552
Epoch 9/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0606
Epoch 9/30, Step 80/1,Classification Loss: 0.3302, Contrastive Loss: 0.0576
Epoch 9/30, Step 100/1,Classification Loss: 0.3144, Contrastive Loss: 0.0538
Epoch 9/30, Step 120/1,Classification Loss: 0.3497, Contrastive Loss: 0.0713
Epoch 9/30, Step 140/1,Classification Loss: 0.3136, Contrastive Loss: 0.0527
Accuracy: 0.9979, Precision: 0.9969, Recall: 0.9946, F1: 0.9958
Accuracy: 0.9934, Precision: 0.9879, Recall: 0.9847, F1: 0.9863
Epoch 9/30
Training - Loss: 53.4894
Training Metrics: {'accuracy': 0.9979499113475178, 'precision': 0.9969056462290127, 'recall': 0.9946173355141461, 'f1': 0.9957576103949727}
Validation Metrics: {'accuracy': 0.9933723627526787, 'precision': 0.9879164449987574, 'recall': 0.984730460191974, 'f1': 0.9863157498015811}
Epoch 10/30, Step 0/1,Classification Loss: 0.3246, Contrastive Loss: 0.0539
Epoch 10/30, Step 20/1,Classification Loss: 0.3447, Contrastive Loss: 0.0560
Epoch 10/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0526
Epoch 10/30, Step 60/1,Classification Loss: 0.3287, Contrastive Loss: 0.0542
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0479
Epoch 10/30, Step 100/1,Classification Loss: 0.3238, Contrastive Loss: 0.0500
Epoch 10/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0479
Epoch 10/30, Step 140/1,Classification Loss: 0.3265, Contrastive Loss: 0.0487
Accuracy: 0.9981, Precision: 0.9970, Recall: 0.9950, F1: 0.9960
Accuracy: 0.9935, Precision: 0.9883, Recall: 0.9848, F1: 0.9865
Epoch 10/30
Training - Loss: 52.8148
Training Metrics: {'accuracy': 0.9980607269503546, 'precision': 0.9969844264768359, 'recall': 0.995037131445324, 'f1': 0.996007961326367}
Validation Metrics: {'accuracy': 0.9934828233734674, 'precision': 0.9883026908029917, 'recall': 0.9847947936968633, 'f1': 0.9865394111838205}
Epoch 11/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0532
Epoch 11/30, Step 20/1,Classification Loss: 0.3202, Contrastive Loss: 0.0481
Epoch 11/30, Step 40/1,Classification Loss: 0.3575, Contrastive Loss: 0.0590
Epoch 11/30, Step 60/1,Classification Loss: 0.3303, Contrastive Loss: 0.0601
Epoch 11/30, Step 80/1,Classification Loss: 0.3443, Contrastive Loss: 0.0581
Epoch 11/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0440
Epoch 11/30, Step 120/1,Classification Loss: 0.3222, Contrastive Loss: 0.0451
Epoch 11/30, Step 140/1,Classification Loss: 0.3141, Contrastive Loss: 0.0439
Accuracy: 0.9982, Precision: 0.9949, Recall: 0.9975, F1: 0.9962
Accuracy: 0.9940, Precision: 0.9856, Recall: 0.9900, F1: 0.9878
Epoch 11/30
Training - Loss: 52.4897
Training Metrics: {'accuracy': 0.9981715425531915, 'precision': 0.9949293024637116, 'recall': 0.9975356400888316, 'f1': 0.996227433543025}
Validation Metrics: {'accuracy': 0.9940351264774108, 'precision': 0.9855835948643373, 'recall': 0.9900062595847381, 'f1': 0.9877800630316798}
Epoch 12/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0439
Epoch 12/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0559
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0418
Epoch 12/30, Step 60/1,Classification Loss: 0.3291, Contrastive Loss: 0.0730
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0413
Epoch 12/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0458
Epoch 12/30, Step 120/1,Classification Loss: 0.3376, Contrastive Loss: 0.0498
Epoch 12/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0393
Accuracy: 0.9979, Precision: 0.9970, Recall: 0.9944, F1: 0.9957
Accuracy: 0.9936, Precision: 0.9887, Recall: 0.9849, F1: 0.9868
Epoch 12/30
Training - Loss: 51.9512
Training Metrics: {'accuracy': 0.9978945035460993, 'precision': 0.9969649232562756, 'recall': 0.9943653305752085, 'f1': 0.995660105483716}
Validation Metrics: {'accuracy': 0.9935932839942561, 'precision': 0.9886895448180463, 'recall': 0.9848591272017526, 'f1': 0.9867632185298907}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0394
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0395
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0388
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0380
Epoch 13/30, Step 80/1,Classification Loss: 0.3140, Contrastive Loss: 0.0389
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0371
Epoch 13/30, Step 120/1,Classification Loss: 0.3336, Contrastive Loss: 0.0474
Epoch 13/30, Step 140/1,Classification Loss: 0.3140, Contrastive Loss: 0.0374
Accuracy: 0.9972, Precision: 0.9967, Recall: 0.9919, F1: 0.9943
Accuracy: 0.9927, Precision: 0.9891, Recall: 0.9808, F1: 0.9849
Epoch 13/30
Training - Loss: 51.4625
Training Metrics: {'accuracy': 0.997229609929078, 'precision': 0.996737676863701, 'recall': 0.9918767740118026, 'f1': 0.9942896124785737}
Validation Metrics: {'accuracy': 0.9927095990279465, 'precision': 0.9890823982858001, 'recall': 0.9807586070294574, 'f1': 0.9848679212025067}
Epoch 14/30, Step 0/1,Classification Loss: 0.3341, Contrastive Loss: 0.0398
Epoch 14/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0376
Epoch 14/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0365
Epoch 14/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0347
Epoch 14/30, Step 100/1,Classification Loss: 0.3286, Contrastive Loss: 0.0378
Epoch 14/30, Step 120/1,Classification Loss: 0.3274, Contrastive Loss: 0.0362
Epoch 14/30, Step 140/1,Classification Loss: 0.3281, Contrastive Loss: 0.0367
Accuracy: 0.9981, Precision: 0.9970, Recall: 0.9953, F1: 0.9961
Accuracy: 0.9937, Precision: 0.9891, Recall: 0.9849, F1: 0.9870
Epoch 14/30
Training - Loss: 50.7372
Training Metrics: {'accuracy': 0.9981161347517731, 'precision': 0.9970271221211122, 'recall': 0.9952519125418489, 'f1': 0.9961371706300779}
Validation Metrics: {'accuracy': 0.9937037446150447, 'precision': 0.9890770084831098, 'recall': 0.9849234607066419, 'f1': 0.986987172017264}
Epoch 15/30, Step 0/1,Classification Loss: 0.3246, Contrastive Loss: 0.0363
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0338
Epoch 15/30, Step 40/1,Classification Loss: 0.3304, Contrastive Loss: 0.0506
Epoch 15/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0332
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 15/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0348
Epoch 15/30, Step 120/1,Classification Loss: 0.3214, Contrastive Loss: 0.0337
Epoch 15/30, Step 140/1,Classification Loss: 0.3137, Contrastive Loss: 0.0329
Accuracy: 0.9976, Precision: 0.9970, Recall: 0.9933, F1: 0.9951
Accuracy: 0.9927, Precision: 0.9888, Recall: 0.9811, F1: 0.9849
Epoch 15/30
Training - Loss: 50.5399
Training Metrics: {'accuracy': 0.9976174645390071, 'precision': 0.9969717563240705, 'recall': 0.9932542491363945, 'f1': 0.9951027027160058}
Validation Metrics: {'accuracy': 0.9927095990279465, 'precision': 0.9887606826094038, 'recall': 0.9810845935870193, 'f1': 0.9848779031486057}
Epoch 16/30, Step 0/1,Classification Loss: 0.3193, Contrastive Loss: 0.0328
Epoch 16/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0317
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0305
Epoch 16/30, Step 80/1,Classification Loss: 0.3251, Contrastive Loss: 0.0327
Epoch 16/30, Step 100/1,Classification Loss: 0.3171, Contrastive Loss: 0.0312
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 16/30, Step 140/1,Classification Loss: 0.3215, Contrastive Loss: 0.0301
Accuracy: 0.9974, Precision: 0.9972, Recall: 0.9921, F1: 0.9946
Accuracy: 0.9924, Precision: 0.9892, Recall: 0.9793, F1: 0.9842
Epoch 16/30
Training - Loss: 50.1221
Training Metrics: {'accuracy': 0.9973958333333334, 'precision': 0.9971639966365979, 'recall': 0.9921363646072581, 'f1': 0.9946313558008222}
Validation Metrics: {'accuracy': 0.9923782171655805, 'precision': 0.9891961040625401, 'recall': 0.9792616602845419, 'f1': 0.9841539358186417}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 17/30, Step 20/1,Classification Loss: 0.3367, Contrastive Loss: 0.0347
Epoch 17/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0295
Epoch 17/30, Step 60/1,Classification Loss: 0.3155, Contrastive Loss: 0.0287
Epoch 17/30, Step 80/1,Classification Loss: 0.3249, Contrastive Loss: 0.0304
Epoch 17/30, Step 100/1,Classification Loss: 0.3359, Contrastive Loss: 0.0329
Epoch 17/30, Step 120/1,Classification Loss: 0.3260, Contrastive Loss: 0.0288
Epoch 17/30, Step 140/1,Classification Loss: 0.3402, Contrastive Loss: 0.0343
Accuracy: 0.9982, Precision: 0.9972, Recall: 0.9953, F1: 0.9962
Accuracy: 0.9938, Precision: 0.9895, Recall: 0.9850, F1: 0.9872
Epoch 17/30
Training - Loss: 49.9969
Training Metrics: {'accuracy': 0.9981715425531915, 'precision': 0.9972137539879475, 'recall': 0.995266496642562, 'f1': 0.9962373087255643}
Validation Metrics: {'accuracy': 0.9938142052358334, 'precision': 0.9894650832419146, 'recall': 0.9849877942115314, 'f1': 0.9872112718236898}
Epoch 18/30, Step 0/1,Classification Loss: 0.3315, Contrastive Loss: 0.0324
Epoch 18/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0277
Epoch 18/30, Step 40/1,Classification Loss: 0.3284, Contrastive Loss: 0.0320
Epoch 18/30, Step 60/1,Classification Loss: 0.3139, Contrastive Loss: 0.0268
Epoch 18/30, Step 80/1,Classification Loss: 0.3142, Contrastive Loss: 0.0277
Epoch 18/30, Step 100/1,Classification Loss: 0.3220, Contrastive Loss: 0.0272
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0255
Epoch 18/30, Step 140/1,Classification Loss: 0.3147, Contrastive Loss: 0.0268
Accuracy: 0.9982, Precision: 0.9973, Recall: 0.9953, F1: 0.9963
Accuracy: 0.9940, Precision: 0.9896, Recall: 0.9858, F1: 0.9877
Epoch 18/30
Training - Loss: 49.6332
Training Metrics: {'accuracy': 0.9981992464539007, 'precision': 0.9972991179910553, 'recall': 0.9952536146103848, 'f1': 0.9962732695203698}
Validation Metrics: {'accuracy': 0.9940351264774108, 'precision': 0.9896060355363125, 'recall': 0.9857684343364338, 'f1': 0.987676100010588}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 19/30, Step 20/1,Classification Loss: 0.3158, Contrastive Loss: 0.0268
Epoch 19/30, Step 40/1,Classification Loss: 0.3316, Contrastive Loss: 0.0301
Epoch 19/30, Step 60/1,Classification Loss: 0.3308, Contrastive Loss: 0.0292
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Epoch 19/30, Step 100/1,Classification Loss: 0.3140, Contrastive Loss: 0.0258
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 19/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0243
Accuracy: 0.9982, Precision: 0.9974, Recall: 0.9952, F1: 0.9963
Accuracy: 0.9937, Precision: 0.9891, Recall: 0.9849, F1: 0.9870
Epoch 19/30
Training - Loss: 49.5377
Training Metrics: {'accuracy': 0.9981992464539007, 'precision': 0.9973890566540806, 'recall': 0.9951915603575239, 'f1': 0.9962867264948678}
Validation Metrics: {'accuracy': 0.9937037446150447, 'precision': 0.9890770084831098, 'recall': 0.9849234607066419, 'f1': 0.986987172017264}
Epoch 20/30, Step 0/1,Classification Loss: 0.3363, Contrastive Loss: 0.0286
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 20/30, Step 40/1,Classification Loss: 0.3304, Contrastive Loss: 0.0355
Epoch 20/30, Step 60/1,Classification Loss: 0.3249, Contrastive Loss: 0.0257
Epoch 20/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0401
Epoch 20/30, Step 100/1,Classification Loss: 0.3278, Contrastive Loss: 0.0249
Epoch 20/30, Step 120/1,Classification Loss: 0.3174, Contrastive Loss: 0.0249
Epoch 20/30, Step 140/1,Classification Loss: 0.3163, Contrastive Loss: 0.0248
Accuracy: 0.9983, Precision: 0.9973, Recall: 0.9957, F1: 0.9965
Accuracy: 0.9938, Precision: 0.9876, Recall: 0.9869, F1: 0.9873
Epoch 20/30
Training - Loss: 49.2849
Training Metrics: {'accuracy': 0.9982823581560284, 'precision': 0.9972817105822419, 'recall': 0.9956609731684479, 'f1': 0.9964693903301437}
Validation Metrics: {'accuracy': 0.9938142052358334, 'precision': 0.9875796871470488, 'recall': 0.9869437135569026, 'f1': 0.9872613936060723}
Epoch 21/30, Step 0/1,Classification Loss: 0.3204, Contrastive Loss: 0.0244
Epoch 21/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.0840
Epoch 21/30, Step 40/1,Classification Loss: 0.3398, Contrastive Loss: 0.0315
Epoch 21/30, Step 60/1,Classification Loss: 0.3274, Contrastive Loss: 0.0267
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 21/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0226
Epoch 21/30, Step 120/1,Classification Loss: 0.3273, Contrastive Loss: 0.0251
Epoch 21/30, Step 140/1,Classification Loss: 0.3139, Contrastive Loss: 0.0226
Accuracy: 0.9980, Precision: 0.9977, Recall: 0.9942, F1: 0.9959
Accuracy: 0.9926, Precision: 0.9884, Recall: 0.9810, F1: 0.9847
Epoch 21/30
Training - Loss: 48.9025
Training Metrics: {'accuracy': 0.9980330230496454, 'precision': 0.9976968475022938, 'recall': 0.99418266183794, 'f1': 0.9959306053518135}
Validation Metrics: {'accuracy': 0.9925991384071579, 'precision': 0.988369496161067, 'recall': 0.9810202600821298, 'f1': 0.9846538408864369}
Epoch 22/30, Step 0/1,Classification Loss: 0.3299, Contrastive Loss: 0.0257
Epoch 22/30, Step 20/1,Classification Loss: 0.3280, Contrastive Loss: 0.0247
Epoch 22/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0299
Epoch 22/30, Step 60/1,Classification Loss: 0.3399, Contrastive Loss: 0.0289
Epoch 22/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0224
Epoch 22/30, Step 100/1,Classification Loss: 0.3232, Contrastive Loss: 0.0244
Epoch 22/30, Step 120/1,Classification Loss: 0.3417, Contrastive Loss: 0.0290
Epoch 22/30, Step 140/1,Classification Loss: 0.3145, Contrastive Loss: 0.0214
Accuracy: 0.9983, Precision: 0.9974, Recall: 0.9958, F1: 0.9966
Accuracy: 0.9938, Precision: 0.9879, Recall: 0.9866, F1: 0.9873
Epoch 22/30
Training - Loss: 48.8726
Training Metrics: {'accuracy': 0.9983377659574468, 'precision': 0.9973840968375594, 'recall': 0.9957504919987127, 'f1': 0.9965653186796404}
Validation Metrics: {'accuracy': 0.9938142052358334, 'precision': 0.9878908780223712, 'recall': 0.9866177269993407, 'f1': 0.9872530736866116}
Epoch 23/30, Step 0/1,Classification Loss: 0.3145, Contrastive Loss: 0.0223
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 40/1,Classification Loss: 0.3285, Contrastive Loss: 0.0230
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 23/30, Step 80/1,Classification Loss: 0.3359, Contrastive Loss: 0.0380
Epoch 23/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0250
Epoch 23/30, Step 120/1,Classification Loss: 0.3292, Contrastive Loss: 0.0323
Epoch 23/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0200
Accuracy: 0.9983, Precision: 0.9974, Recall: 0.9956, F1: 0.9965
Accuracy: 0.9938, Precision: 0.9885, Recall: 0.9860, F1: 0.9872
Epoch 23/30
Training - Loss: 48.7534
Training Metrics: {'accuracy': 0.9983100620567376, 'precision': 0.997447640408504, 'recall': 0.9955662689604143, 'f1': 0.996504335549584}
Validation Metrics: {'accuracy': 0.9938142052358334, 'precision': 0.9885168932768171, 'recall': 0.985965753884217, 'f1': 0.9872363934891125}
Epoch 24/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0203
Epoch 24/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0812
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 60/1,Classification Loss: 0.3274, Contrastive Loss: 0.0220
Epoch 24/30, Step 80/1,Classification Loss: 0.3265, Contrastive Loss: 0.0215
Epoch 24/30, Step 100/1,Classification Loss: 0.3153, Contrastive Loss: 0.0208
Epoch 24/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0344
Epoch 24/30, Step 140/1,Classification Loss: 0.3146, Contrastive Loss: 0.0207
Accuracy: 0.9984, Precision: 0.9979, Recall: 0.9958, F1: 0.9968
Accuracy: 0.9936, Precision: 0.9893, Recall: 0.9842, F1: 0.9867
Epoch 24/30
Training - Loss: 48.4217
Training Metrics: {'accuracy': 0.9984485815602837, 'precision': 0.9978656283411623, 'recall': 0.9957516468489945, 'f1': 0.9968053238129609}
Validation Metrics: {'accuracy': 0.9935932839942561, 'precision': 0.9893241553337353, 'recall': 0.984207154086629, 'f1': 0.9867458304472765}
Epoch 25/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0197
Epoch 25/30, Step 20/1,Classification Loss: 0.3185, Contrastive Loss: 0.0204
Epoch 25/30, Step 40/1,Classification Loss: 0.3387, Contrastive Loss: 0.0361
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 25/30, Step 80/1,Classification Loss: 0.3147, Contrastive Loss: 0.0204
Epoch 25/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0267
Epoch 25/30, Step 120/1,Classification Loss: 0.3168, Contrastive Loss: 0.0210
Epoch 25/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Accuracy: 0.9974, Precision: 0.9973, Recall: 0.9919, F1: 0.9946
Accuracy: 0.9919, Precision: 0.9892, Recall: 0.9774, F1: 0.9832
Epoch 25/30
Training - Loss: 48.3011
Training Metrics: {'accuracy': 0.9973958333333334, 'precision': 0.9973240507366171, 'recall': 0.9919463028754985, 'f1': 0.9946136820727647}
Validation Metrics: {'accuracy': 0.9919363746824257, 'precision': 0.9892436956451024, 'recall': 0.9773743934771753, 'f1': 0.9832019577029907}
Epoch 26/30, Step 0/1,Classification Loss: 0.3448, Contrastive Loss: 0.0690
Epoch 26/30, Step 20/1,Classification Loss: 0.3144, Contrastive Loss: 0.0195
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 80/1,Classification Loss: 0.3245, Contrastive Loss: 0.0214
Epoch 26/30, Step 100/1,Classification Loss: 0.3278, Contrastive Loss: 0.0204
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 26/30, Step 140/1,Classification Loss: 0.3460, Contrastive Loss: 0.0300
Accuracy: 0.9984, Precision: 0.9977, Recall: 0.9956, F1: 0.9966
Accuracy: 0.9936, Precision: 0.9884, Recall: 0.9852, F1: 0.9868
Epoch 26/30
Training - Loss: 48.5727
Training Metrics: {'accuracy': 0.998365469858156, 'precision': 0.99765062380249, 'recall': 0.9956145021504775, 'f1': 0.9966294902030339}
Validation Metrics: {'accuracy': 0.9935932839942561, 'precision': 0.9883740868647028, 'recall': 0.9851851137593146, 'f1': 0.9867718914748618}
Epoch 27/30, Step 0/1,Classification Loss: 0.3267, Contrastive Loss: 0.0214
Epoch 27/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.0222
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 27/30, Step 80/1,Classification Loss: 0.3535, Contrastive Loss: 0.0406
Epoch 27/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0181
Epoch 27/30, Step 120/1,Classification Loss: 0.3191, Contrastive Loss: 0.0204
Epoch 27/30, Step 140/1,Classification Loss: 0.3279, Contrastive Loss: 0.0209
Accuracy: 0.9979, Precision: 0.9977, Recall: 0.9939, F1: 0.9958
Accuracy: 0.9926, Precision: 0.9893, Recall: 0.9800, F1: 0.9846
Epoch 27/30
Training - Loss: 48.1499
Training Metrics: {'accuracy': 0.9979499113475178, 'precision': 0.997653602843013, 'recall': 0.993915780485141, 'f1': 0.9957743132341446}
Validation Metrics: {'accuracy': 0.9925991384071579, 'precision': 0.9893356119249068, 'recall': 0.9800423004094443, 'f1': 0.9846234165447101}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 20/1,Classification Loss: 0.3176, Contrastive Loss: 0.0189
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 60/1,Classification Loss: 0.3381, Contrastive Loss: 0.0226
Epoch 28/30, Step 80/1,Classification Loss: 0.3447, Contrastive Loss: 0.0335
Epoch 28/30, Step 100/1,Classification Loss: 0.3219, Contrastive Loss: 0.0184
Epoch 28/30, Step 120/1,Classification Loss: 0.3235, Contrastive Loss: 0.0196
Epoch 28/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Accuracy: 0.9984, Precision: 0.9978, Recall: 0.9957, F1: 0.9968
Accuracy: 0.9937, Precision: 0.9894, Recall: 0.9846, F1: 0.9870
Epoch 28/30
Training - Loss: 48.0761
Training Metrics: {'accuracy': 0.9984208776595744, 'precision': 0.9977685641784515, 'recall': 0.9957378292871901, 'f1': 0.9967501373075802}
Validation Metrics: {'accuracy': 0.9937037446150447, 'precision': 0.9893946162549443, 'recall': 0.9845974741490802, 'f1': 0.986978627877275}
Epoch 29/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0190
Epoch 29/30, Step 20/1,Classification Loss: 0.3269, Contrastive Loss: 0.0198
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 60/1,Classification Loss: 0.3472, Contrastive Loss: 0.0398
Epoch 29/30, Step 80/1,Classification Loss: 0.3173, Contrastive Loss: 0.0186
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 29/30, Step 120/1,Classification Loss: 0.3139, Contrastive Loss: 0.0185
Epoch 29/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Accuracy: 0.9979, Precision: 0.9977, Recall: 0.9935, F1: 0.9956
Accuracy: 0.9922, Precision: 0.9894, Recall: 0.9782, F1: 0.9837
Epoch 29/30
Training - Loss: 48.1329
Training Metrics: {'accuracy': 0.99786679964539, 'precision': 0.9976736439930602, 'recall': 0.9934701821273906, 'f1': 0.9955588619267307}
Validation Metrics: {'accuracy': 0.9921572959240031, 'precision': 0.9893824963849992, 'recall': 0.9781550336020777, 'f1': 0.9836730128909085}
Epoch 30/30, Step 0/1,Classification Loss: 0.3233, Contrastive Loss: 0.0182
Epoch 30/30, Step 20/1,Classification Loss: 0.3224, Contrastive Loss: 0.0182
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 60/1,Classification Loss: 0.3338, Contrastive Loss: 0.0208
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 30/30, Step 100/1,Classification Loss: 0.3270, Contrastive Loss: 0.0189
Epoch 30/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0271
Accuracy: 0.9978, Precision: 0.9977, Recall: 0.9933, F1: 0.9955
Accuracy: 0.9922, Precision: 0.9891, Recall: 0.9785, F1: 0.9837
Epoch 30/30
Training - Loss: 48.0295
Training Metrics: {'accuracy': 0.9978113918439716, 'precision': 0.9977340385619209, 'recall': 0.9932518676001134, 'f1': 0.9954780414954183}
Validation Metrics: {'accuracy': 0.9921572959240031, 'precision': 0.9890566225627886, 'recall': 0.9784810201596394, 'f1': 0.983683830067208}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1755, 5814), y shape: (1755,), y distribution: Counter({np.float64(0.0): 1559, np.float64(1.0): 196}), env shape: (1755,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9624, Precision: 0.8870, Recall: 0.9409, F1: 0.9115
month: 2021-11, f1 score is already high enough, skip active learning
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1772, 5814), y shape: (1772,), y distribution: Counter({np.float64(0.0): 1577, np.float64(1.0): 195}), env shape: (1772,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9515, Precision: 0.8599, Recall: 0.9166, F1: 0.8853
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11215]))
original train data shape: torch.Size([45362]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1772, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45362]), new train data shape: torch.Size([45362])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11215]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.6040
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.8204
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3804
Epoch 1/30, Step 60/1,Classification Loss: 0.3150, Contrastive Loss: 0.2543
Epoch 1/30, Step 80/1,Classification Loss: 0.3213, Contrastive Loss: 0.2062
Epoch 1/30, Step 100/1,Classification Loss: 0.3192, Contrastive Loss: 0.1739
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1561
Epoch 1/30, Step 140/1,Classification Loss: 0.3329, Contrastive Loss: 0.1594
Accuracy: 0.9976, Precision: 0.9936, Recall: 0.9966, F1: 0.9951
Accuracy: 0.9947, Precision: 0.9883, Recall: 0.9902, F1: 0.9892
Epoch 1/30
Training - Loss: 104.3037
Training Metrics: {'accuracy': 0.9975620567375887, 'precision': 0.9935526607327014, 'recall': 0.9965658159245463, 'f1': 0.9950524154426901}
Validation Metrics: {'accuracy': 0.9947095778684008, 'precision': 0.9882645548199389, 'recall': 0.9901501843925299, 'f1': 0.9892046698458932}
Epoch 2/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.1483
Epoch 2/30, Step 20/1,Classification Loss: 0.3256, Contrastive Loss: 0.1453
Epoch 2/30, Step 40/1,Classification Loss: 0.3182, Contrastive Loss: 0.1370
Epoch 2/30, Step 60/1,Classification Loss: 0.3243, Contrastive Loss: 0.1329
Epoch 2/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1254
Epoch 2/30, Step 100/1,Classification Loss: 0.3272, Contrastive Loss: 0.1288
Epoch 2/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.1210
Epoch 2/30, Step 140/1,Classification Loss: 0.3510, Contrastive Loss: 0.1370
Accuracy: 0.9974, Precision: 0.9965, Recall: 0.9928, F1: 0.9947
Accuracy: 0.9934, Precision: 0.9896, Recall: 0.9833, F1: 0.9864
Epoch 2/30
Training - Loss: 65.1209
Training Metrics: {'accuracy': 0.9973958333333334, 'precision': 0.9965208508994041, 'recall': 0.9928200302492431, 'f1': 0.9946602064592254}
Validation Metrics: {'accuracy': 0.9933869723355009, 'precision': 0.9895862750990698, 'recall': 0.9832585371823994, 'f1': 0.9863919642246495}
Epoch 3/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.1227
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1132
Epoch 3/30, Step 40/1,Classification Loss: 0.3230, Contrastive Loss: 0.1142
Epoch 3/30, Step 60/1,Classification Loss: 0.3286, Contrastive Loss: 0.1139
Epoch 3/30, Step 80/1,Classification Loss: 0.3494, Contrastive Loss: 0.1492
Epoch 3/30, Step 100/1,Classification Loss: 0.3186, Contrastive Loss: 0.1065
Epoch 3/30, Step 120/1,Classification Loss: 0.3279, Contrastive Loss: 0.1069
Epoch 3/30, Step 140/1,Classification Loss: 0.3224, Contrastive Loss: 0.1025
Accuracy: 0.9980, Precision: 0.9967, Recall: 0.9950, F1: 0.9959
Accuracy: 0.9935, Precision: 0.9893, Recall: 0.9840, F1: 0.9866
Epoch 3/30
Training - Loss: 61.7653
Training Metrics: {'accuracy': 0.9979776152482269, 'precision': 0.9967060507530092, 'recall': 0.9950159339635686, 'f1': 0.9958588619899699}
Validation Metrics: {'accuracy': 0.9934971894632426, 'precision': 0.9893404565038071, 'recall': 0.9839670590956153, 'f1': 0.9866318044268302}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0994
Epoch 4/30, Step 20/1,Classification Loss: 0.3140, Contrastive Loss: 0.0993
Epoch 4/30, Step 40/1,Classification Loss: 0.3160, Contrastive Loss: 0.0977
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0952
Epoch 4/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.1197
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0910
Epoch 4/30, Step 120/1,Classification Loss: 0.3329, Contrastive Loss: 0.0969
Epoch 4/30, Step 140/1,Classification Loss: 0.3203, Contrastive Loss: 0.0900
Accuracy: 0.9979, Precision: 0.9964, Recall: 0.9952, F1: 0.9958
Accuracy: 0.9939, Precision: 0.9899, Recall: 0.9852, F1: 0.9875
Epoch 4/30
Training - Loss: 59.6804
Training Metrics: {'accuracy': 0.9979222074468085, 'precision': 0.9963608476270627, 'recall': 0.9951596332507595, 'f1': 0.9957591618423256}
Validation Metrics: {'accuracy': 0.9939380579742092, 'precision': 0.9899360748018313, 'recall': 0.9851905310000193, 'f1': 0.9875462102197918}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0879
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0866
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0854
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0847
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0822
Epoch 5/30, Step 100/1,Classification Loss: 0.3363, Contrastive Loss: 0.0881
Epoch 5/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0818
Epoch 5/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0798
Accuracy: 0.9980, Precision: 0.9973, Recall: 0.9945, F1: 0.9959
Accuracy: 0.9940, Precision: 0.9913, Recall: 0.9843, F1: 0.9877
Epoch 5/30
Training - Loss: 58.1063
Training Metrics: {'accuracy': 0.9979776152482269, 'precision': 0.9972738908140473, 'recall': 0.9944583472063642, 'f1': 0.9958602057208198}
Validation Metrics: {'accuracy': 0.9940482751019508, 'precision': 0.9912751066425124, 'recall': 0.9842884371647758, 'f1': 0.9877447954239151}
Epoch 6/30, Step 0/1,Classification Loss: 0.3224, Contrastive Loss: 0.0845
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0773
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0769
Epoch 6/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0800
Epoch 6/30, Step 80/1,Classification Loss: 0.3309, Contrastive Loss: 0.0909
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0736
Epoch 6/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0718
Epoch 6/30, Step 140/1,Classification Loss: 0.3137, Contrastive Loss: 0.0724
Accuracy: 0.9963, Precision: 0.9967, Recall: 0.9882, F1: 0.9924
Accuracy: 0.9911, Precision: 0.9884, Recall: 0.9748, F1: 0.9815
Epoch 6/30
Training - Loss: 56.8159
Training Metrics: {'accuracy': 0.9963153812056738, 'precision': 0.9966945750868857, 'recall': 0.988202484976201, 'f1': 0.9923945859464385}
Validation Metrics: {'accuracy': 0.9910724126529262, 'precision': 0.988442894367707, 'recall': 0.9748220399987045, 'f1': 0.9814904565711557}
Epoch 7/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0767
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0699
Epoch 7/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0810
Epoch 7/30, Step 60/1,Classification Loss: 0.3211, Contrastive Loss: 0.0700
Epoch 7/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0678
Epoch 7/30, Step 100/1,Classification Loss: 0.3306, Contrastive Loss: 0.0865
Epoch 7/30, Step 120/1,Classification Loss: 0.3509, Contrastive Loss: 0.0778
Epoch 7/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0695
Accuracy: 0.9980, Precision: 0.9969, Recall: 0.9950, F1: 0.9959
Accuracy: 0.9937, Precision: 0.9901, Recall: 0.9841, F1: 0.9871
Epoch 7/30
Training - Loss: 55.8408
Training Metrics: {'accuracy': 0.9980053191489362, 'precision': 0.9968990489430887, 'recall': 0.9949830519430423, 'f1': 0.9959383033550799}
Validation Metrics: {'accuracy': 0.9937176237187259, 'precision': 0.9901124974226674, 'recall': 0.9840956103232794, 'f1': 0.9870765685842026}
Epoch 8/30, Step 0/1,Classification Loss: 0.3513, Contrastive Loss: 0.0746
Epoch 8/30, Step 20/1,Classification Loss: 0.3297, Contrastive Loss: 0.0703
Epoch 8/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0648
Epoch 8/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0637
Epoch 8/30, Step 80/1,Classification Loss: 0.3330, Contrastive Loss: 0.0693
Epoch 8/30, Step 100/1,Classification Loss: 0.3263, Contrastive Loss: 0.0645
Epoch 8/30, Step 120/1,Classification Loss: 0.3150, Contrastive Loss: 0.0620
Epoch 8/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0593
Accuracy: 0.9980, Precision: 0.9975, Recall: 0.9943, F1: 0.9959
Accuracy: 0.9934, Precision: 0.9899, Recall: 0.9829, F1: 0.9864
Epoch 8/30
Training - Loss: 54.9053
Training Metrics: {'accuracy': 0.9980053191489362, 'precision': 0.9975302537097493, 'recall': 0.9943024964351059, 'f1': 0.9959086144380934}
Validation Metrics: {'accuracy': 0.9933869723355009, 'precision': 0.9899035783188577, 'recall': 0.9829364140327076, 'f1': 0.9863831060265724}
Epoch 9/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0597
Epoch 9/30, Step 20/1,Classification Loss: 0.3196, Contrastive Loss: 0.0623
Epoch 9/30, Step 40/1,Classification Loss: 0.3286, Contrastive Loss: 0.0617
Epoch 9/30, Step 60/1,Classification Loss: 0.3252, Contrastive Loss: 0.0600
Epoch 9/30, Step 80/1,Classification Loss: 0.3502, Contrastive Loss: 0.0944
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0555
Epoch 9/30, Step 120/1,Classification Loss: 0.3350, Contrastive Loss: 0.0585
Epoch 9/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0695
Accuracy: 0.9982, Precision: 0.9975, Recall: 0.9951, F1: 0.9963
Accuracy: 0.9934, Precision: 0.9874, Recall: 0.9855, F1: 0.9865
Epoch 9/30
Training - Loss: 54.0402
Training Metrics: {'accuracy': 0.9981992464539007, 'precision': 0.9974748774810902, 'recall': 0.9951213821762365, 'f1': 0.9962940162279423}
Validation Metrics: {'accuracy': 0.9933869723355009, 'precision': 0.9873991730394093, 'recall': 0.9855133992302425, 'f1': 0.986453574864715}
Epoch 10/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0550
Epoch 10/30, Step 20/1,Classification Loss: 0.3160, Contrastive Loss: 0.0548
Epoch 10/30, Step 40/1,Classification Loss: 0.3140, Contrastive Loss: 0.0545
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Epoch 10/30, Step 80/1,Classification Loss: 0.3299, Contrastive Loss: 0.0700
Epoch 10/30, Step 100/1,Classification Loss: 0.3163, Contrastive Loss: 0.0535
Epoch 10/30, Step 120/1,Classification Loss: 0.3373, Contrastive Loss: 0.0565
Epoch 10/30, Step 140/1,Classification Loss: 0.3166, Contrastive Loss: 0.0518
Accuracy: 0.9981, Precision: 0.9975, Recall: 0.9950, F1: 0.9962
Accuracy: 0.9938, Precision: 0.9902, Recall: 0.9845, F1: 0.9873
Epoch 10/30
Training - Loss: 53.3344
Training Metrics: {'accuracy': 0.9981438386524822, 'precision': 0.9974512525826447, 'recall': 0.9949528034266744, 'f1': 0.9961973777061743}
Validation Metrics: {'accuracy': 0.9938278408464676, 'precision': 0.9901821514825853, 'recall': 0.9844820090868034, 'f1': 0.987307420974901}
Epoch 11/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 0.0508
Epoch 11/30, Step 20/1,Classification Loss: 0.3479, Contrastive Loss: 0.0559
Epoch 11/30, Step 40/1,Classification Loss: 0.3388, Contrastive Loss: 0.0601
Epoch 11/30, Step 60/1,Classification Loss: 0.3234, Contrastive Loss: 0.0523
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0474
Epoch 11/30, Step 100/1,Classification Loss: 0.3385, Contrastive Loss: 0.0663
Epoch 11/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.0478
Epoch 11/30, Step 140/1,Classification Loss: 0.3137, Contrastive Loss: 0.0469
Accuracy: 0.9982, Precision: 0.9977, Recall: 0.9949, F1: 0.9963
Accuracy: 0.9940, Precision: 0.9910, Recall: 0.9846, F1: 0.9878
Epoch 11/30
Training - Loss: 52.8926
Training Metrics: {'accuracy': 0.9981992464539007, 'precision': 0.9977267781473481, 'recall': 0.9949032734126907, 'f1': 0.9963090901358325}
Validation Metrics: {'accuracy': 0.9940482751019508, 'precision': 0.990956001483908, 'recall': 0.9846105603144677, 'f1': 0.9877527678021845}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0454
Epoch 12/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0466
Epoch 12/30, Step 40/1,Classification Loss: 0.3153, Contrastive Loss: 0.0488
Epoch 12/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0520
Epoch 12/30, Step 80/1,Classification Loss: 0.3265, Contrastive Loss: 0.0476
Epoch 12/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0436
Epoch 12/30, Step 120/1,Classification Loss: 0.3277, Contrastive Loss: 0.0470
Epoch 12/30, Step 140/1,Classification Loss: 0.3177, Contrastive Loss: 0.0452
Accuracy: 0.9982, Precision: 0.9977, Recall: 0.9950, F1: 0.9964
Accuracy: 0.9938, Precision: 0.9905, Recall: 0.9842, F1: 0.9873
Epoch 12/30
Training - Loss: 52.2516
Training Metrics: {'accuracy': 0.99822695035461, 'precision': 0.9977400376758164, 'recall': 0.9949893439173016, 'f1': 0.9963590646310851}
Validation Metrics: {'accuracy': 0.9938278408464676, 'precision': 0.9904994260222952, 'recall': 0.9841598859371117, 'f1': 0.9872991666096729}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0419
Epoch 13/30, Step 20/1,Classification Loss: 0.3329, Contrastive Loss: 0.0464
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0417
Epoch 13/30, Step 60/1,Classification Loss: 0.3187, Contrastive Loss: 0.0433
Epoch 13/30, Step 80/1,Classification Loss: 0.3145, Contrastive Loss: 0.0409
Epoch 13/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0400
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0390
Epoch 13/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0390
Accuracy: 0.9981, Precision: 0.9949, Recall: 0.9974, F1: 0.9961
Accuracy: 0.9944, Precision: 0.9874, Recall: 0.9896, F1: 0.9885
Epoch 13/30
Training - Loss: 51.5914
Training Metrics: {'accuracy': 0.9981161347517731, 'precision': 0.9949448523884268, 'recall': 0.9973569578103583, 'f1': 0.996146565911151}
Validation Metrics: {'accuracy': 0.9943789264851758, 'precision': 0.987439390025409, 'recall': 0.9896352344013417, 'f1': 0.9885336444731729}
Epoch 14/30, Step 0/1,Classification Loss: 0.3284, Contrastive Loss: 0.0439
Epoch 14/30, Step 20/1,Classification Loss: 0.3324, Contrastive Loss: 0.0436
Epoch 14/30, Step 40/1,Classification Loss: 0.3297, Contrastive Loss: 0.0449
Epoch 14/30, Step 60/1,Classification Loss: 0.3206, Contrastive Loss: 0.0401
Epoch 14/30, Step 80/1,Classification Loss: 0.3273, Contrastive Loss: 0.0421
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0368
Epoch 14/30, Step 120/1,Classification Loss: 0.3374, Contrastive Loss: 0.0414
Epoch 14/30, Step 140/1,Classification Loss: 0.3224, Contrastive Loss: 0.0382
Accuracy: 0.9983, Precision: 0.9975, Recall: 0.9956, F1: 0.9965
Accuracy: 0.9945, Precision: 0.9909, Recall: 0.9865, F1: 0.9887
Epoch 14/30
Training - Loss: 51.3636
Training Metrics: {'accuracy': 0.9983100620567376, 'precision': 0.9974648826955808, 'recall': 0.9956059391708165, 'f1': 0.9965328409376739}
Validation Metrics: {'accuracy': 0.9944891436129174, 'precision': 0.990915625401001, 'recall': 0.9864782785182553, 'f1': 0.9886820446157718}
Epoch 15/30, Step 0/1,Classification Loss: 0.3167, Contrastive Loss: 0.0367
Epoch 15/30, Step 20/1,Classification Loss: 0.3185, Contrastive Loss: 0.0375
Epoch 15/30, Step 40/1,Classification Loss: 0.3359, Contrastive Loss: 0.0412
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0347
Epoch 15/30, Step 80/1,Classification Loss: 0.3202, Contrastive Loss: 0.0367
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 15/30, Step 120/1,Classification Loss: 0.3174, Contrastive Loss: 0.0361
Epoch 15/30, Step 140/1,Classification Loss: 0.3316, Contrastive Loss: 0.0372
Accuracy: 0.9981, Precision: 0.9954, Recall: 0.9970, F1: 0.9962
Accuracy: 0.9942, Precision: 0.9894, Recall: 0.9866, F1: 0.9880
Epoch 15/30
Training - Loss: 50.7561
Training Metrics: {'accuracy': 0.9981161347517731, 'precision': 0.995352601172713, 'recall': 0.9969568375405383, 'f1': 0.9961527980523992}
Validation Metrics: {'accuracy': 0.9941584922296925, 'precision': 0.9894494473189323, 'recall': 0.9866075748264509, 'f1': 0.9880223804877704}
Epoch 16/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0342
Epoch 16/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0332
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0324
Epoch 16/30, Step 60/1,Classification Loss: 0.3234, Contrastive Loss: 0.0339
Epoch 16/30, Step 80/1,Classification Loss: 0.3263, Contrastive Loss: 0.0353
Epoch 16/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0325
Epoch 16/30, Step 120/1,Classification Loss: 0.3202, Contrastive Loss: 0.0334
Epoch 16/30, Step 140/1,Classification Loss: 0.3138, Contrastive Loss: 0.0317
Accuracy: 0.9981, Precision: 0.9956, Recall: 0.9967, F1: 0.9962
Accuracy: 0.9944, Precision: 0.9893, Recall: 0.9877, F1: 0.9885
Epoch 16/30
Training - Loss: 50.3647
Training Metrics: {'accuracy': 0.9981161347517731, 'precision': 0.9955967840617337, 'recall': 0.9967181453090836, 'f1': 0.9961565253594246}
Validation Metrics: {'accuracy': 0.9943789264851758, 'precision': 0.989279794163118, 'recall': 0.9877024955031906, 'f1': 0.9884892568461947}
Epoch 17/30, Step 0/1,Classification Loss: 0.3147, Contrastive Loss: 0.0321
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0303
Epoch 17/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0384
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0294
Epoch 17/30, Step 80/1,Classification Loss: 0.3164, Contrastive Loss: 0.0306
Epoch 17/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0351
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 17/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Accuracy: 0.9984, Precision: 0.9957, Recall: 0.9977, F1: 0.9967
Accuracy: 0.9945, Precision: 0.9894, Recall: 0.9881, F1: 0.9887
Epoch 17/30
Training - Loss: 50.1472
Training Metrics: {'accuracy': 0.998365469858156, 'precision': 0.9956648077571209, 'recall': 0.9976700168994532, 'f1': 0.9966644127643731}
Validation Metrics: {'accuracy': 0.9944891436129174, 'precision': 0.9893507216583152, 'recall': 0.9880888942667145, 'f1': 0.9887186000828405}
Epoch 18/30, Step 0/1,Classification Loss: 0.3273, Contrastive Loss: 0.0310
Epoch 18/30, Step 20/1,Classification Loss: 0.3209, Contrastive Loss: 0.0308
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 18/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0336
Epoch 18/30, Step 120/1,Classification Loss: 0.3257, Contrastive Loss: 0.0305
Epoch 18/30, Step 140/1,Classification Loss: 0.3155, Contrastive Loss: 0.0279
Accuracy: 0.9983, Precision: 0.9971, Recall: 0.9958, F1: 0.9965
Accuracy: 0.9935, Precision: 0.9875, Recall: 0.9859, F1: 0.9867
Epoch 18/30
Training - Loss: 49.6500
Training Metrics: {'accuracy': 0.9982823581560284, 'precision': 0.9971113337619876, 'recall': 0.9958091400014999, 'f1': 0.9964589793579891}
Validation Metrics: {'accuracy': 0.9934971894632426, 'precision': 0.9874712664756813, 'recall': 0.9858997979937664, 'f1': 0.9866836500769705}
Epoch 19/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0275
Epoch 19/30, Step 20/1,Classification Loss: 0.3295, Contrastive Loss: 0.0371
Epoch 19/30, Step 40/1,Classification Loss: 0.3376, Contrastive Loss: 0.0441
Epoch 19/30, Step 60/1,Classification Loss: 0.3257, Contrastive Loss: 0.0286
Epoch 19/30, Step 80/1,Classification Loss: 0.3190, Contrastive Loss: 0.0275
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0255
Epoch 19/30, Step 120/1,Classification Loss: 0.3518, Contrastive Loss: 0.0431
Epoch 19/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0257
Accuracy: 0.9982, Precision: 0.9955, Recall: 0.9971, F1: 0.9963
Accuracy: 0.9935, Precision: 0.9853, Recall: 0.9882, F1: 0.9867
Epoch 19/30
Training - Loss: 49.5524
Training Metrics: {'accuracy': 0.9981715425531915, 'precision': 0.9954512303541321, 'recall': 0.9970627302589024, 'f1': 0.9962550456143108}
Validation Metrics: {'accuracy': 0.9934971894632426, 'precision': 0.9853444333490381, 'recall': 0.9881546600416093, 'f1': 0.98674351119703}
Epoch 20/30, Step 0/1,Classification Loss: 0.3442, Contrastive Loss: 0.0391
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0252
Epoch 20/30, Step 40/1,Classification Loss: 0.3224, Contrastive Loss: 0.0270
Epoch 20/30, Step 60/1,Classification Loss: 0.3307, Contrastive Loss: 0.0283
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 20/30, Step 100/1,Classification Loss: 0.3160, Contrastive Loss: 0.0249
Epoch 20/30, Step 120/1,Classification Loss: 0.3139, Contrastive Loss: 0.0248
Epoch 20/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0242
Accuracy: 0.9984, Precision: 0.9957, Recall: 0.9976, F1: 0.9967
Accuracy: 0.9943, Precision: 0.9871, Recall: 0.9896, F1: 0.9883
Epoch 20/30
Training - Loss: 49.1718
Training Metrics: {'accuracy': 0.998365469858156, 'precision': 0.9957437989805578, 'recall': 0.9975890285429372, 'f1': 0.9966638739826295}
Validation Metrics: {'accuracy': 0.9942687093574342, 'precision': 0.9870637434346178, 'recall': 0.9895709587875097, 'f1': 0.9883125659560342}
Epoch 21/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0346
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 21/30, Step 60/1,Classification Loss: 0.3505, Contrastive Loss: 0.0402
Epoch 21/30, Step 80/1,Classification Loss: 0.3317, Contrastive Loss: 0.0352
Epoch 21/30, Step 100/1,Classification Loss: 0.3462, Contrastive Loss: 0.0304
Epoch 21/30, Step 120/1,Classification Loss: 0.3203, Contrastive Loss: 0.0258
Epoch 21/30, Step 140/1,Classification Loss: 0.3213, Contrastive Loss: 0.0231
Accuracy: 0.9984, Precision: 0.9975, Recall: 0.9959, F1: 0.9967
Accuracy: 0.9943, Precision: 0.9892, Recall: 0.9873, F1: 0.9883
Epoch 21/30
Training - Loss: 49.1611
Training Metrics: {'accuracy': 0.9983931737588653, 'precision': 0.9975139847583335, 'recall': 0.9958971526660034, 'f1': 0.9967036252356851}
Validation Metrics: {'accuracy': 0.9942687093574342, 'precision': 0.9892088723736122, 'recall': 0.9873160967396666, 'f1': 0.9882597648827529}
Epoch 22/30, Step 0/1,Classification Loss: 0.3347, Contrastive Loss: 0.0258
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 22/30, Step 40/1,Classification Loss: 0.3241, Contrastive Loss: 0.0239
Epoch 22/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0381
Epoch 22/30, Step 80/1,Classification Loss: 0.3296, Contrastive Loss: 0.0265
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 22/30, Step 120/1,Classification Loss: 0.3217, Contrastive Loss: 0.0239
Epoch 22/30, Step 140/1,Classification Loss: 0.3155, Contrastive Loss: 0.0219
Accuracy: 0.9981, Precision: 0.9977, Recall: 0.9945, F1: 0.9961
Accuracy: 0.9943, Precision: 0.9917, Recall: 0.9847, F1: 0.9882
Epoch 22/30
Training - Loss: 48.7604
Training Metrics: {'accuracy': 0.9980884308510638, 'precision': 0.9976606692090926, 'recall': 0.9945129027622241, 'f1': 0.9960794078026636}
Validation Metrics: {'accuracy': 0.9942687093574342, 'precision': 0.9917322827503973, 'recall': 0.9847391115421319, 'f1': 0.9881986918896961}
Epoch 23/30, Step 0/1,Classification Loss: 0.3315, Contrastive Loss: 0.0248
Epoch 23/30, Step 20/1,Classification Loss: 0.3162, Contrastive Loss: 0.0220
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 60/1,Classification Loss: 0.3263, Contrastive Loss: 0.0243
Epoch 23/30, Step 80/1,Classification Loss: 0.3282, Contrastive Loss: 0.0228
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 23/30, Step 140/1,Classification Loss: 0.3206, Contrastive Loss: 0.0226
Accuracy: 0.9983, Precision: 0.9978, Recall: 0.9952, F1: 0.9965
Accuracy: 0.9937, Precision: 0.9904, Recall: 0.9838, F1: 0.9871
Epoch 23/30
Training - Loss: 48.6991
Training Metrics: {'accuracy': 0.9982823581560284, 'precision': 0.9977693993738843, 'recall': 0.9951724721238042, 'f1': 0.9964659284221267}
Validation Metrics: {'accuracy': 0.9937176237187259, 'precision': 0.990430086410055, 'recall': 0.9837734871735877, 'f1': 0.9870681600617415}
Epoch 24/30, Step 0/1,Classification Loss: 0.3174, Contrastive Loss: 0.0215
Epoch 24/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0204
Epoch 24/30, Step 40/1,Classification Loss: 0.3423, Contrastive Loss: 0.0297
Epoch 24/30, Step 60/1,Classification Loss: 0.3462, Contrastive Loss: 0.0279
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 100/1,Classification Loss: 0.3318, Contrastive Loss: 0.0277
Epoch 24/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0285
Epoch 24/30, Step 140/1,Classification Loss: 0.3326, Contrastive Loss: 0.0226
Accuracy: 0.9980, Precision: 0.9955, Recall: 0.9964, F1: 0.9960
Accuracy: 0.9938, Precision: 0.9896, Recall: 0.9851, F1: 0.9873
Epoch 24/30
Training - Loss: 48.6109
Training Metrics: {'accuracy': 0.9980330230496454, 'precision': 0.9955467799793697, 'recall': 0.9964276523784151, 'f1': 0.9959866363466776}
Validation Metrics: {'accuracy': 0.9938278408464676, 'precision': 0.9895512699698448, 'recall': 0.9851262553861871, 'f1': 0.9873238899696644}
Epoch 25/30, Step 0/1,Classification Loss: 0.3178, Contrastive Loss: 0.0214
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 25/30, Step 40/1,Classification Loss: 0.3202, Contrastive Loss: 0.0219
Epoch 25/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0201
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 25/30, Step 140/1,Classification Loss: 0.3284, Contrastive Loss: 0.0215
Accuracy: 0.9983, Precision: 0.9977, Recall: 0.9955, F1: 0.9966
Accuracy: 0.9934, Precision: 0.9893, Recall: 0.9836, F1: 0.9864
Epoch 25/30
Training - Loss: 48.6745
Training Metrics: {'accuracy': 0.9983377659574468, 'precision': 0.9977334530879525, 'recall': 0.9954859988359309, 'f1': 0.9966059587288995}
Validation Metrics: {'accuracy': 0.9933869723355009, 'precision': 0.9892701979661819, 'recall': 0.9835806603320913, 'f1': 0.986400808187394}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 20/1,Classification Loss: 0.3147, Contrastive Loss: 0.0200
Epoch 26/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0193
Epoch 26/30, Step 60/1,Classification Loss: 0.3178, Contrastive Loss: 0.0206
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 26/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0187
Accuracy: 0.9977, Precision: 0.9974, Recall: 0.9932, F1: 0.9953
Accuracy: 0.9924, Precision: 0.9890, Recall: 0.9798, F1: 0.9843
Epoch 26/30
Training - Loss: 48.2816
Training Metrics: {'accuracy': 0.997728280141844, 'precision': 0.9974432784902116, 'recall': 0.9932288493276573, 'f1': 0.9953228467232802}
Validation Metrics: {'accuracy': 0.9923950181858261, 'precision': 0.9889570542830299, 'recall': 0.9797809483106839, 'f1': 0.9843047882132817}
Epoch 27/30, Step 0/1,Classification Loss: 0.3263, Contrastive Loss: 0.0191
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 27/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0186
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0185
Epoch 27/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0179
Epoch 27/30, Step 140/1,Classification Loss: 0.3344, Contrastive Loss: 0.0234
Accuracy: 0.9979, Precision: 0.9956, Recall: 0.9960, F1: 0.9958
Accuracy: 0.9933, Precision: 0.9867, Recall: 0.9858, F1: 0.9862
Epoch 27/30
Training - Loss: 48.3967
Training Metrics: {'accuracy': 0.9979222074468085, 'precision': 0.9955546790015639, 'recall': 0.9959556546668515, 'f1': 0.9957550467209465}
Validation Metrics: {'accuracy': 0.9932767552077593, 'precision': 0.9867123698634419, 'recall': 0.9857712467661022, 'f1': 0.9862411322657683}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 28/30, Step 40/1,Classification Loss: 0.3302, Contrastive Loss: 0.0334
Epoch 28/30, Step 60/1,Classification Loss: 0.3198, Contrastive Loss: 0.0195
Epoch 28/30, Step 80/1,Classification Loss: 0.3150, Contrastive Loss: 0.0193
Epoch 28/30, Step 100/1,Classification Loss: 0.3276, Contrastive Loss: 0.0224
Epoch 28/30, Step 120/1,Classification Loss: 0.3181, Contrastive Loss: 0.0184
Epoch 28/30, Step 140/1,Classification Loss: 0.3250, Contrastive Loss: 0.0184
Accuracy: 0.9978, Precision: 0.9976, Recall: 0.9934, F1: 0.9955
Accuracy: 0.9924, Precision: 0.9886, Recall: 0.9801, F1: 0.9843
Epoch 28/30
Training - Loss: 48.3542
Training Metrics: {'accuracy': 0.9977836879432624, 'precision': 0.9975630322020117, 'recall': 0.9933697411074527, 'f1': 0.9954532761871518}
Validation Metrics: {'accuracy': 0.9923950181858261, 'precision': 0.9886381491500376, 'recall': 0.9801030714603758, 'f1': 0.9843150327391813}
Epoch 29/30, Step 0/1,Classification Loss: 0.3218, Contrastive Loss: 0.0207
Epoch 29/30, Step 20/1,Classification Loss: 0.3173, Contrastive Loss: 0.0186
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0176
Epoch 29/30, Step 80/1,Classification Loss: 0.3193, Contrastive Loss: 0.0186
Epoch 29/30, Step 100/1,Classification Loss: 0.3297, Contrastive Loss: 0.0227
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 29/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Accuracy: 0.9983, Precision: 0.9978, Recall: 0.9954, F1: 0.9966
Accuracy: 0.9934, Precision: 0.9890, Recall: 0.9839, F1: 0.9864
Epoch 29/30
Training - Loss: 48.2920
Training Metrics: {'accuracy': 0.9983377659574468, 'precision': 0.9978093125276665, 'recall': 0.9953903906556103, 'f1': 0.9965954960130098}
Validation Metrics: {'accuracy': 0.9933869723355009, 'precision': 0.9889553413417573, 'recall': 0.9839027834817832, 'f1': 0.9864096379478419}
Epoch 30/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0343
Epoch 30/30, Step 20/1,Classification Loss: 0.3218, Contrastive Loss: 0.0185
Epoch 30/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.0312
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0166
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 100/1,Classification Loss: 0.3174, Contrastive Loss: 0.0177
Epoch 30/30, Step 120/1,Classification Loss: 0.3436, Contrastive Loss: 0.0244
Epoch 30/30, Step 140/1,Classification Loss: 0.3250, Contrastive Loss: 0.0209
Accuracy: 0.9982, Precision: 0.9977, Recall: 0.9950, F1: 0.9964
Accuracy: 0.9931, Precision: 0.9894, Recall: 0.9821, F1: 0.9857
Epoch 30/30
Training - Loss: 48.0091
Training Metrics: {'accuracy': 0.99822695035461, 'precision': 0.9977491517384687, 'recall': 0.9950213321779616, 'f1': 0.9963796893108261}
Validation Metrics: {'accuracy': 0.993056320952276, 'precision': 0.9893764757205832, 'recall': 0.9820993408918276, 'f1': 0.985697605157879}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1510, 5814), y shape: (1510,), y distribution: Counter({np.float64(0.0): 1363, np.float64(1.0): 147}), env shape: (1510,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9000, Precision: 0.4512, Recall: 0.4985, F1: 0.4737
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11315]))
original train data shape: torch.Size([45462]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1510, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45462]), new train data shape: torch.Size([45462])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11315]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3298, Contrastive Loss: 1.5697
Epoch 1/30, Step 20/1,Classification Loss: 0.3361, Contrastive Loss: 0.6832
Epoch 1/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.3022
Epoch 1/30, Step 60/1,Classification Loss: 0.3295, Contrastive Loss: 0.2517
Epoch 1/30, Step 80/1,Classification Loss: 0.3443, Contrastive Loss: 0.1839
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1455
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1342
Epoch 1/30, Step 140/1,Classification Loss: 0.3364, Contrastive Loss: 0.1620
Accuracy: 0.9960, Precision: 0.9943, Recall: 0.9892, F1: 0.9918
Accuracy: 0.9916, Precision: 0.9855, Recall: 0.9805, F1: 0.9830
Epoch 1/30
Training - Loss: 99.0655
Training Metrics: {'accuracy': 0.9959837147887324, 'precision': 0.994323841612812, 'recall': 0.9892380947015644, 'f1': 0.9917615138675255}
Validation Metrics: {'accuracy': 0.9916419223578576, 'precision': 0.9854675141928284, 'recall': 0.9805286152930515, 'f1': 0.9829792411508151}
Epoch 2/30, Step 0/1,Classification Loss: 0.3512, Contrastive Loss: 0.1668
Epoch 2/30, Step 20/1,Classification Loss: 0.3446, Contrastive Loss: 0.1848
Epoch 2/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.1537
Epoch 2/30, Step 60/1,Classification Loss: 0.3332, Contrastive Loss: 0.1299
Epoch 2/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.2023
Epoch 2/30, Step 100/1,Classification Loss: 0.3191, Contrastive Loss: 0.1104
Epoch 2/30, Step 120/1,Classification Loss: 0.3441, Contrastive Loss: 0.1503
Epoch 2/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.1025
Accuracy: 0.9963, Precision: 0.9965, Recall: 0.9884, F1: 0.9924
Accuracy: 0.9914, Precision: 0.9869, Recall: 0.9782, F1: 0.9825
Epoch 2/30
Training - Loss: 66.4995
Training Metrics: {'accuracy': 0.9963138204225352, 'precision': 0.9965427513155674, 'recall': 0.9883948666833036, 'f1': 0.9924190381824018}
Validation Metrics: {'accuracy': 0.9914219729462224, 'precision': 0.9868641238773961, 'recall': 0.9781801516966632, 'f1': 0.9824640218398776}
Epoch 3/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.1751
Epoch 3/30, Step 20/1,Classification Loss: 0.3452, Contrastive Loss: 0.1267
Epoch 3/30, Step 40/1,Classification Loss: 0.3253, Contrastive Loss: 0.1012
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0967
Epoch 3/30, Step 80/1,Classification Loss: 0.3263, Contrastive Loss: 0.0984
Epoch 3/30, Step 100/1,Classification Loss: 0.3342, Contrastive Loss: 0.0987
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0906
Epoch 3/30, Step 140/1,Classification Loss: 0.3350, Contrastive Loss: 0.0945
Accuracy: 0.9964, Precision: 0.9968, Recall: 0.9886, F1: 0.9926
Accuracy: 0.9918, Precision: 0.9896, Recall: 0.9768, F1: 0.9831
Epoch 3/30
Training - Loss: 63.5501
Training Metrics: {'accuracy': 0.9963963468309859, 'precision': 0.996763032696708, 'recall': 0.988608760558148, 'f1': 0.9926358717934196}
Validation Metrics: {'accuracy': 0.9917518970636754, 'precision': 0.9896000688460536, 'recall': 0.976787217112541, 'f1': 0.9830676718349817}
Epoch 4/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.0944
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0870
Epoch 4/30, Step 40/1,Classification Loss: 0.3410, Contrastive Loss: 0.1259
Epoch 4/30, Step 60/1,Classification Loss: 0.3265, Contrastive Loss: 0.0878
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0832
Epoch 4/30, Step 100/1,Classification Loss: 0.3300, Contrastive Loss: 0.0890
Epoch 4/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.1338
Epoch 4/30, Step 140/1,Classification Loss: 0.3307, Contrastive Loss: 0.0930
Accuracy: 0.9965, Precision: 0.9947, Recall: 0.9911, F1: 0.9929
Accuracy: 0.9923, Precision: 0.9844, Recall: 0.9844, F1: 0.9844
Epoch 4/30
Training - Loss: 61.7397
Training Metrics: {'accuracy': 0.9964788732394366, 'precision': 0.9946755208202571, 'recall': 0.9910799998406832, 'f1': 0.9928679828409626}
Validation Metrics: {'accuracy': 0.9923017705927637, 'precision': 0.984402631902407, 'recall': 0.984402631902407, 'f1': 0.984402631902407}
Epoch 5/30, Step 0/1,Classification Loss: 0.3512, Contrastive Loss: 0.1074
Epoch 5/30, Step 20/1,Classification Loss: 0.3432, Contrastive Loss: 0.0843
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0772
Epoch 5/30, Step 60/1,Classification Loss: 0.3442, Contrastive Loss: 0.1033
Epoch 5/30, Step 80/1,Classification Loss: 0.3275, Contrastive Loss: 0.0779
Epoch 5/30, Step 100/1,Classification Loss: 0.3157, Contrastive Loss: 0.0755
Epoch 5/30, Step 120/1,Classification Loss: 0.3221, Contrastive Loss: 0.0739
Epoch 5/30, Step 140/1,Classification Loss: 0.3141, Contrastive Loss: 0.0732
Accuracy: 0.9964, Precision: 0.9966, Recall: 0.9887, F1: 0.9926
Accuracy: 0.9920, Precision: 0.9866, Recall: 0.9807, F1: 0.9836
Epoch 5/30
Training - Loss: 60.0161
Training Metrics: {'accuracy': 0.996368838028169, 'precision': 0.9965831257690512, 'recall': 0.9886551927227321, 'f1': 0.9925718969146359}
Validation Metrics: {'accuracy': 0.9919718464753107, 'precision': 0.9866027436349154, 'recall': 0.980721367798834, 'f1': 0.9836354219257769}
Epoch 6/30, Step 0/1,Classification Loss: 0.3474, Contrastive Loss: 0.0815
Epoch 6/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0715
Epoch 6/30, Step 40/1,Classification Loss: 0.3432, Contrastive Loss: 0.1078
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0687
Epoch 6/30, Step 80/1,Classification Loss: 0.3287, Contrastive Loss: 0.0709
Epoch 6/30, Step 100/1,Classification Loss: 0.3416, Contrastive Loss: 0.0720
Epoch 6/30, Step 120/1,Classification Loss: 0.3338, Contrastive Loss: 0.0815
Epoch 6/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0656
Accuracy: 0.9964, Precision: 0.9965, Recall: 0.9889, F1: 0.9927
Accuracy: 0.9916, Precision: 0.9861, Recall: 0.9799, F1: 0.9830
Epoch 6/30
Training - Loss: 58.4802
Training Metrics: {'accuracy': 0.9964238556338029, 'precision': 0.996532397357175, 'recall': 0.9889073421486574, 'f1': 0.9926761912713222}
Validation Metrics: {'accuracy': 0.9916419223578576, 'precision': 0.9860795589365058, 'recall': 0.9798943404570896, 'f1': 0.9829574509893668}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0658
Epoch 7/30, Step 20/1,Classification Loss: 0.3251, Contrastive Loss: 0.0664
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0636
Epoch 7/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0663
Epoch 7/30, Step 80/1,Classification Loss: 0.3354, Contrastive Loss: 0.0672
Epoch 7/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0616
Epoch 7/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0640
Epoch 7/30, Step 140/1,Classification Loss: 0.3418, Contrastive Loss: 0.0785
Accuracy: 0.9962, Precision: 0.9967, Recall: 0.9878, F1: 0.9922
Accuracy: 0.9919, Precision: 0.9884, Recall: 0.9784, F1: 0.9833
Epoch 7/30
Training - Loss: 57.5739
Training Metrics: {'accuracy': 0.9962037852112676, 'precision': 0.9967222551750272, 'recall': 0.9877582707070671, 'f1': 0.9921800517543817}
Validation Metrics: {'accuracy': 0.991861871769493, 'precision': 0.9883991124368703, 'recall': 0.9784371550377066, 'f1': 0.983341882533983}
Epoch 8/30, Step 0/1,Classification Loss: 0.3139, Contrastive Loss: 0.0603
Epoch 8/30, Step 20/1,Classification Loss: 0.3231, Contrastive Loss: 0.0608
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0585
Epoch 8/30, Step 60/1,Classification Loss: 0.3337, Contrastive Loss: 0.0791
Epoch 8/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0877
Epoch 8/30, Step 100/1,Classification Loss: 0.3253, Contrastive Loss: 0.0587
Epoch 8/30, Step 120/1,Classification Loss: 0.3306, Contrastive Loss: 0.0582
Epoch 8/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0554
Accuracy: 0.9964, Precision: 0.9966, Recall: 0.9888, F1: 0.9927
Accuracy: 0.9922, Precision: 0.9889, Recall: 0.9793, F1: 0.9840
Epoch 8/30
Training - Loss: 56.1021
Training Metrics: {'accuracy': 0.9963963468309859, 'precision': 0.9966083584229932, 'recall': 0.9888276746273623, 'f1': 0.9926723286998966}
Validation Metrics: {'accuracy': 0.992191795886946, 'precision': 0.9889237088826315, 'recall': 0.979264182379451, 'f1': 0.9840223557288659}
Epoch 9/30, Step 0/1,Classification Loss: 0.3353, Contrastive Loss: 0.0620
Epoch 9/30, Step 20/1,Classification Loss: 0.3204, Contrastive Loss: 0.0555
Epoch 9/30, Step 40/1,Classification Loss: 0.3575, Contrastive Loss: 0.0716
Epoch 9/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0532
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0525
Epoch 9/30, Step 100/1,Classification Loss: 0.3425, Contrastive Loss: 0.0544
Epoch 9/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0672
Epoch 9/30, Step 140/1,Classification Loss: 0.3185, Contrastive Loss: 0.0511
Accuracy: 0.9964, Precision: 0.9965, Recall: 0.9890, F1: 0.9927
Accuracy: 0.9912, Precision: 0.9852, Recall: 0.9790, F1: 0.9821
Epoch 9/30
Training - Loss: 55.2019
Training Metrics: {'accuracy': 0.9964238556338029, 'precision': 0.9965434365801626, 'recall': 0.9889932999294482, 'f1': 0.992725363968247}
Validation Metrics: {'accuracy': 0.9912020235345871, 'precision': 0.9851767933344864, 'recall': 0.9790030622800843, 'f1': 0.9820604747256494}
Epoch 10/30, Step 0/1,Classification Loss: 0.3310, Contrastive Loss: 0.0543
Epoch 10/30, Step 20/1,Classification Loss: 0.3183, Contrastive Loss: 0.0510
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0489
Epoch 10/30, Step 60/1,Classification Loss: 0.3184, Contrastive Loss: 0.0491
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0483
Epoch 10/30, Step 100/1,Classification Loss: 0.3559, Contrastive Loss: 0.0647
Epoch 10/30, Step 120/1,Classification Loss: 0.3276, Contrastive Loss: 0.0479
Epoch 10/30, Step 140/1,Classification Loss: 0.3373, Contrastive Loss: 0.0511
Accuracy: 0.9962, Precision: 0.9965, Recall: 0.9881, F1: 0.9922
Accuracy: 0.9919, Precision: 0.9881, Recall: 0.9788, F1: 0.9834
Epoch 10/30
Training - Loss: 54.4278
Training Metrics: {'accuracy': 0.9962312940140845, 'precision': 0.9964940204204464, 'recall': 0.9881063496607994, 'f1': 0.9922474288123488}
Validation Metrics: {'accuracy': 0.991861871769493, 'precision': 0.988084745620441, 'recall': 0.9787542924556876, 'f1': 0.9833526011903914}
Epoch 11/30, Step 0/1,Classification Loss: 0.3593, Contrastive Loss: 0.0625
Epoch 11/30, Step 20/1,Classification Loss: 0.3280, Contrastive Loss: 0.0479
Epoch 11/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0490
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0443
Epoch 11/30, Step 80/1,Classification Loss: 0.3446, Contrastive Loss: 0.0497
Epoch 11/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0435
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0427
Epoch 11/30, Step 140/1,Classification Loss: 0.3292, Contrastive Loss: 0.0450
Accuracy: 0.9944, Precision: 0.9954, Recall: 0.9820, F1: 0.9886
Accuracy: 0.9899, Precision: 0.9881, Recall: 0.9706, F1: 0.9791
Epoch 11/30
Training - Loss: 53.5829
Training Metrics: {'accuracy': 0.9944432218309859, 'precision': 0.9954489187845333, 'recall': 0.9819913934642134, 'f1': 0.9885830915153486}
Validation Metrics: {'accuracy': 0.9898823270647751, 'precision': 0.9881080932712121, 'recall': 0.9706207542254113, 'f1': 0.9791283234017583}
Epoch 12/30, Step 0/1,Classification Loss: 0.3148, Contrastive Loss: 0.0435
Epoch 12/30, Step 20/1,Classification Loss: 0.3446, Contrastive Loss: 0.0542
Epoch 12/30, Step 40/1,Classification Loss: 0.3348, Contrastive Loss: 0.0435
Epoch 12/30, Step 60/1,Classification Loss: 0.3446, Contrastive Loss: 0.0655
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0401
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Epoch 12/30, Step 120/1,Classification Loss: 0.3309, Contrastive Loss: 0.0406
Epoch 12/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0394
Accuracy: 0.9962, Precision: 0.9945, Recall: 0.9901, F1: 0.9923
Accuracy: 0.9914, Precision: 0.9869, Recall: 0.9782, F1: 0.9825
Epoch 12/30
Training - Loss: 52.9187
Training Metrics: {'accuracy': 0.9962037852112676, 'precision': 0.9944873014971038, 'recall': 0.990080126478639, 'f1': 0.9922690546799684}
Validation Metrics: {'accuracy': 0.9914219729462224, 'precision': 0.9868641238773961, 'recall': 0.9781801516966632, 'f1': 0.9824640218398776}
Epoch 13/30, Step 0/1,Classification Loss: 0.3362, Contrastive Loss: 0.0542
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0385
Epoch 13/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0425
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0384
Epoch 13/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 13/30, Step 100/1,Classification Loss: 0.3266, Contrastive Loss: 0.0384
Epoch 13/30, Step 120/1,Classification Loss: 0.3440, Contrastive Loss: 0.0404
Epoch 13/30, Step 140/1,Classification Loss: 0.3300, Contrastive Loss: 0.0402
Accuracy: 0.9969, Precision: 0.9968, Recall: 0.9906, F1: 0.9937
Accuracy: 0.9921, Precision: 0.9876, Recall: 0.9802, F1: 0.9838
Epoch 13/30
Training - Loss: 52.3691
Training Metrics: {'accuracy': 0.9968915052816901, 'precision': 0.9968154742197347, 'recall': 0.9905751766796012, 'f1': 0.9936660437407305}
Validation Metrics: {'accuracy': 0.9920818211811283, 'precision': 0.9876014326437078, 'recall': 0.9801513437981331, 'f1': 0.9838337182448036}
Epoch 14/30, Step 0/1,Classification Loss: 0.3363, Contrastive Loss: 0.0402
Epoch 14/30, Step 20/1,Classification Loss: 0.3441, Contrastive Loss: 0.0436
Epoch 14/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0475
Epoch 14/30, Step 60/1,Classification Loss: 0.3597, Contrastive Loss: 0.0439
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0338
Epoch 14/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0348
Epoch 14/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Accuracy: 0.9969, Precision: 0.9968, Recall: 0.9904, F1: 0.9936
Accuracy: 0.9916, Precision: 0.9870, Recall: 0.9789, F1: 0.9829
Epoch 14/30
Training - Loss: 51.9721
Training Metrics: {'accuracy': 0.9968639964788732, 'precision': 0.9967891413581216, 'recall': 0.9904144782296636, 'f1': 0.9935713638970212}
Validation Metrics: {'accuracy': 0.9916419223578576, 'precision': 0.9870064923933151, 'recall': 0.9789429282031468, 'f1': 0.9829246356213882}
Epoch 15/30, Step 0/1,Classification Loss: 0.3497, Contrastive Loss: 0.0555
Epoch 15/30, Step 20/1,Classification Loss: 0.3444, Contrastive Loss: 0.0450
Epoch 15/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0326
Epoch 15/30, Step 60/1,Classification Loss: 0.3307, Contrastive Loss: 0.0471
Epoch 15/30, Step 80/1,Classification Loss: 0.3395, Contrastive Loss: 0.0388
Epoch 15/30, Step 100/1,Classification Loss: 0.3260, Contrastive Loss: 0.0329
Epoch 15/30, Step 120/1,Classification Loss: 0.3439, Contrastive Loss: 0.0458
Epoch 15/30, Step 140/1,Classification Loss: 0.3320, Contrastive Loss: 0.0334
Accuracy: 0.9971, Precision: 0.9970, Recall: 0.9911, F1: 0.9940
Accuracy: 0.9920, Precision: 0.9863, Recall: 0.9810, F1: 0.9836
Epoch 15/30
Training - Loss: 51.2572
Training Metrics: {'accuracy': 0.9970840669014085, 'precision': 0.9970028520820319, 'recall': 0.9911190523200657, 'f1': 0.9940350081284197}
Validation Metrics: {'accuracy': 0.9919718464753107, 'precision': 0.9862958493668095, 'recall': 0.9810385052168149, 'f1': 0.9836458869327658}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0315
Epoch 16/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0326
Epoch 16/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0321
Epoch 16/30, Step 60/1,Classification Loss: 0.3434, Contrastive Loss: 0.0430
Epoch 16/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0352
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0290
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Epoch 16/30, Step 140/1,Classification Loss: 0.3403, Contrastive Loss: 0.0328
Accuracy: 0.9958, Precision: 0.9963, Recall: 0.9867, F1: 0.9914
Accuracy: 0.9910, Precision: 0.9888, Recall: 0.9744, F1: 0.9815
Epoch 16/30
Training - Loss: 50.9004
Training Metrics: {'accuracy': 0.995818661971831, 'precision': 0.9962547973881958, 'recall': 0.9867087435336891, 'f1': 0.9914132308970051}
Validation Metrics: {'accuracy': 0.9909820741229517, 'precision': 0.988797485867091, 'recall': 0.9744346367578294, 'f1': 0.9814573294710749}
Epoch 17/30, Step 0/1,Classification Loss: 0.3301, Contrastive Loss: 0.0325
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0284
Epoch 17/30, Step 60/1,Classification Loss: 0.3224, Contrastive Loss: 0.0280
Epoch 17/30, Step 80/1,Classification Loss: 0.3177, Contrastive Loss: 0.0282
Epoch 17/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 17/30, Step 120/1,Classification Loss: 0.3161, Contrastive Loss: 0.0278
Epoch 17/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0267
Accuracy: 0.9963, Precision: 0.9963, Recall: 0.9885, F1: 0.9923
Accuracy: 0.9911, Precision: 0.9879, Recall: 0.9758, F1: 0.9817
Epoch 17/30
Training - Loss: 50.3750
Training Metrics: {'accuracy': 0.9962588028169014, 'precision': 0.9962711498606717, 'recall': 0.9884815361473293, 'f1': 0.9923307499122357}
Validation Metrics: {'accuracy': 0.9910920488287693, 'precision': 0.9879094563982311, 'recall': 0.975767437265014, 'f1': 0.9817249028094972}
Epoch 18/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0458
Epoch 18/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0267
Epoch 18/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0262
Epoch 18/30, Step 60/1,Classification Loss: 0.3310, Contrastive Loss: 0.0298
Epoch 18/30, Step 80/1,Classification Loss: 0.3199, Contrastive Loss: 0.0263
Epoch 18/30, Step 100/1,Classification Loss: 0.3218, Contrastive Loss: 0.0262
Epoch 18/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0284
Epoch 18/30, Step 140/1,Classification Loss: 0.3141, Contrastive Loss: 0.0262
Accuracy: 0.9976, Precision: 0.9970, Recall: 0.9933, F1: 0.9951
Accuracy: 0.9920, Precision: 0.9860, Recall: 0.9814, F1: 0.9837
Epoch 18/30
Training - Loss: 50.1597
Training Metrics: {'accuracy': 0.9976067341549296, 'precision': 0.9969897260602447, 'recall': 0.9932513945635066, 'f1': 0.9951101051294835}
Validation Metrics: {'accuracy': 0.9919718464753107, 'precision': 0.9859901303445294, 'recall': 0.9813556426347959, 'f1': 0.9836563353444647}
Epoch 19/30, Step 0/1,Classification Loss: 0.3159, Contrastive Loss: 0.0262
Epoch 19/30, Step 20/1,Classification Loss: 0.3297, Contrastive Loss: 0.0290
Epoch 19/30, Step 40/1,Classification Loss: 0.3413, Contrastive Loss: 0.0259
Epoch 19/30, Step 60/1,Classification Loss: 0.3217, Contrastive Loss: 0.0252
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 19/30, Step 100/1,Classification Loss: 0.3425, Contrastive Loss: 0.0281
Epoch 19/30, Step 120/1,Classification Loss: 0.3425, Contrastive Loss: 0.0288
Epoch 19/30, Step 140/1,Classification Loss: 0.3329, Contrastive Loss: 0.0506
Accuracy: 0.9977, Precision: 0.9969, Recall: 0.9936, F1: 0.9952
Accuracy: 0.9924, Precision: 0.9863, Recall: 0.9829, F1: 0.9846
Epoch 19/30
Training - Loss: 49.9740
Training Metrics: {'accuracy': 0.9976617517605634, 'precision': 0.9968689407652327, 'recall': 0.9936224672490689, 'f1': 0.9952378051909789}
Validation Metrics: {'accuracy': 0.9924117452985813, 'precision': 0.9862797480974049, 'recall': 0.9828811956477631, 'f1': 0.9845715834907629}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0232
Epoch 20/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0261
Epoch 20/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0239
Epoch 20/30, Step 60/1,Classification Loss: 0.3294, Contrastive Loss: 0.0253
Epoch 20/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0229
Epoch 20/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0226
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 20/30, Step 140/1,Classification Loss: 0.3294, Contrastive Loss: 0.0468
Accuracy: 0.9978, Precision: 0.9970, Recall: 0.9939, F1: 0.9955
Accuracy: 0.9919, Precision: 0.9865, Recall: 0.9803, F1: 0.9834
Epoch 20/30
Training - Loss: 49.5195
Training Metrics: {'accuracy': 0.997771786971831, 'precision': 0.997011291399228, 'recall': 0.9939166899555039, 'f1': 0.9954568224203081}
Validation Metrics: {'accuracy': 0.991861871769493, 'precision': 0.9865309417375155, 'recall': 0.9803399795455923, 'f1': 0.9834059391212256}
Epoch 21/30, Step 0/1,Classification Loss: 0.3198, Contrastive Loss: 0.0231
Epoch 21/30, Step 20/1,Classification Loss: 0.3297, Contrastive Loss: 0.0389
Epoch 21/30, Step 40/1,Classification Loss: 0.3247, Contrastive Loss: 0.0232
Epoch 21/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0246
Epoch 21/30, Step 80/1,Classification Loss: 0.3236, Contrastive Loss: 0.0235
Epoch 21/30, Step 100/1,Classification Loss: 0.3411, Contrastive Loss: 0.0245
Epoch 21/30, Step 120/1,Classification Loss: 0.3198, Contrastive Loss: 0.0223
Epoch 21/30, Step 140/1,Classification Loss: 0.3231, Contrastive Loss: 0.0215
Accuracy: 0.9980, Precision: 0.9970, Recall: 0.9947, F1: 0.9958
Accuracy: 0.9926, Precision: 0.9858, Recall: 0.9843, F1: 0.9850
Epoch 21/30
Training - Loss: 49.3688
Training Metrics: {'accuracy': 0.9979643485915493, 'precision': 0.9970408319481676, 'recall': 0.9946525872140131, 'f1': 0.9958424486406753}
Validation Metrics: {'accuracy': 0.9926316947102166, 'precision': 0.9858201549643641, 'recall': 0.9842782469902085, 'f1': 0.9850473711845156}
Epoch 22/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0232
Epoch 22/30, Step 20/1,Classification Loss: 0.3179, Contrastive Loss: 0.0220
Epoch 22/30, Step 40/1,Classification Loss: 0.3172, Contrastive Loss: 0.0214
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 22/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0233
Epoch 22/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 22/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0254
Epoch 22/30, Step 140/1,Classification Loss: 0.3209, Contrastive Loss: 0.0222
Accuracy: 0.9952, Precision: 0.9957, Recall: 0.9850, F1: 0.9902
Accuracy: 0.9896, Precision: 0.9879, Recall: 0.9695, F1: 0.9784
Epoch 22/30
Training - Loss: 49.3160
Training Metrics: {'accuracy': 0.995240977112676, 'precision': 0.995671404106656, 'recall': 0.9849663836939431, 'f1': 0.9902324334566769}
Validation Metrics: {'accuracy': 0.9895524029473222, 'precision': 0.9879014135984643, 'recall': 0.9694765894656859, 'f1': 0.9784266416534402}
Epoch 23/30, Step 0/1,Classification Loss: 0.3147, Contrastive Loss: 0.0205
Epoch 23/30, Step 20/1,Classification Loss: 0.3197, Contrastive Loss: 0.0213
Epoch 23/30, Step 40/1,Classification Loss: 0.3286, Contrastive Loss: 0.0204
Epoch 23/30, Step 60/1,Classification Loss: 0.3443, Contrastive Loss: 0.0258
Epoch 23/30, Step 80/1,Classification Loss: 0.3141, Contrastive Loss: 0.0209
Epoch 23/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0197
Epoch 23/30, Step 120/1,Classification Loss: 0.3215, Contrastive Loss: 0.0217
Epoch 23/30, Step 140/1,Classification Loss: 0.3300, Contrastive Loss: 0.0209
Accuracy: 0.9975, Precision: 0.9969, Recall: 0.9929, F1: 0.9949
Accuracy: 0.9918, Precision: 0.9858, Recall: 0.9806, F1: 0.9832
Epoch 23/30
Training - Loss: 49.0629
Training Metrics: {'accuracy': 0.997496698943662, 'precision': 0.9969269490068386, 'recall': 0.9928780208165651, 'f1': 0.9948902064192211}
Validation Metrics: {'accuracy': 0.9917518970636754, 'precision': 0.9858453398198517, 'recall': 0.9805928661283123, 'f1': 0.9831978290405128}
Epoch 24/30, Step 0/1,Classification Loss: 0.3277, Contrastive Loss: 0.0219
Epoch 24/30, Step 20/1,Classification Loss: 0.3286, Contrastive Loss: 0.0213
Epoch 24/30, Step 40/1,Classification Loss: 0.3375, Contrastive Loss: 0.0213
Epoch 24/30, Step 60/1,Classification Loss: 0.3174, Contrastive Loss: 0.0200
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 24/30, Step 120/1,Classification Loss: 0.3284, Contrastive Loss: 0.0209
Epoch 24/30, Step 140/1,Classification Loss: 0.3230, Contrastive Loss: 0.0207
Accuracy: 0.9980, Precision: 0.9952, Recall: 0.9966, F1: 0.9959
Accuracy: 0.9929, Precision: 0.9851, Recall: 0.9860, F1: 0.9855
Epoch 24/30
Training - Loss: 48.9770
Training Metrics: {'accuracy': 0.9979918573943662, 'precision': 0.9952423895605231, 'recall': 0.9965883910752179, 'f1': 0.99591403383372}
Validation Metrics: {'accuracy': 0.992851644121852, 'precision': 0.9850698608418286, 'recall': 0.985992435750635, 'f1': 0.9855304928989139}
Epoch 25/30, Step 0/1,Classification Loss: 0.3505, Contrastive Loss: 0.0251
Epoch 25/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0345
Epoch 25/30, Step 40/1,Classification Loss: 0.3423, Contrastive Loss: 0.0275
Epoch 25/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0266
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 25/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0190
Epoch 25/30, Step 120/1,Classification Loss: 0.3139, Contrastive Loss: 0.0187
Epoch 25/30, Step 140/1,Classification Loss: 0.3162, Contrastive Loss: 0.0188
Accuracy: 0.9978, Precision: 0.9972, Recall: 0.9939, F1: 0.9956
Accuracy: 0.9927, Precision: 0.9886, Recall: 0.9818, F1: 0.9852
Epoch 25/30
Training - Loss: 48.8697
Training Metrics: {'accuracy': 0.9978268045774648, 'precision': 0.9972032977652379, 'recall': 0.9939477213083039, 'f1': 0.9955675798307047}
Validation Metrics: {'accuracy': 0.9927416694160344, 'precision': 0.9886471857641781, 'recall': 0.981805398481622, 'f1': 0.9851904075649744}
Epoch 26/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0202
Epoch 26/30, Step 20/1,Classification Loss: 0.3384, Contrastive Loss: 0.0221
Epoch 26/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0196
Epoch 26/30, Step 60/1,Classification Loss: 0.3173, Contrastive Loss: 0.0187
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 26/30, Step 100/1,Classification Loss: 0.3152, Contrastive Loss: 0.0188
Epoch 26/30, Step 120/1,Classification Loss: 0.3173, Contrastive Loss: 0.0193
Epoch 26/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0181
Accuracy: 0.9974, Precision: 0.9970, Recall: 0.9923, F1: 0.9947
Accuracy: 0.9918, Precision: 0.9880, Recall: 0.9784, F1: 0.9831
Epoch 26/30
Training - Loss: 48.7785
Training Metrics: {'accuracy': 0.9973866637323944, 'precision': 0.9970230136908573, 'recall': 0.9923410396946186, 'f1': 0.9946656001079781}
Validation Metrics: {'accuracy': 0.9917518970636754, 'precision': 0.9880144670741072, 'recall': 0.9783729042024457, 'f1': 0.9831222067558443}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0184
Epoch 27/30, Step 40/1,Classification Loss: 0.3183, Contrastive Loss: 0.0184
Epoch 27/30, Step 60/1,Classification Loss: 0.3218, Contrastive Loss: 0.0191
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 27/30, Step 100/1,Classification Loss: 0.3433, Contrastive Loss: 0.0224
Epoch 27/30, Step 120/1,Classification Loss: 0.3213, Contrastive Loss: 0.0189
Epoch 27/30, Step 140/1,Classification Loss: 0.3295, Contrastive Loss: 0.0232
Accuracy: 0.9980, Precision: 0.9973, Recall: 0.9946, F1: 0.9960
Accuracy: 0.9927, Precision: 0.9874, Recall: 0.9831, F1: 0.9852
Epoch 27/30
Training - Loss: 48.6708
Training Metrics: {'accuracy': 0.9980193661971831, 'precision': 0.9973204626163746, 'recall': 0.9946259093251595, 'f1': 0.9959677524462667}
Validation Metrics: {'accuracy': 0.9927416694160344, 'precision': 0.9874114515361455, 'recall': 0.9830739481535457, 'f1': 0.9852282537037051}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 28/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0189
Epoch 28/30, Step 40/1,Classification Loss: 0.3205, Contrastive Loss: 0.0195
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 28/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0200
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 28/30, Step 140/1,Classification Loss: 0.3211, Contrastive Loss: 0.0179
Accuracy: 0.9978, Precision: 0.9973, Recall: 0.9936, F1: 0.9955
Accuracy: 0.9922, Precision: 0.9883, Recall: 0.9799, F1: 0.9840
Epoch 28/30
Training - Loss: 48.4548
Training Metrics: {'accuracy': 0.997771786971831, 'precision': 0.9973370367657909, 'recall': 0.9936233912436756, 'f1': 0.9954698723623855}
Validation Metrics: {'accuracy': 0.992191795886946, 'precision': 0.9882956162491638, 'recall': 0.9798984572154129, 'f1': 0.9840428912040925}
Epoch 29/30, Step 0/1,Classification Loss: 0.3165, Contrastive Loss: 0.0181
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 29/30, Step 40/1,Classification Loss: 0.3279, Contrastive Loss: 0.0219
Epoch 29/30, Step 60/1,Classification Loss: 0.3271, Contrastive Loss: 0.0197
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0175
Epoch 29/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0173
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0167
Epoch 29/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0171
Accuracy: 0.9977, Precision: 0.9973, Recall: 0.9935, F1: 0.9954
Accuracy: 0.9920, Precision: 0.9875, Recall: 0.9798, F1: 0.9836
Epoch 29/30
Training - Loss: 48.4138
Training Metrics: {'accuracy': 0.9977442781690141, 'precision': 0.9973119216938489, 'recall': 0.9934914290474381, 'f1': 0.9953907633375283}
Validation Metrics: {'accuracy': 0.9919718464753107, 'precision': 0.9875305309805911, 'recall': 0.9797699555448912, 'f1': 0.9836039269517399}
Epoch 30/30, Step 0/1,Classification Loss: 0.3236, Contrastive Loss: 0.0193
Epoch 30/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0171
Epoch 30/30, Step 40/1,Classification Loss: 0.3280, Contrastive Loss: 0.0188
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 100/1,Classification Loss: 0.3390, Contrastive Loss: 0.0231
Epoch 30/30, Step 120/1,Classification Loss: 0.3190, Contrastive Loss: 0.0176
Epoch 30/30, Step 140/1,Classification Loss: 0.3147, Contrastive Loss: 0.0173
Accuracy: 0.9977, Precision: 0.9971, Recall: 0.9936, F1: 0.9953
Accuracy: 0.9918, Precision: 0.9871, Recall: 0.9793, F1: 0.9832
Epoch 30/30
Training - Loss: 48.5254
Training Metrics: {'accuracy': 0.9977167693661971, 'precision': 0.9971413850750912, 'recall': 0.993577362711714, 'f1': 0.9953498568335439}
Validation Metrics: {'accuracy': 0.9917518970636754, 'precision': 0.9870776834045134, 'recall': 0.9793243164563885, 'f1': 0.9831547194709658}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1533, 5814), y shape: (1533,), y distribution: Counter({np.float64(0.0): 1385, np.float64(1.0): 148}), env shape: (1533,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.5219, Precision: 0.5021, Recall: 0.5061, F1: 0.4147
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11415]))
original train data shape: torch.Size([45562]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1533, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45562]), new train data shape: torch.Size([45562])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11415]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3160, Contrastive Loss: 1.6296
Epoch 1/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 1.0624
Epoch 1/30, Step 40/1,Classification Loss: 0.3385, Contrastive Loss: 0.5224
Epoch 1/30, Step 60/1,Classification Loss: 0.3488, Contrastive Loss: 0.3026
Epoch 1/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.2256
Epoch 1/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.2169
Epoch 1/30, Step 120/1,Classification Loss: 0.3346, Contrastive Loss: 0.1857
Epoch 1/30, Step 140/1,Classification Loss: 0.3328, Contrastive Loss: 0.1592
Accuracy: 0.9970, Precision: 0.9945, Recall: 0.9933, F1: 0.9939
Accuracy: 0.9925, Precision: 0.9861, Recall: 0.9836, F1: 0.9848
Epoch 1/30
Training - Loss: 114.2112
Training Metrics: {'accuracy': 0.9970015404929577, 'precision': 0.9944831356015765, 'recall': 0.9932975308696743, 'f1': 0.9938892768395622}
Validation Metrics: {'accuracy': 0.9925381323384177, 'precision': 0.9860723454870925, 'recall': 0.9836062452399086, 'f1': 0.9848346169463544}
Epoch 2/30, Step 0/1,Classification Loss: 0.3381, Contrastive Loss: 0.1599
Epoch 2/30, Step 20/1,Classification Loss: 0.3151, Contrastive Loss: 0.1393
Epoch 2/30, Step 40/1,Classification Loss: 0.3175, Contrastive Loss: 0.1340
Epoch 2/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1668
Epoch 2/30, Step 80/1,Classification Loss: 0.3146, Contrastive Loss: 0.1218
Epoch 2/30, Step 100/1,Classification Loss: 0.3295, Contrastive Loss: 0.1327
Epoch 2/30, Step 120/1,Classification Loss: 0.3285, Contrastive Loss: 0.1228
Epoch 2/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.1097
Accuracy: 0.9961, Precision: 0.9963, Recall: 0.9880, F1: 0.9921
Accuracy: 0.9909, Precision: 0.9881, Recall: 0.9747, F1: 0.9813
Epoch 2/30
Training - Loss: 65.1229
Training Metrics: {'accuracy': 0.9961487676056338, 'precision': 0.9962885006501992, 'recall': 0.9880295416744227, 'f1': 0.9921077316464999}
Validation Metrics: {'accuracy': 0.990892132118951, 'precision': 0.9881096639663636, 'recall': 0.9747270880934247, 'f1': 0.9812804669539468}
Epoch 3/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.1147
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1067
Epoch 3/30, Step 40/1,Classification Loss: 0.3227, Contrastive Loss: 0.1105
Epoch 3/30, Step 60/1,Classification Loss: 0.3330, Contrastive Loss: 0.1402
Epoch 3/30, Step 80/1,Classification Loss: 0.3343, Contrastive Loss: 0.1092
Epoch 3/30, Step 100/1,Classification Loss: 0.3600, Contrastive Loss: 0.1321
Epoch 3/30, Step 120/1,Classification Loss: 0.3279, Contrastive Loss: 0.1061
Epoch 3/30, Step 140/1,Classification Loss: 0.3140, Contrastive Loss: 0.0960
Accuracy: 0.9976, Precision: 0.9969, Recall: 0.9932, F1: 0.9950
Accuracy: 0.9932, Precision: 0.9883, Recall: 0.9840, F1: 0.9861
Epoch 3/30
Training - Loss: 62.3518
Training Metrics: {'accuracy': 0.9975792253521126, 'precision': 0.996886068752312, 'recall': 0.9932107953185606, 'f1': 0.9950383449936357}
Validation Metrics: {'accuracy': 0.9931965324262043, 'precision': 0.9883305915656804, 'recall': 0.983990860624524, 'f1': 0.9861463021268657}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0948
Epoch 4/30, Step 20/1,Classification Loss: 0.3199, Contrastive Loss: 0.0976
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0910
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0899
Epoch 4/30, Step 80/1,Classification Loss: 0.3171, Contrastive Loss: 0.0914
Epoch 4/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0901
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0856
Epoch 4/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0847
Accuracy: 0.9975, Precision: 0.9971, Recall: 0.9928, F1: 0.9950
Accuracy: 0.9928, Precision: 0.9880, Recall: 0.9825, F1: 0.9852
Epoch 4/30
Training - Loss: 60.0070
Training Metrics: {'accuracy': 0.9975242077464789, 'precision': 0.9971073672429813, 'recall': 0.9928313685504317, 'f1': 0.9949556596115221}
Validation Metrics: {'accuracy': 0.9927575990343466, 'precision': 0.9880474817543121, 'recall': 0.9824676313785224, 'f1': 0.9852336791667944}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0844
Epoch 5/30, Step 20/1,Classification Loss: 0.3164, Contrastive Loss: 0.0876
Epoch 5/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0859
Epoch 5/30, Step 60/1,Classification Loss: 0.3415, Contrastive Loss: 0.0889
Epoch 5/30, Step 80/1,Classification Loss: 0.3281, Contrastive Loss: 0.0827
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0777
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0765
Epoch 5/30, Step 140/1,Classification Loss: 0.3410, Contrastive Loss: 0.1108
Accuracy: 0.9975, Precision: 0.9970, Recall: 0.9928, F1: 0.9949
Accuracy: 0.9928, Precision: 0.9896, Recall: 0.9809, F1: 0.9852
Epoch 5/30
Training - Loss: 58.2621
Training Metrics: {'accuracy': 0.997496698943662, 'precision': 0.9970079636034627, 'recall': 0.9928022278713494, 'f1': 0.9948918451556653}
Validation Metrics: {'accuracy': 0.9927575990343466, 'precision': 0.9896049599462371, 'recall': 0.9808841076415333, 'f1': 0.9851863269042183}
Epoch 6/30, Step 0/1,Classification Loss: 0.3212, Contrastive Loss: 0.0764
Epoch 6/30, Step 20/1,Classification Loss: 0.3186, Contrastive Loss: 0.0767
Epoch 6/30, Step 40/1,Classification Loss: 0.3475, Contrastive Loss: 0.0963
Epoch 6/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0736
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0717
Epoch 6/30, Step 100/1,Classification Loss: 0.3246, Contrastive Loss: 0.0726
Epoch 6/30, Step 120/1,Classification Loss: 0.3251, Contrastive Loss: 0.0745
Epoch 6/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0686
Accuracy: 0.9971, Precision: 0.9969, Recall: 0.9912, F1: 0.9940
Accuracy: 0.9919, Precision: 0.9884, Recall: 0.9785, F1: 0.9834
Epoch 6/30
Training - Loss: 57.2397
Training Metrics: {'accuracy': 0.9970840669014085, 'precision': 0.9969222238172132, 'recall': 0.9911988148608633, 'f1': 0.994035967894096}
Validation Metrics: {'accuracy': 0.991879732250631, 'precision': 0.9884197240409249, 'recall': 0.9784710586443259, 'f1': 0.9833693749610352}
Epoch 7/30, Step 0/1,Classification Loss: 0.3234, Contrastive Loss: 0.0695
Epoch 7/30, Step 20/1,Classification Loss: 0.3317, Contrastive Loss: 0.0732
Epoch 7/30, Step 40/1,Classification Loss: 0.3166, Contrastive Loss: 0.0703
Epoch 7/30, Step 60/1,Classification Loss: 0.3268, Contrastive Loss: 0.0702
Epoch 7/30, Step 80/1,Classification Loss: 0.3148, Contrastive Loss: 0.0667
Epoch 7/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0669
Epoch 7/30, Step 120/1,Classification Loss: 0.3171, Contrastive Loss: 0.0645
Epoch 7/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0638
Accuracy: 0.9976, Precision: 0.9970, Recall: 0.9931, F1: 0.9950
Accuracy: 0.9922, Precision: 0.9871, Recall: 0.9812, F1: 0.9841
Epoch 7/30
Training - Loss: 56.4372
Training Metrics: {'accuracy': 0.9975792253521126, 'precision': 0.9970499641321497, 'recall': 0.9930616941249344, 'f1': 0.9950439425722398}
Validation Metrics: {'accuracy': 0.9922089322945243, 'precision': 0.9870760263164293, 'recall': 0.9811970043158162, 'f1': 0.9841099427135909}
Epoch 8/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0660
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0625
Epoch 8/30, Step 40/1,Classification Loss: 0.3200, Contrastive Loss: 0.0627
Epoch 8/30, Step 60/1,Classification Loss: 0.3139, Contrastive Loss: 0.0611
Epoch 8/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0647
Epoch 8/30, Step 100/1,Classification Loss: 0.3146, Contrastive Loss: 0.0605
Epoch 8/30, Step 120/1,Classification Loss: 0.3330, Contrastive Loss: 0.0625
Epoch 8/30, Step 140/1,Classification Loss: 0.3157, Contrastive Loss: 0.0596
Accuracy: 0.9961, Precision: 0.9962, Recall: 0.9878, F1: 0.9919
Accuracy: 0.9903, Precision: 0.9868, Recall: 0.9738, F1: 0.9802
Epoch 8/30
Training - Loss: 55.4596
Training Metrics: {'accuracy': 0.9960662411971831, 'precision': 0.9962407555179835, 'recall': 0.9877514190621436, 'f1': 0.9919418618262636}
Validation Metrics: {'accuracy': 0.9903434653791288, 'precision': 0.9868076553633716, 'recall': 0.9737731657781162, 'f1': 0.98015919670111}
Epoch 9/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0692
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0568
Epoch 9/30, Step 40/1,Classification Loss: 0.3226, Contrastive Loss: 0.0585
Epoch 9/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0685
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0547
Epoch 9/30, Step 100/1,Classification Loss: 0.3152, Contrastive Loss: 0.0556
Epoch 9/30, Step 120/1,Classification Loss: 0.3171, Contrastive Loss: 0.0545
Epoch 9/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0529
Accuracy: 0.9977, Precision: 0.9951, Recall: 0.9956, F1: 0.9954
Accuracy: 0.9932, Precision: 0.9868, Recall: 0.9856, F1: 0.9862
Epoch 9/30
Training - Loss: 54.3993
Training Metrics: {'accuracy': 0.9977167693661971, 'precision': 0.9950785443709488, 'recall': 0.9956320230326636, 'f1': 0.9953550540121205}
Validation Metrics: {'accuracy': 0.9931965324262043, 'precision': 0.986808541505228, 'recall': 0.985574384361513, 'f1': 0.9861902940649105}
Epoch 10/30, Step 0/1,Classification Loss: 0.3260, Contrastive Loss: 0.0548
Epoch 10/30, Step 20/1,Classification Loss: 0.3161, Contrastive Loss: 0.0537
Epoch 10/30, Step 40/1,Classification Loss: 0.3286, Contrastive Loss: 0.0576
Epoch 10/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0569
Epoch 10/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0667
Epoch 10/30, Step 100/1,Classification Loss: 0.3145, Contrastive Loss: 0.0505
Epoch 10/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0560
Epoch 10/30, Step 140/1,Classification Loss: 0.3179, Contrastive Loss: 0.0497
Accuracy: 0.9974, Precision: 0.9971, Recall: 0.9924, F1: 0.9947
Accuracy: 0.9923, Precision: 0.9875, Recall: 0.9813, F1: 0.9843
Epoch 10/30
Training - Loss: 53.8362
Training Metrics: {'accuracy': 0.9974141725352113, 'precision': 0.9971203769410337, 'recall': 0.992361305946956, 'f1': 0.9947238674263237}
Validation Metrics: {'accuracy': 0.9923186656424887, 'precision': 0.987455322086466, 'recall': 0.9812611068799187, 'f1': 0.9843287380741577}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0488
Epoch 11/30, Step 20/1,Classification Loss: 0.3303, Contrastive Loss: 0.0537
Epoch 11/30, Step 40/1,Classification Loss: 0.3260, Contrastive Loss: 0.0510
Epoch 11/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0479
Epoch 11/30, Step 80/1,Classification Loss: 0.3233, Contrastive Loss: 0.0489
Epoch 11/30, Step 100/1,Classification Loss: 0.3270, Contrastive Loss: 0.0496
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0453
Epoch 11/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0548
Accuracy: 0.9969, Precision: 0.9967, Recall: 0.9906, F1: 0.9936
Accuracy: 0.9919, Precision: 0.9897, Recall: 0.9772, F1: 0.9833
Epoch 11/30
Training - Loss: 53.1064
Training Metrics: {'accuracy': 0.9968915052816901, 'precision': 0.9967207219475034, 'recall': 0.9905677332314596, 'f1': 0.9936158984161814}
Validation Metrics: {'accuracy': 0.991879732250631, 'precision': 0.9896876553056415, 'recall': 0.9772042396547347, 'f1': 0.9833264598081742}
Epoch 12/30, Step 0/1,Classification Loss: 0.3169, Contrastive Loss: 0.0461
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0447
Epoch 12/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0452
Epoch 12/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0440
Epoch 12/30, Step 80/1,Classification Loss: 0.3145, Contrastive Loss: 0.0439
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0416
Epoch 12/30, Step 140/1,Classification Loss: 0.3293, Contrastive Loss: 0.0553
Accuracy: 0.9972, Precision: 0.9969, Recall: 0.9916, F1: 0.9942
Accuracy: 0.9911, Precision: 0.9854, Recall: 0.9783, F1: 0.9818
Epoch 12/30
Training - Loss: 52.7712
Training Metrics: {'accuracy': 0.9971665933098591, 'precision': 0.9968900392630602, 'recall': 0.9915629393943215, 'f1': 0.9942052274173949}
Validation Metrics: {'accuracy': 0.9911115988148799, 'precision': 0.985436156751063, 'recall': 0.9783390454430059, 'f1': 0.9818486977627796}
Epoch 13/30, Step 0/1,Classification Loss: 0.3542, Contrastive Loss: 0.0463
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0406
Epoch 13/30, Step 40/1,Classification Loss: 0.3279, Contrastive Loss: 0.0440
Epoch 13/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0412
Epoch 13/30, Step 80/1,Classification Loss: 0.3476, Contrastive Loss: 0.0516
Epoch 13/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0404
Epoch 13/30, Step 120/1,Classification Loss: 0.3345, Contrastive Loss: 0.0431
Epoch 13/30, Step 140/1,Classification Loss: 0.3296, Contrastive Loss: 0.0458
Accuracy: 0.9959, Precision: 0.9968, Recall: 0.9867, F1: 0.9917
Accuracy: 0.9903, Precision: 0.9878, Recall: 0.9728, F1: 0.9801
Epoch 13/30
Training - Loss: 52.1583
Training Metrics: {'accuracy': 0.9959286971830986, 'precision': 0.9968141649590163, 'recall': 0.9866913831175349, 'f1': 0.9916755393312546}
Validation Metrics: {'accuracy': 0.9903434653791288, 'precision': 0.9877625476947376, 'recall': 0.9728230515359229, 'f1': 0.9801206448777686}
Epoch 14/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0430
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0378
Epoch 14/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0399
Epoch 14/30, Step 60/1,Classification Loss: 0.3233, Contrastive Loss: 0.0404
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0365
Epoch 14/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0387
Epoch 14/30, Step 120/1,Classification Loss: 0.3442, Contrastive Loss: 0.0688
Epoch 14/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0355
Accuracy: 0.9977, Precision: 0.9972, Recall: 0.9935, F1: 0.9953
Accuracy: 0.9920, Precision: 0.9869, Recall: 0.9804, F1: 0.9837
Epoch 14/30
Training - Loss: 51.8469
Training Metrics: {'accuracy': 0.9977167693661971, 'precision': 0.9972144890914305, 'recall': 0.9934718091177288, 'f1': 0.9953326782751402}
Validation Metrics: {'accuracy': 0.9919894655985955, 'precision': 0.9869333496425239, 'recall': 0.9804353896928155, 'f1': 0.9836518855160894}
Epoch 15/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0373
Epoch 15/30, Step 20/1,Classification Loss: 0.3246, Contrastive Loss: 0.0380
Epoch 15/30, Step 40/1,Classification Loss: 0.3413, Contrastive Loss: 0.0547
Epoch 15/30, Step 60/1,Classification Loss: 0.3142, Contrastive Loss: 0.0348
Epoch 15/30, Step 80/1,Classification Loss: 0.3387, Contrastive Loss: 0.0382
Epoch 15/30, Step 100/1,Classification Loss: 0.3362, Contrastive Loss: 0.0397
Epoch 15/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.0336
Epoch 15/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0332
Accuracy: 0.9972, Precision: 0.9970, Recall: 0.9916, F1: 0.9943
Accuracy: 0.9912, Precision: 0.9871, Recall: 0.9771, F1: 0.9820
Epoch 15/30
Training - Loss: 51.3934
Training Metrics: {'accuracy': 0.997194102112676, 'precision': 0.9969840912628585, 'recall': 0.9915634344429032, 'f1': 0.9942517736248919}
Validation Metrics: {'accuracy': 0.9912213321628442, 'precision': 0.9870572418923864, 'recall': 0.9771363290175171, 'f1': 0.9820209459038218}
Epoch 16/30, Step 0/1,Classification Loss: 0.3218, Contrastive Loss: 0.0350
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Epoch 16/30, Step 40/1,Classification Loss: 0.3300, Contrastive Loss: 0.0349
Epoch 16/30, Step 60/1,Classification Loss: 0.3166, Contrastive Loss: 0.0335
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 16/30, Step 100/1,Classification Loss: 0.3424, Contrastive Loss: 0.0420
Epoch 16/30, Step 120/1,Classification Loss: 0.3138, Contrastive Loss: 0.0327
Epoch 16/30, Step 140/1,Classification Loss: 0.3136, Contrastive Loss: 0.0321
Accuracy: 0.9968, Precision: 0.9967, Recall: 0.9903, F1: 0.9934
Accuracy: 0.9900, Precision: 0.9866, Recall: 0.9726, F1: 0.9795
Epoch 16/30
Training - Loss: 51.0745
Training Metrics: {'accuracy': 0.9967814700704225, 'precision': 0.9966717333203317, 'recall': 0.9902838443850728, 'f1': 0.9934470741699317}
Validation Metrics: {'accuracy': 0.9900142653352354, 'precision': 0.9865966286871222, 'recall': 0.972630743843615, 'f1': 0.9794628965586583}
Epoch 17/30, Step 0/1,Classification Loss: 0.3224, Contrastive Loss: 0.0332
Epoch 17/30, Step 20/1,Classification Loss: 0.3167, Contrastive Loss: 0.0329
Epoch 17/30, Step 40/1,Classification Loss: 0.3144, Contrastive Loss: 0.0307
Epoch 17/30, Step 60/1,Classification Loss: 0.3379, Contrastive Loss: 0.0346
Epoch 17/30, Step 80/1,Classification Loss: 0.3617, Contrastive Loss: 0.0545
Epoch 17/30, Step 100/1,Classification Loss: 0.3185, Contrastive Loss: 0.0299
Epoch 17/30, Step 120/1,Classification Loss: 0.3200, Contrastive Loss: 0.0309
Epoch 17/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0288
Accuracy: 0.9974, Precision: 0.9970, Recall: 0.9925, F1: 0.9948
Accuracy: 0.9922, Precision: 0.9877, Recall: 0.9806, F1: 0.9841
Epoch 17/30
Training - Loss: 50.6471
Training Metrics: {'accuracy': 0.9974416813380281, 'precision': 0.997048773831968, 'recall': 0.992500932822515, 'f1': 0.9947593926562414}
Validation Metrics: {'accuracy': 0.9922089322945243, 'precision': 0.9876937117444387, 'recall': 0.9805635948210205, 'f1': 0.9840895992735476}
Epoch 18/30, Step 0/1,Classification Loss: 0.3196, Contrastive Loss: 0.0320
Epoch 18/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0327
Epoch 18/30, Step 40/1,Classification Loss: 0.3177, Contrastive Loss: 0.0294
Epoch 18/30, Step 60/1,Classification Loss: 0.3351, Contrastive Loss: 0.0314
Epoch 18/30, Step 80/1,Classification Loss: 0.3157, Contrastive Loss: 0.0288
Epoch 18/30, Step 100/1,Classification Loss: 0.3204, Contrastive Loss: 0.0287
Epoch 18/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0271
Epoch 18/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0265
Accuracy: 0.9974, Precision: 0.9950, Recall: 0.9945, F1: 0.9947
Accuracy: 0.9920, Precision: 0.9866, Recall: 0.9808, F1: 0.9837
Epoch 18/30
Training - Loss: 50.3914
Training Metrics: {'accuracy': 0.9974141725352113, 'precision': 0.9949855322468351, 'recall': 0.9945129898335091, 'f1': 0.9947490931777617}
Validation Metrics: {'accuracy': 0.9919894655985955, 'precision': 0.9866256807566398, 'recall': 0.9807520944402133, 'f1': 0.9836623354660863}
Epoch 19/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0353
Epoch 19/30, Step 20/1,Classification Loss: 0.3183, Contrastive Loss: 0.0274
Epoch 19/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0269
Epoch 19/30, Step 60/1,Classification Loss: 0.3411, Contrastive Loss: 0.0319
Epoch 19/30, Step 80/1,Classification Loss: 0.3342, Contrastive Loss: 0.0438
Epoch 19/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0283
Epoch 19/30, Step 120/1,Classification Loss: 0.3748, Contrastive Loss: 0.0404
Epoch 19/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Accuracy: 0.9974, Precision: 0.9971, Recall: 0.9925, F1: 0.9948
Accuracy: 0.9913, Precision: 0.9871, Recall: 0.9775, F1: 0.9823
Epoch 19/30
Training - Loss: 50.0631
Training Metrics: {'accuracy': 0.9974416813380281, 'precision': 0.9970580598016096, 'recall': 0.9925433657225066, 'f1': 0.9947854291736967}
Validation Metrics: {'accuracy': 0.9913310655108087, 'precision': 0.9871279412535203, 'recall': 0.9775171363290175, 'f1': 0.98225139041791}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 20/30, Step 20/1,Classification Loss: 0.3259, Contrastive Loss: 0.0283
Epoch 20/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0254
Epoch 20/30, Step 60/1,Classification Loss: 0.3164, Contrastive Loss: 0.0252
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 20/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0241
Epoch 20/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0241
Epoch 20/30, Step 140/1,Classification Loss: 0.3349, Contrastive Loss: 0.0357
Accuracy: 0.9963, Precision: 0.9964, Recall: 0.9887, F1: 0.9925
Accuracy: 0.9901, Precision: 0.9870, Recall: 0.9727, F1: 0.9797
Epoch 20/30
Training - Loss: 49.7316
Training Metrics: {'accuracy': 0.9963413292253521, 'precision': 0.9964042468479546, 'recall': 0.988712364304905, 'f1': 0.9925138161542062}
Validation Metrics: {'accuracy': 0.9901239986831998, 'precision': 0.9869846558886828, 'recall': 0.9726948464077176, 'f1': 0.9796820050596184}
Epoch 21/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0380
Epoch 21/30, Step 20/1,Classification Loss: 0.3187, Contrastive Loss: 0.0252
Epoch 21/30, Step 40/1,Classification Loss: 0.3286, Contrastive Loss: 0.0310
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0225
Epoch 21/30, Step 120/1,Classification Loss: 0.3268, Contrastive Loss: 0.0252
Epoch 21/30, Step 140/1,Classification Loss: 0.3213, Contrastive Loss: 0.0239
Accuracy: 0.9976, Precision: 0.9972, Recall: 0.9930, F1: 0.9951
Accuracy: 0.9919, Precision: 0.9900, Recall: 0.9769, F1: 0.9833
Epoch 21/30
Training - Loss: 49.6423
Training Metrics: {'accuracy': 0.9976067341549296, 'precision': 0.9972292126748614, 'recall': 0.993006644128281, 'f1': 0.995104598690016}
Validation Metrics: {'accuracy': 0.991879732250631, 'precision': 0.9900077072937967, 'recall': 0.9768875349073369, 'f1': 0.9833156881350242}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 22/30, Step 40/1,Classification Loss: 0.3244, Contrastive Loss: 0.0241
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 22/30, Step 80/1,Classification Loss: 0.3299, Contrastive Loss: 0.0289
Epoch 22/30, Step 100/1,Classification Loss: 0.3375, Contrastive Loss: 0.0391
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 22/30, Step 140/1,Classification Loss: 0.3326, Contrastive Loss: 0.0259
Accuracy: 0.9968, Precision: 0.9947, Recall: 0.9922, F1: 0.9934
Accuracy: 0.9912, Precision: 0.9880, Recall: 0.9762, F1: 0.9820
Epoch 22/30
Training - Loss: 49.4330
Training Metrics: {'accuracy': 0.9967814700704225, 'precision': 0.9946670317379642, 'recall': 0.9922172602268546, 'f1': 0.9934376323848895}
Validation Metrics: {'accuracy': 0.9912213321628442, 'precision': 0.988000990648875, 'recall': 0.9761862147753237, 'f1': 0.9819861776084214}
Epoch 23/30, Step 0/1,Classification Loss: 0.3597, Contrastive Loss: 0.0418
Epoch 23/30, Step 20/1,Classification Loss: 0.3266, Contrastive Loss: 0.0236
Epoch 23/30, Step 40/1,Classification Loss: 0.3328, Contrastive Loss: 0.0258
Epoch 23/30, Step 60/1,Classification Loss: 0.3261, Contrastive Loss: 0.0221
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 23/30, Step 100/1,Classification Loss: 0.3378, Contrastive Loss: 0.0250
Epoch 23/30, Step 120/1,Classification Loss: 0.3199, Contrastive Loss: 0.0220
Epoch 23/30, Step 140/1,Classification Loss: 0.3451, Contrastive Loss: 0.0302
Accuracy: 0.9974, Precision: 0.9952, Recall: 0.9941, F1: 0.9946
Accuracy: 0.9916, Precision: 0.9854, Recall: 0.9802, F1: 0.9828
Epoch 23/30
Training - Loss: 49.2945
Training Metrics: {'accuracy': 0.9973591549295775, 'precision': 0.9951814802711514, 'recall': 0.994076276822701, 'f1': 0.9946279610842439}
Validation Metrics: {'accuracy': 0.9915505322067376, 'precision': 0.9854196575365182, 'recall': 0.9801789794364052, 'f1': 0.9827781260571147}
Epoch 24/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0210
Epoch 24/30, Step 20/1,Classification Loss: 0.3203, Contrastive Loss: 0.0219
Epoch 24/30, Step 40/1,Classification Loss: 0.3363, Contrastive Loss: 0.0264
Epoch 24/30, Step 60/1,Classification Loss: 0.3169, Contrastive Loss: 0.0206
Epoch 24/30, Step 80/1,Classification Loss: 0.3137, Contrastive Loss: 0.0206
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 24/30, Step 120/1,Classification Loss: 0.3272, Contrastive Loss: 0.0224
Epoch 24/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0306
Accuracy: 0.9977, Precision: 0.9972, Recall: 0.9934, F1: 0.9953
Accuracy: 0.9919, Precision: 0.9872, Recall: 0.9797, F1: 0.9834
Epoch 24/30
Training - Loss: 49.0633
Training Metrics: {'accuracy': 0.9976892605633803, 'precision': 0.997201490038382, 'recall': 0.9933890693096212, 'f1': 0.9952844020865572}
Validation Metrics: {'accuracy': 0.991879732250631, 'precision': 0.9871711695310802, 'recall': 0.9797378776339172, 'f1': 0.9834120175389918}
Epoch 25/30, Step 0/1,Classification Loss: 0.3150, Contrastive Loss: 0.0210
Epoch 25/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0231
Epoch 25/30, Step 40/1,Classification Loss: 0.3258, Contrastive Loss: 0.0220
Epoch 25/30, Step 60/1,Classification Loss: 0.3287, Contrastive Loss: 0.0224
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 100/1,Classification Loss: 0.3215, Contrastive Loss: 0.0209
Epoch 25/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0243
Epoch 25/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Accuracy: 0.9977, Precision: 0.9973, Recall: 0.9933, F1: 0.9953
Accuracy: 0.9918, Precision: 0.9865, Recall: 0.9800, F1: 0.9832
Epoch 25/30
Training - Loss: 48.9235
Training Metrics: {'accuracy': 0.9976892605633803, 'precision': 0.9972849553134682, 'recall': 0.9933239585544367, 'f1': 0.995292702011503}
Validation Metrics: {'accuracy': 0.9917699989026665, 'precision': 0.9864824222948219, 'recall': 0.9799904798172125, 'f1': 0.9832039919685851}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 26/30, Step 60/1,Classification Loss: 0.3153, Contrastive Loss: 0.0199
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 26/30, Step 100/1,Classification Loss: 0.3230, Contrastive Loss: 0.0237
Epoch 26/30, Step 120/1,Classification Loss: 0.3273, Contrastive Loss: 0.0211
Epoch 26/30, Step 140/1,Classification Loss: 0.3226, Contrastive Loss: 0.0201
Accuracy: 0.9960, Precision: 0.9963, Recall: 0.9873, F1: 0.9917
Accuracy: 0.9895, Precision: 0.9866, Recall: 0.9704, F1: 0.9783
Epoch 26/30
Training - Loss: 48.7930
Training Metrics: {'accuracy': 0.9959562059859155, 'precision': 0.9962539866718934, 'recall': 0.9872629668574759, 'f1': 0.9916977059396899}
Validation Metrics: {'accuracy': 0.9894655985954132, 'precision': 0.9865645892306641, 'recall': 0.9704100025387155, 'f1': 0.978285280610862}
Epoch 27/30, Step 0/1,Classification Loss: 0.3156, Contrastive Loss: 0.0191
Epoch 27/30, Step 20/1,Classification Loss: 0.3148, Contrastive Loss: 0.0215
Epoch 27/30, Step 40/1,Classification Loss: 0.3526, Contrastive Loss: 0.0278
Epoch 27/30, Step 60/1,Classification Loss: 0.3146, Contrastive Loss: 0.0191
Epoch 27/30, Step 80/1,Classification Loss: 0.3278, Contrastive Loss: 0.0205
Epoch 27/30, Step 100/1,Classification Loss: 0.3286, Contrastive Loss: 0.0206
Epoch 27/30, Step 120/1,Classification Loss: 0.3292, Contrastive Loss: 0.0210
Epoch 27/30, Step 140/1,Classification Loss: 0.3302, Contrastive Loss: 0.0212
Accuracy: 0.9977, Precision: 0.9972, Recall: 0.9936, F1: 0.9954
Accuracy: 0.9921, Precision: 0.9876, Recall: 0.9802, F1: 0.9839
Epoch 27/30
Training - Loss: 48.7357
Training Metrics: {'accuracy': 0.9977442781690141, 'precision': 0.997231738265473, 'recall': 0.993571304992037, 'f1': 0.995391503729385}
Validation Metrics: {'accuracy': 0.9920991989465598, 'precision': 0.9876229730565855, 'recall': 0.9801827875095201, 'f1': 0.9838603413892894}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 20/1,Classification Loss: 0.3234, Contrastive Loss: 0.0198
Epoch 28/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0192
Epoch 28/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0185
Epoch 28/30, Step 80/1,Classification Loss: 0.3334, Contrastive Loss: 0.0220
Epoch 28/30, Step 100/1,Classification Loss: 0.3162, Contrastive Loss: 0.0183
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 28/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Accuracy: 0.9966, Precision: 0.9973, Recall: 0.9890, F1: 0.9931
Accuracy: 0.9907, Precision: 0.9902, Recall: 0.9717, F1: 0.9807
Epoch 28/30
Training - Loss: 48.6739
Training Metrics: {'accuracy': 0.9966164172535211, 'precision': 0.9972966077667309, 'recall': 0.988956746182267, 'f1': 0.9930744570722556}
Validation Metrics: {'accuracy': 0.990672665423022, 'precision': 0.990235851459323, 'recall': 0.9717485402386392, 'f1': 0.980729614478101}
Epoch 29/30, Step 0/1,Classification Loss: 0.3340, Contrastive Loss: 0.0366
Epoch 29/30, Step 20/1,Classification Loss: 0.3206, Contrastive Loss: 0.0191
Epoch 29/30, Step 40/1,Classification Loss: 0.3154, Contrastive Loss: 0.0190
Epoch 29/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0178
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 100/1,Classification Loss: 0.3202, Contrastive Loss: 0.0192
Epoch 29/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0179
Epoch 29/30, Step 140/1,Classification Loss: 0.3293, Contrastive Loss: 0.0203
Accuracy: 0.9975, Precision: 0.9953, Recall: 0.9946, F1: 0.9949
Accuracy: 0.9918, Precision: 0.9856, Recall: 0.9809, F1: 0.9832
Epoch 29/30
Training - Loss: 48.6128
Training Metrics: {'accuracy': 0.997496698943662, 'precision': 0.9952646717696023, 'recall': 0.9945540334862893, 'f1': 0.9949089735037796}
Validation Metrics: {'accuracy': 0.9917699989026665, 'precision': 0.9855646809353826, 'recall': 0.9809405940594059, 'f1': 0.9832361497264033}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 30/30, Step 20/1,Classification Loss: 0.3179, Contrastive Loss: 0.0202
Epoch 30/30, Step 40/1,Classification Loss: 0.3187, Contrastive Loss: 0.0193
Epoch 30/30, Step 60/1,Classification Loss: 0.3165, Contrastive Loss: 0.0186
Epoch 30/30, Step 80/1,Classification Loss: 0.3184, Contrastive Loss: 0.0183
Epoch 30/30, Step 100/1,Classification Loss: 0.3190, Contrastive Loss: 0.0191
Epoch 30/30, Step 120/1,Classification Loss: 0.3437, Contrastive Loss: 0.0215
Epoch 30/30, Step 140/1,Classification Loss: 0.3249, Contrastive Loss: 0.0201
Accuracy: 0.9978, Precision: 0.9974, Recall: 0.9937, F1: 0.9955
Accuracy: 0.9919, Precision: 0.9872, Recall: 0.9797, F1: 0.9834
Epoch 30/30
Training - Loss: 48.5155
Training Metrics: {'accuracy': 0.9978268045774648, 'precision': 0.997352805788214, 'recall': 0.9937473461226456, 'f1': 0.9955403873242794}
Validation Metrics: {'accuracy': 0.991879732250631, 'precision': 0.9871711695310802, 'recall': 0.9797378776339172, 'f1': 0.9834120175389918}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1513, 5814), y shape: (1513,), y distribution: Counter({np.float64(0.0): 1368, np.float64(1.0): 145}), env shape: (1513,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.5360, Precision: 0.4956, Recall: 0.4876, F1: 0.4155
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11515]))
original train data shape: torch.Size([45662]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1513, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45662]), new train data shape: torch.Size([45662])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11515]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3210, Contrastive Loss: 1.6292
Epoch 1/30, Step 20/1,Classification Loss: 0.3420, Contrastive Loss: 0.9460
Epoch 1/30, Step 40/1,Classification Loss: 0.3409, Contrastive Loss: 0.3837
Epoch 1/30, Step 60/1,Classification Loss: 0.3613, Contrastive Loss: 0.2627
Epoch 1/30, Step 80/1,Classification Loss: 0.3224, Contrastive Loss: 0.1957
Epoch 1/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.1685
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1506
Epoch 1/30, Step 140/1,Classification Loss: 0.3149, Contrastive Loss: 0.1440
Accuracy: 0.9973, Precision: 0.9971, Recall: 0.9918, F1: 0.9944
Accuracy: 0.9928, Precision: 0.9878, Recall: 0.9828, F1: 0.9853
Epoch 1/30
Training - Loss: 106.7733
Training Metrics: {'accuracy': 0.9972766285211268, 'precision': 0.9971183690897298, 'recall': 0.9917988925241938, 'f1': 0.9944374239351479}
Validation Metrics: {'accuracy': 0.9927734588853607, 'precision': 0.9877604146706201, 'recall': 0.982811771995405, 'f1': 0.985267312712554}
Epoch 2/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1518
Epoch 2/30, Step 20/1,Classification Loss: 0.3179, Contrastive Loss: 0.1398
Epoch 2/30, Step 40/1,Classification Loss: 0.3229, Contrastive Loss: 0.1318
Epoch 2/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.1284
Epoch 2/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1497
Epoch 2/30, Step 100/1,Classification Loss: 0.3248, Contrastive Loss: 0.1207
Epoch 2/30, Step 120/1,Classification Loss: 0.3286, Contrastive Loss: 0.1199
Epoch 2/30, Step 140/1,Classification Loss: 0.3247, Contrastive Loss: 0.1156
Accuracy: 0.9967, Precision: 0.9974, Recall: 0.9892, F1: 0.9933
Accuracy: 0.9919, Precision: 0.9884, Recall: 0.9785, F1: 0.9834
Epoch 2/30
Training - Loss: 65.2173
Training Metrics: {'accuracy': 0.9967264524647887, 'precision': 0.9974386317696967, 'recall': 0.9891800528313035, 'f1': 0.9932583554005443}
Validation Metrics: {'accuracy': 0.9918975145078287, 'precision': 0.9884402599401284, 'recall': 0.9785048542556078, 'f1': 0.9833967744477744}
Epoch 3/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1224
Epoch 3/30, Step 20/1,Classification Loss: 0.3154, Contrastive Loss: 0.1150
Epoch 3/30, Step 40/1,Classification Loss: 0.3271, Contrastive Loss: 0.1112
Epoch 3/30, Step 60/1,Classification Loss: 0.3249, Contrastive Loss: 0.1084
Epoch 3/30, Step 80/1,Classification Loss: 0.3323, Contrastive Loss: 0.1116
Epoch 3/30, Step 100/1,Classification Loss: 0.3577, Contrastive Loss: 0.1151
Epoch 3/30, Step 120/1,Classification Loss: 0.3221, Contrastive Loss: 0.1055
Epoch 3/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0989
Accuracy: 0.9972, Precision: 0.9970, Recall: 0.9917, F1: 0.9944
Accuracy: 0.9924, Precision: 0.9869, Recall: 0.9823, F1: 0.9846
Epoch 3/30
Training - Loss: 62.0232
Training Metrics: {'accuracy': 0.9972491197183099, 'precision': 0.9970141693167346, 'recall': 0.9917417944200553, 'f1': 0.9943572012791271}
Validation Metrics: {'accuracy': 0.9924449797437863, 'precision': 0.9869344194679315, 'recall': 0.9823036339071286, 'f1': 0.9846025513736347}
Epoch 4/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0988
Epoch 4/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0978
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0949
Epoch 4/30, Step 60/1,Classification Loss: 0.3303, Contrastive Loss: 0.0994
Epoch 4/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.0966
Epoch 4/30, Step 100/1,Classification Loss: 0.3236, Contrastive Loss: 0.0936
Epoch 4/30, Step 120/1,Classification Loss: 0.3391, Contrastive Loss: 0.0955
Epoch 4/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0878
Accuracy: 0.9969, Precision: 0.9970, Recall: 0.9905, F1: 0.9937
Accuracy: 0.9923, Precision: 0.9881, Recall: 0.9807, F1: 0.9843
Epoch 4/30
Training - Loss: 59.9431
Training Metrics: {'accuracy': 0.996919014084507, 'precision': 0.9969874344645393, 'recall': 0.9904749858608806, 'f1': 0.9936993948588715}
Validation Metrics: {'accuracy': 0.9923354866965948, 'precision': 0.9880954920880258, 'recall': 0.9806583131255064, 'f1': 0.984334461489303}
Epoch 5/30, Step 0/1,Classification Loss: 0.3341, Contrastive Loss: 0.0910
Epoch 5/30, Step 20/1,Classification Loss: 0.3403, Contrastive Loss: 0.0975
Epoch 5/30, Step 40/1,Classification Loss: 0.3279, Contrastive Loss: 0.0882
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0833
Epoch 5/30, Step 80/1,Classification Loss: 0.3173, Contrastive Loss: 0.0842
Epoch 5/30, Step 100/1,Classification Loss: 0.3171, Contrastive Loss: 0.0827
Epoch 5/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0809
Epoch 5/30, Step 140/1,Classification Loss: 0.3430, Contrastive Loss: 0.0916
Accuracy: 0.9973, Precision: 0.9951, Recall: 0.9941, F1: 0.9946
Accuracy: 0.9933, Precision: 0.9863, Recall: 0.9866, F1: 0.9865
Epoch 5/30
Training - Loss: 58.7011
Training Metrics: {'accuracy': 0.9973316461267606, 'precision': 0.9950787700999566, 'recall': 0.9940503311922784, 'f1': 0.9945637568602923}
Validation Metrics: {'accuracy': 0.9933209241213183, 'precision': 0.9863029897818371, 'recall': 0.9866105516469257, 'f1': 0.9864566981198928}
Epoch 6/30, Step 0/1,Classification Loss: 0.3183, Contrastive Loss: 0.0788
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0777
Epoch 6/30, Step 40/1,Classification Loss: 0.3263, Contrastive Loss: 0.0784
Epoch 6/30, Step 60/1,Classification Loss: 0.3558, Contrastive Loss: 0.1128
Epoch 6/30, Step 80/1,Classification Loss: 0.3300, Contrastive Loss: 0.0873
Epoch 6/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0743
Epoch 6/30, Step 120/1,Classification Loss: 0.3336, Contrastive Loss: 0.0737
Epoch 6/30, Step 140/1,Classification Loss: 0.3372, Contrastive Loss: 0.0754
Accuracy: 0.9974, Precision: 0.9971, Recall: 0.9921, F1: 0.9946
Accuracy: 0.9929, Precision: 0.9888, Recall: 0.9822, F1: 0.9855
Epoch 6/30
Training - Loss: 57.1591
Training Metrics: {'accuracy': 0.9973591549295775, 'precision': 0.9970810457270554, 'recall': 0.9921353440689711, 'f1': 0.9945899045881336}
Validation Metrics: {'accuracy': 0.9928829519325523, 'precision': 0.9887565304299255, 'recall': 0.9822431806487321, 'f1': 0.9854673711030151}
Epoch 7/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0757
Epoch 7/30, Step 20/1,Classification Loss: 0.3315, Contrastive Loss: 0.0736
Epoch 7/30, Step 40/1,Classification Loss: 0.3282, Contrastive Loss: 0.0702
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0684
Epoch 7/30, Step 80/1,Classification Loss: 0.3698, Contrastive Loss: 0.0872
Epoch 7/30, Step 100/1,Classification Loss: 0.3196, Contrastive Loss: 0.0691
Epoch 7/30, Step 120/1,Classification Loss: 0.3300, Contrastive Loss: 0.0698
Epoch 7/30, Step 140/1,Classification Loss: 0.3162, Contrastive Loss: 0.0663
Accuracy: 0.9963, Precision: 0.9965, Recall: 0.9885, F1: 0.9924
Accuracy: 0.9914, Precision: 0.9887, Recall: 0.9760, F1: 0.9822
Epoch 7/30
Training - Loss: 56.1476
Training Metrics: {'accuracy': 0.9962863116197183, 'precision': 0.9964565269760775, 'recall': 0.9884736678028974, 'f1': 0.9924171039677561}
Validation Metrics: {'accuracy': 0.9913500492718712, 'precision': 0.9887258915624938, 'recall': 0.9759711672488272, 'f1': 0.9822235293488654}
Epoch 8/30, Step 0/1,Classification Loss: 0.3312, Contrastive Loss: 0.0690
Epoch 8/30, Step 20/1,Classification Loss: 0.3214, Contrastive Loss: 0.0653
Epoch 8/30, Step 40/1,Classification Loss: 0.3422, Contrastive Loss: 0.0672
Epoch 8/30, Step 60/1,Classification Loss: 0.3369, Contrastive Loss: 0.0656
Epoch 8/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0617
Epoch 8/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0607
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0598
Epoch 8/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0587
Accuracy: 0.9973, Precision: 0.9950, Recall: 0.9938, F1: 0.9944
Accuracy: 0.9936, Precision: 0.9868, Recall: 0.9874, F1: 0.9871
Epoch 8/30
Training - Loss: 55.2993
Training Metrics: {'accuracy': 0.9972766285211268, 'precision': 0.9950241156090276, 'recall': 0.9938295855354019, 'f1': 0.9944257825215717}
Validation Metrics: {'accuracy': 0.9936494032628929, 'precision': 0.9868192808164085, 'recall': 0.9874349628963871, 'f1': 0.9871268313585113}
Epoch 9/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.0603
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0582
Epoch 9/30, Step 40/1,Classification Loss: 0.3256, Contrastive Loss: 0.0603
Epoch 9/30, Step 60/1,Classification Loss: 0.3463, Contrastive Loss: 0.0675
Epoch 9/30, Step 80/1,Classification Loss: 0.3303, Contrastive Loss: 0.0579
Epoch 9/30, Step 100/1,Classification Loss: 0.3455, Contrastive Loss: 0.0643
Epoch 9/30, Step 120/1,Classification Loss: 0.3660, Contrastive Loss: 0.0759
Epoch 9/30, Step 140/1,Classification Loss: 0.3296, Contrastive Loss: 0.0563
Accuracy: 0.9975, Precision: 0.9972, Recall: 0.9925, F1: 0.9948
Accuracy: 0.9923, Precision: 0.9863, Recall: 0.9826, F1: 0.9844
Epoch 9/30
Training - Loss: 54.5939
Training Metrics: {'accuracy': 0.9974691901408451, 'precision': 0.9972305665572727, 'recall': 0.9924591748160353, 'f1': 0.9948278302910271}
Validation Metrics: {'accuracy': 0.9923354866965948, 'precision': 0.9862536988519469, 'recall': 0.9825559520926166, 'f1': 0.9843943084763186}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0544
Epoch 10/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0671
Epoch 10/30, Step 40/1,Classification Loss: 0.3249, Contrastive Loss: 0.0548
Epoch 10/30, Step 60/1,Classification Loss: 0.3382, Contrastive Loss: 0.0552
Epoch 10/30, Step 80/1,Classification Loss: 0.3145, Contrastive Loss: 0.0520
Epoch 10/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0548
Epoch 10/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0557
Epoch 10/30, Step 140/1,Classification Loss: 0.3163, Contrastive Loss: 0.0496
Accuracy: 0.9975, Precision: 0.9981, Recall: 0.9919, F1: 0.9949
Accuracy: 0.9923, Precision: 0.9875, Recall: 0.9813, F1: 0.9844
Epoch 10/30
Training - Loss: 53.7568
Training Metrics: {'accuracy': 0.9975242077464789, 'precision': 0.9980708469034063, 'recall': 0.9918576591185327, 'f1': 0.994935384259979}
Validation Metrics: {'accuracy': 0.9923354866965948, 'precision': 0.9874768600846682, 'recall': 0.9812908594478764, 'f1': 0.9843544736744215}
Epoch 11/30, Step 0/1,Classification Loss: 0.3193, Contrastive Loss: 0.0501
Epoch 11/30, Step 20/1,Classification Loss: 0.3147, Contrastive Loss: 0.0494
Epoch 11/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0486
Epoch 11/30, Step 60/1,Classification Loss: 0.3141, Contrastive Loss: 0.0482
Epoch 11/30, Step 80/1,Classification Loss: 0.3492, Contrastive Loss: 0.0545
Epoch 11/30, Step 100/1,Classification Loss: 0.3162, Contrastive Loss: 0.0464
Epoch 11/30, Step 120/1,Classification Loss: 0.3443, Contrastive Loss: 0.0512
Epoch 11/30, Step 140/1,Classification Loss: 0.3470, Contrastive Loss: 0.0508
Accuracy: 0.9972, Precision: 0.9971, Recall: 0.9914, F1: 0.9942
Accuracy: 0.9926, Precision: 0.9892, Recall: 0.9805, F1: 0.9848
Epoch 11/30
Training - Loss: 53.0317
Training Metrics: {'accuracy': 0.9971665933098591, 'precision': 0.9970557907691634, 'recall': 0.9914318708898148, 'f1': 0.9942200956777671}
Validation Metrics: {'accuracy': 0.9925544727909777, 'precision': 0.9891711087224725, 'recall': 0.9804699499157157, 'f1': 0.9847625461360359}
Epoch 12/30, Step 0/1,Classification Loss: 0.3365, Contrastive Loss: 0.0506
Epoch 12/30, Step 20/1,Classification Loss: 0.3154, Contrastive Loss: 0.0453
Epoch 12/30, Step 40/1,Classification Loss: 0.3439, Contrastive Loss: 0.0503
Epoch 12/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0450
Epoch 12/30, Step 80/1,Classification Loss: 0.3183, Contrastive Loss: 0.0450
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0421
Epoch 12/30, Step 120/1,Classification Loss: 0.3258, Contrastive Loss: 0.0444
Epoch 12/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0415
Accuracy: 0.9976, Precision: 0.9974, Recall: 0.9927, F1: 0.9950
Accuracy: 0.9918, Precision: 0.9859, Recall: 0.9807, F1: 0.9833
Epoch 12/30
Training - Loss: 52.3470
Training Metrics: {'accuracy': 0.9975517165492958, 'precision': 0.9973639523375881, 'recall': 0.9926898187757852, 'f1': 0.995010510446982}
Validation Metrics: {'accuracy': 0.9917880214606373, 'precision': 0.9858934220139373, 'recall': 0.9806548114082059, 'f1': 0.9832529727852831}
Epoch 13/30, Step 0/1,Classification Loss: 0.3172, Contrastive Loss: 0.0423
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0406
Epoch 13/30, Step 40/1,Classification Loss: 0.3161, Contrastive Loss: 0.0414
Epoch 13/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0400
Epoch 13/30, Step 80/1,Classification Loss: 0.3182, Contrastive Loss: 0.0412
Epoch 13/30, Step 100/1,Classification Loss: 0.3204, Contrastive Loss: 0.0424
Epoch 13/30, Step 120/1,Classification Loss: 0.3205, Contrastive Loss: 0.0390
Epoch 13/30, Step 140/1,Classification Loss: 0.3284, Contrastive Loss: 0.0402
Accuracy: 0.9972, Precision: 0.9971, Recall: 0.9915, F1: 0.9942
Accuracy: 0.9916, Precision: 0.9861, Recall: 0.9796, F1: 0.9828
Epoch 13/30
Training - Loss: 51.9605
Training Metrics: {'accuracy': 0.997194102112676, 'precision': 0.9970612289092664, 'recall': 0.9914612883254775, 'f1': 0.9942378259966744}
Validation Metrics: {'accuracy': 0.9915690353662543, 'precision': 0.9860554359735425, 'recall': 0.9795780819732566, 'f1': 0.9827844242297257}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0376
Epoch 14/30, Step 20/1,Classification Loss: 0.3144, Contrastive Loss: 0.0376
Epoch 14/30, Step 40/1,Classification Loss: 0.3143, Contrastive Loss: 0.0374
Epoch 14/30, Step 60/1,Classification Loss: 0.3202, Contrastive Loss: 0.0374
Epoch 14/30, Step 80/1,Classification Loss: 0.3304, Contrastive Loss: 0.0401
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0360
Epoch 14/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0402
Epoch 14/30, Step 140/1,Classification Loss: 0.3187, Contrastive Loss: 0.0371
Accuracy: 0.9955, Precision: 0.9969, Recall: 0.9845, F1: 0.9906
Accuracy: 0.9901, Precision: 0.9886, Recall: 0.9712, F1: 0.9796
Epoch 14/30
Training - Loss: 51.5649
Training Metrics: {'accuracy': 0.9954610475352113, 'precision': 0.996949120799697, 'recall': 0.9845351329461499, 'f1': 0.9906264248732235}
Validation Metrics: {'accuracy': 0.9901456257527647, 'precision': 0.9886131007369243, 'recall': 0.9711561114207536, 'f1': 0.9796497792291827}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 15/30, Step 20/1,Classification Loss: 0.3294, Contrastive Loss: 0.0451
Epoch 15/30, Step 40/1,Classification Loss: 0.3150, Contrastive Loss: 0.0347
Epoch 15/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0347
Epoch 15/30, Step 80/1,Classification Loss: 0.3147, Contrastive Loss: 0.0343
Epoch 15/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0340
Epoch 15/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0329
Epoch 15/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0323
Accuracy: 0.9977, Precision: 0.9973, Recall: 0.9931, F1: 0.9952
Accuracy: 0.9926, Precision: 0.9870, Recall: 0.9827, F1: 0.9848
Epoch 15/30
Training - Loss: 51.0142
Training Metrics: {'accuracy': 0.9976617517605634, 'precision': 0.997343824512895, 'recall': 0.9931262782752395, 'f1': 0.9952217488735928}
Validation Metrics: {'accuracy': 0.9925544727909777, 'precision': 0.9870058998381852, 'recall': 0.9826838620440108, 'f1': 0.9848305341423143}
Epoch 16/30, Step 0/1,Classification Loss: 0.3172, Contrastive Loss: 0.0333
Epoch 16/30, Step 20/1,Classification Loss: 0.3164, Contrastive Loss: 0.0332
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0312
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0306
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0317
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0304
Epoch 16/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0332
Epoch 16/30, Step 140/1,Classification Loss: 0.3282, Contrastive Loss: 0.0313
Accuracy: 0.9974, Precision: 0.9972, Recall: 0.9923, F1: 0.9947
Accuracy: 0.9916, Precision: 0.9876, Recall: 0.9780, F1: 0.9827
Epoch 16/30
Training - Loss: 50.7928
Training Metrics: {'accuracy': 0.9974141725352113, 'precision': 0.9972016303981079, 'recall': 0.9922873854201131, 'f1': 0.9947264035399628}
Validation Metrics: {'accuracy': 0.9915690353662543, 'precision': 0.9876036850538334, 'recall': 0.9779967161673315, 'f1': 0.9827292157111849}
Epoch 17/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0337
Epoch 17/30, Step 20/1,Classification Loss: 0.3414, Contrastive Loss: 0.0371
Epoch 17/30, Step 40/1,Classification Loss: 0.3282, Contrastive Loss: 0.0316
Epoch 17/30, Step 60/1,Classification Loss: 0.3267, Contrastive Loss: 0.0308
Epoch 17/30, Step 80/1,Classification Loss: 0.3242, Contrastive Loss: 0.0308
Epoch 17/30, Step 100/1,Classification Loss: 0.3183, Contrastive Loss: 0.0289
Epoch 17/30, Step 120/1,Classification Loss: 0.3146, Contrastive Loss: 0.0284
Epoch 17/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Accuracy: 0.9951, Precision: 0.9960, Recall: 0.9840, F1: 0.9899
Accuracy: 0.9908, Precision: 0.9890, Recall: 0.9734, F1: 0.9810
Epoch 17/30
Training - Loss: 50.5902
Training Metrics: {'accuracy': 0.9951034330985915, 'precision': 0.995992882115148, 'recall': 0.9839848586126899, 'f1': 0.9898804678812277}
Validation Metrics: {'accuracy': 0.9908025840359137, 'precision': 0.9890228794878339, 'recall': 0.9734374802420465, 'f1': 0.9810433833754881}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0280
Epoch 18/30, Step 20/1,Classification Loss: 0.3177, Contrastive Loss: 0.0290
Epoch 18/30, Step 40/1,Classification Loss: 0.3214, Contrastive Loss: 0.0285
Epoch 18/30, Step 60/1,Classification Loss: 0.3147, Contrastive Loss: 0.0284
Epoch 18/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0268
Epoch 18/30, Step 100/1,Classification Loss: 0.3195, Contrastive Loss: 0.0276
Epoch 18/30, Step 120/1,Classification Loss: 0.3506, Contrastive Loss: 0.0314
Epoch 18/30, Step 140/1,Classification Loss: 0.3172, Contrastive Loss: 0.0273
Accuracy: 0.9973, Precision: 0.9971, Recall: 0.9919, F1: 0.9945
Accuracy: 0.9923, Precision: 0.9893, Recall: 0.9794, F1: 0.9843
Epoch 18/30
Training - Loss: 50.0643
Training Metrics: {'accuracy': 0.9973041373239436, 'precision': 0.9971294607526446, 'recall': 0.9918646067219978, 'f1': 0.994476303387801}
Validation Metrics: {'accuracy': 0.9923354866965948, 'precision': 0.9893470717019723, 'recall': 0.9793932204807663, 'f1': 0.9842942460992461}
Epoch 19/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0259
Epoch 19/30, Step 20/1,Classification Loss: 0.3166, Contrastive Loss: 0.0272
Epoch 19/30, Step 40/1,Classification Loss: 0.3220, Contrastive Loss: 0.0272
Epoch 19/30, Step 60/1,Classification Loss: 0.3170, Contrastive Loss: 0.0261
Epoch 19/30, Step 80/1,Classification Loss: 0.3243, Contrastive Loss: 0.0271
Epoch 19/30, Step 100/1,Classification Loss: 0.3215, Contrastive Loss: 0.0266
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0241
Epoch 19/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Accuracy: 0.9974, Precision: 0.9972, Recall: 0.9923, F1: 0.9947
Accuracy: 0.9924, Precision: 0.9891, Recall: 0.9801, F1: 0.9845
Epoch 19/30
Training - Loss: 49.9686
Training Metrics: {'accuracy': 0.9974141725352113, 'precision': 0.9972013710293601, 'recall': 0.9922859681438729, 'f1': 0.9947255585048242}
Validation Metrics: {'accuracy': 0.9924449797437863, 'precision': 0.9891017379228444, 'recall': 0.9800897217788335, 'f1': 0.9845335088655165}
Epoch 20/30, Step 0/1,Classification Loss: 0.3164, Contrastive Loss: 0.0255
Epoch 20/30, Step 20/1,Classification Loss: 0.3228, Contrastive Loss: 0.0256
Epoch 20/30, Step 40/1,Classification Loss: 0.3224, Contrastive Loss: 0.0252
Epoch 20/30, Step 60/1,Classification Loss: 0.3286, Contrastive Loss: 0.0243
Epoch 20/30, Step 80/1,Classification Loss: 0.3178, Contrastive Loss: 0.0254
Epoch 20/30, Step 100/1,Classification Loss: 0.3282, Contrastive Loss: 0.0258
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 20/30, Step 140/1,Classification Loss: 0.3393, Contrastive Loss: 0.0271
Accuracy: 0.9978, Precision: 0.9974, Recall: 0.9935, F1: 0.9955
Accuracy: 0.9928, Precision: 0.9875, Recall: 0.9831, F1: 0.9853
Epoch 20/30
Training - Loss: 49.6190
Training Metrics: {'accuracy': 0.997771786971831, 'precision': 0.9974108747600813, 'recall': 0.9935181602878755, 'f1': 0.9954531808528448}
Validation Metrics: {'accuracy': 0.9927734588853607, 'precision': 0.987454060245949, 'recall': 0.98312804515659, 'f1': 0.9852766949028344}
Epoch 21/30, Step 0/1,Classification Loss: 0.3305, Contrastive Loss: 0.0275
Epoch 21/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.0267
Epoch 21/30, Step 40/1,Classification Loss: 0.3293, Contrastive Loss: 0.0254
Epoch 21/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0357
Epoch 21/30, Step 80/1,Classification Loss: 0.3198, Contrastive Loss: 0.0234
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 21/30, Step 120/1,Classification Loss: 0.3554, Contrastive Loss: 0.0264
Epoch 21/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Accuracy: 0.9976, Precision: 0.9973, Recall: 0.9929, F1: 0.9951
Accuracy: 0.9929, Precision: 0.9888, Recall: 0.9822, F1: 0.9855
Epoch 21/30
Training - Loss: 49.4880
Training Metrics: {'accuracy': 0.9975792253521126, 'precision': 0.9973028009009862, 'recall': 0.9928778428676474, 'f1': 0.9950756309938902}
Validation Metrics: {'accuracy': 0.9928829519325523, 'precision': 0.9887565304299255, 'recall': 0.9822431806487321, 'f1': 0.9854673711030151}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 22/30, Step 20/1,Classification Loss: 0.3155, Contrastive Loss: 0.0218
Epoch 22/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0232
Epoch 22/30, Step 60/1,Classification Loss: 0.3277, Contrastive Loss: 0.0245
Epoch 22/30, Step 80/1,Classification Loss: 0.3202, Contrastive Loss: 0.0220
Epoch 22/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0280
Epoch 22/30, Step 120/1,Classification Loss: 0.3314, Contrastive Loss: 0.0234
Epoch 22/30, Step 140/1,Classification Loss: 0.3194, Contrastive Loss: 0.0220
Accuracy: 0.9942, Precision: 0.9954, Recall: 0.9806, F1: 0.9879
Accuracy: 0.9892, Precision: 0.9880, Recall: 0.9677, F1: 0.9775
Epoch 22/30
Training - Loss: 49.2220
Training Metrics: {'accuracy': 0.9941681338028169, 'precision': 0.9954397851189222, 'recall': 0.9806265753428396, 'f1': 0.9878681215363032}
Validation Metrics: {'accuracy': 0.9891601883280412, 'precision': 0.9879989344158315, 'recall': 0.9677340581888145, 'f1': 0.9775490889506423}
Epoch 23/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0210
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Epoch 23/30, Step 40/1,Classification Loss: 0.3299, Contrastive Loss: 0.0463
Epoch 23/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0213
Epoch 23/30, Step 80/1,Classification Loss: 0.3253, Contrastive Loss: 0.0222
Epoch 23/30, Step 100/1,Classification Loss: 0.3440, Contrastive Loss: 0.0249
Epoch 23/30, Step 120/1,Classification Loss: 0.3149, Contrastive Loss: 0.0210
Epoch 23/30, Step 140/1,Classification Loss: 0.3347, Contrastive Loss: 0.0227
Accuracy: 0.9974, Precision: 0.9973, Recall: 0.9923, F1: 0.9948
Accuracy: 0.9922, Precision: 0.9883, Recall: 0.9800, F1: 0.9841
Epoch 23/30
Training - Loss: 49.2371
Training Metrics: {'accuracy': 0.9974416813380281, 'precision': 0.9972978794925766, 'recall': 0.9923020339494124, 'f1': 0.9947812514372072}
Validation Metrics: {'accuracy': 0.9922259936494032, 'precision': 0.9883366190436604, 'recall': 0.9799618118274392, 'f1': 0.984095402225353}
Epoch 24/30, Step 0/1,Classification Loss: 0.3195, Contrastive Loss: 0.0202
Epoch 24/30, Step 20/1,Classification Loss: 0.3318, Contrastive Loss: 0.0216
Epoch 24/30, Step 40/1,Classification Loss: 0.3313, Contrastive Loss: 0.0246
Epoch 24/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0197
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 24/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0194
Epoch 24/30, Step 140/1,Classification Loss: 0.3195, Contrastive Loss: 0.0216
Accuracy: 0.9977, Precision: 0.9973, Recall: 0.9931, F1: 0.9952
Accuracy: 0.9921, Precision: 0.9876, Recall: 0.9802, F1: 0.9839
Epoch 24/30
Training - Loss: 49.0958
Training Metrics: {'accuracy': 0.9976617517605634, 'precision': 0.997345411686422, 'recall': 0.9931338342777731, 'f1': 0.995226350085292}
Validation Metrics: {'accuracy': 0.9921165006022118, 'precision': 0.9876444361736867, 'recall': 0.9802141300129272, 'f1': 0.9838868746747118}
Epoch 25/30, Step 0/1,Classification Loss: 0.3301, Contrastive Loss: 0.0207
Epoch 25/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0200
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 25/30, Step 60/1,Classification Loss: 0.3142, Contrastive Loss: 0.0214
Epoch 25/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.0191
Epoch 25/30, Step 100/1,Classification Loss: 0.3174, Contrastive Loss: 0.0219
Epoch 25/30, Step 120/1,Classification Loss: 0.3246, Contrastive Loss: 0.0202
Epoch 25/30, Step 140/1,Classification Loss: 0.3445, Contrastive Loss: 0.0255
Accuracy: 0.9957, Precision: 0.9962, Recall: 0.9864, F1: 0.9912
Accuracy: 0.9904, Precision: 0.9884, Recall: 0.9722, F1: 0.9801
Epoch 25/30
Training - Loss: 48.9244
Training Metrics: {'accuracy': 0.9957361355633803, 'precision': 0.9962027614449191, 'recall': 0.9863854916626573, 'f1': 0.9912217195798155}
Validation Metrics: {'accuracy': 0.9903646118471477, 'precision': 0.9884268411569235, 'recall': 0.972232840855703, 'f1': 0.9801278143345271}
Epoch 26/30, Step 0/1,Classification Loss: 0.3250, Contrastive Loss: 0.0192
Epoch 26/30, Step 20/1,Classification Loss: 0.3245, Contrastive Loss: 0.0197
Epoch 26/30, Step 40/1,Classification Loss: 0.3505, Contrastive Loss: 0.0380
Epoch 26/30, Step 60/1,Classification Loss: 0.3158, Contrastive Loss: 0.0199
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 100/1,Classification Loss: 0.3442, Contrastive Loss: 0.0247
Epoch 26/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0187
Epoch 26/30, Step 140/1,Classification Loss: 0.3283, Contrastive Loss: 0.0195
Accuracy: 0.9965, Precision: 0.9966, Recall: 0.9889, F1: 0.9927
Accuracy: 0.9910, Precision: 0.9879, Recall: 0.9755, F1: 0.9816
Epoch 26/30
Training - Loss: 48.8531
Training Metrics: {'accuracy': 0.9964513644366197, 'precision': 0.9966222380710764, 'recall': 0.9888611342422726, 'f1': 0.992696578104425}
Validation Metrics: {'accuracy': 0.9910215701302967, 'precision': 0.9878833111254173, 'recall': 0.9754630291605508, 'f1': 0.981554421041535}
Epoch 27/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 20/1,Classification Loss: 0.3619, Contrastive Loss: 0.0258
Epoch 27/30, Step 40/1,Classification Loss: 0.3280, Contrastive Loss: 0.0211
Epoch 27/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0183
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 27/30, Step 100/1,Classification Loss: 0.3256, Contrastive Loss: 0.0190
Epoch 27/30, Step 120/1,Classification Loss: 0.3452, Contrastive Loss: 0.0211
Epoch 27/30, Step 140/1,Classification Loss: 0.3184, Contrastive Loss: 0.0184
Accuracy: 0.9969, Precision: 0.9978, Recall: 0.9895, F1: 0.9936
Accuracy: 0.9921, Precision: 0.9905, Recall: 0.9774, F1: 0.9838
Epoch 27/30
Training - Loss: 48.7857
Training Metrics: {'accuracy': 0.9968915052816901, 'precision': 0.997781504161734, 'recall': 0.9895211528414416, 'f1': 0.9936003504033495}
Validation Metrics: {'accuracy': 0.9921165006022118, 'precision': 0.9904824511432392, 'recall': 0.977367671562262, 'f1': 0.9837934332617024}
Epoch 28/30, Step 0/1,Classification Loss: 0.3247, Contrastive Loss: 0.0201
Epoch 28/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0179
Epoch 28/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0330
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 80/1,Classification Loss: 0.3422, Contrastive Loss: 0.0244
Epoch 28/30, Step 100/1,Classification Loss: 0.3355, Contrastive Loss: 0.0216
Epoch 28/30, Step 120/1,Classification Loss: 0.3257, Contrastive Loss: 0.0193
Epoch 28/30, Step 140/1,Classification Loss: 0.3145, Contrastive Loss: 0.0187
Accuracy: 0.9972, Precision: 0.9951, Recall: 0.9935, F1: 0.9943
Accuracy: 0.9929, Precision: 0.9875, Recall: 0.9835, F1: 0.9855
Epoch 28/30
Training - Loss: 48.8450
Training Metrics: {'accuracy': 0.997194102112676, 'precision': 0.9950995736710326, 'recall': 0.9935302689953752, 'f1': 0.9943130658082376}
Validation Metrics: {'accuracy': 0.9928829519325523, 'precision': 0.9875252575480371, 'recall': 0.9835082732934721, 'f1': 0.9855043898273437}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 29/30, Step 20/1,Classification Loss: 0.3191, Contrastive Loss: 0.0182
Epoch 29/30, Step 40/1,Classification Loss: 0.3268, Contrastive Loss: 0.0192
Epoch 29/30, Step 60/1,Classification Loss: 0.3286, Contrastive Loss: 0.0190
Epoch 29/30, Step 80/1,Classification Loss: 0.3215, Contrastive Loss: 0.0185
Epoch 29/30, Step 100/1,Classification Loss: 0.3335, Contrastive Loss: 0.0199
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 140/1,Classification Loss: 0.3175, Contrastive Loss: 0.0189
Accuracy: 0.9977, Precision: 0.9975, Recall: 0.9932, F1: 0.9953
Accuracy: 0.9924, Precision: 0.9882, Recall: 0.9810, F1: 0.9846
Epoch 29/30
Training - Loss: 48.7049
Training Metrics: {'accuracy': 0.9977167693661971, 'precision': 0.9974552534600136, 'recall': 0.9932307653305018, 'f1': 0.9953296746123141}
Validation Metrics: {'accuracy': 0.9924449797437863, 'precision': 0.9881657718833645, 'recall': 0.9810385412623885, 'f1': 0.9845631923346765}
Epoch 30/30, Step 0/1,Classification Loss: 0.3342, Contrastive Loss: 0.0235
Epoch 30/30, Step 20/1,Classification Loss: 0.3162, Contrastive Loss: 0.0179
Epoch 30/30, Step 40/1,Classification Loss: 0.3194, Contrastive Loss: 0.0181
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 80/1,Classification Loss: 0.3246, Contrastive Loss: 0.0215
Epoch 30/30, Step 100/1,Classification Loss: 0.3150, Contrastive Loss: 0.0183
Epoch 30/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0176
Epoch 30/30, Step 140/1,Classification Loss: 0.3154, Contrastive Loss: 0.0178
Accuracy: 0.9979, Precision: 0.9976, Recall: 0.9937, F1: 0.9957
Accuracy: 0.9929, Precision: 0.9888, Recall: 0.9822, F1: 0.9855
Epoch 30/30
Training - Loss: 48.8014
Training Metrics: {'accuracy': 0.9978818221830986, 'precision': 0.997634457809996, 'recall': 0.9937326156726995, 'f1': 0.9956721620111522}
Validation Metrics: {'accuracy': 0.9928829519325523, 'precision': 0.9887565304299255, 'recall': 0.9822431806487321, 'f1': 0.9854673711030151}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1503, 5814), y shape: (1503,), y distribution: Counter({np.float64(0.0): 1362, np.float64(1.0): 141}), env shape: (1503,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.7265, Precision: 0.5044, Recall: 0.5090, F1: 0.4897
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11615]))
original train data shape: torch.Size([45762]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1503, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45762]), new train data shape: torch.Size([45762])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11615]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3167, Contrastive Loss: 1.6065
Epoch 1/30, Step 20/1,Classification Loss: 0.3234, Contrastive Loss: 0.8944
Epoch 1/30, Step 40/1,Classification Loss: 0.3353, Contrastive Loss: 0.3857
Epoch 1/30, Step 60/1,Classification Loss: 0.3258, Contrastive Loss: 0.2376
Epoch 1/30, Step 80/1,Classification Loss: 0.3141, Contrastive Loss: 0.1889
Epoch 1/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.1695
Epoch 1/30, Step 120/1,Classification Loss: 0.3450, Contrastive Loss: 0.1668
Epoch 1/30, Step 140/1,Classification Loss: 0.3144, Contrastive Loss: 0.1456
Accuracy: 0.9971, Precision: 0.9950, Recall: 0.9930, F1: 0.9940
Accuracy: 0.9930, Precision: 0.9873, Recall: 0.9842, F1: 0.9858
Epoch 1/30
Training - Loss: 105.4658
Training Metrics: {'accuracy': 0.9970771416083916, 'precision': 0.9950171214419482, 'recall': 0.9930475765654116, 'f1': 0.9940294390539728}
Validation Metrics: {'accuracy': 0.9930077570195565, 'precision': 0.987313112924953, 'recall': 0.9842301055463889, 'f1': 0.9857643219972565}
Epoch 2/30, Step 0/1,Classification Loss: 0.3431, Contrastive Loss: 0.1518
Epoch 2/30, Step 20/1,Classification Loss: 0.3331, Contrastive Loss: 0.1443
Epoch 2/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1297
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1274
Epoch 2/30, Step 80/1,Classification Loss: 0.3565, Contrastive Loss: 0.1518
Epoch 2/30, Step 100/1,Classification Loss: 0.3420, Contrastive Loss: 0.1395
Epoch 2/30, Step 120/1,Classification Loss: 0.3328, Contrastive Loss: 0.1255
Epoch 2/30, Step 140/1,Classification Loss: 0.3255, Contrastive Loss: 0.1193
Accuracy: 0.9970, Precision: 0.9970, Recall: 0.9908, F1: 0.9938
Accuracy: 0.9934, Precision: 0.9901, Recall: 0.9832, F1: 0.9866
Epoch 2/30
Training - Loss: 65.7870
Training Metrics: {'accuracy': 0.9969951923076923, 'precision': 0.9969535619631815, 'recall': 0.9907618476187803, 'f1': 0.9938290317782612}
Validation Metrics: {'accuracy': 0.9934447722058342, 'precision': 0.990055286352054, 'recall': 0.9832219671837591, 'f1': 0.986602989681487}
Epoch 3/30, Step 0/1,Classification Loss: 0.3167, Contrastive Loss: 0.1176
Epoch 3/30, Step 20/1,Classification Loss: 0.3651, Contrastive Loss: 0.1307
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1102
Epoch 3/30, Step 60/1,Classification Loss: 0.3424, Contrastive Loss: 0.1243
Epoch 3/30, Step 80/1,Classification Loss: 0.3153, Contrastive Loss: 0.1085
Epoch 3/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1128
Epoch 3/30, Step 120/1,Classification Loss: 0.3252, Contrastive Loss: 0.1052
Epoch 3/30, Step 140/1,Classification Loss: 0.3232, Contrastive Loss: 0.1017
Accuracy: 0.9971, Precision: 0.9968, Recall: 0.9913, F1: 0.9940
Accuracy: 0.9929, Precision: 0.9882, Recall: 0.9829, F1: 0.9855
Epoch 3/30
Training - Loss: 62.9720
Training Metrics: {'accuracy': 0.9970771416083916, 'precision': 0.9967638277703745, 'recall': 0.9913033814284504, 'f1': 0.9940112808457149}
Validation Metrics: {'accuracy': 0.992898503222987, 'precision': 0.9881587634319074, 'recall': 0.9829029268570617, 'f1': 0.9855096847728974}
Epoch 4/30, Step 0/1,Classification Loss: 0.3282, Contrastive Loss: 0.1098
Epoch 4/30, Step 20/1,Classification Loss: 0.3369, Contrastive Loss: 0.1062
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0942
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0949
Epoch 4/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0991
Epoch 4/30, Step 100/1,Classification Loss: 0.3553, Contrastive Loss: 0.1144
Epoch 4/30, Step 120/1,Classification Loss: 0.3452, Contrastive Loss: 0.0992
Epoch 4/30, Step 140/1,Classification Loss: 0.3254, Contrastive Loss: 0.0957
Accuracy: 0.9972, Precision: 0.9953, Recall: 0.9933, F1: 0.9943
Accuracy: 0.9929, Precision: 0.9866, Recall: 0.9845, F1: 0.9856
Epoch 4/30
Training - Loss: 60.6713
Training Metrics: {'accuracy': 0.9972137237762237, 'precision': 0.9953393252044562, 'recall': 0.993291997870335, 'f1': 0.9943125178654564}
Validation Metrics: {'accuracy': 0.992898503222987, 'precision': 0.9866362575467208, 'recall': 0.9844821401370464, 'f1': 0.9855556372661427}
Epoch 5/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.0953
Epoch 5/30, Step 20/1,Classification Loss: 0.3329, Contrastive Loss: 0.0973
Epoch 5/30, Step 40/1,Classification Loss: 0.3220, Contrastive Loss: 0.0853
Epoch 5/30, Step 60/1,Classification Loss: 0.3198, Contrastive Loss: 0.0841
Epoch 5/30, Step 80/1,Classification Loss: 0.3201, Contrastive Loss: 0.0872
Epoch 5/30, Step 100/1,Classification Loss: 0.3180, Contrastive Loss: 0.0818
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0787
Epoch 5/30, Step 140/1,Classification Loss: 0.3286, Contrastive Loss: 0.0801
Accuracy: 0.9969, Precision: 0.9950, Recall: 0.9923, F1: 0.9936
Accuracy: 0.9924, Precision: 0.9869, Recall: 0.9820, F1: 0.9844
Epoch 5/30
Training - Loss: 59.1515
Training Metrics: {'accuracy': 0.9968859265734266, 'precision': 0.9949835085334484, 'recall': 0.9923079684376073, 'f1': 0.9936403627474358}
Validation Metrics: {'accuracy': 0.9923522342401399, 'precision': 0.9868852107571942, 'recall': 0.9819522012183707, 'f1': 0.9844000114532856}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0780
Epoch 6/30, Step 20/1,Classification Loss: 0.3156, Contrastive Loss: 0.0820
Epoch 6/30, Step 40/1,Classification Loss: 0.3176, Contrastive Loss: 0.0785
Epoch 6/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0737
Epoch 6/30, Step 80/1,Classification Loss: 0.3141, Contrastive Loss: 0.0732
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0715
Epoch 6/30, Step 120/1,Classification Loss: 0.3186, Contrastive Loss: 0.0756
Epoch 6/30, Step 140/1,Classification Loss: 0.3291, Contrastive Loss: 0.0742
Accuracy: 0.9970, Precision: 0.9951, Recall: 0.9929, F1: 0.9940
Accuracy: 0.9927, Precision: 0.9871, Recall: 0.9831, F1: 0.9851
Epoch 6/30
Training - Loss: 57.8512
Training Metrics: {'accuracy': 0.9970498251748252, 'precision': 0.9950663761275378, 'recall': 0.9928506310922458, 'f1': 0.9939548273283154}
Validation Metrics: {'accuracy': 0.9926799956298481, 'precision': 0.9870991439650395, 'recall': 0.9830911533823798, 'f1': 0.9850828203141371}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0700
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0684
Epoch 7/30, Step 40/1,Classification Loss: 0.3680, Contrastive Loss: 0.0922
Epoch 7/30, Step 60/1,Classification Loss: 0.3182, Contrastive Loss: 0.0701
Epoch 7/30, Step 80/1,Classification Loss: 0.3316, Contrastive Loss: 0.0844
Epoch 7/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0678
Epoch 7/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0660
Epoch 7/30, Step 140/1,Classification Loss: 0.3171, Contrastive Loss: 0.0662
Accuracy: 0.9966, Precision: 0.9967, Recall: 0.9896, F1: 0.9931
Accuracy: 0.9930, Precision: 0.9907, Recall: 0.9808, F1: 0.9857
Epoch 7/30
Training - Loss: 56.7601
Training Metrics: {'accuracy': 0.9966127622377622, 'precision': 0.9966567696808246, 'recall': 0.9895769611445895, 'f1': 0.9930791897054556}
Validation Metrics: {'accuracy': 0.9930077570195565, 'precision': 0.9907239886136823, 'recall': 0.980755836330423, 'f1': 0.9856640704689328}
Epoch 8/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0646
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0618
Epoch 8/30, Step 40/1,Classification Loss: 0.3392, Contrastive Loss: 0.0819
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0609
Epoch 8/30, Step 80/1,Classification Loss: 0.3424, Contrastive Loss: 0.0713
Epoch 8/30, Step 100/1,Classification Loss: 0.3381, Contrastive Loss: 0.0683
Epoch 8/30, Step 120/1,Classification Loss: 0.3278, Contrastive Loss: 0.0634
Epoch 8/30, Step 140/1,Classification Loss: 0.3171, Contrastive Loss: 0.0600
Accuracy: 0.9974, Precision: 0.9955, Recall: 0.9941, F1: 0.9948
Accuracy: 0.9927, Precision: 0.9847, Recall: 0.9856, F1: 0.9852
Epoch 8/30
Training - Loss: 55.8959
Training Metrics: {'accuracy': 0.9974322552447552, 'precision': 0.9954913393276883, 'recall': 0.9940835791051904, 'f1': 0.9947859695179757}
Validation Metrics: {'accuracy': 0.9926799956298481, 'precision': 0.9846997841300791, 'recall': 0.9856178946303551, 'f1': 0.9851581904401574}
Epoch 9/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0648
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0571
Epoch 9/30, Step 40/1,Classification Loss: 0.3456, Contrastive Loss: 0.0624
Epoch 9/30, Step 60/1,Classification Loss: 0.3217, Contrastive Loss: 0.0594
Epoch 9/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0592
Epoch 9/30, Step 100/1,Classification Loss: 0.3589, Contrastive Loss: 0.0620
Epoch 9/30, Step 120/1,Classification Loss: 0.3272, Contrastive Loss: 0.0557
Epoch 9/30, Step 140/1,Classification Loss: 0.3309, Contrastive Loss: 0.0594
Accuracy: 0.9961, Precision: 0.9946, Recall: 0.9896, F1: 0.9921
Accuracy: 0.9919, Precision: 0.9875, Recall: 0.9795, F1: 0.9835
Epoch 9/30
Training - Loss: 54.9405
Training Metrics: {'accuracy': 0.9961210664335665, 'precision': 0.9945988775801681, 'recall': 0.9895630761464, 'f1': 0.9920618879837122}
Validation Metrics: {'accuracy': 0.9919152190538622, 'precision': 0.9875250274831864, 'recall': 0.9794860703650344, 'f1': 0.983455895284226}
Epoch 10/30, Step 0/1,Classification Loss: 0.3199, Contrastive Loss: 0.0551
Epoch 10/30, Step 20/1,Classification Loss: 0.3148, Contrastive Loss: 0.0540
Epoch 10/30, Step 40/1,Classification Loss: 0.3201, Contrastive Loss: 0.0533
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0504
Epoch 10/30, Step 80/1,Classification Loss: 0.3324, Contrastive Loss: 0.0545
Epoch 10/30, Step 100/1,Classification Loss: 0.3421, Contrastive Loss: 0.0606
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0496
Epoch 10/30, Step 140/1,Classification Loss: 0.3137, Contrastive Loss: 0.0497
Accuracy: 0.9974, Precision: 0.9954, Recall: 0.9939, F1: 0.9946
Accuracy: 0.9932, Precision: 0.9872, Recall: 0.9853, F1: 0.9862
Epoch 10/30
Training - Loss: 54.2683
Training Metrics: {'accuracy': 0.9973776223776224, 'precision': 0.9953529404955865, 'recall': 0.9939322792910148, 'f1': 0.994641098418679}
Validation Metrics: {'accuracy': 0.9932262646126953, 'precision': 0.9871533145761513, 'recall': 0.9853052496450585, 'f1': 0.9862266643599704}
Epoch 11/30, Step 0/1,Classification Loss: 0.3258, Contrastive Loss: 0.0509
Epoch 11/30, Step 20/1,Classification Loss: 0.3352, Contrastive Loss: 0.0537
Epoch 11/30, Step 40/1,Classification Loss: 0.3159, Contrastive Loss: 0.0481
Epoch 11/30, Step 60/1,Classification Loss: 0.3398, Contrastive Loss: 0.0522
Epoch 11/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0467
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0451
Epoch 11/30, Step 120/1,Classification Loss: 0.3191, Contrastive Loss: 0.0494
Epoch 11/30, Step 140/1,Classification Loss: 0.3209, Contrastive Loss: 0.0466
Accuracy: 0.9973, Precision: 0.9952, Recall: 0.9937, F1: 0.9945
Accuracy: 0.9927, Precision: 0.9865, Recall: 0.9837, F1: 0.9851
Epoch 11/30
Training - Loss: 53.7071
Training Metrics: {'accuracy': 0.9972956730769231, 'precision': 0.995230843613335, 'recall': 0.9937347438494497, 'f1': 0.9944811153933752}
Validation Metrics: {'accuracy': 0.9926799956298481, 'precision': 0.9864924482958233, 'recall': 0.9837228386943736, 'f1': 0.9851017518926453}
Epoch 12/30, Step 0/1,Classification Loss: 0.3166, Contrastive Loss: 0.0475
Epoch 12/30, Step 20/1,Classification Loss: 0.3213, Contrastive Loss: 0.0449
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0441
Epoch 12/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0460
Epoch 12/30, Step 80/1,Classification Loss: 0.3339, Contrastive Loss: 0.0479
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0412
Epoch 12/30, Step 120/1,Classification Loss: 0.3259, Contrastive Loss: 0.0435
Epoch 12/30, Step 140/1,Classification Loss: 0.3368, Contrastive Loss: 0.0476
Accuracy: 0.9974, Precision: 0.9953, Recall: 0.9939, F1: 0.9946
Accuracy: 0.9930, Precision: 0.9867, Recall: 0.9849, F1: 0.9858
Epoch 12/30
Training - Loss: 52.9399
Training Metrics: {'accuracy': 0.9973503059440559, 'precision': 0.9953479794113663, 'recall': 0.9938543395928433, 'f1': 0.9945994857827081}
Validation Metrics: {'accuracy': 0.9930077570195565, 'precision': 0.9867081670778189, 'recall': 0.9848617908583828, 'f1': 0.985782363210292}
Epoch 13/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0425
Epoch 13/30, Step 20/1,Classification Loss: 0.3250, Contrastive Loss: 0.0427
Epoch 13/30, Step 40/1,Classification Loss: 0.3333, Contrastive Loss: 0.0433
Epoch 13/30, Step 60/1,Classification Loss: 0.3293, Contrastive Loss: 0.0466
Epoch 13/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0428
Epoch 13/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0394
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0383
Epoch 13/30, Step 140/1,Classification Loss: 0.3348, Contrastive Loss: 0.0429
Accuracy: 0.9965, Precision: 0.9974, Recall: 0.9885, F1: 0.9929
Accuracy: 0.9925, Precision: 0.9920, Recall: 0.9773, F1: 0.9845
Epoch 13/30
Training - Loss: 52.5185
Training Metrics: {'accuracy': 0.9965308129370629, 'precision': 0.9974118627201121, 'recall': 0.9884511144235955, 'f1': 0.9928713257583268}
Validation Metrics: {'accuracy': 0.9924614880367093, 'precision': 0.9919904888522196, 'recall': 0.9772783694437565, 'f1': 0.9844692935725425}
Epoch 14/30, Step 0/1,Classification Loss: 0.3378, Contrastive Loss: 0.0428
Epoch 14/30, Step 20/1,Classification Loss: 0.3408, Contrastive Loss: 0.0822
Epoch 14/30, Step 40/1,Classification Loss: 0.3173, Contrastive Loss: 0.0406
Epoch 14/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0461
Epoch 14/30, Step 80/1,Classification Loss: 0.3279, Contrastive Loss: 0.0386
Epoch 14/30, Step 100/1,Classification Loss: 0.3575, Contrastive Loss: 0.0572
Epoch 14/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0355
Epoch 14/30, Step 140/1,Classification Loss: 0.3295, Contrastive Loss: 0.0504
Accuracy: 0.9972, Precision: 0.9953, Recall: 0.9932, F1: 0.9943
Accuracy: 0.9925, Precision: 0.9882, Recall: 0.9811, F1: 0.9846
Epoch 14/30
Training - Loss: 52.1705
Training Metrics: {'accuracy': 0.9971864073426573, 'precision': 0.9953220663464726, 'recall': 0.9931954880576955, 'f1': 0.9942553855033427}
Validation Metrics: {'accuracy': 0.9924614880367093, 'precision': 0.9881862474490011, 'recall': 0.9810684813157193, 'f1': 0.9845885194954715}
Epoch 15/30, Step 0/1,Classification Loss: 0.3401, Contrastive Loss: 0.0388
Epoch 15/30, Step 20/1,Classification Loss: 0.3151, Contrastive Loss: 0.0351
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0336
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Epoch 15/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0336
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0326
Epoch 15/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0324
Accuracy: 0.9970, Precision: 0.9958, Recall: 0.9919, F1: 0.9938
Accuracy: 0.9928, Precision: 0.9887, Recall: 0.9819, F1: 0.9853
Epoch 15/30
Training - Loss: 51.6647
Training Metrics: {'accuracy': 0.9969951923076923, 'precision': 0.9958361546146759, 'recall': 0.9918867760501016, 'f1': 0.9938497748367086}
Validation Metrics: {'accuracy': 0.9927892494264176, 'precision': 0.9887060969270183, 'recall': 0.9818915908237316, 'f1': 0.9852632886496356}
Epoch 16/30, Step 0/1,Classification Loss: 0.3435, Contrastive Loss: 0.0872
Epoch 16/30, Step 20/1,Classification Loss: 0.3313, Contrastive Loss: 0.0363
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0317
Epoch 16/30, Step 60/1,Classification Loss: 0.3224, Contrastive Loss: 0.0343
Epoch 16/30, Step 80/1,Classification Loss: 0.3284, Contrastive Loss: 0.0333
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0308
Epoch 16/30, Step 120/1,Classification Loss: 0.3223, Contrastive Loss: 0.0328
Epoch 16/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0441
Accuracy: 0.9973, Precision: 0.9955, Recall: 0.9936, F1: 0.9945
Accuracy: 0.9929, Precision: 0.9882, Recall: 0.9829, F1: 0.9855
Epoch 16/30
Training - Loss: 51.4347
Training Metrics: {'accuracy': 0.9973229895104895, 'precision': 0.9954783873019024, 'recall': 0.9935841509670849, 'f1': 0.9945285815783188}
Validation Metrics: {'accuracy': 0.992898503222987, 'precision': 0.9881587634319074, 'recall': 0.9829029268570617, 'f1': 0.9855096847728974}
Epoch 17/30, Step 0/1,Classification Loss: 0.3181, Contrastive Loss: 0.0319
Epoch 17/30, Step 20/1,Classification Loss: 0.3323, Contrastive Loss: 0.0322
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0290
Epoch 17/30, Step 60/1,Classification Loss: 0.3219, Contrastive Loss: 0.0295
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 17/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0285
Epoch 17/30, Step 120/1,Classification Loss: 0.3357, Contrastive Loss: 0.0346
Epoch 17/30, Step 140/1,Classification Loss: 0.3442, Contrastive Loss: 0.0417
Accuracy: 0.9975, Precision: 0.9952, Recall: 0.9945, F1: 0.9948
Accuracy: 0.9927, Precision: 0.9853, Recall: 0.9850, F1: 0.9851
Epoch 17/30
Training - Loss: 50.8574
Training Metrics: {'accuracy': 0.9974595716783217, 'precision': 0.9951882817443627, 'recall': 0.99448309216866, 'f1': 0.994835313473132}
Validation Metrics: {'accuracy': 0.9926799956298481, 'precision': 0.9852928086820643, 'recall': 0.9849862093183612, 'f1': 0.9851394366865793}
Epoch 18/30, Step 0/1,Classification Loss: 0.3238, Contrastive Loss: 0.0303
Epoch 18/30, Step 20/1,Classification Loss: 0.3301, Contrastive Loss: 0.0342
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0275
Epoch 18/30, Step 60/1,Classification Loss: 0.3281, Contrastive Loss: 0.0306
Epoch 18/30, Step 80/1,Classification Loss: 0.3298, Contrastive Loss: 0.0316
Epoch 18/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0266
Epoch 18/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0270
Epoch 18/30, Step 140/1,Classification Loss: 0.3674, Contrastive Loss: 0.0411
Accuracy: 0.9975, Precision: 0.9953, Recall: 0.9945, F1: 0.9949
Accuracy: 0.9924, Precision: 0.9848, Recall: 0.9842, F1: 0.9845
Epoch 18/30
Training - Loss: 50.5368
Training Metrics: {'accuracy': 0.9974868881118881, 'precision': 0.9952661869240638, 'recall': 0.9944782390717013, 'f1': 0.9948717478642662}
Validation Metrics: {'accuracy': 0.9923522342401399, 'precision': 0.9847757391357499, 'recall': 0.984163099810349, 'f1': 0.9844691303391713}
Epoch 19/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0311
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0255
Epoch 19/30, Step 60/1,Classification Loss: 0.3144, Contrastive Loss: 0.0255
Epoch 19/30, Step 80/1,Classification Loss: 0.3282, Contrastive Loss: 0.0306
Epoch 19/30, Step 100/1,Classification Loss: 0.3150, Contrastive Loss: 0.0272
Epoch 19/30, Step 120/1,Classification Loss: 0.3374, Contrastive Loss: 0.0317
Epoch 19/30, Step 140/1,Classification Loss: 0.3279, Contrastive Loss: 0.0260
Accuracy: 0.9975, Precision: 0.9954, Recall: 0.9943, F1: 0.9949
Accuracy: 0.9928, Precision: 0.9854, Recall: 0.9854, F1: 0.9854
Epoch 19/30
Training - Loss: 50.4330
Training Metrics: {'accuracy': 0.9974868881118881, 'precision': 0.9954317649675504, 'recall': 0.9943314715058564, 'f1': 0.9948807102567028}
Validation Metrics: {'accuracy': 0.9927892494264176, 'precision': 0.9853658600396976, 'recall': 0.9853658600396976, 'f1': 0.9853658600396976}
Epoch 20/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0246
Epoch 20/30, Step 20/1,Classification Loss: 0.3277, Contrastive Loss: 0.0275
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0239
Epoch 20/30, Step 60/1,Classification Loss: 0.3198, Contrastive Loss: 0.0252
Epoch 20/30, Step 80/1,Classification Loss: 0.3281, Contrastive Loss: 0.0256
Epoch 20/30, Step 100/1,Classification Loss: 0.3183, Contrastive Loss: 0.0251
Epoch 20/30, Step 120/1,Classification Loss: 0.3358, Contrastive Loss: 0.0291
Epoch 20/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0235
Accuracy: 0.9974, Precision: 0.9953, Recall: 0.9938, F1: 0.9946
Accuracy: 0.9926, Precision: 0.9861, Recall: 0.9837, F1: 0.9849
Epoch 20/30
Training - Loss: 50.0747
Training Metrics: {'accuracy': 0.9973503059440559, 'precision': 0.9953238991056506, 'recall': 0.9938179603461501, 'f1': 0.9945692342471419}
Validation Metrics: {'accuracy': 0.9925707418332788, 'precision': 0.986118637339503, 'recall': 0.9836590306290341, 'f1': 0.9848841840620484}
Epoch 21/30, Step 0/1,Classification Loss: 0.3294, Contrastive Loss: 0.0290
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 21/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0241
Epoch 21/30, Step 60/1,Classification Loss: 0.3285, Contrastive Loss: 0.0272
Epoch 21/30, Step 80/1,Classification Loss: 0.3203, Contrastive Loss: 0.0237
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 21/30, Step 120/1,Classification Loss: 0.3431, Contrastive Loss: 0.0291
Epoch 21/30, Step 140/1,Classification Loss: 0.3291, Contrastive Loss: 0.0379
Accuracy: 0.9975, Precision: 0.9951, Recall: 0.9949, F1: 0.9950
Accuracy: 0.9928, Precision: 0.9833, Recall: 0.9876, F1: 0.9854
Epoch 21/30
Training - Loss: 50.0377
Training Metrics: {'accuracy': 0.9975415209790209, 'precision': 0.9950830194738656, 'recall': 0.9949263860191802, 'f1': 0.995004684321375}
Validation Metrics: {'accuracy': 0.9927892494264176, 'precision': 0.9833117249484732, 'recall': 0.9875767586316759, 'f1': 0.9854302154936387}
Epoch 22/30, Step 0/1,Classification Loss: 0.3164, Contrastive Loss: 0.0227
Epoch 22/30, Step 20/1,Classification Loss: 0.3293, Contrastive Loss: 0.0364
Epoch 22/30, Step 40/1,Classification Loss: 0.3140, Contrastive Loss: 0.0224
Epoch 22/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0223
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 22/30, Step 100/1,Classification Loss: 0.3249, Contrastive Loss: 0.0234
Epoch 22/30, Step 120/1,Classification Loss: 0.3251, Contrastive Loss: 0.0235
Epoch 22/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0246
Accuracy: 0.9967, Precision: 0.9950, Recall: 0.9917, F1: 0.9933
Accuracy: 0.9921, Precision: 0.9867, Recall: 0.9812, F1: 0.9839
Epoch 22/30
Training - Loss: 49.7622
Training Metrics: {'accuracy': 0.996722027972028, 'precision': 0.9949625586477961, 'recall': 0.9916566085974965, 'f1': 0.9933013730233488}
Validation Metrics: {'accuracy': 0.992133726647001, 'precision': 0.986742608023684, 'recall': 0.981192899775698, 'f1': 0.9839440770431702}
Epoch 23/30, Step 0/1,Classification Loss: 0.3298, Contrastive Loss: 0.0351
Epoch 23/30, Step 20/1,Classification Loss: 0.3303, Contrastive Loss: 0.0303
Epoch 23/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0206
Epoch 23/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0211
Epoch 23/30, Step 80/1,Classification Loss: 0.3223, Contrastive Loss: 0.0223
Epoch 23/30, Step 100/1,Classification Loss: 0.3440, Contrastive Loss: 0.0263
Epoch 23/30, Step 120/1,Classification Loss: 0.3314, Contrastive Loss: 0.0325
Epoch 23/30, Step 140/1,Classification Loss: 0.3148, Contrastive Loss: 0.0205
Accuracy: 0.9974, Precision: 0.9953, Recall: 0.9939, F1: 0.9946
Accuracy: 0.9929, Precision: 0.9872, Recall: 0.9839, F1: 0.9855
Epoch 23/30
Training - Loss: 49.7714
Training Metrics: {'accuracy': 0.9973503059440559, 'precision': 0.9953466125111501, 'recall': 0.9938522741413638, 'f1': 0.9945977683752145}
Validation Metrics: {'accuracy': 0.992898503222987, 'precision': 0.9872417859089544, 'recall': 0.9838504548250525, 'f1': 0.9855372997256524}
Epoch 24/30, Step 0/1,Classification Loss: 0.3368, Contrastive Loss: 0.0276
Epoch 24/30, Step 20/1,Classification Loss: 0.3226, Contrastive Loss: 0.0229
Epoch 24/30, Step 40/1,Classification Loss: 0.3318, Contrastive Loss: 0.0241
Epoch 24/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0268
Epoch 24/30, Step 80/1,Classification Loss: 0.3161, Contrastive Loss: 0.0219
Epoch 24/30, Step 100/1,Classification Loss: 0.3246, Contrastive Loss: 0.0208
Epoch 24/30, Step 120/1,Classification Loss: 0.3271, Contrastive Loss: 0.0225
Epoch 24/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0210
Accuracy: 0.9974, Precision: 0.9960, Recall: 0.9935, F1: 0.9947
Accuracy: 0.9928, Precision: 0.9872, Recall: 0.9835, F1: 0.9853
Epoch 24/30
Training - Loss: 49.8784
Training Metrics: {'accuracy': 0.9974322552447552, 'precision': 0.9960092459275875, 'recall': 0.9934705574269378, 'f1': 0.9947350864868814}
Validation Metrics: {'accuracy': 0.9927892494264176, 'precision': 0.9871704629336708, 'recall': 0.9834708041037161, 'f1': 0.9853101325550329}
Epoch 25/30, Step 0/1,Classification Loss: 0.3210, Contrastive Loss: 0.0202
Epoch 25/30, Step 20/1,Classification Loss: 0.3154, Contrastive Loss: 0.0214
Epoch 25/30, Step 40/1,Classification Loss: 0.3248, Contrastive Loss: 0.0209
Epoch 25/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0198
Epoch 25/30, Step 80/1,Classification Loss: 0.3180, Contrastive Loss: 0.0197
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 25/30, Step 120/1,Classification Loss: 0.3294, Contrastive Loss: 0.0339
Epoch 25/30, Step 140/1,Classification Loss: 0.3297, Contrastive Loss: 0.0353
Accuracy: 0.9973, Precision: 0.9953, Recall: 0.9937, F1: 0.9945
Accuracy: 0.9929, Precision: 0.9866, Recall: 0.9845, F1: 0.9856
Epoch 25/30
Training - Loss: 49.4860
Training Metrics: {'accuracy': 0.9972956730769231, 'precision': 0.9953411623272129, 'recall': 0.9937052250117843, 'f1': 0.9945211776806726}
Validation Metrics: {'accuracy': 0.992898503222987, 'precision': 0.9866362575467208, 'recall': 0.9844821401370464, 'f1': 0.9855556372661427}
Epoch 26/30, Step 0/1,Classification Loss: 0.3296, Contrastive Loss: 0.0253
Epoch 26/30, Step 20/1,Classification Loss: 0.3204, Contrastive Loss: 0.0204
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 26/30, Step 60/1,Classification Loss: 0.3156, Contrastive Loss: 0.0205
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 26/30, Step 100/1,Classification Loss: 0.3424, Contrastive Loss: 0.0233
Epoch 26/30, Step 120/1,Classification Loss: 0.3184, Contrastive Loss: 0.0212
Epoch 26/30, Step 140/1,Classification Loss: 0.3197, Contrastive Loss: 0.0207
Accuracy: 0.9968, Precision: 0.9951, Recall: 0.9918, F1: 0.9934
Accuracy: 0.9912, Precision: 0.9855, Recall: 0.9784, F1: 0.9819
Epoch 26/30
Training - Loss: 49.4368
Training Metrics: {'accuracy': 0.9967766608391608, 'precision': 0.9950811774513391, 'recall': 0.9917821990972749, 'f1': 0.9934235063026883}
Validation Metrics: {'accuracy': 0.9911504424778761, 'precision': 0.9854861269126468, 'recall': 0.9784077285956645, 'f1': 0.981908262016423}
Epoch 27/30, Step 0/1,Classification Loss: 0.3350, Contrastive Loss: 0.0243
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 40/1,Classification Loss: 0.3209, Contrastive Loss: 0.0218
Epoch 27/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0182
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 100/1,Classification Loss: 0.3187, Contrastive Loss: 0.0232
Epoch 27/30, Step 120/1,Classification Loss: 0.3360, Contrastive Loss: 0.0216
Epoch 27/30, Step 140/1,Classification Loss: 0.3173, Contrastive Loss: 0.0190
Accuracy: 0.9975, Precision: 0.9954, Recall: 0.9944, F1: 0.9949
Accuracy: 0.9927, Precision: 0.9844, Recall: 0.9859, F1: 0.9852
Epoch 27/30
Training - Loss: 49.2540
Training Metrics: {'accuracy': 0.9974868881118881, 'precision': 0.9953550377525829, 'recall': 0.9944125905622632, 'f1': 0.9948831478053267}
Validation Metrics: {'accuracy': 0.9926799956298481, 'precision': 0.9844049532763903, 'recall': 0.9859337372863519, 'f1': 0.9851675452730162}
Epoch 28/30, Step 0/1,Classification Loss: 0.3421, Contrastive Loss: 0.0257
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0174
Epoch 28/30, Step 40/1,Classification Loss: 0.3252, Contrastive Loss: 0.0232
Epoch 28/30, Step 60/1,Classification Loss: 0.3358, Contrastive Loss: 0.0221
Epoch 28/30, Step 80/1,Classification Loss: 0.3328, Contrastive Loss: 0.0218
Epoch 28/30, Step 100/1,Classification Loss: 0.3276, Contrastive Loss: 0.0190
Epoch 28/30, Step 120/1,Classification Loss: 0.3189, Contrastive Loss: 0.0183
Epoch 28/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0208
Accuracy: 0.9972, Precision: 0.9953, Recall: 0.9934, F1: 0.9943
Accuracy: 0.9922, Precision: 0.9862, Recall: 0.9822, F1: 0.9842
Epoch 28/30
Training - Loss: 49.5559
Training Metrics: {'accuracy': 0.9972137237762237, 'precision': 0.9952512011158975, 'recall': 0.9933556009270541, 'f1': 0.9943007095174141}
Validation Metrics: {'accuracy': 0.9922429804435704, 'precision': 0.9862048680344571, 'recall': 0.9822042358090282, 'f1': 0.9841922424224439}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 29/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0174
Epoch 29/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0177
Epoch 29/30, Step 60/1,Classification Loss: 0.3199, Contrastive Loss: 0.0192
Epoch 29/30, Step 80/1,Classification Loss: 0.3536, Contrastive Loss: 0.0232
Epoch 29/30, Step 100/1,Classification Loss: 0.3317, Contrastive Loss: 0.0361
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 29/30, Step 140/1,Classification Loss: 0.3201, Contrastive Loss: 0.0205
Accuracy: 0.9961, Precision: 0.9966, Recall: 0.9875, F1: 0.9920
Accuracy: 0.9910, Precision: 0.9892, Recall: 0.9742, F1: 0.9815
Epoch 29/30
Training - Loss: 49.0477
Training Metrics: {'accuracy': 0.9961210664335665, 'precision': 0.9965939629086851, 'recall': 0.9874765097463305, 'f1': 0.9919730927046571}
Validation Metrics: {'accuracy': 0.9910411886813066, 'precision': 0.9891795394928592, 'recall': 0.9742379660023651, 'f1': 0.9815372558048918}
Epoch 30/30, Step 0/1,Classification Loss: 0.3236, Contrastive Loss: 0.0190
Epoch 30/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0178
Epoch 30/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0229
Epoch 30/30, Step 60/1,Classification Loss: 0.3300, Contrastive Loss: 0.0199
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0171
Epoch 30/30, Step 100/1,Classification Loss: 0.3295, Contrastive Loss: 0.0202
Epoch 30/30, Step 120/1,Classification Loss: 0.3218, Contrastive Loss: 0.0181
Epoch 30/30, Step 140/1,Classification Loss: 0.3138, Contrastive Loss: 0.0184
Accuracy: 0.9973, Precision: 0.9952, Recall: 0.9938, F1: 0.9945
Accuracy: 0.9926, Precision: 0.9861, Recall: 0.9837, F1: 0.9849
Epoch 30/30
Training - Loss: 49.0301
Training Metrics: {'accuracy': 0.9973229895104895, 'precision': 0.9952488846317136, 'recall': 0.9938321965618926, 'f1': 0.9945390355214216}
Validation Metrics: {'accuracy': 0.9925707418332788, 'precision': 0.986118637339503, 'recall': 0.9836590306290341, 'f1': 0.9848841840620484}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1516, 5814), y shape: (1516,), y distribution: Counter({np.float64(0.0): 1374, np.float64(1.0): 142}), env shape: (1516,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8219, Precision: 0.4949, Recall: 0.4945, F1: 0.4946
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11715]))
original train data shape: torch.Size([45862]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1516, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45862]), new train data shape: torch.Size([45862])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11715]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3159, Contrastive Loss: 1.5365
Epoch 1/30, Step 20/1,Classification Loss: 0.3238, Contrastive Loss: 0.7895
Epoch 1/30, Step 40/1,Classification Loss: 0.3305, Contrastive Loss: 0.3834
Epoch 1/30, Step 60/1,Classification Loss: 0.3606, Contrastive Loss: 0.2791
Epoch 1/30, Step 80/1,Classification Loss: 0.3410, Contrastive Loss: 0.2099
Epoch 1/30, Step 100/1,Classification Loss: 0.3319, Contrastive Loss: 0.1833
Epoch 1/30, Step 120/1,Classification Loss: 0.3145, Contrastive Loss: 0.1567
Epoch 1/30, Step 140/1,Classification Loss: 0.3168, Contrastive Loss: 0.1495
Accuracy: 0.9970, Precision: 0.9952, Recall: 0.9927, F1: 0.9940
Accuracy: 0.9926, Precision: 0.9855, Recall: 0.9843, F1: 0.9849
Epoch 1/30
Training - Loss: 104.2488
Training Metrics: {'accuracy': 0.9970498251748252, 'precision': 0.9952391106332912, 'recall': 0.992718661813179, 'f1': 0.9939741198734584}
Validation Metrics: {'accuracy': 0.9925869399324103, 'precision': 0.9855420404189574, 'recall': 0.9843161194452279, 'f1': 0.9849279243544005}
Epoch 2/30, Step 0/1,Classification Loss: 0.3144, Contrastive Loss: 0.1463
Epoch 2/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.1360
Epoch 2/30, Step 40/1,Classification Loss: 0.3173, Contrastive Loss: 0.1307
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1229
Epoch 2/30, Step 80/1,Classification Loss: 0.3364, Contrastive Loss: 0.1313
Epoch 2/30, Step 100/1,Classification Loss: 0.3212, Contrastive Loss: 0.1232
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1154
Epoch 2/30, Step 140/1,Classification Loss: 0.3448, Contrastive Loss: 0.1400
Accuracy: 0.9969, Precision: 0.9952, Recall: 0.9919, F1: 0.9935
Accuracy: 0.9925, Precision: 0.9849, Recall: 0.9846, F1: 0.9847
Epoch 2/30
Training - Loss: 65.6878
Training Metrics: {'accuracy': 0.9968586101398601, 'precision': 0.9951791672714214, 'recall': 0.9919223487628048, 'f1': 0.99354282360741}
Validation Metrics: {'accuracy': 0.992477924343181, 'precision': 0.9848737888647519, 'recall': 0.9845678708453538, 'f1': 0.9847207578157663}
Epoch 3/30, Step 0/1,Classification Loss: 0.3326, Contrastive Loss: 0.1210
Epoch 3/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.1087
Epoch 3/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.1075
Epoch 3/30, Step 60/1,Classification Loss: 0.3260, Contrastive Loss: 0.1104
Epoch 3/30, Step 80/1,Classification Loss: 0.3249, Contrastive Loss: 0.1060
Epoch 3/30, Step 100/1,Classification Loss: 0.3305, Contrastive Loss: 0.1113
Epoch 3/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.1014
Epoch 3/30, Step 140/1,Classification Loss: 0.3181, Contrastive Loss: 0.0996
Accuracy: 0.9966, Precision: 0.9952, Recall: 0.9908, F1: 0.9930
Accuracy: 0.9918, Precision: 0.9853, Recall: 0.9813, F1: 0.9833
Epoch 3/30
Training - Loss: 62.3746
Training Metrics: {'accuracy': 0.9965854458041958, 'precision': 0.9951763694903991, 'recall': 0.9908103209089874, 'f1': 0.9929790698723626}
Validation Metrics: {'accuracy': 0.9918238308078056, 'precision': 0.9853352081727791, 'recall': 0.9813471808187055, 'f1': 0.983328941270548}
Epoch 4/30, Step 0/1,Classification Loss: 0.3207, Contrastive Loss: 0.1002
Epoch 4/30, Step 20/1,Classification Loss: 0.3188, Contrastive Loss: 0.0983
Epoch 4/30, Step 40/1,Classification Loss: 0.3243, Contrastive Loss: 0.0970
Epoch 4/30, Step 60/1,Classification Loss: 0.3302, Contrastive Loss: 0.1001
Epoch 4/30, Step 80/1,Classification Loss: 0.3145, Contrastive Loss: 0.0949
Epoch 4/30, Step 100/1,Classification Loss: 0.3339, Contrastive Loss: 0.0935
Epoch 4/30, Step 120/1,Classification Loss: 0.3221, Contrastive Loss: 0.0900
Epoch 4/30, Step 140/1,Classification Loss: 0.3380, Contrastive Loss: 0.1079
Accuracy: 0.9968, Precision: 0.9951, Recall: 0.9918, F1: 0.9934
Accuracy: 0.9929, Precision: 0.9870, Recall: 0.9842, F1: 0.9856
Epoch 4/30
Training - Loss: 60.5305
Training Metrics: {'accuracy': 0.9968039772727273, 'precision': 0.9950664965188929, 'recall': 0.9918104190515327, 'f1': 0.9934305248875388}
Validation Metrics: {'accuracy': 0.9929139867000981, 'precision': 0.9869601855438507, 'recall': 0.9841916917018376, 'f1': 0.985570060478955}
Epoch 5/30, Step 0/1,Classification Loss: 0.3145, Contrastive Loss: 0.0881
Epoch 5/30, Step 20/1,Classification Loss: 0.3182, Contrastive Loss: 0.0872
Epoch 5/30, Step 40/1,Classification Loss: 0.3153, Contrastive Loss: 0.0848
Epoch 5/30, Step 60/1,Classification Loss: 0.3146, Contrastive Loss: 0.0837
Epoch 5/30, Step 80/1,Classification Loss: 0.3269, Contrastive Loss: 0.0861
Epoch 5/30, Step 100/1,Classification Loss: 0.3388, Contrastive Loss: 0.0889
Epoch 5/30, Step 120/1,Classification Loss: 0.3238, Contrastive Loss: 0.0817
Epoch 5/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0790
Accuracy: 0.9972, Precision: 0.9953, Recall: 0.9931, F1: 0.9942
Accuracy: 0.9927, Precision: 0.9856, Recall: 0.9847, F1: 0.9852
Epoch 5/30
Training - Loss: 59.0987
Training Metrics: {'accuracy': 0.9971864073426573, 'precision': 0.9952843774095395, 'recall': 0.9931296447094631, 'f1': 0.9942035482394037}
Validation Metrics: {'accuracy': 0.9926959555216396, 'precision': 0.985614632064877, 'recall': 0.9846951945020892, 'f1': 0.9851542634953911}
Epoch 6/30, Step 0/1,Classification Loss: 0.3516, Contrastive Loss: 0.0907
Epoch 6/30, Step 20/1,Classification Loss: 0.3238, Contrastive Loss: 0.0796
Epoch 6/30, Step 40/1,Classification Loss: 0.3150, Contrastive Loss: 0.0799
Epoch 6/30, Step 60/1,Classification Loss: 0.3263, Contrastive Loss: 0.0791
Epoch 6/30, Step 80/1,Classification Loss: 0.3235, Contrastive Loss: 0.0755
Epoch 6/30, Step 100/1,Classification Loss: 0.3286, Contrastive Loss: 0.0766
Epoch 6/30, Step 120/1,Classification Loss: 0.3164, Contrastive Loss: 0.0741
Epoch 6/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0719
Accuracy: 0.9972, Precision: 0.9953, Recall: 0.9933, F1: 0.9943
Accuracy: 0.9927, Precision: 0.9838, Recall: 0.9866, F1: 0.9852
Epoch 6/30
Training - Loss: 57.7858
Training Metrics: {'accuracy': 0.9972137237762237, 'precision': 0.9953333261472728, 'recall': 0.9932816807448938, 'f1': 0.9943043493254315}
Validation Metrics: {'accuracy': 0.9926959555216396, 'precision': 0.983844460058206, 'recall': 0.9865876738730506, 'f1': 0.9852102693250357}
Epoch 7/30, Step 0/1,Classification Loss: 0.3234, Contrastive Loss: 0.0762
Epoch 7/30, Step 20/1,Classification Loss: 0.3224, Contrastive Loss: 0.0748
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0699
Epoch 7/30, Step 60/1,Classification Loss: 0.3145, Contrastive Loss: 0.0706
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0670
Epoch 7/30, Step 100/1,Classification Loss: 0.3285, Contrastive Loss: 0.0718
Epoch 7/30, Step 120/1,Classification Loss: 0.3185, Contrastive Loss: 0.0681
Epoch 7/30, Step 140/1,Classification Loss: 0.3164, Contrastive Loss: 0.0664
Accuracy: 0.9969, Precision: 0.9951, Recall: 0.9921, F1: 0.9936
Accuracy: 0.9919, Precision: 0.9854, Recall: 0.9817, F1: 0.9836
Epoch 7/30
Training - Loss: 57.2298
Training Metrics: {'accuracy': 0.9968859265734266, 'precision': 0.9951342773621604, 'recall': 0.9921355489397361, 'f1': 0.9936281683270483}
Validation Metrics: {'accuracy': 0.9919328463970348, 'precision': 0.9854074979315937, 'recall': 0.9817262558755668, 'f1': 0.9835564399070559}
Epoch 8/30, Step 0/1,Classification Loss: 0.3245, Contrastive Loss: 0.0692
Epoch 8/30, Step 20/1,Classification Loss: 0.3447, Contrastive Loss: 0.0838
Epoch 8/30, Step 40/1,Classification Loss: 0.3147, Contrastive Loss: 0.0651
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0619
Epoch 8/30, Step 80/1,Classification Loss: 0.3427, Contrastive Loss: 0.0705
Epoch 8/30, Step 100/1,Classification Loss: 0.3186, Contrastive Loss: 0.0629
Epoch 8/30, Step 120/1,Classification Loss: 0.3266, Contrastive Loss: 0.0658
Epoch 8/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0616
Accuracy: 0.9970, Precision: 0.9972, Recall: 0.9905, F1: 0.9938
Accuracy: 0.9928, Precision: 0.9890, Recall: 0.9816, F1: 0.9853
Epoch 8/30
Training - Loss: 55.9688
Training Metrics: {'accuracy': 0.9969951923076923, 'precision': 0.997198081636919, 'recall': 0.9905440908849035, 'f1': 0.9938379428424639}
Validation Metrics: {'accuracy': 0.9928049711108689, 'precision': 0.9890358370556391, 'recall': 0.9816047240455215, 'f1': 0.9852780340792435}
Epoch 9/30, Step 0/1,Classification Loss: 0.3243, Contrastive Loss: 0.0627
Epoch 9/30, Step 20/1,Classification Loss: 0.3199, Contrastive Loss: 0.0620
Epoch 9/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0588
Epoch 9/30, Step 60/1,Classification Loss: 0.3326, Contrastive Loss: 0.0646
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0566
Epoch 9/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0574
Epoch 9/30, Step 120/1,Classification Loss: 0.3162, Contrastive Loss: 0.0574
Epoch 9/30, Step 140/1,Classification Loss: 0.3408, Contrastive Loss: 0.0589
Accuracy: 0.9968, Precision: 0.9972, Recall: 0.9897, F1: 0.9934
Accuracy: 0.9927, Precision: 0.9887, Recall: 0.9815, F1: 0.9851
Epoch 9/30
Training - Loss: 55.2039
Training Metrics: {'accuracy': 0.9968039772727273, 'precision': 0.9972433810581476, 'recall': 0.9896715170939232, 'f1': 0.9934146175580632}
Validation Metrics: {'accuracy': 0.9926959555216396, 'precision': 0.9886559282612137, 'recall': 0.9815410622171538, 'f1': 0.9850597394313307}
Epoch 10/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 0.0564
Epoch 10/30, Step 20/1,Classification Loss: 0.3306, Contrastive Loss: 0.0582
Epoch 10/30, Step 40/1,Classification Loss: 0.3216, Contrastive Loss: 0.0548
Epoch 10/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0552
Epoch 10/30, Step 80/1,Classification Loss: 0.3294, Contrastive Loss: 0.0584
Epoch 10/30, Step 100/1,Classification Loss: 0.3209, Contrastive Loss: 0.0556
Epoch 10/30, Step 120/1,Classification Loss: 0.3312, Contrastive Loss: 0.0547
Epoch 10/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0510
Accuracy: 0.9972, Precision: 0.9955, Recall: 0.9930, F1: 0.9942
Accuracy: 0.9927, Precision: 0.9859, Recall: 0.9844, F1: 0.9851
Epoch 10/30
Training - Loss: 54.5744
Training Metrics: {'accuracy': 0.9971864073426573, 'precision': 0.9954693253545445, 'recall': 0.9930173744759347, 'f1': 0.9942388490126606}
Validation Metrics: {'accuracy': 0.9926959555216396, 'precision': 0.985913589650776, 'recall': 0.9843797812735957, 'f1': 0.9851448778723577}
Epoch 11/30, Step 0/1,Classification Loss: 0.3139, Contrastive Loss: 0.0507
Epoch 11/30, Step 20/1,Classification Loss: 0.3415, Contrastive Loss: 0.0576
Epoch 11/30, Step 40/1,Classification Loss: 0.3200, Contrastive Loss: 0.0511
Epoch 11/30, Step 60/1,Classification Loss: 0.3146, Contrastive Loss: 0.0488
Epoch 11/30, Step 80/1,Classification Loss: 0.3489, Contrastive Loss: 0.0540
Epoch 11/30, Step 100/1,Classification Loss: 0.3225, Contrastive Loss: 0.0487
Epoch 11/30, Step 120/1,Classification Loss: 0.3326, Contrastive Loss: 0.0493
Epoch 11/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0475
Accuracy: 0.9970, Precision: 0.9954, Recall: 0.9924, F1: 0.9939
Accuracy: 0.9927, Precision: 0.9859, Recall: 0.9844, F1: 0.9851
Epoch 11/30
Training - Loss: 53.9869
Training Metrics: {'accuracy': 0.9970225087412588, 'precision': 0.9953668778935858, 'recall': 0.9924368367554559, 'f1': 0.9938954301525456}
Validation Metrics: {'accuracy': 0.9926959555216396, 'precision': 0.985913589650776, 'recall': 0.9843797812735957, 'f1': 0.9851448778723577}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0458
Epoch 12/30, Step 20/1,Classification Loss: 0.3141, Contrastive Loss: 0.0474
Epoch 12/30, Step 40/1,Classification Loss: 0.3282, Contrastive Loss: 0.0475
Epoch 12/30, Step 60/1,Classification Loss: 0.3343, Contrastive Loss: 0.0506
Epoch 12/30, Step 80/1,Classification Loss: 0.3400, Contrastive Loss: 0.0505
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0437
Epoch 12/30, Step 120/1,Classification Loss: 0.3285, Contrastive Loss: 0.0468
Epoch 12/30, Step 140/1,Classification Loss: 0.3145, Contrastive Loss: 0.0436
Accuracy: 0.9970, Precision: 0.9953, Recall: 0.9926, F1: 0.9940
Accuracy: 0.9918, Precision: 0.9847, Recall: 0.9820, F1: 0.9834
Epoch 12/30
Training - Loss: 53.3226
Training Metrics: {'accuracy': 0.9970498251748252, 'precision': 0.9953139657741576, 'recall': 0.992631593292996, 'f1': 0.9939673848560618}
Validation Metrics: {'accuracy': 0.9918238308078056, 'precision': 0.9847338437925038, 'recall': 0.9819780072756927, 'f1': 0.9833500697834097}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0429
Epoch 13/30, Step 20/1,Classification Loss: 0.3443, Contrastive Loss: 0.0489
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0412
Epoch 13/30, Step 60/1,Classification Loss: 0.3249, Contrastive Loss: 0.0440
Epoch 13/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0414
Epoch 13/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0736
Epoch 13/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0428
Epoch 13/30, Step 140/1,Classification Loss: 0.3336, Contrastive Loss: 0.0440
Accuracy: 0.9972, Precision: 0.9952, Recall: 0.9935, F1: 0.9943
Accuracy: 0.9928, Precision: 0.9854, Recall: 0.9854, F1: 0.9854
Epoch 13/30
Training - Loss: 52.9399
Training Metrics: {'accuracy': 0.9972410402097902, 'precision': 0.9951606470100944, 'recall': 0.9934867363075375, 'f1': 0.9943216011499588}
Validation Metrics: {'accuracy': 0.9928049711108689, 'precision': 0.985389682787444, 'recall': 0.985389682787444, 'f1': 0.985389682787444}
Epoch 14/30, Step 0/1,Classification Loss: 0.3148, Contrastive Loss: 0.0401
Epoch 14/30, Step 20/1,Classification Loss: 0.3444, Contrastive Loss: 0.0528
Epoch 14/30, Step 40/1,Classification Loss: 0.3242, Contrastive Loss: 0.0399
Epoch 14/30, Step 60/1,Classification Loss: 0.3316, Contrastive Loss: 0.0437
Epoch 14/30, Step 80/1,Classification Loss: 0.3282, Contrastive Loss: 0.0388
Epoch 14/30, Step 100/1,Classification Loss: 0.3299, Contrastive Loss: 0.0389
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Epoch 14/30, Step 140/1,Classification Loss: 0.3175, Contrastive Loss: 0.0375
Accuracy: 0.9970, Precision: 0.9954, Recall: 0.9926, F1: 0.9940
Accuracy: 0.9923, Precision: 0.9868, Recall: 0.9816, F1: 0.9842
Epoch 14/30
Training - Loss: 52.2514
Training Metrics: {'accuracy': 0.9970498251748252, 'precision': 0.9954004143964027, 'recall': 0.9925675528762345, 'f1': 0.9939779600928361}
Validation Metrics: {'accuracy': 0.9922598931647225, 'precision': 0.9868362658935239, 'recall': 0.9816018281321764, 'f1': 0.9841979996469752}
Epoch 15/30, Step 0/1,Classification Loss: 0.3294, Contrastive Loss: 0.0399
Epoch 15/30, Step 20/1,Classification Loss: 0.3236, Contrastive Loss: 0.0365
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0356
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Epoch 15/30, Step 80/1,Classification Loss: 0.3518, Contrastive Loss: 0.0581
Epoch 15/30, Step 100/1,Classification Loss: 0.3275, Contrastive Loss: 0.0358
Epoch 15/30, Step 120/1,Classification Loss: 0.3293, Contrastive Loss: 0.0486
Epoch 15/30, Step 140/1,Classification Loss: 0.3191, Contrastive Loss: 0.0353
Accuracy: 0.9972, Precision: 0.9954, Recall: 0.9931, F1: 0.9942
Accuracy: 0.9926, Precision: 0.9864, Recall: 0.9834, F1: 0.9849
Epoch 15/30
Training - Loss: 51.9094
Training Metrics: {'accuracy': 0.9971864073426573, 'precision': 0.995384445980696, 'recall': 0.9930863781619022, 'f1': 0.9942314615202954}
Validation Metrics: {'accuracy': 0.9925869399324103, 'precision': 0.9864431877439777, 'recall': 0.9833698797597473, 'f1': 0.9848992797910974}
Epoch 16/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0327
Epoch 16/30, Step 20/1,Classification Loss: 0.3285, Contrastive Loss: 0.0340
Epoch 16/30, Step 40/1,Classification Loss: 0.3341, Contrastive Loss: 0.0369
Epoch 16/30, Step 60/1,Classification Loss: 0.3366, Contrastive Loss: 0.0444
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0323
Epoch 16/30, Step 100/1,Classification Loss: 0.3223, Contrastive Loss: 0.0346
Epoch 16/30, Step 120/1,Classification Loss: 0.3158, Contrastive Loss: 0.0324
Epoch 16/30, Step 140/1,Classification Loss: 0.3248, Contrastive Loss: 0.0325
Accuracy: 0.9971, Precision: 0.9954, Recall: 0.9929, F1: 0.9941
Accuracy: 0.9926, Precision: 0.9864, Recall: 0.9834, F1: 0.9849
Epoch 16/30
Training - Loss: 51.6173
Training Metrics: {'accuracy': 0.9971317744755245, 'precision': 0.9953617288692063, 'recall': 0.9929143519995273, 'f1': 0.9941335520089427}
Validation Metrics: {'accuracy': 0.9925869399324103, 'precision': 0.9864431877439777, 'recall': 0.9833698797597473, 'f1': 0.9848992797910974}
Epoch 17/30, Step 0/1,Classification Loss: 0.3211, Contrastive Loss: 0.0314
Epoch 17/30, Step 20/1,Classification Loss: 0.3478, Contrastive Loss: 0.0401
Epoch 17/30, Step 40/1,Classification Loss: 0.3158, Contrastive Loss: 0.0321
Epoch 17/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0303
Epoch 17/30, Step 80/1,Classification Loss: 0.3141, Contrastive Loss: 0.0312
Epoch 17/30, Step 100/1,Classification Loss: 0.3527, Contrastive Loss: 0.0348
Epoch 17/30, Step 120/1,Classification Loss: 0.3542, Contrastive Loss: 0.0383
Epoch 17/30, Step 140/1,Classification Loss: 0.3168, Contrastive Loss: 0.0317
Accuracy: 0.9972, Precision: 0.9954, Recall: 0.9930, F1: 0.9942
Accuracy: 0.9928, Precision: 0.9857, Recall: 0.9851, F1: 0.9854
Epoch 17/30
Training - Loss: 51.2076
Training Metrics: {'accuracy': 0.9971590909090909, 'precision': 0.9953639535175329, 'recall': 0.9929832779046013, 'f1': 0.9941693782127838}
Validation Metrics: {'accuracy': 0.9928049711108689, 'precision': 0.9856872257970732, 'recall': 0.9850742695589505, 'f1': 0.9853804589829507}
Epoch 18/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0284
Epoch 18/30, Step 20/1,Classification Loss: 0.3200, Contrastive Loss: 0.0303
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0271
Epoch 18/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0281
Epoch 18/30, Step 80/1,Classification Loss: 0.3248, Contrastive Loss: 0.0304
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0263
Epoch 18/30, Step 120/1,Classification Loss: 0.3206, Contrastive Loss: 0.0292
Epoch 18/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0263
Accuracy: 0.9971, Precision: 0.9953, Recall: 0.9928, F1: 0.9940
Accuracy: 0.9926, Precision: 0.9864, Recall: 0.9834, F1: 0.9849
Epoch 18/30
Training - Loss: 50.7929
Training Metrics: {'accuracy': 0.9970771416083916, 'precision': 0.9952570286079552, 'recall': 0.9928164975657745, 'f1': 0.9940322936782298}
Validation Metrics: {'accuracy': 0.9925869399324103, 'precision': 0.9864431877439777, 'recall': 0.9833698797597473, 'f1': 0.9848992797910974}
Epoch 19/30, Step 0/1,Classification Loss: 0.3266, Contrastive Loss: 0.0306
Epoch 19/30, Step 20/1,Classification Loss: 0.3143, Contrastive Loss: 0.0270
Epoch 19/30, Step 40/1,Classification Loss: 0.3184, Contrastive Loss: 0.0297
Epoch 19/30, Step 60/1,Classification Loss: 0.3346, Contrastive Loss: 0.0280
Epoch 19/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0254
Epoch 19/30, Step 100/1,Classification Loss: 0.3273, Contrastive Loss: 0.0304
Epoch 19/30, Step 120/1,Classification Loss: 0.3182, Contrastive Loss: 0.0255
Epoch 19/30, Step 140/1,Classification Loss: 0.3376, Contrastive Loss: 0.0322
Accuracy: 0.9974, Precision: 0.9958, Recall: 0.9936, F1: 0.9947
Accuracy: 0.9928, Precision: 0.9857, Recall: 0.9851, F1: 0.9854
Epoch 19/30
Training - Loss: 50.6297
Training Metrics: {'accuracy': 0.9974049388111889, 'precision': 0.9957530887069492, 'recall': 0.9936110681162955, 'f1': 0.9946786501086595}
Validation Metrics: {'accuracy': 0.9928049711108689, 'precision': 0.9856872257970732, 'recall': 0.9850742695589505, 'f1': 0.9853804589829507}
Epoch 20/30, Step 0/1,Classification Loss: 0.3300, Contrastive Loss: 0.0313
Epoch 20/30, Step 20/1,Classification Loss: 0.3284, Contrastive Loss: 0.0255
Epoch 20/30, Step 40/1,Classification Loss: 0.3203, Contrastive Loss: 0.0262
Epoch 20/30, Step 60/1,Classification Loss: 0.3333, Contrastive Loss: 0.0286
Epoch 20/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.0248
Epoch 20/30, Step 100/1,Classification Loss: 0.3541, Contrastive Loss: 0.0432
Epoch 20/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0240
Epoch 20/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0244
Accuracy: 0.9968, Precision: 0.9952, Recall: 0.9918, F1: 0.9935
Accuracy: 0.9922, Precision: 0.9862, Recall: 0.9819, F1: 0.9840
Epoch 20/30
Training - Loss: 50.4368
Training Metrics: {'accuracy': 0.9968312937062938, 'precision': 0.995168479663285, 'recall': 0.9918392579176907, 'f1': 0.993495569621432}
Validation Metrics: {'accuracy': 0.9921508775754933, 'precision': 0.9861563011918884, 'recall': 0.9818535795323022, 'f1': 0.9839907027902488}
Epoch 21/30, Step 0/1,Classification Loss: 0.3327, Contrastive Loss: 0.0300
Epoch 21/30, Step 20/1,Classification Loss: 0.3544, Contrastive Loss: 0.0360
Epoch 21/30, Step 40/1,Classification Loss: 0.3284, Contrastive Loss: 0.0255
Epoch 21/30, Step 60/1,Classification Loss: 0.3280, Contrastive Loss: 0.0250
Epoch 21/30, Step 80/1,Classification Loss: 0.3228, Contrastive Loss: 0.0236
Epoch 21/30, Step 100/1,Classification Loss: 0.3188, Contrastive Loss: 0.0244
Epoch 21/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0231
Epoch 21/30, Step 140/1,Classification Loss: 0.3349, Contrastive Loss: 0.0410
Accuracy: 0.9972, Precision: 0.9953, Recall: 0.9933, F1: 0.9943
Accuracy: 0.9927, Precision: 0.9862, Recall: 0.9841, F1: 0.9851
Epoch 21/30
Training - Loss: 50.0457
Training Metrics: {'accuracy': 0.9972137237762237, 'precision': 0.9953212620850687, 'recall': 0.9932609376060101, 'f1': 0.9942879246645169}
Validation Metrics: {'accuracy': 0.9926959555216396, 'precision': 0.9862136830168073, 'recall': 0.9840643680451021, 'f1': 0.9851354774983363}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0222
Epoch 22/30, Step 20/1,Classification Loss: 0.3311, Contrastive Loss: 0.0267
Epoch 22/30, Step 40/1,Classification Loss: 0.3153, Contrastive Loss: 0.0261
Epoch 22/30, Step 60/1,Classification Loss: 0.3191, Contrastive Loss: 0.0232
Epoch 22/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0218
Epoch 22/30, Step 100/1,Classification Loss: 0.3309, Contrastive Loss: 0.0298
Epoch 22/30, Step 120/1,Classification Loss: 0.3450, Contrastive Loss: 0.0687
Epoch 22/30, Step 140/1,Classification Loss: 0.3314, Contrastive Loss: 0.0387
Accuracy: 0.9973, Precision: 0.9953, Recall: 0.9934, F1: 0.9944
Accuracy: 0.9920, Precision: 0.9840, Recall: 0.9837, F1: 0.9838
Epoch 22/30
Training - Loss: 50.0595
Training Metrics: {'accuracy': 0.9972683566433567, 'precision': 0.9953300271817849, 'recall': 0.9934120234288109, 'f1': 0.9943682838731496}
Validation Metrics: {'accuracy': 0.992041861986264, 'precision': 0.9839877560758397, 'recall': 0.9836823970748958, 'f1': 0.9838350046456659}
Epoch 23/30, Step 0/1,Classification Loss: 0.3384, Contrastive Loss: 0.0255
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0204
Epoch 23/30, Step 60/1,Classification Loss: 0.3269, Contrastive Loss: 0.0216
Epoch 23/30, Step 80/1,Classification Loss: 0.3440, Contrastive Loss: 0.0402
Epoch 23/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0255
Epoch 23/30, Step 120/1,Classification Loss: 0.3315, Contrastive Loss: 0.0232
Epoch 23/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Accuracy: 0.9971, Precision: 0.9954, Recall: 0.9928, F1: 0.9941
Accuracy: 0.9923, Precision: 0.9862, Recall: 0.9822, F1: 0.9842
Epoch 23/30
Training - Loss: 49.8088
Training Metrics: {'accuracy': 0.9971317744755245, 'precision': 0.9954412761804491, 'recall': 0.9928360003678816, 'f1': 0.9941335520089427}
Validation Metrics: {'accuracy': 0.9922598931647225, 'precision': 0.9862280182147654, 'recall': 0.9822326545891635, 'f1': 0.9842180644027855}
Epoch 24/30, Step 0/1,Classification Loss: 0.3140, Contrastive Loss: 0.0221
Epoch 24/30, Step 20/1,Classification Loss: 0.3213, Contrastive Loss: 0.0226
Epoch 24/30, Step 40/1,Classification Loss: 0.3214, Contrastive Loss: 0.0217
Epoch 24/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0290
Epoch 24/30, Step 80/1,Classification Loss: 0.3284, Contrastive Loss: 0.0233
Epoch 24/30, Step 100/1,Classification Loss: 0.3374, Contrastive Loss: 0.0244
Epoch 24/30, Step 120/1,Classification Loss: 0.3399, Contrastive Loss: 0.0290
Epoch 24/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0234
Accuracy: 0.9970, Precision: 0.9952, Recall: 0.9925, F1: 0.9938
Accuracy: 0.9920, Precision: 0.9855, Recall: 0.9821, F1: 0.9838
Epoch 24/30
Training - Loss: 49.7282
Training Metrics: {'accuracy': 0.9969951923076923, 'precision': 0.995197949324212, 'recall': 0.9925124115895048, 'f1': 0.9938497748367086}
Validation Metrics: {'accuracy': 0.992041861986264, 'precision': 0.9854797898792895, 'recall': 0.9821053309324281, 'f1': 0.983783793470465}
Epoch 25/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0200
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 40/1,Classification Loss: 0.3337, Contrastive Loss: 0.0228
Epoch 25/30, Step 60/1,Classification Loss: 0.3214, Contrastive Loss: 0.0203
Epoch 25/30, Step 80/1,Classification Loss: 0.3177, Contrastive Loss: 0.0205
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 25/30, Step 120/1,Classification Loss: 0.3304, Contrastive Loss: 0.0219
Epoch 25/30, Step 140/1,Classification Loss: 0.3352, Contrastive Loss: 0.0223
Accuracy: 0.9974, Precision: 0.9954, Recall: 0.9937, F1: 0.9946
Accuracy: 0.9929, Precision: 0.9849, Recall: 0.9864, F1: 0.9856
Epoch 25/30
Training - Loss: 49.4597
Training Metrics: {'accuracy': 0.9973503059440559, 'precision': 0.9954062298059594, 'recall': 0.9937433321273181, 'f1': 0.9945727128220624}
Validation Metrics: {'accuracy': 0.9929139867000981, 'precision': 0.9848714058673166, 'recall': 0.9863995843012923, 'f1': 0.9856336991692822}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 26/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 26/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0191
Epoch 26/30, Step 60/1,Classification Loss: 0.3284, Contrastive Loss: 0.0211
Epoch 26/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0192
Epoch 26/30, Step 100/1,Classification Loss: 0.3355, Contrastive Loss: 0.0236
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 26/30, Step 140/1,Classification Loss: 0.3137, Contrastive Loss: 0.0215
Accuracy: 0.9974, Precision: 0.9955, Recall: 0.9939, F1: 0.9947
Accuracy: 0.9929, Precision: 0.9861, Recall: 0.9851, F1: 0.9856
Epoch 26/30
Training - Loss: 49.6668
Training Metrics: {'accuracy': 0.9973776223776224, 'precision': 0.9954535069832404, 'recall': 0.9938867584920006, 'f1': 0.9946682885509186}
Validation Metrics: {'accuracy': 0.9929139867000981, 'precision': 0.9860582087952856, 'recall': 0.9851379313873181, 'f1': 0.9855974198089617}
Epoch 27/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0192
Epoch 27/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0185
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 60/1,Classification Loss: 0.3540, Contrastive Loss: 0.0245
Epoch 27/30, Step 80/1,Classification Loss: 0.3210, Contrastive Loss: 0.0203
Epoch 27/30, Step 100/1,Classification Loss: 0.3153, Contrastive Loss: 0.0187
Epoch 27/30, Step 120/1,Classification Loss: 0.3312, Contrastive Loss: 0.0332
Epoch 27/30, Step 140/1,Classification Loss: 0.3429, Contrastive Loss: 0.0358
Accuracy: 0.9971, Precision: 0.9953, Recall: 0.9928, F1: 0.9941
Accuracy: 0.9926, Precision: 0.9858, Recall: 0.9840, F1: 0.9849
Epoch 27/30
Training - Loss: 49.2948
Training Metrics: {'accuracy': 0.997104458041958, 'precision': 0.9953360519084584, 'recall': 0.9928014073758329, 'f1': 0.9940639217101843}
Validation Metrics: {'accuracy': 0.9925869399324103, 'precision': 0.9858412837760582, 'recall': 0.9840007062167344, 'f1': 0.9849183911661064}
Epoch 28/30, Step 0/1,Classification Loss: 0.3466, Contrastive Loss: 0.0370
Epoch 28/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0191
Epoch 28/30, Step 40/1,Classification Loss: 0.3238, Contrastive Loss: 0.0206
Epoch 28/30, Step 60/1,Classification Loss: 0.3257, Contrastive Loss: 0.0200
Epoch 28/30, Step 80/1,Classification Loss: 0.3264, Contrastive Loss: 0.0230
Epoch 28/30, Step 100/1,Classification Loss: 0.3252, Contrastive Loss: 0.0191
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 28/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Accuracy: 0.9969, Precision: 0.9952, Recall: 0.9921, F1: 0.9936
Accuracy: 0.9920, Precision: 0.9855, Recall: 0.9821, F1: 0.9838
Epoch 28/30
Training - Loss: 49.4020
Training Metrics: {'accuracy': 0.9968859265734266, 'precision': 0.9952210148524687, 'recall': 0.9920725691358968, 'f1': 0.9936393487553171}
Validation Metrics: {'accuracy': 0.992041861986264, 'precision': 0.9854797898792895, 'recall': 0.9821053309324281, 'f1': 0.983783793470465}
Epoch 29/30, Step 0/1,Classification Loss: 0.3503, Contrastive Loss: 0.0382
Epoch 29/30, Step 20/1,Classification Loss: 0.3249, Contrastive Loss: 0.0185
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 29/30, Step 60/1,Classification Loss: 0.3238, Contrastive Loss: 0.0191
Epoch 29/30, Step 80/1,Classification Loss: 0.3265, Contrastive Loss: 0.0215
Epoch 29/30, Step 100/1,Classification Loss: 0.3724, Contrastive Loss: 0.0259
Epoch 29/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0175
Epoch 29/30, Step 140/1,Classification Loss: 0.3181, Contrastive Loss: 0.0184
Accuracy: 0.9968, Precision: 0.9952, Recall: 0.9916, F1: 0.9934
Accuracy: 0.9911, Precision: 0.9854, Recall: 0.9781, F1: 0.9817
Epoch 29/30
Training - Loss: 49.3152
Training Metrics: {'accuracy': 0.9967766608391608, 'precision': 0.9952261806615808, 'recall': 0.9915943575789608, 'f1': 0.9934003745093865}
Validation Metrics: {'accuracy': 0.9910607216832007, 'precision': 0.9854392908848355, 'recall': 0.9780628289636897, 'f1': 0.9817090726439086}
Epoch 30/30, Step 0/1,Classification Loss: 0.3328, Contrastive Loss: 0.0214
Epoch 30/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0194
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0170
Epoch 30/30, Step 60/1,Classification Loss: 0.3354, Contrastive Loss: 0.0344
Epoch 30/30, Step 80/1,Classification Loss: 0.3364, Contrastive Loss: 0.0226
Epoch 30/30, Step 100/1,Classification Loss: 0.3250, Contrastive Loss: 0.0205
Epoch 30/30, Step 120/1,Classification Loss: 0.3154, Contrastive Loss: 0.0179
Epoch 30/30, Step 140/1,Classification Loss: 0.3181, Contrastive Loss: 0.0186
Accuracy: 0.9970, Precision: 0.9952, Recall: 0.9926, F1: 0.9939
Accuracy: 0.9918, Precision: 0.9862, Recall: 0.9804, F1: 0.9833
Epoch 30/30
Training - Loss: 48.9244
Training Metrics: {'accuracy': 0.9970225087412588, 'precision': 0.9952078487936957, 'recall': 0.9925951901333049, 'f1': 0.9938964087392066}
Validation Metrics: {'accuracy': 0.9918238308078056, 'precision': 0.9862458841805978, 'recall': 0.980400941133225, 'f1': 0.9832971234343488}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1641, 5814), y shape: (1641,), y distribution: Counter({np.float64(0.0): 1480, np.float64(1.0): 161}), env shape: (1641,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8605, Precision: 0.5171, Recall: 0.5102, F1: 0.5096
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11815]))
original train data shape: torch.Size([45962]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1641, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([45962]), new train data shape: torch.Size([45962])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11815]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3181, Contrastive Loss: 1.6421
Epoch 1/30, Step 20/1,Classification Loss: 0.3561, Contrastive Loss: 1.0983
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.3972
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2346
Epoch 1/30, Step 80/1,Classification Loss: 0.3695, Contrastive Loss: 0.2338
Epoch 1/30, Step 100/1,Classification Loss: 0.3176, Contrastive Loss: 0.1711
Epoch 1/30, Step 120/1,Classification Loss: 0.3275, Contrastive Loss: 0.1532
Epoch 1/30, Step 140/1,Classification Loss: 0.3140, Contrastive Loss: 0.1440
Accuracy: 0.9969, Precision: 0.9948, Recall: 0.9923, F1: 0.9936
Accuracy: 0.9927, Precision: 0.9859, Recall: 0.9844, F1: 0.9852
Epoch 1/30
Training - Loss: 110.6687
Training Metrics: {'accuracy': 0.9968586101398601, 'precision': 0.994794970978826, 'recall': 0.9923452019782752, 'f1': 0.9935655873663627}
Validation Metrics: {'accuracy': 0.9927118459697596, 'precision': 0.9859367505642413, 'recall': 0.9844049550568368, 'f1': 0.9851690507078563}
Epoch 2/30, Step 0/1,Classification Loss: 0.3285, Contrastive Loss: 0.1532
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1295
Epoch 2/30, Step 40/1,Classification Loss: 0.3308, Contrastive Loss: 0.1544
Epoch 2/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1353
Epoch 2/30, Step 80/1,Classification Loss: 0.3327, Contrastive Loss: 0.1357
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1138
Epoch 2/30, Step 120/1,Classification Loss: 0.3162, Contrastive Loss: 0.1167
Epoch 2/30, Step 140/1,Classification Loss: 0.3361, Contrastive Loss: 0.1170
Accuracy: 0.9970, Precision: 0.9947, Recall: 0.9931, F1: 0.9939
Accuracy: 0.9935, Precision: 0.9873, Recall: 0.9861, F1: 0.9867
Epoch 2/30
Training - Loss: 65.6140
Training Metrics: {'accuracy': 0.9970225087412588, 'precision': 0.9947368031308894, 'recall': 0.9930777194922629, 'f1': 0.9939051985697352}
Validation Metrics: {'accuracy': 0.9934732948982922, 'precision': 0.9873382917375739, 'recall': 0.9861095083793381, 'f1': 0.9867227444841546}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1089
Epoch 3/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.1088
Epoch 3/30, Step 40/1,Classification Loss: 0.3349, Contrastive Loss: 0.1130
Epoch 3/30, Step 60/1,Classification Loss: 0.3365, Contrastive Loss: 0.1192
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1006
Epoch 3/30, Step 100/1,Classification Loss: 0.3158, Contrastive Loss: 0.1019
Epoch 3/30, Step 120/1,Classification Loss: 0.3260, Contrastive Loss: 0.1020
Epoch 3/30, Step 140/1,Classification Loss: 0.3204, Contrastive Loss: 0.1036
Accuracy: 0.9969, Precision: 0.9946, Recall: 0.9925, F1: 0.9936
Accuracy: 0.9930, Precision: 0.9871, Recall: 0.9846, F1: 0.9858
Epoch 3/30
Training - Loss: 62.4703
Training Metrics: {'accuracy': 0.9968586101398601, 'precision': 0.9946482543151642, 'recall': 0.9925225683525176, 'f1': 0.993582018480281}
Validation Metrics: {'accuracy': 0.993038181224845, 'precision': 0.9870531313185985, 'recall': 0.9845955038373245, 'f1': 0.9858196888522285}
Epoch 4/30, Step 0/1,Classification Loss: 0.3185, Contrastive Loss: 0.1014
Epoch 4/30, Step 20/1,Classification Loss: 0.3231, Contrastive Loss: 0.0996
Epoch 4/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0983
Epoch 4/30, Step 60/1,Classification Loss: 0.3181, Contrastive Loss: 0.0947
Epoch 4/30, Step 80/1,Classification Loss: 0.3212, Contrastive Loss: 0.0940
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0877
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0870
Epoch 4/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0874
Accuracy: 0.9970, Precision: 0.9943, Recall: 0.9934, F1: 0.9939
Accuracy: 0.9938, Precision: 0.9888, Recall: 0.9860, F1: 0.9874
Epoch 4/30
Training - Loss: 60.4769
Training Metrics: {'accuracy': 0.9969951923076923, 'precision': 0.994326976824067, 'recall': 0.9933798165007772, 'f1': 0.9938527240498194}
Validation Metrics: {'accuracy': 0.9937996301533776, 'precision': 0.988760015597872, 'recall': 0.9859850722844852, 'f1': 0.9873666658397152}
Epoch 5/30, Step 0/1,Classification Loss: 0.3327, Contrastive Loss: 0.1060
Epoch 5/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0878
Epoch 5/30, Step 40/1,Classification Loss: 0.3176, Contrastive Loss: 0.0857
Epoch 5/30, Step 60/1,Classification Loss: 0.3148, Contrastive Loss: 0.0853
Epoch 5/30, Step 80/1,Classification Loss: 0.3358, Contrastive Loss: 0.0921
Epoch 5/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0858
Epoch 5/30, Step 120/1,Classification Loss: 0.3391, Contrastive Loss: 0.1030
Epoch 5/30, Step 140/1,Classification Loss: 0.3364, Contrastive Loss: 0.0883
Accuracy: 0.9966, Precision: 0.9942, Recall: 0.9919, F1: 0.9930
Accuracy: 0.9929, Precision: 0.9885, Recall: 0.9826, F1: 0.9855
Epoch 5/30
Training - Loss: 59.2822
Training Metrics: {'accuracy': 0.9966127622377622, 'precision': 0.9941516821614572, 'recall': 0.9919295518916884, 'f1': 0.9930369190217196}
Validation Metrics: {'accuracy': 0.9929294028064832, 'precision': 0.9885061750529147, 'recall': 0.9826420783251171, 'f1': 0.9855478170515128}
Epoch 6/30, Step 0/1,Classification Loss: 0.3332, Contrastive Loss: 0.0879
Epoch 6/30, Step 20/1,Classification Loss: 0.3450, Contrastive Loss: 0.0912
Epoch 6/30, Step 40/1,Classification Loss: 0.3266, Contrastive Loss: 0.0813
Epoch 6/30, Step 60/1,Classification Loss: 0.3292, Contrastive Loss: 0.0911
Epoch 6/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0743
Epoch 6/30, Step 100/1,Classification Loss: 0.3278, Contrastive Loss: 0.0767
Epoch 6/30, Step 120/1,Classification Loss: 0.3157, Contrastive Loss: 0.0724
Epoch 6/30, Step 140/1,Classification Loss: 0.3488, Contrastive Loss: 0.0891
Accuracy: 0.9972, Precision: 0.9950, Recall: 0.9935, F1: 0.9942
Accuracy: 0.9937, Precision: 0.9887, Recall: 0.9856, F1: 0.9871
Epoch 6/30
Training - Loss: 58.3827
Training Metrics: {'accuracy': 0.9971864073426573, 'precision': 0.9949724642937645, 'recall': 0.9934604571276147, 'f1': 0.9942147535748268}
Validation Metrics: {'accuracy': 0.9936908517350158, 'precision': 0.9886898689305703, 'recall': 0.9856065711489818, 'f1': 0.9871409605820184}
Epoch 7/30, Step 0/1,Classification Loss: 0.3208, Contrastive Loss: 0.0737
Epoch 7/30, Step 20/1,Classification Loss: 0.3145, Contrastive Loss: 0.0713
Epoch 7/30, Step 40/1,Classification Loss: 0.3338, Contrastive Loss: 0.0714
Epoch 7/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0711
Epoch 7/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.0694
Epoch 7/30, Step 100/1,Classification Loss: 0.3156, Contrastive Loss: 0.0708
Epoch 7/30, Step 120/1,Classification Loss: 0.3179, Contrastive Loss: 0.0668
Epoch 7/30, Step 140/1,Classification Loss: 0.3397, Contrastive Loss: 0.0743
Accuracy: 0.9970, Precision: 0.9947, Recall: 0.9930, F1: 0.9939
Accuracy: 0.9930, Precision: 0.9883, Recall: 0.9833, F1: 0.9858
Epoch 7/30
Training - Loss: 57.1937
Training Metrics: {'accuracy': 0.9970225087412588, 'precision': 0.994714847053721, 'recall': 0.9930448193209971, 'f1': 0.9938777489287002}
Validation Metrics: {'accuracy': 0.993038181224845, 'precision': 0.9882691007437459, 'recall': 0.9833355643359614, 'f1': 0.9857837091791959}
Epoch 8/30, Step 0/1,Classification Loss: 0.3292, Contrastive Loss: 0.0792
Epoch 8/30, Step 20/1,Classification Loss: 0.3382, Contrastive Loss: 0.0714
Epoch 8/30, Step 40/1,Classification Loss: 0.3541, Contrastive Loss: 0.0812
Epoch 8/30, Step 60/1,Classification Loss: 0.3206, Contrastive Loss: 0.0644
Epoch 8/30, Step 80/1,Classification Loss: 0.3146, Contrastive Loss: 0.0621
Epoch 8/30, Step 100/1,Classification Loss: 0.3192, Contrastive Loss: 0.0627
Epoch 8/30, Step 120/1,Classification Loss: 0.3220, Contrastive Loss: 0.0616
Epoch 8/30, Step 140/1,Classification Loss: 0.3272, Contrastive Loss: 0.0629
Accuracy: 0.9972, Precision: 0.9948, Recall: 0.9936, F1: 0.9942
Accuracy: 0.9930, Precision: 0.9880, Recall: 0.9837, F1: 0.9858
Epoch 8/30
Training - Loss: 56.0925
Training Metrics: {'accuracy': 0.9971590909090909, 'precision': 0.994817972168876, 'recall': 0.9935530471989804, 'f1': 0.9941843114780337}
Validation Metrics: {'accuracy': 0.993038181224845, 'precision': 0.9879633767413647, 'recall': 0.9836505492113021, 'f1': 0.9857927253205494}
Epoch 9/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0584
Epoch 9/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0596
Epoch 9/30, Step 40/1,Classification Loss: 0.3316, Contrastive Loss: 0.0657
Epoch 9/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0575
Epoch 9/30, Step 80/1,Classification Loss: 0.3284, Contrastive Loss: 0.0594
Epoch 9/30, Step 100/1,Classification Loss: 0.3308, Contrastive Loss: 0.0652
Epoch 9/30, Step 120/1,Classification Loss: 0.3154, Contrastive Loss: 0.0572
Epoch 9/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0551
Accuracy: 0.9969, Precision: 0.9947, Recall: 0.9924, F1: 0.9935
Accuracy: 0.9934, Precision: 0.9885, Recall: 0.9845, F1: 0.9865
Epoch 9/30
Training - Loss: 55.2306
Training Metrics: {'accuracy': 0.9968586101398601, 'precision': 0.9946932073344469, 'recall': 0.9923858298522031, 'f1': 0.9935355387172504}
Validation Metrics: {'accuracy': 0.9933645164799304, 'precision': 0.988479461060078, 'recall': 0.9844710677424715, 'f1': 0.9864629830093807}
Epoch 10/30, Step 0/1,Classification Loss: 0.3217, Contrastive Loss: 0.0573
Epoch 10/30, Step 20/1,Classification Loss: 0.3175, Contrastive Loss: 0.0553
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0530
Epoch 10/30, Step 60/1,Classification Loss: 0.3249, Contrastive Loss: 0.0572
Epoch 10/30, Step 80/1,Classification Loss: 0.3298, Contrastive Loss: 0.0555
Epoch 10/30, Step 100/1,Classification Loss: 0.3187, Contrastive Loss: 0.0528
Epoch 10/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0660
Epoch 10/30, Step 140/1,Classification Loss: 0.3243, Contrastive Loss: 0.0508
Accuracy: 0.9969, Precision: 0.9947, Recall: 0.9926, F1: 0.9937
Accuracy: 0.9927, Precision: 0.9884, Recall: 0.9819, F1: 0.9851
Epoch 10/30
Training - Loss: 54.6797
Training Metrics: {'accuracy': 0.9968859265734266, 'precision': 0.994678067850147, 'recall': 0.9926392340636084, 'f1': 0.9936555246671269}
Validation Metrics: {'accuracy': 0.9927118459697596, 'precision': 0.9883665662856085, 'recall': 0.9818850760541102, 'f1': 0.9850936584925507}
Epoch 11/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.0545
Epoch 11/30, Step 20/1,Classification Loss: 0.3436, Contrastive Loss: 0.0591
Epoch 11/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0492
Epoch 11/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0528
Epoch 11/30, Step 80/1,Classification Loss: 0.3349, Contrastive Loss: 0.0529
Epoch 11/30, Step 100/1,Classification Loss: 0.3138, Contrastive Loss: 0.0477
Epoch 11/30, Step 120/1,Classification Loss: 0.3216, Contrastive Loss: 0.0498
Epoch 11/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0459
Accuracy: 0.9970, Precision: 0.9967, Recall: 0.9910, F1: 0.9938
Accuracy: 0.9933, Precision: 0.9906, Recall: 0.9819, F1: 0.9862
Epoch 11/30
Training - Loss: 53.9440
Training Metrics: {'accuracy': 0.9970225087412588, 'precision': 0.9967071240659109, 'recall': 0.990985378080387, 'f1': 0.9938219211638197}
Validation Metrics: {'accuracy': 0.9932557380615686, 'precision': 0.9905780394921044, 'recall': 0.9818876724795824, 'f1': 0.9861752719170909}
Epoch 12/30, Step 0/1,Classification Loss: 0.3441, Contrastive Loss: 0.0542
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0444
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0448
Epoch 12/30, Step 60/1,Classification Loss: 0.3347, Contrastive Loss: 0.0468
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0440
Epoch 12/30, Step 100/1,Classification Loss: 0.3311, Contrastive Loss: 0.0472
Epoch 12/30, Step 120/1,Classification Loss: 0.3189, Contrastive Loss: 0.0436
Epoch 12/30, Step 140/1,Classification Loss: 0.3164, Contrastive Loss: 0.0453
Accuracy: 0.9973, Precision: 0.9951, Recall: 0.9937, F1: 0.9944
Accuracy: 0.9931, Precision: 0.9880, Recall: 0.9840, F1: 0.9860
Epoch 12/30
Training - Loss: 53.1532
Training Metrics: {'accuracy': 0.9972683566433567, 'precision': 0.9951177127834551, 'recall': 0.9936923558160706, 'f1': 0.9944035144363889}
Validation Metrics: {'accuracy': 0.9931469596432068, 'precision': 0.9880337865222357, 'recall': 0.9840290503468054, 'f1': 0.9860191463867376}
Epoch 13/30, Step 0/1,Classification Loss: 0.3413, Contrastive Loss: 0.0476
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0413
Epoch 13/30, Step 40/1,Classification Loss: 0.3175, Contrastive Loss: 0.0429
Epoch 13/30, Step 60/1,Classification Loss: 0.3409, Contrastive Loss: 0.0519
Epoch 13/30, Step 80/1,Classification Loss: 0.3164, Contrastive Loss: 0.0416
Epoch 13/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0406
Epoch 13/30, Step 120/1,Classification Loss: 0.3342, Contrastive Loss: 0.0450
Epoch 13/30, Step 140/1,Classification Loss: 0.3240, Contrastive Loss: 0.0446
Accuracy: 0.9970, Precision: 0.9947, Recall: 0.9932, F1: 0.9939
Accuracy: 0.9930, Precision: 0.9871, Recall: 0.9846, F1: 0.9858
Epoch 13/30
Training - Loss: 52.9703
Training Metrics: {'accuracy': 0.9970225087412588, 'precision': 0.9946685701258821, 'recall': 0.9931724085555166, 'f1': 0.9939188094944017}
Validation Metrics: {'accuracy': 0.993038181224845, 'precision': 0.9870531313185985, 'recall': 0.9845955038373245, 'f1': 0.9858196888522285}
Epoch 14/30, Step 0/1,Classification Loss: 0.3168, Contrastive Loss: 0.0395
Epoch 14/30, Step 20/1,Classification Loss: 0.3349, Contrastive Loss: 0.0439
Epoch 14/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0399
Epoch 14/30, Step 60/1,Classification Loss: 0.3441, Contrastive Loss: 0.0476
Epoch 14/30, Step 80/1,Classification Loss: 0.3355, Contrastive Loss: 0.0452
Epoch 14/30, Step 100/1,Classification Loss: 0.3315, Contrastive Loss: 0.0408
Epoch 14/30, Step 120/1,Classification Loss: 0.3400, Contrastive Loss: 0.0413
Epoch 14/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0381
Accuracy: 0.9972, Precision: 0.9949, Recall: 0.9938, F1: 0.9944
Accuracy: 0.9926, Precision: 0.9856, Recall: 0.9843, F1: 0.9850
Epoch 14/30
Training - Loss: 52.4183
Training Metrics: {'accuracy': 0.9972410402097902, 'precision': 0.9949489320234999, 'recall': 0.9937636358632621, 'f1': 0.9943552318956757}
Validation Metrics: {'accuracy': 0.9926030675513978, 'precision': 0.9855657528441025, 'recall': 0.9843414387966741, 'f1': 0.9849524437487085}
Epoch 15/30, Step 0/1,Classification Loss: 0.3231, Contrastive Loss: 0.0382
Epoch 15/30, Step 20/1,Classification Loss: 0.3374, Contrastive Loss: 0.0402
Epoch 15/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0354
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Epoch 15/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0347
Epoch 15/30, Step 100/1,Classification Loss: 0.3331, Contrastive Loss: 0.0356
Epoch 15/30, Step 120/1,Classification Loss: 0.3274, Contrastive Loss: 0.0360
Epoch 15/30, Step 140/1,Classification Loss: 0.3338, Contrastive Loss: 0.0417
Accuracy: 0.9971, Precision: 0.9948, Recall: 0.9934, F1: 0.9941
Accuracy: 0.9930, Precision: 0.9883, Recall: 0.9833, F1: 0.9858
Epoch 15/30
Training - Loss: 52.1274
Training Metrics: {'accuracy': 0.997104458041958, 'precision': 0.9947822210901681, 'recall': 0.993358166300371, 'f1': 0.9940686752578487}
Validation Metrics: {'accuracy': 0.993038181224845, 'precision': 0.9882691007437459, 'recall': 0.9833355643359614, 'f1': 0.9857837091791959}
Epoch 16/30, Step 0/1,Classification Loss: 0.3170, Contrastive Loss: 0.0342
Epoch 16/30, Step 20/1,Classification Loss: 0.3176, Contrastive Loss: 0.0333
Epoch 16/30, Step 40/1,Classification Loss: 0.3189, Contrastive Loss: 0.0330
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0317
Epoch 16/30, Step 80/1,Classification Loss: 0.3137, Contrastive Loss: 0.0330
Epoch 16/30, Step 100/1,Classification Loss: 0.3293, Contrastive Loss: 0.0433
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Epoch 16/30, Step 140/1,Classification Loss: 0.3143, Contrastive Loss: 0.0311
Accuracy: 0.9969, Precision: 0.9949, Recall: 0.9926, F1: 0.9937
Accuracy: 0.9927, Precision: 0.9884, Recall: 0.9819, F1: 0.9851
Epoch 16/30
Training - Loss: 51.5400
Training Metrics: {'accuracy': 0.9969405594405595, 'precision': 0.994934613853053, 'recall': 0.9925716585775166, 'f1': 0.9937489455404116}
Validation Metrics: {'accuracy': 0.9927118459697596, 'precision': 0.9883665662856085, 'recall': 0.9818850760541102, 'f1': 0.9850936584925507}
Epoch 17/30, Step 0/1,Classification Loss: 0.3275, Contrastive Loss: 0.0340
Epoch 17/30, Step 20/1,Classification Loss: 0.3282, Contrastive Loss: 0.0330
Epoch 17/30, Step 40/1,Classification Loss: 0.3514, Contrastive Loss: 0.0494
Epoch 17/30, Step 60/1,Classification Loss: 0.3149, Contrastive Loss: 0.0296
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 17/30, Step 100/1,Classification Loss: 0.3353, Contrastive Loss: 0.0368
Epoch 17/30, Step 120/1,Classification Loss: 0.3198, Contrastive Loss: 0.0318
Epoch 17/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0283
Accuracy: 0.9970, Precision: 0.9950, Recall: 0.9928, F1: 0.9939
Accuracy: 0.9930, Precision: 0.9877, Recall: 0.9840, F1: 0.9858
Epoch 17/30
Training - Loss: 51.0991
Training Metrics: {'accuracy': 0.9970225087412588, 'precision': 0.9949657329728319, 'recall': 0.9928261037275257, 'f1': 0.9938924920601878}
Validation Metrics: {'accuracy': 0.993038181224845, 'precision': 0.9876588105838711, 'recall': 0.9839655340866429, 'f1': 0.9858017272917698}
Epoch 18/30, Step 0/1,Classification Loss: 0.3150, Contrastive Loss: 0.0299
Epoch 18/30, Step 20/1,Classification Loss: 0.3478, Contrastive Loss: 0.0425
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Epoch 18/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0277
Epoch 18/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0340
Epoch 18/30, Step 100/1,Classification Loss: 0.3322, Contrastive Loss: 0.0306
Epoch 18/30, Step 120/1,Classification Loss: 0.3429, Contrastive Loss: 0.0326
Epoch 18/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Accuracy: 0.9972, Precision: 0.9948, Recall: 0.9937, F1: 0.9943
Accuracy: 0.9931, Precision: 0.9874, Recall: 0.9847, F1: 0.9860
Epoch 18/30
Training - Loss: 51.0560
Training Metrics: {'accuracy': 0.9972137237762237, 'precision': 0.9948222303134978, 'recall': 0.9937057623645369, 'f1': 0.9942630664493168}
Validation Metrics: {'accuracy': 0.9931469596432068, 'precision': 0.9874263917386985, 'recall': 0.9846590200974872, 'f1': 0.9860368411912642}
Epoch 19/30, Step 0/1,Classification Loss: 0.3342, Contrastive Loss: 0.0433
Epoch 19/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0312
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0255
Epoch 19/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0254
Epoch 19/30, Step 80/1,Classification Loss: 0.3270, Contrastive Loss: 0.0278
Epoch 19/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0256
Epoch 19/30, Step 120/1,Classification Loss: 0.3150, Contrastive Loss: 0.0261
Epoch 19/30, Step 140/1,Classification Loss: 0.3142, Contrastive Loss: 0.0262
Accuracy: 0.9969, Precision: 0.9947, Recall: 0.9927, F1: 0.9937
Accuracy: 0.9929, Precision: 0.9882, Recall: 0.9830, F1: 0.9856
Epoch 19/30
Training - Loss: 50.6687
Training Metrics: {'accuracy': 0.9969405594405595, 'precision': 0.9947285423560586, 'recall': 0.9926506050400796, 'f1': 0.9936863528044426}
Validation Metrics: {'accuracy': 0.9929294028064832, 'precision': 0.9881989910623397, 'recall': 0.9829570632004578, 'f1': 0.9855569957187875}
Epoch 20/30, Step 0/1,Classification Loss: 0.3328, Contrastive Loss: 0.0419
Epoch 20/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0266
Epoch 20/30, Step 40/1,Classification Loss: 0.3139, Contrastive Loss: 0.0262
Epoch 20/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0242
Epoch 20/30, Step 80/1,Classification Loss: 0.3229, Contrastive Loss: 0.0258
Epoch 20/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0234
Epoch 20/30, Step 120/1,Classification Loss: 0.3362, Contrastive Loss: 0.0290
Epoch 20/30, Step 140/1,Classification Loss: 0.3299, Contrastive Loss: 0.0342
Accuracy: 0.9974, Precision: 0.9951, Recall: 0.9940, F1: 0.9946
Accuracy: 0.9927, Precision: 0.9871, Recall: 0.9831, F1: 0.9851
Epoch 20/30
Training - Loss: 50.4812
Training Metrics: {'accuracy': 0.9973503059440559, 'precision': 0.9950754533357693, 'recall': 0.994041923081589, 'f1': 0.9945578906456136}
Validation Metrics: {'accuracy': 0.9927118459697596, 'precision': 0.9871424374465511, 'recall': 0.9831450155554735, 'f1': 0.9851314731414511}
Epoch 21/30, Step 0/1,Classification Loss: 0.3159, Contrastive Loss: 0.0245
Epoch 21/30, Step 20/1,Classification Loss: 0.3199, Contrastive Loss: 0.0266
Epoch 21/30, Step 40/1,Classification Loss: 0.3381, Contrastive Loss: 0.0301
Epoch 21/30, Step 60/1,Classification Loss: 0.3285, Contrastive Loss: 0.0279
Epoch 21/30, Step 80/1,Classification Loss: 0.3140, Contrastive Loss: 0.0223
Epoch 21/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0380
Epoch 21/30, Step 120/1,Classification Loss: 0.3283, Contrastive Loss: 0.0232
Epoch 21/30, Step 140/1,Classification Loss: 0.3267, Contrastive Loss: 0.0241
Accuracy: 0.9974, Precision: 0.9952, Recall: 0.9941, F1: 0.9946
Accuracy: 0.9931, Precision: 0.9874, Recall: 0.9847, F1: 0.9860
Epoch 21/30
Training - Loss: 50.2647
Training Metrics: {'accuracy': 0.9973776223776224, 'precision': 0.995196665929386, 'recall': 0.994092484963113, 'f1': 0.9946436621097408}
Validation Metrics: {'accuracy': 0.9931469596432068, 'precision': 0.9874263917386985, 'recall': 0.9846590200974872, 'f1': 0.9860368411912642}
Epoch 22/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0253
Epoch 22/30, Step 20/1,Classification Loss: 0.3286, Contrastive Loss: 0.0250
Epoch 22/30, Step 40/1,Classification Loss: 0.3333, Contrastive Loss: 0.0246
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 22/30, Step 80/1,Classification Loss: 0.3217, Contrastive Loss: 0.0222
Epoch 22/30, Step 100/1,Classification Loss: 0.3294, Contrastive Loss: 0.0334
Epoch 22/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0257
Epoch 22/30, Step 140/1,Classification Loss: 0.3217, Contrastive Loss: 0.0246
Accuracy: 0.9967, Precision: 0.9948, Recall: 0.9916, F1: 0.9932
Accuracy: 0.9922, Precision: 0.9877, Recall: 0.9803, F1: 0.9840
Epoch 22/30
Training - Loss: 50.0228
Training Metrics: {'accuracy': 0.9966673951048951, 'precision': 0.9947516409142139, 'recall': 0.991583864345877, 'f1': 0.9931602321342272}
Validation Metrics: {'accuracy': 0.9921679538779506, 'precision': 0.9877083660446249, 'recall': 0.980307555251934, 'f1': 0.9839659400497434}
Epoch 23/30, Step 0/1,Classification Loss: 0.3352, Contrastive Loss: 0.0259
Epoch 23/30, Step 20/1,Classification Loss: 0.3492, Contrastive Loss: 0.0299
Epoch 23/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0205
Epoch 23/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0247
Epoch 23/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0210
Epoch 23/30, Step 100/1,Classification Loss: 0.3285, Contrastive Loss: 0.0234
Epoch 23/30, Step 120/1,Classification Loss: 0.3377, Contrastive Loss: 0.0300
Epoch 23/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Accuracy: 0.9973, Precision: 0.9950, Recall: 0.9938, F1: 0.9944
Accuracy: 0.9929, Precision: 0.9861, Recall: 0.9852, F1: 0.9856
Epoch 23/30
Training - Loss: 49.9014
Training Metrics: {'accuracy': 0.9972683566433567, 'precision': 0.9950374594467275, 'recall': 0.9937701789936193, 'f1': 0.9944026178965883}
Validation Metrics: {'accuracy': 0.9929294028064832, 'precision': 0.9860810270491607, 'recall': 0.9851619573278436, 'f1': 0.9856208438795598}
Epoch 24/30, Step 0/1,Classification Loss: 0.3304, Contrastive Loss: 0.0222
Epoch 24/30, Step 20/1,Classification Loss: 0.3148, Contrastive Loss: 0.0220
Epoch 24/30, Step 40/1,Classification Loss: 0.3305, Contrastive Loss: 0.0242
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 24/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0201
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 24/30, Step 120/1,Classification Loss: 0.3187, Contrastive Loss: 0.0214
Epoch 24/30, Step 140/1,Classification Loss: 0.3306, Contrastive Loss: 0.0234
Accuracy: 0.9970, Precision: 0.9977, Recall: 0.9902, F1: 0.9939
Accuracy: 0.9934, Precision: 0.9906, Recall: 0.9823, F1: 0.9864
Epoch 24/30
Training - Loss: 49.6687
Training Metrics: {'accuracy': 0.9970498251748252, 'precision': 0.9977121241957578, 'recall': 0.9901919144481298, 'f1': 0.9939098682610115}
Validation Metrics: {'accuracy': 0.9933645164799304, 'precision': 0.9906460583412726, 'recall': 0.982266173615086, 'f1': 0.9864025907124592}
Epoch 25/30, Step 0/1,Classification Loss: 0.3223, Contrastive Loss: 0.0195
Epoch 25/30, Step 20/1,Classification Loss: 0.3209, Contrastive Loss: 0.0215
Epoch 25/30, Step 40/1,Classification Loss: 0.3169, Contrastive Loss: 0.0204
Epoch 25/30, Step 60/1,Classification Loss: 0.3355, Contrastive Loss: 0.0222
Epoch 25/30, Step 80/1,Classification Loss: 0.3142, Contrastive Loss: 0.0193
Epoch 25/30, Step 100/1,Classification Loss: 0.3594, Contrastive Loss: 0.0308
Epoch 25/30, Step 120/1,Classification Loss: 0.3344, Contrastive Loss: 0.0236
Epoch 25/30, Step 140/1,Classification Loss: 0.3291, Contrastive Loss: 0.0220
Accuracy: 0.9971, Precision: 0.9948, Recall: 0.9931, F1: 0.9940
Accuracy: 0.9924, Precision: 0.9872, Recall: 0.9817, F1: 0.9844
Epoch 25/30
Training - Loss: 49.5779
Training Metrics: {'accuracy': 0.9970771416083916, 'precision': 0.994814229643735, 'recall': 0.9931371194233491, 'f1': 0.9939735766391157}
Validation Metrics: {'accuracy': 0.9923855107146742, 'precision': 0.987234684120782, 'recall': 0.9816945272736225, 'f1': 0.9844410549763092}
Epoch 26/30, Step 0/1,Classification Loss: 0.3336, Contrastive Loss: 0.0254
Epoch 26/30, Step 20/1,Classification Loss: 0.3361, Contrastive Loss: 0.0243
Epoch 26/30, Step 40/1,Classification Loss: 0.3217, Contrastive Loss: 0.0216
Epoch 26/30, Step 60/1,Classification Loss: 0.3308, Contrastive Loss: 0.0216
Epoch 26/30, Step 80/1,Classification Loss: 0.3323, Contrastive Loss: 0.0226
Epoch 26/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0244
Epoch 26/30, Step 120/1,Classification Loss: 0.3140, Contrastive Loss: 0.0207
Epoch 26/30, Step 140/1,Classification Loss: 0.3173, Contrastive Loss: 0.0198
Accuracy: 0.9970, Precision: 0.9950, Recall: 0.9929, F1: 0.9939
Accuracy: 0.9925, Precision: 0.9876, Recall: 0.9818, F1: 0.9847
Epoch 26/30
Training - Loss: 49.7349
Training Metrics: {'accuracy': 0.9970225087412588, 'precision': 0.9949852682215876, 'recall': 0.9928591353210368, 'f1': 0.9939188094944017}
Validation Metrics: {'accuracy': 0.9924942891330361, 'precision': 0.9876113992471541, 'recall': 0.9817580435337852, 'f1': 0.9846584519469905}
Epoch 27/30, Step 0/1,Classification Loss: 0.3206, Contrastive Loss: 0.0205
Epoch 27/30, Step 20/1,Classification Loss: 0.3422, Contrastive Loss: 0.0228
Epoch 27/30, Step 40/1,Classification Loss: 0.3224, Contrastive Loss: 0.0199
Epoch 27/30, Step 60/1,Classification Loss: 0.3188, Contrastive Loss: 0.0193
Epoch 27/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0178
Epoch 27/30, Step 100/1,Classification Loss: 0.3268, Contrastive Loss: 0.0196
Epoch 27/30, Step 120/1,Classification Loss: 0.3179, Contrastive Loss: 0.0185
Epoch 27/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0182
Accuracy: 0.9972, Precision: 0.9950, Recall: 0.9934, F1: 0.9942
Accuracy: 0.9935, Precision: 0.9882, Recall: 0.9852, F1: 0.9867
Epoch 27/30
Training - Loss: 49.4414
Training Metrics: {'accuracy': 0.9971590909090909, 'precision': 0.994964066409412, 'recall': 0.9933765850953211, 'f1': 0.9941684417295598}
Validation Metrics: {'accuracy': 0.9934732948982922, 'precision': 0.9882450450011042, 'recall': 0.9851645537533158, 'f1': 0.9866975454296742}
Epoch 28/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 0.0193
Epoch 28/30, Step 20/1,Classification Loss: 0.3615, Contrastive Loss: 0.0287
Epoch 28/30, Step 40/1,Classification Loss: 0.3191, Contrastive Loss: 0.0192
Epoch 28/30, Step 60/1,Classification Loss: 0.3270, Contrastive Loss: 0.0194
Epoch 28/30, Step 80/1,Classification Loss: 0.3373, Contrastive Loss: 0.0254
Epoch 28/30, Step 100/1,Classification Loss: 0.3271, Contrastive Loss: 0.0187
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 28/30, Step 140/1,Classification Loss: 0.3190, Contrastive Loss: 0.0198
Accuracy: 0.9972, Precision: 0.9949, Recall: 0.9936, F1: 0.9942
Accuracy: 0.9939, Precision: 0.9897, Recall: 0.9854, F1: 0.9876
Epoch 28/30
Training - Loss: 49.4286
Training Metrics: {'accuracy': 0.9971864073426573, 'precision': 0.9949178456664172, 'recall': 0.9935754421730416, 'f1': 0.9942452938754391}
Validation Metrics: {'accuracy': 0.9939084085717393, 'precision': 0.9897472126230304, 'recall': 0.9854186187939662, 'f1': 0.9875686346554807}
Epoch 29/30, Step 0/1,Classification Loss: 0.3422, Contrastive Loss: 0.0226
Epoch 29/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0178
Epoch 29/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0333
Epoch 29/30, Step 60/1,Classification Loss: 0.3490, Contrastive Loss: 0.0258
Epoch 29/30, Step 80/1,Classification Loss: 0.3178, Contrastive Loss: 0.0183
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 29/30, Step 120/1,Classification Loss: 0.3149, Contrastive Loss: 0.0189
Epoch 29/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0190
Accuracy: 0.9970, Precision: 0.9947, Recall: 0.9929, F1: 0.9938
Accuracy: 0.9931, Precision: 0.9880, Recall: 0.9840, F1: 0.9860
Epoch 29/30
Training - Loss: 49.4520
Training Metrics: {'accuracy': 0.9969678758741258, 'precision': 0.9947010636055134, 'recall': 0.992882677537996, 'f1': 0.9937893930231848}
Validation Metrics: {'accuracy': 0.9931469596432068, 'precision': 0.9880337865222357, 'recall': 0.9840290503468054, 'f1': 0.9860191463867376}
Epoch 30/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0204
Epoch 30/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0221
Epoch 30/30, Step 40/1,Classification Loss: 0.3263, Contrastive Loss: 0.0190
Epoch 30/30, Step 60/1,Classification Loss: 0.3180, Contrastive Loss: 0.0195
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 100/1,Classification Loss: 0.3141, Contrastive Loss: 0.0172
Epoch 30/30, Step 120/1,Classification Loss: 0.3226, Contrastive Loss: 0.0189
Epoch 30/30, Step 140/1,Classification Loss: 0.3138, Contrastive Loss: 0.0183
Accuracy: 0.9954, Precision: 0.9938, Recall: 0.9872, F1: 0.9905
Accuracy: 0.9905, Precision: 0.9873, Recall: 0.9740, F1: 0.9805
Epoch 30/30
Training - Loss: 49.3002
Training Metrics: {'accuracy': 0.9953835227272727, 'precision': 0.9938090751844779, 'recall': 0.9872345970343066, 'f1': 0.9904893170141673}
Validation Metrics: {'accuracy': 0.9905362776025236, 'precision': 0.9872866736461444, 'recall': 0.9740000684687014, 'f1': 0.9805073616977729}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1501, 5814), y shape: (1501,), y distribution: Counter({np.float64(0.0): 1362, np.float64(1.0): 139}), env shape: (1501,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8668, Precision: 0.4600, Recall: 0.4808, F1: 0.4692
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11915]))
original train data shape: torch.Size([46062]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1501, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46062]), new train data shape: torch.Size([46062])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 11915]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3183, Contrastive Loss: 1.4938
Epoch 1/30, Step 20/1,Classification Loss: 0.3188, Contrastive Loss: 0.8016
Epoch 1/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.3554
Epoch 1/30, Step 60/1,Classification Loss: 0.3273, Contrastive Loss: 0.2296
Epoch 1/30, Step 80/1,Classification Loss: 0.3284, Contrastive Loss: 0.1864
Epoch 1/30, Step 100/1,Classification Loss: 0.3296, Contrastive Loss: 0.1704
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1445
Epoch 1/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.1374
Accuracy: 0.9958, Precision: 0.9943, Recall: 0.9884, F1: 0.9913
Accuracy: 0.9918, Precision: 0.9850, Recall: 0.9813, F1: 0.9832
Epoch 1/30
Training - Loss: 100.9301
Training Metrics: {'accuracy': 0.9958205856643356, 'precision': 0.9942759538486101, 'recall': 0.98841441710593, 'f1': 0.9913195167981763}
Validation Metrics: {'accuracy': 0.9917507869315099, 'precision': 0.9850025065367969, 'recall': 0.9813309212452341, 'f1': 0.9831563330771218}
Epoch 2/30, Step 0/1,Classification Loss: 0.3444, Contrastive Loss: 0.1529
Epoch 2/30, Step 20/1,Classification Loss: 0.3464, Contrastive Loss: 0.1416
Epoch 2/30, Step 40/1,Classification Loss: 0.3282, Contrastive Loss: 0.1259
Epoch 2/30, Step 60/1,Classification Loss: 0.3146, Contrastive Loss: 0.1233
Epoch 2/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.1158
Epoch 2/30, Step 100/1,Classification Loss: 0.3272, Contrastive Loss: 0.1177
Epoch 2/30, Step 120/1,Classification Loss: 0.3204, Contrastive Loss: 0.1172
Epoch 2/30, Step 140/1,Classification Loss: 0.3273, Contrastive Loss: 0.1151
Accuracy: 0.9969, Precision: 0.9953, Recall: 0.9919, F1: 0.9936
Accuracy: 0.9927, Precision: 0.9857, Recall: 0.9847, F1: 0.9852
Epoch 2/30
Training - Loss: 64.9784
Training Metrics: {'accuracy': 0.996913243006993, 'precision': 0.9953453477051479, 'recall': 0.9918940584218967, 'f1': 0.993610832829182}
Validation Metrics: {'accuracy': 0.9927276674264626, 'precision': 0.9856527246055727, 'recall': 0.9847348546794247, 'f1': 0.9851931428533048}
Epoch 3/30, Step 0/1,Classification Loss: 0.3176, Contrastive Loss: 0.1122
Epoch 3/30, Step 20/1,Classification Loss: 0.3292, Contrastive Loss: 0.1155
Epoch 3/30, Step 40/1,Classification Loss: 0.3284, Contrastive Loss: 0.1082
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0999
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0990
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0976
Epoch 3/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.0978
Epoch 3/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0966
Accuracy: 0.9964, Precision: 0.9949, Recall: 0.9904, F1: 0.9926
Accuracy: 0.9920, Precision: 0.9854, Recall: 0.9818, F1: 0.9836
Epoch 3/30
Training - Loss: 62.0828
Training Metrics: {'accuracy': 0.9964215472027972, 'precision': 0.9949006558867748, 'recall': 0.9903501074700691, 'f1': 0.9926099032010718}
Validation Metrics: {'accuracy': 0.9919678714859438, 'precision': 0.985447453039864, 'recall': 0.9817724993965626, 'f1': 0.9835995874698291}
Epoch 4/30, Step 0/1,Classification Loss: 0.3285, Contrastive Loss: 0.0998
Epoch 4/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0937
Epoch 4/30, Step 40/1,Classification Loss: 0.3216, Contrastive Loss: 0.0923
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0887
Epoch 4/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0887
Epoch 4/30, Step 100/1,Classification Loss: 0.3149, Contrastive Loss: 0.0866
Epoch 4/30, Step 120/1,Classification Loss: 0.3541, Contrastive Loss: 0.0986
Epoch 4/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0839
Accuracy: 0.9971, Precision: 0.9954, Recall: 0.9926, F1: 0.9940
Accuracy: 0.9927, Precision: 0.9851, Recall: 0.9854, F1: 0.9852
Epoch 4/30
Training - Loss: 59.7788
Training Metrics: {'accuracy': 0.9970771416083916, 'precision': 0.995366693653833, 'recall': 0.992560906776323, 'f1': 0.9939579377445263}
Validation Metrics: {'accuracy': 0.9927276674264626, 'precision': 0.9850591609689926, 'recall': 0.9853645576808525, 'f1': 0.9852117876669426}
Epoch 5/30, Step 0/1,Classification Loss: 0.3284, Contrastive Loss: 0.0882
Epoch 5/30, Step 20/1,Classification Loss: 0.3295, Contrastive Loss: 0.0879
Epoch 5/30, Step 40/1,Classification Loss: 0.3253, Contrastive Loss: 0.0843
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0804
Epoch 5/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0786
Epoch 5/30, Step 100/1,Classification Loss: 0.3360, Contrastive Loss: 0.1236
Epoch 5/30, Step 120/1,Classification Loss: 0.3156, Contrastive Loss: 0.0777
Epoch 5/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0791
Accuracy: 0.9967, Precision: 0.9948, Recall: 0.9917, F1: 0.9932
Accuracy: 0.9924, Precision: 0.9854, Recall: 0.9836, F1: 0.9845
Epoch 5/30
Training - Loss: 58.7011
Training Metrics: {'accuracy': 0.9966947115384616, 'precision': 0.9947610171027028, 'recall': 0.9916651879657727, 'f1': 0.9932059274477967}
Validation Metrics: {'accuracy': 0.9924020405948116, 'precision': 0.9854359683354804, 'recall': 0.9836002102013612, 'f1': 0.984515499434989}
Epoch 6/30, Step 0/1,Classification Loss: 0.3179, Contrastive Loss: 0.0786
Epoch 6/30, Step 20/1,Classification Loss: 0.3335, Contrastive Loss: 0.0780
Epoch 6/30, Step 40/1,Classification Loss: 0.3274, Contrastive Loss: 0.0771
Epoch 6/30, Step 60/1,Classification Loss: 0.3160, Contrastive Loss: 0.0729
Epoch 6/30, Step 80/1,Classification Loss: 0.3250, Contrastive Loss: 0.0725
Epoch 6/30, Step 100/1,Classification Loss: 0.3271, Contrastive Loss: 0.0732
Epoch 6/30, Step 120/1,Classification Loss: 0.3495, Contrastive Loss: 0.0975
Epoch 6/30, Step 140/1,Classification Loss: 0.3166, Contrastive Loss: 0.0703
Accuracy: 0.9973, Precision: 0.9954, Recall: 0.9934, F1: 0.9944
Accuracy: 0.9927, Precision: 0.9851, Recall: 0.9854, F1: 0.9852
Epoch 6/30
Training - Loss: 57.2935
Training Metrics: {'accuracy': 0.9972956730769231, 'precision': 0.9954382365476296, 'recall': 0.9934483117162811, 'f1': 0.9944403185308424}
Validation Metrics: {'accuracy': 0.9927276674264626, 'precision': 0.9850591609689926, 'recall': 0.9853645576808525, 'f1': 0.9852117876669426}
Epoch 7/30, Step 0/1,Classification Loss: 0.3298, Contrastive Loss: 0.0736
Epoch 7/30, Step 20/1,Classification Loss: 0.3140, Contrastive Loss: 0.0692
Epoch 7/30, Step 40/1,Classification Loss: 0.3328, Contrastive Loss: 0.0699
Epoch 7/30, Step 60/1,Classification Loss: 0.3186, Contrastive Loss: 0.0674
Epoch 7/30, Step 80/1,Classification Loss: 0.3270, Contrastive Loss: 0.0659
Epoch 7/30, Step 100/1,Classification Loss: 0.3283, Contrastive Loss: 0.0671
Epoch 7/30, Step 120/1,Classification Loss: 0.3222, Contrastive Loss: 0.0661
Epoch 7/30, Step 140/1,Classification Loss: 0.3457, Contrastive Loss: 0.0688
Accuracy: 0.9968, Precision: 0.9951, Recall: 0.9916, F1: 0.9934
Accuracy: 0.9926, Precision: 0.9856, Recall: 0.9844, F1: 0.9850
Epoch 7/30
Training - Loss: 56.4614
Training Metrics: {'accuracy': 0.9967766608391608, 'precision': 0.9951288488208554, 'recall': 0.9916328556225804, 'f1': 0.9933717083019149}
Validation Metrics: {'accuracy': 0.9926191251492457, 'precision': 0.9855804705346443, 'recall': 0.9843566398534035, 'f1': 0.9849674049503012}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0621
Epoch 8/30, Step 20/1,Classification Loss: 0.3153, Contrastive Loss: 0.0623
Epoch 8/30, Step 40/1,Classification Loss: 0.3149, Contrastive Loss: 0.0627
Epoch 8/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0598
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0586
Epoch 8/30, Step 100/1,Classification Loss: 0.3167, Contrastive Loss: 0.0601
Epoch 8/30, Step 120/1,Classification Loss: 0.3588, Contrastive Loss: 0.0810
Epoch 8/30, Step 140/1,Classification Loss: 0.3284, Contrastive Loss: 0.0617
Accuracy: 0.9969, Precision: 0.9954, Recall: 0.9920, F1: 0.9937
Accuracy: 0.9924, Precision: 0.9857, Recall: 0.9833, F1: 0.9845
Epoch 8/30
Training - Loss: 55.5514
Training Metrics: {'accuracy': 0.9969405594405595, 'precision': 0.9953524111230317, 'recall': 0.9919694081909103, 'f1': 0.9936524001973221}
Validation Metrics: {'accuracy': 0.9924020405948116, 'precision': 0.9857352904621763, 'recall': 0.9832853587006474, 'f1': 0.9845057137447972}
Epoch 9/30, Step 0/1,Classification Loss: 0.3340, Contrastive Loss: 0.0604
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0552
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0567
Epoch 9/30, Step 60/1,Classification Loss: 0.3313, Contrastive Loss: 0.0621
Epoch 9/30, Step 80/1,Classification Loss: 0.3152, Contrastive Loss: 0.0540
Epoch 9/30, Step 100/1,Classification Loss: 0.3542, Contrastive Loss: 0.0709
Epoch 9/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0542
Epoch 9/30, Step 140/1,Classification Loss: 0.3245, Contrastive Loss: 0.0548
Accuracy: 0.9972, Precision: 0.9951, Recall: 0.9934, F1: 0.9943
Accuracy: 0.9926, Precision: 0.9841, Recall: 0.9859, F1: 0.9850
Epoch 9/30
Training - Loss: 54.9312
Training Metrics: {'accuracy': 0.9972137237762237, 'precision': 0.9951389964114584, 'recall': 0.9933824720097264, 'f1': 0.994258433663623}
Validation Metrics: {'accuracy': 0.9926191251492457, 'precision': 0.98410351934052, 'recall': 0.9859308973569729, 'f1': 0.9850146389069616}
Epoch 10/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0526
Epoch 10/30, Step 20/1,Classification Loss: 0.3236, Contrastive Loss: 0.0530
Epoch 10/30, Step 40/1,Classification Loss: 0.3168, Contrastive Loss: 0.0531
Epoch 10/30, Step 60/1,Classification Loss: 0.3359, Contrastive Loss: 0.0629
Epoch 10/30, Step 80/1,Classification Loss: 0.3224, Contrastive Loss: 0.0527
Epoch 10/30, Step 100/1,Classification Loss: 0.3442, Contrastive Loss: 0.0544
Epoch 10/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0516
Epoch 10/30, Step 140/1,Classification Loss: 0.3355, Contrastive Loss: 0.0543
Accuracy: 0.9971, Precision: 0.9950, Recall: 0.9930, F1: 0.9940
Accuracy: 0.9928, Precision: 0.9863, Recall: 0.9845, F1: 0.9854
Epoch 10/30
Training - Loss: 54.1595
Training Metrics: {'accuracy': 0.9970771416083916, 'precision': 0.9949681796306172, 'recall': 0.9929673709690133, 'f1': 0.9939647920802834}
Validation Metrics: {'accuracy': 0.9928362097036796, 'precision': 0.986322477120895, 'recall': 0.9844833665040181, 'f1': 0.9854003280387039}
Epoch 11/30, Step 0/1,Classification Loss: 0.3365, Contrastive Loss: 0.0544
Epoch 11/30, Step 20/1,Classification Loss: 0.3336, Contrastive Loss: 0.0506
Epoch 11/30, Step 40/1,Classification Loss: 0.3148, Contrastive Loss: 0.0467
Epoch 11/30, Step 60/1,Classification Loss: 0.3381, Contrastive Loss: 0.0626
Epoch 11/30, Step 80/1,Classification Loss: 0.3233, Contrastive Loss: 0.0477
Epoch 11/30, Step 100/1,Classification Loss: 0.3601, Contrastive Loss: 0.0520
Epoch 11/30, Step 120/1,Classification Loss: 0.3270, Contrastive Loss: 0.0469
Epoch 11/30, Step 140/1,Classification Loss: 0.3212, Contrastive Loss: 0.0468
Accuracy: 0.9971, Precision: 0.9953, Recall: 0.9927, F1: 0.9940
Accuracy: 0.9926, Precision: 0.9859, Recall: 0.9840, F1: 0.9850
Epoch 11/30
Training - Loss: 53.6383
Training Metrics: {'accuracy': 0.9970771416083916, 'precision': 0.9953063896880112, 'recall': 0.9926802088639837, 'f1': 0.9939881475929275}
Validation Metrics: {'accuracy': 0.9926191251492457, 'precision': 0.9858792227281877, 'recall': 0.9840417883526896, 'f1': 0.9849579137368464}
Epoch 12/30, Step 0/1,Classification Loss: 0.3172, Contrastive Loss: 0.0448
Epoch 12/30, Step 20/1,Classification Loss: 0.3363, Contrastive Loss: 0.0505
Epoch 12/30, Step 40/1,Classification Loss: 0.3348, Contrastive Loss: 0.0475
Epoch 12/30, Step 60/1,Classification Loss: 0.3248, Contrastive Loss: 0.0458
Epoch 12/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0492
Epoch 12/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0411
Epoch 12/30, Step 120/1,Classification Loss: 0.3441, Contrastive Loss: 0.0612
Epoch 12/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0399
Accuracy: 0.9970, Precision: 0.9951, Recall: 0.9924, F1: 0.9937
Accuracy: 0.9919, Precision: 0.9854, Recall: 0.9814, F1: 0.9834
Epoch 12/30
Training - Loss: 52.9748
Training Metrics: {'accuracy': 0.9969678758741258, 'precision': 0.9951497227868429, 'recall': 0.9923544715370496, 'f1': 0.9937462675160373}
Validation Metrics: {'accuracy': 0.9918593292087268, 'precision': 0.9853754991138892, 'recall': 0.9813942845705415, 'f1': 0.9833726952693125}
Epoch 13/30, Step 0/1,Classification Loss: 0.3370, Contrastive Loss: 0.0442
Epoch 13/30, Step 20/1,Classification Loss: 0.3283, Contrastive Loss: 0.0425
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0392
Epoch 13/30, Step 60/1,Classification Loss: 0.3207, Contrastive Loss: 0.0402
Epoch 13/30, Step 80/1,Classification Loss: 0.3155, Contrastive Loss: 0.0386
Epoch 13/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0376
Epoch 13/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0383
Epoch 13/30, Step 140/1,Classification Loss: 0.3141, Contrastive Loss: 0.0379
Accuracy: 0.9960, Precision: 0.9947, Recall: 0.9890, F1: 0.9918
Accuracy: 0.9906, Precision: 0.9848, Recall: 0.9765, F1: 0.9806
Epoch 13/30
Training - Loss: 52.5080
Training Metrics: {'accuracy': 0.9960118006993007, 'precision': 0.994667569118389, 'recall': 0.9889501379050392, 'f1': 0.9917843336425078}
Validation Metrics: {'accuracy': 0.9905568218821231, 'precision': 0.9848175946306787, 'recall': 0.9765408551575734, 'f1': 0.9806263164501011}
Epoch 14/30, Step 0/1,Classification Loss: 0.3306, Contrastive Loss: 0.0492
Epoch 14/30, Step 20/1,Classification Loss: 0.3153, Contrastive Loss: 0.0376
Epoch 14/30, Step 40/1,Classification Loss: 0.3626, Contrastive Loss: 0.0471
Epoch 14/30, Step 60/1,Classification Loss: 0.3480, Contrastive Loss: 0.0445
Epoch 14/30, Step 80/1,Classification Loss: 0.3212, Contrastive Loss: 0.0367
Epoch 14/30, Step 100/1,Classification Loss: 0.3228, Contrastive Loss: 0.0383
Epoch 14/30, Step 120/1,Classification Loss: 0.3205, Contrastive Loss: 0.0356
Epoch 14/30, Step 140/1,Classification Loss: 0.3517, Contrastive Loss: 0.0440
Accuracy: 0.9969, Precision: 0.9960, Recall: 0.9912, F1: 0.9936
Accuracy: 0.9924, Precision: 0.9863, Recall: 0.9827, F1: 0.9845
Epoch 14/30
Training - Loss: 52.1477
Training Metrics: {'accuracy': 0.9968859265734266, 'precision': 0.9959953795224569, 'recall': 0.9912191189207707, 'f1': 0.9935902013279521}
Validation Metrics: {'accuracy': 0.9924020405948116, 'precision': 0.9863373460459985, 'recall': 0.9826556556992196, 'f1': 0.9844860962552437}
Epoch 15/30, Step 0/1,Classification Loss: 0.3186, Contrastive Loss: 0.0351
Epoch 15/30, Step 20/1,Classification Loss: 0.3447, Contrastive Loss: 0.0459
Epoch 15/30, Step 40/1,Classification Loss: 0.3168, Contrastive Loss: 0.0354
Epoch 15/30, Step 60/1,Classification Loss: 0.3182, Contrastive Loss: 0.0343
Epoch 15/30, Step 80/1,Classification Loss: 0.3442, Contrastive Loss: 0.0503
Epoch 15/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0349
Epoch 15/30, Step 120/1,Classification Loss: 0.3448, Contrastive Loss: 0.0400
Epoch 15/30, Step 140/1,Classification Loss: 0.3313, Contrastive Loss: 0.0343
Accuracy: 0.9970, Precision: 0.9955, Recall: 0.9923, F1: 0.9939
Accuracy: 0.9918, Precision: 0.9850, Recall: 0.9813, F1: 0.9832
Epoch 15/30
Training - Loss: 51.6430
Training Metrics: {'accuracy': 0.9970225087412588, 'precision': 0.9955231553046032, 'recall': 0.9922717646942465, 'f1': 0.9938895504645812}
Validation Metrics: {'accuracy': 0.9917507869315099, 'precision': 0.9850025065367969, 'recall': 0.9813309212452341, 'f1': 0.9831563330771218}
Epoch 16/30, Step 0/1,Classification Loss: 0.3296, Contrastive Loss: 0.0350
Epoch 16/30, Step 20/1,Classification Loss: 0.3590, Contrastive Loss: 0.0560
Epoch 16/30, Step 40/1,Classification Loss: 0.3297, Contrastive Loss: 0.0339
Epoch 16/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0297
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Epoch 16/30, Step 100/1,Classification Loss: 0.3273, Contrastive Loss: 0.0319
Epoch 16/30, Step 120/1,Classification Loss: 0.3444, Contrastive Loss: 0.0343
Epoch 16/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0449
Accuracy: 0.9972, Precision: 0.9952, Recall: 0.9931, F1: 0.9942
Accuracy: 0.9922, Precision: 0.9853, Recall: 0.9828, F1: 0.9841
Epoch 16/30
Training - Loss: 51.3038
Training Metrics: {'accuracy': 0.9971590909090909, 'precision': 0.9952021052123828, 'recall': 0.9931374028197191, 'f1': 0.9941665676458327}
Validation Metrics: {'accuracy': 0.9921849560403777, 'precision': 0.9852914738065798, 'recall': 0.9828437805493189, 'f1': 0.9840630198517915}
Epoch 17/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0316
Epoch 17/30, Step 20/1,Classification Loss: 0.3180, Contrastive Loss: 0.0316
Epoch 17/30, Step 40/1,Classification Loss: 0.3285, Contrastive Loss: 0.0312
Epoch 17/30, Step 60/1,Classification Loss: 0.3583, Contrastive Loss: 0.0424
Epoch 17/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0317
Epoch 17/30, Step 100/1,Classification Loss: 0.3155, Contrastive Loss: 0.0296
Epoch 17/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0287
Epoch 17/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0278
Accuracy: 0.9971, Precision: 0.9953, Recall: 0.9930, F1: 0.9941
Accuracy: 0.9918, Precision: 0.9853, Recall: 0.9810, F1: 0.9831
Epoch 17/30
Training - Loss: 50.9769
Training Metrics: {'accuracy': 0.9971317744755245, 'precision': 0.9952688123884237, 'recall': 0.9929685660033702, 'f1': 0.9941147320691522}
Validation Metrics: {'accuracy': 0.9917507869315099, 'precision': 0.9853035472845546, 'recall': 0.9810160697445203, 'f1': 0.9831456584763723}
Epoch 18/30, Step 0/1,Classification Loss: 0.3273, Contrastive Loss: 0.0294
Epoch 18/30, Step 20/1,Classification Loss: 0.3146, Contrastive Loss: 0.0278
Epoch 18/30, Step 40/1,Classification Loss: 0.3158, Contrastive Loss: 0.0281
Epoch 18/30, Step 60/1,Classification Loss: 0.3182, Contrastive Loss: 0.0280
Epoch 18/30, Step 80/1,Classification Loss: 0.3256, Contrastive Loss: 0.0278
Epoch 18/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0264
Epoch 18/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0271
Epoch 18/30, Step 140/1,Classification Loss: 0.3484, Contrastive Loss: 0.0323
Accuracy: 0.9972, Precision: 0.9952, Recall: 0.9933, F1: 0.9943
Accuracy: 0.9920, Precision: 0.9845, Recall: 0.9827, F1: 0.9836
Epoch 18/30
Training - Loss: 50.5731
Training Metrics: {'accuracy': 0.9972137237762237, 'precision': 0.9952276624934422, 'recall': 0.9933168624749988, 'f1': 0.9942695368484574}
Validation Metrics: {'accuracy': 0.9919678714859438, 'precision': 0.9845494595500657, 'recall': 0.9827170538987042, 'f1': 0.9836306708312741}
Epoch 19/30, Step 0/1,Classification Loss: 0.3214, Contrastive Loss: 0.0261
Epoch 19/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0251
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0247
Epoch 19/30, Step 60/1,Classification Loss: 0.3265, Contrastive Loss: 0.0270
Epoch 19/30, Step 80/1,Classification Loss: 0.3260, Contrastive Loss: 0.0270
Epoch 19/30, Step 100/1,Classification Loss: 0.3443, Contrastive Loss: 0.0366
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 19/30, Step 140/1,Classification Loss: 0.3147, Contrastive Loss: 0.0251
Accuracy: 0.9962, Precision: 0.9949, Recall: 0.9895, F1: 0.9921
Accuracy: 0.9906, Precision: 0.9854, Recall: 0.9759, F1: 0.9806
Epoch 19/30
Training - Loss: 50.2597
Training Metrics: {'accuracy': 0.9961756993006993, 'precision': 0.994850603941513, 'recall': 0.9894572803512129, 'f1': 0.9921321235359768}
Validation Metrics: {'accuracy': 0.9905568218821231, 'precision': 0.9854318861416237, 'recall': 0.9759111521561457, 'f1': 0.9806015672698196}
Epoch 20/30, Step 0/1,Classification Loss: 0.3164, Contrastive Loss: 0.0245
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 20/30, Step 40/1,Classification Loss: 0.3159, Contrastive Loss: 0.0246
Epoch 20/30, Step 60/1,Classification Loss: 0.3651, Contrastive Loss: 0.0453
Epoch 20/30, Step 80/1,Classification Loss: 0.3225, Contrastive Loss: 0.0256
Epoch 20/30, Step 100/1,Classification Loss: 0.3140, Contrastive Loss: 0.0260
Epoch 20/30, Step 120/1,Classification Loss: 0.3352, Contrastive Loss: 0.0275
Epoch 20/30, Step 140/1,Classification Loss: 0.3154, Contrastive Loss: 0.0234
Accuracy: 0.9971, Precision: 0.9952, Recall: 0.9928, F1: 0.9940
Accuracy: 0.9922, Precision: 0.9850, Recall: 0.9832, F1: 0.9841
Epoch 20/30
Training - Loss: 50.3531
Training Metrics: {'accuracy': 0.997104458041958, 'precision': 0.9952373587033286, 'recall': 0.992845434153994, 'f1': 0.9940371265385635}
Validation Metrics: {'accuracy': 0.9921849560403777, 'precision': 0.984992713942773, 'recall': 0.9831586320500327, 'f1': 0.9840730851331315}
Epoch 21/30, Step 0/1,Classification Loss: 0.3180, Contrastive Loss: 0.0245
Epoch 21/30, Step 20/1,Classification Loss: 0.3295, Contrastive Loss: 0.0353
Epoch 21/30, Step 40/1,Classification Loss: 0.3258, Contrastive Loss: 0.0233
Epoch 21/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0225
Epoch 21/30, Step 80/1,Classification Loss: 0.3443, Contrastive Loss: 0.0292
Epoch 21/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 21/30, Step 120/1,Classification Loss: 0.3159, Contrastive Loss: 0.0233
Epoch 21/30, Step 140/1,Classification Loss: 0.3201, Contrastive Loss: 0.0246
Accuracy: 0.9972, Precision: 0.9955, Recall: 0.9931, F1: 0.9943
Accuracy: 0.9920, Precision: 0.9854, Recall: 0.9818, F1: 0.9836
Epoch 21/30
Training - Loss: 50.0474
Training Metrics: {'accuracy': 0.9972410402097902, 'precision': 0.9954600627560005, 'recall': 0.9931303791377744, 'f1': 0.9942911848177454}
Validation Metrics: {'accuracy': 0.9919678714859438, 'precision': 0.985447453039864, 'recall': 0.9817724993965626, 'f1': 0.9835995874698291}
Epoch 22/30, Step 0/1,Classification Loss: 0.3178, Contrastive Loss: 0.0231
Epoch 22/30, Step 20/1,Classification Loss: 0.3145, Contrastive Loss: 0.0228
Epoch 22/30, Step 40/1,Classification Loss: 0.3212, Contrastive Loss: 0.0223
Epoch 22/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0210
Epoch 22/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0220
Epoch 22/30, Step 100/1,Classification Loss: 0.3628, Contrastive Loss: 0.0310
Epoch 22/30, Step 120/1,Classification Loss: 0.3332, Contrastive Loss: 0.0234
Epoch 22/30, Step 140/1,Classification Loss: 0.3179, Contrastive Loss: 0.0240
Accuracy: 0.9970, Precision: 0.9953, Recall: 0.9924, F1: 0.9938
Accuracy: 0.9921, Precision: 0.9852, Recall: 0.9825, F1: 0.9838
Epoch 22/30
Training - Loss: 49.7582
Training Metrics: {'accuracy': 0.9969951923076923, 'precision': 0.9952704458781566, 'recall': 0.9924195861066212, 'f1': 0.9938389309952866}
Validation Metrics: {'accuracy': 0.9920764137631608, 'precision': 0.985219229323127, 'recall': 0.9824655657232977, 'f1': 0.9838365643629781}
Epoch 23/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0202
Epoch 23/30, Step 20/1,Classification Loss: 0.3280, Contrastive Loss: 0.0233
Epoch 23/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0209
Epoch 23/30, Step 60/1,Classification Loss: 0.3192, Contrastive Loss: 0.0215
Epoch 23/30, Step 80/1,Classification Loss: 0.3514, Contrastive Loss: 0.0266
Epoch 23/30, Step 100/1,Classification Loss: 0.3206, Contrastive Loss: 0.0225
Epoch 23/30, Step 120/1,Classification Loss: 0.3183, Contrastive Loss: 0.0218
Epoch 23/30, Step 140/1,Classification Loss: 0.3263, Contrastive Loss: 0.0224
Accuracy: 0.9970, Precision: 0.9960, Recall: 0.9917, F1: 0.9938
Accuracy: 0.9916, Precision: 0.9852, Recall: 0.9806, F1: 0.9829
Epoch 23/30
Training - Loss: 49.6571
Training Metrics: {'accuracy': 0.9969951923076923, 'precision': 0.9959883976158646, 'recall': 0.9917070086553732, 'f1': 0.9938339863040899}
Validation Metrics: {'accuracy': 0.9916422446542928, 'precision': 0.985231597514096, 'recall': 0.9806378549184991, 'f1': 0.9829184769207013}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 24/30, Step 20/1,Classification Loss: 0.3196, Contrastive Loss: 0.0201
Epoch 24/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0202
Epoch 24/30, Step 60/1,Classification Loss: 0.3168, Contrastive Loss: 0.0207
Epoch 24/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 24/30, Step 140/1,Classification Loss: 0.3192, Contrastive Loss: 0.0208
Accuracy: 0.9968, Precision: 0.9961, Recall: 0.9908, F1: 0.9934
Accuracy: 0.9914, Precision: 0.9845, Recall: 0.9805, F1: 0.9825
Epoch 24/30
Training - Loss: 49.6888
Training Metrics: {'accuracy': 0.9968039772727273, 'precision': 0.9961041551790222, 'recall': 0.9907592340940982, 'f1': 0.9934103595025845}
Validation Metrics: {'accuracy': 0.9914251600998589, 'precision': 0.9844850389548532, 'recall': 0.9805111282678844, 'f1': 0.9824859056836759}
Epoch 25/30, Step 0/1,Classification Loss: 0.3437, Contrastive Loss: 0.0257
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 25/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0192
Epoch 25/30, Step 60/1,Classification Loss: 0.3545, Contrastive Loss: 0.0250
Epoch 25/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.0201
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 25/30, Step 120/1,Classification Loss: 0.3292, Contrastive Loss: 0.0247
Epoch 25/30, Step 140/1,Classification Loss: 0.3361, Contrastive Loss: 0.0230
Accuracy: 0.9970, Precision: 0.9952, Recall: 0.9926, F1: 0.9939
Accuracy: 0.9915, Precision: 0.9843, Recall: 0.9812, F1: 0.9827
Epoch 25/30
Training - Loss: 49.6353
Training Metrics: {'accuracy': 0.9970498251748252, 'precision': 0.995198085041112, 'recall': 0.9926412561013684, 'f1': 0.9939147951640175}
Validation Metrics: {'accuracy': 0.9915337023770758, 'precision': 0.9842582252632424, 'recall': 0.9812041945946195, 'f1': 0.9827240170046596}
Epoch 26/30, Step 0/1,Classification Loss: 0.3189, Contrastive Loss: 0.0204
Epoch 26/30, Step 20/1,Classification Loss: 0.3372, Contrastive Loss: 0.0218
Epoch 26/30, Step 40/1,Classification Loss: 0.3226, Contrastive Loss: 0.0207
Epoch 26/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0185
Epoch 26/30, Step 80/1,Classification Loss: 0.3179, Contrastive Loss: 0.0196
Epoch 26/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0193
Epoch 26/30, Step 120/1,Classification Loss: 0.3315, Contrastive Loss: 0.0222
Epoch 26/30, Step 140/1,Classification Loss: 0.3399, Contrastive Loss: 0.0247
Accuracy: 0.9970, Precision: 0.9954, Recall: 0.9922, F1: 0.9938
Accuracy: 0.9916, Precision: 0.9846, Recall: 0.9813, F1: 0.9829
Epoch 26/30
Training - Loss: 49.6306
Training Metrics: {'accuracy': 0.9969951923076923, 'precision': 0.9954216461618233, 'recall': 0.9922435788915219, 'f1': 0.9938250610576591}
Validation Metrics: {'accuracy': 0.9916422446542928, 'precision': 0.9846300823532206, 'recall': 0.9812675579199268, 'f1': 0.9829401070423807}
Epoch 27/30, Step 0/1,Classification Loss: 0.3268, Contrastive Loss: 0.0240
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0178
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 80/1,Classification Loss: 0.3162, Contrastive Loss: 0.0184
Epoch 27/30, Step 100/1,Classification Loss: 0.3171, Contrastive Loss: 0.0201
Epoch 27/30, Step 120/1,Classification Loss: 0.3149, Contrastive Loss: 0.0191
Epoch 27/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Accuracy: 0.9973, Precision: 0.9953, Recall: 0.9934, F1: 0.9944
Accuracy: 0.9918, Precision: 0.9826, Recall: 0.9838, F1: 0.9832
Epoch 27/30
Training - Loss: 49.4129
Training Metrics: {'accuracy': 0.9972683566433567, 'precision': 0.9953204365012849, 'recall': 0.9933960805930002, 'f1': 0.9943555027357032}
Validation Metrics: {'accuracy': 0.9917507869315099, 'precision': 0.9826348071487132, 'recall': 0.983849733250945, 'f1': 0.9832411300449324}
Epoch 28/30, Step 0/1,Classification Loss: 0.3167, Contrastive Loss: 0.0202
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 28/30, Step 40/1,Classification Loss: 0.3301, Contrastive Loss: 0.0364
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Epoch 28/30, Step 80/1,Classification Loss: 0.3177, Contrastive Loss: 0.0183
Epoch 28/30, Step 100/1,Classification Loss: 0.3594, Contrastive Loss: 0.0299
Epoch 28/30, Step 120/1,Classification Loss: 0.3293, Contrastive Loss: 0.0203
Epoch 28/30, Step 140/1,Classification Loss: 0.3475, Contrastive Loss: 0.0219
Accuracy: 0.9971, Precision: 0.9953, Recall: 0.9927, F1: 0.9940
Accuracy: 0.9918, Precision: 0.9841, Recall: 0.9823, F1: 0.9832
Epoch 28/30
Training - Loss: 49.2535
Training Metrics: {'accuracy': 0.9970771416083916, 'precision': 0.9953063896880112, 'recall': 0.9926802088639837, 'f1': 0.9939881475929275}
Validation Metrics: {'accuracy': 0.9917507869315099, 'precision': 0.9841062051573585, 'recall': 0.9822754757473757, 'f1': 0.9831882565294165}
Epoch 29/30, Step 0/1,Classification Loss: 0.3377, Contrastive Loss: 0.0212
Epoch 29/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 29/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0202
Epoch 29/30, Step 60/1,Classification Loss: 0.3251, Contrastive Loss: 0.0197
Epoch 29/30, Step 80/1,Classification Loss: 0.3189, Contrastive Loss: 0.0181
Epoch 29/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0176
Epoch 29/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0187
Epoch 29/30, Step 140/1,Classification Loss: 0.3283, Contrastive Loss: 0.0231
Accuracy: 0.9970, Precision: 0.9952, Recall: 0.9923, F1: 0.9938
Accuracy: 0.9916, Precision: 0.9837, Recall: 0.9822, F1: 0.9830
Epoch 29/30
Training - Loss: 49.4137
Training Metrics: {'accuracy': 0.9969678758741258, 'precision': 0.9952335747552334, 'recall': 0.9922820711615434, 'f1': 0.9937513201595745}
Validation Metrics: {'accuracy': 0.9916422446542928, 'precision': 0.9837363227654267, 'recall': 0.9822121124220684, 'f1': 0.9829724251848087}
Epoch 30/30, Step 0/1,Classification Loss: 0.3480, Contrastive Loss: 0.0239
Epoch 30/30, Step 20/1,Classification Loss: 0.3158, Contrastive Loss: 0.0180
Epoch 30/30, Step 40/1,Classification Loss: 0.3140, Contrastive Loss: 0.0177
Epoch 30/30, Step 60/1,Classification Loss: 0.3251, Contrastive Loss: 0.0204
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0168
Epoch 30/30, Step 100/1,Classification Loss: 0.3430, Contrastive Loss: 0.0219
Epoch 30/30, Step 120/1,Classification Loss: 0.3344, Contrastive Loss: 0.0519
Epoch 30/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0172
Accuracy: 0.9973, Precision: 0.9955, Recall: 0.9936, F1: 0.9945
Accuracy: 0.9926, Precision: 0.9847, Recall: 0.9853, F1: 0.9850
Epoch 30/30
Training - Loss: 49.2017
Training Metrics: {'accuracy': 0.9973229895104895, 'precision': 0.995458099238168, 'recall': 0.9935500268206334, 'f1': 0.9945013444514941}
Validation Metrics: {'accuracy': 0.9926191251492457, 'precision': 0.984690957503641, 'recall': 0.9853011943555452, 'f1': 0.9849957896128456}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1498, 5814), y shape: (1498,), y distribution: Counter({np.float64(0.0): 1359, np.float64(1.0): 139}), env shape: (1498,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8698, Precision: 0.4911, Recall: 0.4955, F1: 0.4895
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12015]))
original train data shape: torch.Size([46162]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1498, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46162]), new train data shape: torch.Size([46162])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12015]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3418, Contrastive Loss: 1.6398
Epoch 1/30, Step 20/1,Classification Loss: 0.3333, Contrastive Loss: 1.0380
Epoch 1/30, Step 40/1,Classification Loss: 0.3146, Contrastive Loss: 0.4651
Epoch 1/30, Step 60/1,Classification Loss: 0.3286, Contrastive Loss: 0.2774
Epoch 1/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.2384
Epoch 1/30, Step 100/1,Classification Loss: 0.3220, Contrastive Loss: 0.1812
Epoch 1/30, Step 120/1,Classification Loss: 0.3225, Contrastive Loss: 0.1600
Epoch 1/30, Step 140/1,Classification Loss: 0.3152, Contrastive Loss: 0.1519
Accuracy: 0.9966, Precision: 0.9951, Recall: 0.9908, F1: 0.9929
Accuracy: 0.9931, Precision: 0.9853, Recall: 0.9865, F1: 0.9859
Epoch 1/30
Training - Loss: 113.4731
Training Metrics: {'accuracy': 0.99658203125, 'precision': 0.9950991766439319, 'recall': 0.9908186417012133, 'f1': 0.9929452191298234}
Validation Metrics: {'accuracy': 0.9930683418173941, 'precision': 0.9853012619738918, 'recall': 0.9865212448703702, 'f1': 0.9859101115322334}
Epoch 2/30, Step 0/1,Classification Loss: 0.3392, Contrastive Loss: 0.1648
Epoch 2/30, Step 20/1,Classification Loss: 0.3446, Contrastive Loss: 0.1859
Epoch 2/30, Step 40/1,Classification Loss: 0.3174, Contrastive Loss: 0.1315
Epoch 2/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1331
Epoch 2/30, Step 80/1,Classification Loss: 0.3140, Contrastive Loss: 0.1226
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1171
Epoch 2/30, Step 120/1,Classification Loss: 0.3212, Contrastive Loss: 0.1242
Epoch 2/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.1103
Accuracy: 0.9967, Precision: 0.9954, Recall: 0.9913, F1: 0.9933
Accuracy: 0.9937, Precision: 0.9869, Recall: 0.9875, F1: 0.9872
Epoch 2/30
Training - Loss: 66.3166
Training Metrics: {'accuracy': 0.9967447916666666, 'precision': 0.9953657127685355, 'recall': 0.9912563267245091, 'f1': 0.9932983927704666}
Validation Metrics: {'accuracy': 0.9937181847720135, 'precision': 0.9869171997777328, 'recall': 0.9875294083492782, 'f1': 0.9872230175318044}
Epoch 3/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.1148
Epoch 3/30, Step 20/1,Classification Loss: 0.3187, Contrastive Loss: 0.1127
Epoch 3/30, Step 40/1,Classification Loss: 0.3802, Contrastive Loss: 0.1310
Epoch 3/30, Step 60/1,Classification Loss: 0.3205, Contrastive Loss: 0.1048
Epoch 3/30, Step 80/1,Classification Loss: 0.3383, Contrastive Loss: 0.1086
Epoch 3/30, Step 100/1,Classification Loss: 0.3283, Contrastive Loss: 0.1030
Epoch 3/30, Step 120/1,Classification Loss: 0.3315, Contrastive Loss: 0.1048
Epoch 3/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.1001
Accuracy: 0.9966, Precision: 0.9952, Recall: 0.9908, F1: 0.9930
Accuracy: 0.9931, Precision: 0.9850, Recall: 0.9868, F1: 0.9859
Epoch 3/30
Training - Loss: 63.1370
Training Metrics: {'accuracy': 0.9966091579861112, 'precision': 0.9951866958416027, 'recall': 0.9908115512301545, 'f1': 0.9929848437442528}
Validation Metrics: {'accuracy': 0.9930683418173941, 'precision': 0.985007358964284, 'recall': 0.9868356692574409, 'f1': 0.985918948549755}
Epoch 4/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.1104
Epoch 4/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0933
Epoch 4/30, Step 40/1,Classification Loss: 0.3303, Contrastive Loss: 0.1023
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0938
Epoch 4/30, Step 80/1,Classification Loss: 0.3303, Contrastive Loss: 0.0972
Epoch 4/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0968
Epoch 4/30, Step 120/1,Classification Loss: 0.3433, Contrastive Loss: 0.1013
Epoch 4/30, Step 140/1,Classification Loss: 0.3378, Contrastive Loss: 0.0947
Accuracy: 0.9967, Precision: 0.9951, Recall: 0.9913, F1: 0.9932
Accuracy: 0.9932, Precision: 0.9848, Recall: 0.9875, F1: 0.9862
Epoch 4/30
Training - Loss: 61.0095
Training Metrics: {'accuracy': 0.9966905381944444, 'precision': 0.995110323993375, 'recall': 0.9913408487553383, 'f1': 0.9932149319388308}
Validation Metrics: {'accuracy': 0.9931766489764974, 'precision': 0.9847877633965454, 'recall': 0.9875277371490432, 'f1': 0.9861519880018607}
Epoch 5/30, Step 0/1,Classification Loss: 0.3430, Contrastive Loss: 0.0984
Epoch 5/30, Step 20/1,Classification Loss: 0.3282, Contrastive Loss: 0.0900
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0836
Epoch 5/30, Step 60/1,Classification Loss: 0.3211, Contrastive Loss: 0.0880
Epoch 5/30, Step 80/1,Classification Loss: 0.3287, Contrastive Loss: 0.0854
Epoch 5/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0803
Epoch 5/30, Step 120/1,Classification Loss: 0.3208, Contrastive Loss: 0.0870
Epoch 5/30, Step 140/1,Classification Loss: 0.3136, Contrastive Loss: 0.0775
Accuracy: 0.9966, Precision: 0.9950, Recall: 0.9908, F1: 0.9929
Accuracy: 0.9932, Precision: 0.9848, Recall: 0.9875, F1: 0.9862
Epoch 5/30
Training - Loss: 59.6534
Training Metrics: {'accuracy': 0.9965549045138888, 'precision': 0.9950076514375388, 'recall': 0.9908142317847911, 'f1': 0.9928977917519357}
Validation Metrics: {'accuracy': 0.9931766489764974, 'precision': 0.9847877633965454, 'recall': 0.9875277371490432, 'f1': 0.9861519880018607}
Epoch 6/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0781
Epoch 6/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0785
Epoch 6/30, Step 40/1,Classification Loss: 0.3463, Contrastive Loss: 0.0868
Epoch 6/30, Step 60/1,Classification Loss: 0.3186, Contrastive Loss: 0.0773
Epoch 6/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0772
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0710
Epoch 6/30, Step 120/1,Classification Loss: 0.3285, Contrastive Loss: 0.0747
Epoch 6/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0767
Accuracy: 0.9969, Precision: 0.9953, Recall: 0.9918, F1: 0.9935
Accuracy: 0.9924, Precision: 0.9814, Recall: 0.9880, F1: 0.9847
Epoch 6/30
Training - Loss: 58.5956
Training Metrics: {'accuracy': 0.9968532986111112, 'precision': 0.9952537701737851, 'recall': 0.9917538083017832, 'f1': 0.9934946576959875}
Validation Metrics: {'accuracy': 0.9924184988627748, 'precision': 0.9813908417767987, 'recall': 0.9880284764880272, 'f1': 0.9846756349447972}
Epoch 7/30, Step 0/1,Classification Loss: 0.3151, Contrastive Loss: 0.0731
Epoch 7/30, Step 20/1,Classification Loss: 0.3166, Contrastive Loss: 0.0706
Epoch 7/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0676
Epoch 7/30, Step 60/1,Classification Loss: 0.3280, Contrastive Loss: 0.0718
Epoch 7/30, Step 80/1,Classification Loss: 0.3295, Contrastive Loss: 0.0722
Epoch 7/30, Step 100/1,Classification Loss: 0.3319, Contrastive Loss: 0.0758
Epoch 7/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0660
Epoch 7/30, Step 140/1,Classification Loss: 0.3270, Contrastive Loss: 0.0657
Accuracy: 0.9967, Precision: 0.9952, Recall: 0.9910, F1: 0.9931
Accuracy: 0.9924, Precision: 0.9837, Recall: 0.9855, F1: 0.9846
Epoch 7/30
Training - Loss: 57.8056
Training Metrics: {'accuracy': 0.9966634114583334, 'precision': 0.9952231415257778, 'recall': 0.9910130591136959, 'f1': 0.9931048721151625}
Validation Metrics: {'accuracy': 0.9924184988627748, 'precision': 0.9836897380741491, 'recall': 0.9855130813914623, 'f1': 0.9845988499762945}
Epoch 8/30, Step 0/1,Classification Loss: 0.3140, Contrastive Loss: 0.0665
Epoch 8/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0666
Epoch 8/30, Step 40/1,Classification Loss: 0.3397, Contrastive Loss: 0.0679
Epoch 8/30, Step 60/1,Classification Loss: 0.3164, Contrastive Loss: 0.0650
Epoch 8/30, Step 80/1,Classification Loss: 0.3301, Contrastive Loss: 0.0677
Epoch 8/30, Step 100/1,Classification Loss: 0.3223, Contrastive Loss: 0.0625
Epoch 8/30, Step 120/1,Classification Loss: 0.3505, Contrastive Loss: 0.0700
Epoch 8/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0700
Accuracy: 0.9967, Precision: 0.9954, Recall: 0.9909, F1: 0.9931
Accuracy: 0.9927, Precision: 0.9845, Recall: 0.9860, F1: 0.9853
Epoch 8/30
Training - Loss: 56.5116
Training Metrics: {'accuracy': 0.9966634114583334, 'precision': 0.9954012205616039, 'recall': 0.9909050343050514, 'f1': 0.9931379960482343}
Validation Metrics: {'accuracy': 0.9927434203400844, 'precision': 0.9844949495526453, 'recall': 0.9860171631309163, 'f1': 0.9852542754391822}
Epoch 9/30, Step 0/1,Classification Loss: 0.3269, Contrastive Loss: 0.0643
Epoch 9/30, Step 20/1,Classification Loss: 0.3148, Contrastive Loss: 0.0609
Epoch 9/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0579
Epoch 9/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0572
Epoch 9/30, Step 80/1,Classification Loss: 0.3208, Contrastive Loss: 0.0636
Epoch 9/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0553
Epoch 9/30, Step 120/1,Classification Loss: 0.3358, Contrastive Loss: 0.0585
Epoch 9/30, Step 140/1,Classification Loss: 0.3347, Contrastive Loss: 0.0743
Accuracy: 0.9966, Precision: 0.9954, Recall: 0.9906, F1: 0.9930
Accuracy: 0.9927, Precision: 0.9854, Recall: 0.9851, F1: 0.9852
Epoch 9/30
Training - Loss: 55.9652
Training Metrics: {'accuracy': 0.9966091579861112, 'precision': 0.9954474232964521, 'recall': 0.9906334088328231, 'f1': 0.9930230704786996}
Validation Metrics: {'accuracy': 0.9927434203400844, 'precision': 0.9853791664158289, 'recall': 0.9850738899697045, 'f1': 0.9852264566482187}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0540
Epoch 10/30, Step 20/1,Classification Loss: 0.3383, Contrastive Loss: 0.0599
Epoch 10/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0574
Epoch 10/30, Step 60/1,Classification Loss: 0.3372, Contrastive Loss: 0.0600
Epoch 10/30, Step 80/1,Classification Loss: 0.3571, Contrastive Loss: 0.0617
Epoch 10/30, Step 100/1,Classification Loss: 0.3303, Contrastive Loss: 0.0615
Epoch 10/30, Step 120/1,Classification Loss: 0.3316, Contrastive Loss: 0.0653
Epoch 10/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0507
Accuracy: 0.9967, Precision: 0.9953, Recall: 0.9913, F1: 0.9933
Accuracy: 0.9922, Precision: 0.9833, Recall: 0.9851, F1: 0.9842
Epoch 10/30
Training - Loss: 55.0967
Training Metrics: {'accuracy': 0.9967447916666666, 'precision': 0.9952612218937311, 'recall': 0.9912726903626932, 'f1': 0.9932551072472833}
Validation Metrics: {'accuracy': 0.9922018845445684, 'precision': 0.9832505311107708, 'recall': 0.9850722187694695, 'f1': 0.9841588171184744}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0492
Epoch 11/30, Step 20/1,Classification Loss: 0.3360, Contrastive Loss: 0.0528
Epoch 11/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0523
Epoch 11/30, Step 60/1,Classification Loss: 0.3163, Contrastive Loss: 0.0488
Epoch 11/30, Step 80/1,Classification Loss: 0.3256, Contrastive Loss: 0.0529
Epoch 11/30, Step 100/1,Classification Loss: 0.3153, Contrastive Loss: 0.0494
Epoch 11/30, Step 120/1,Classification Loss: 0.3321, Contrastive Loss: 0.0511
Epoch 11/30, Step 140/1,Classification Loss: 0.3325, Contrastive Loss: 0.0485
Accuracy: 0.9969, Precision: 0.9954, Recall: 0.9916, F1: 0.9935
Accuracy: 0.9930, Precision: 0.9849, Recall: 0.9865, F1: 0.9857
Epoch 11/30
Training - Loss: 54.3183
Training Metrics: {'accuracy': 0.9968532986111112, 'precision': 0.9954080241577242, 'recall': 0.9915799963229128, 'f1': 0.9934830983560656}
Validation Metrics: {'accuracy': 0.9929600346582909, 'precision': 0.9849344313858095, 'recall': 0.9864580257529092, 'f1': 0.9856944463215948}
Epoch 12/30, Step 0/1,Classification Loss: 0.3392, Contrastive Loss: 0.0511
Epoch 12/30, Step 20/1,Classification Loss: 0.3451, Contrastive Loss: 0.0584
Epoch 12/30, Step 40/1,Classification Loss: 0.3160, Contrastive Loss: 0.0453
Epoch 12/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0442
Epoch 12/30, Step 80/1,Classification Loss: 0.3309, Contrastive Loss: 0.0468
Epoch 12/30, Step 100/1,Classification Loss: 0.3268, Contrastive Loss: 0.0448
Epoch 12/30, Step 120/1,Classification Loss: 0.3575, Contrastive Loss: 0.0516
Epoch 12/30, Step 140/1,Classification Loss: 0.3441, Contrastive Loss: 0.0518
Accuracy: 0.9964, Precision: 0.9952, Recall: 0.9902, F1: 0.9927
Accuracy: 0.9921, Precision: 0.9835, Recall: 0.9844, F1: 0.9839
Epoch 12/30
Training - Loss: 53.7688
Training Metrics: {'accuracy': 0.9964463975694444, 'precision': 0.995180364781211, 'recall': 0.9901909367592167, 'f1': 0.992667036141438}
Validation Metrics: {'accuracy': 0.9920935773854652, 'precision': 0.9834684807223382, 'recall': 0.9843801508778671, 'f1': 0.9839236752086704}
Epoch 13/30, Step 0/1,Classification Loss: 0.3170, Contrastive Loss: 0.0427
Epoch 13/30, Step 20/1,Classification Loss: 0.3347, Contrastive Loss: 0.0450
Epoch 13/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0458
Epoch 13/30, Step 60/1,Classification Loss: 0.3192, Contrastive Loss: 0.0411
Epoch 13/30, Step 80/1,Classification Loss: 0.3185, Contrastive Loss: 0.0408
Epoch 13/30, Step 100/1,Classification Loss: 0.3563, Contrastive Loss: 0.0530
Epoch 13/30, Step 120/1,Classification Loss: 0.3271, Contrastive Loss: 0.0435
Epoch 13/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0385
Accuracy: 0.9966, Precision: 0.9952, Recall: 0.9909, F1: 0.9930
Accuracy: 0.9922, Precision: 0.9835, Recall: 0.9848, F1: 0.9841
Epoch 13/30
Training - Loss: 53.4044
Training Metrics: {'accuracy': 0.9966362847222222, 'precision': 0.9952067565657108, 'recall': 0.9909172185923234, 'f1': 0.9930482542345229}
Validation Metrics: {'accuracy': 0.9922018845445684, 'precision': 0.9835422334499287, 'recall': 0.9847577943823989, 'f1': 0.9841488754737626}
Epoch 14/30, Step 0/1,Classification Loss: 0.3423, Contrastive Loss: 0.0433
Epoch 14/30, Step 20/1,Classification Loss: 0.3260, Contrastive Loss: 0.0430
Epoch 14/30, Step 40/1,Classification Loss: 0.3198, Contrastive Loss: 0.0395
Epoch 14/30, Step 60/1,Classification Loss: 0.3210, Contrastive Loss: 0.0398
Epoch 14/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0373
Epoch 14/30, Step 100/1,Classification Loss: 0.3455, Contrastive Loss: 0.0466
Epoch 14/30, Step 120/1,Classification Loss: 0.3144, Contrastive Loss: 0.0384
Epoch 14/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Accuracy: 0.9966, Precision: 0.9952, Recall: 0.9909, F1: 0.9930
Accuracy: 0.9924, Precision: 0.9843, Recall: 0.9849, F1: 0.9846
Epoch 14/30
Training - Loss: 52.8604
Training Metrics: {'accuracy': 0.9966091579861112, 'precision': 0.9952031673696223, 'recall': 0.9908555925210955, 'f1': 0.993015242367596}
Validation Metrics: {'accuracy': 0.9924184988627748, 'precision': 0.9842753456900266, 'recall': 0.9848842326173212, 'f1': 0.984579503917695}
Epoch 15/30, Step 0/1,Classification Loss: 0.3257, Contrastive Loss: 0.0384
Epoch 15/30, Step 20/1,Classification Loss: 0.3266, Contrastive Loss: 0.0390
Epoch 15/30, Step 40/1,Classification Loss: 0.3235, Contrastive Loss: 0.0380
Epoch 15/30, Step 60/1,Classification Loss: 0.3349, Contrastive Loss: 0.0418
Epoch 15/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0351
Epoch 15/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0372
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0334
Epoch 15/30, Step 140/1,Classification Loss: 0.3227, Contrastive Loss: 0.0375
Accuracy: 0.9970, Precision: 0.9955, Recall: 0.9921, F1: 0.9938
Accuracy: 0.9920, Precision: 0.9811, Recall: 0.9865, F1: 0.9838
Epoch 15/30
Training - Loss: 52.7026
Training Metrics: {'accuracy': 0.9969889322916666, 'precision': 0.9955012356196842, 'recall': 0.9920872944263552, 'f1': 0.9937855736322033}
Validation Metrics: {'accuracy': 0.991985270226362, 'precision': 0.9810872277855831, 'recall': 0.9865179024699002, 'f1': 0.9837797582306969}
Epoch 16/30, Step 0/1,Classification Loss: 0.3339, Contrastive Loss: 0.0395
Epoch 16/30, Step 20/1,Classification Loss: 0.3281, Contrastive Loss: 0.0363
Epoch 16/30, Step 40/1,Classification Loss: 0.3480, Contrastive Loss: 0.0381
Epoch 16/30, Step 60/1,Classification Loss: 0.3174, Contrastive Loss: 0.0336
Epoch 16/30, Step 80/1,Classification Loss: 0.3315, Contrastive Loss: 0.0350
Epoch 16/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0340
Epoch 16/30, Step 120/1,Classification Loss: 0.3351, Contrastive Loss: 0.0353
Epoch 16/30, Step 140/1,Classification Loss: 0.3335, Contrastive Loss: 0.0335
Accuracy: 0.9967, Precision: 0.9953, Recall: 0.9913, F1: 0.9933
Accuracy: 0.9923, Precision: 0.9827, Recall: 0.9861, F1: 0.9844
Epoch 16/30
Training - Loss: 51.8939
Training Metrics: {'accuracy': 0.9967447916666666, 'precision': 0.9952911869892873, 'recall': 0.9913481596227905, 'f1': 0.9933080377013218}
Validation Metrics: {'accuracy': 0.9923101917036716, 'precision': 0.9827449797654173, 'recall': 0.9860787110481424, 'f1': 0.9844032757586678}
Epoch 17/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0317
Epoch 17/30, Step 20/1,Classification Loss: 0.3319, Contrastive Loss: 0.0670
Epoch 17/30, Step 40/1,Classification Loss: 0.3231, Contrastive Loss: 0.0347
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0300
Epoch 17/30, Step 80/1,Classification Loss: 0.3140, Contrastive Loss: 0.0307
Epoch 17/30, Step 100/1,Classification Loss: 0.3463, Contrastive Loss: 0.0367
Epoch 17/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.0295
Epoch 17/30, Step 140/1,Classification Loss: 0.3303, Contrastive Loss: 0.0423
Accuracy: 0.9964, Precision: 0.9951, Recall: 0.9901, F1: 0.9926
Accuracy: 0.9924, Precision: 0.9840, Recall: 0.9852, F1: 0.9846
Epoch 17/30
Training - Loss: 51.9538
Training Metrics: {'accuracy': 0.9964192708333334, 'precision': 0.9950744823120348, 'recall': 0.9901469640614255, 'f1': 0.9925925925925926}
Validation Metrics: {'accuracy': 0.9924184988627748, 'precision': 0.9839819905809195, 'recall': 0.9851986570043917, 'f1': 0.9845891844883803}
Epoch 18/30, Step 0/1,Classification Loss: 0.3213, Contrastive Loss: 0.0323
Epoch 18/30, Step 20/1,Classification Loss: 0.3166, Contrastive Loss: 0.0323
Epoch 18/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0353
Epoch 18/30, Step 60/1,Classification Loss: 0.3166, Contrastive Loss: 0.0301
Epoch 18/30, Step 80/1,Classification Loss: 0.3160, Contrastive Loss: 0.0297
Epoch 18/30, Step 100/1,Classification Loss: 0.3194, Contrastive Loss: 0.0295
Epoch 18/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0307
Epoch 18/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0259
Accuracy: 0.9964, Precision: 0.9953, Recall: 0.9902, F1: 0.9927
Accuracy: 0.9926, Precision: 0.9850, Recall: 0.9850, F1: 0.9850
Epoch 18/30
Training - Loss: 51.4697
Training Metrics: {'accuracy': 0.9964463975694444, 'precision': 0.9952771770980737, 'recall': 0.9901640790022901, 'f1': 0.9927010238175048}
Validation Metrics: {'accuracy': 0.9926351131809813, 'precision': 0.9850106708522434, 'recall': 0.9850106708522434, 'f1': 0.9850106708522434}
Epoch 19/30, Step 0/1,Classification Loss: 0.3200, Contrastive Loss: 0.0287
Epoch 19/30, Step 20/1,Classification Loss: 0.3284, Contrastive Loss: 0.0296
Epoch 19/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0261
Epoch 19/30, Step 60/1,Classification Loss: 0.3151, Contrastive Loss: 0.0282
Epoch 19/30, Step 80/1,Classification Loss: 0.3488, Contrastive Loss: 0.0346
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 19/30, Step 120/1,Classification Loss: 0.3199, Contrastive Loss: 0.0282
Epoch 19/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0254
Accuracy: 0.9969, Precision: 0.9956, Recall: 0.9918, F1: 0.9937
Accuracy: 0.9926, Precision: 0.9827, Recall: 0.9875, F1: 0.9851
Epoch 19/30
Training - Loss: 51.1095
Training Metrics: {'accuracy': 0.9969346788194444, 'precision': 0.9956346160195018, 'recall': 0.9917533574176424, 'f1': 0.99368274025324}
Validation Metrics: {'accuracy': 0.9926351131809813, 'precision': 0.9826813291959057, 'recall': 0.9875260659488081, 'f1': 0.9850856108608292}
Epoch 20/30, Step 0/1,Classification Loss: 0.3652, Contrastive Loss: 0.0381
Epoch 20/30, Step 20/1,Classification Loss: 0.3576, Contrastive Loss: 0.0354
Epoch 20/30, Step 40/1,Classification Loss: 0.3274, Contrastive Loss: 0.0280
Epoch 20/30, Step 60/1,Classification Loss: 0.3336, Contrastive Loss: 0.0289
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0250
Epoch 20/30, Step 100/1,Classification Loss: 0.3247, Contrastive Loss: 0.0249
Epoch 20/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0238
Epoch 20/30, Step 140/1,Classification Loss: 0.3205, Contrastive Loss: 0.0252
Accuracy: 0.9968, Precision: 0.9954, Recall: 0.9915, F1: 0.9935
Accuracy: 0.9921, Precision: 0.9814, Recall: 0.9866, F1: 0.9840
Epoch 20/30
Training - Loss: 51.1697
Training Metrics: {'accuracy': 0.996826171875, 'precision': 0.995410704264871, 'recall': 0.9915321111298079, 'f1': 0.9934601696606018}
Validation Metrics: {'accuracy': 0.9920935773854652, 'precision': 0.9814475282079891, 'recall': 0.9865811215873613, 'f1': 0.9839939595814879}
Epoch 21/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0246
Epoch 21/30, Step 20/1,Classification Loss: 0.3381, Contrastive Loss: 0.0296
Epoch 21/30, Step 40/1,Classification Loss: 0.3189, Contrastive Loss: 0.0267
Epoch 21/30, Step 60/1,Classification Loss: 0.3472, Contrastive Loss: 0.0308
Epoch 21/30, Step 80/1,Classification Loss: 0.3424, Contrastive Loss: 0.0290
Epoch 21/30, Step 100/1,Classification Loss: 0.3190, Contrastive Loss: 0.0249
Epoch 21/30, Step 120/1,Classification Loss: 0.3417, Contrastive Loss: 0.0261
Epoch 21/30, Step 140/1,Classification Loss: 0.3450, Contrastive Loss: 0.0514
Accuracy: 0.9969, Precision: 0.9954, Recall: 0.9918, F1: 0.9936
Accuracy: 0.9924, Precision: 0.9820, Recall: 0.9874, F1: 0.9847
Epoch 21/30
Training - Loss: 50.8563
Training Metrics: {'accuracy': 0.9968804253472222, 'precision': 0.9953597669852705, 'recall': 0.9917928301859679, 'f1': 0.9935668011100163}
Validation Metrics: {'accuracy': 0.9924184988627748, 'precision': 0.9819591109190591, 'recall': 0.9873996277138859, 'f1': 0.9846565280560646}
Epoch 22/30, Step 0/1,Classification Loss: 0.3253, Contrastive Loss: 0.0262
Epoch 22/30, Step 20/1,Classification Loss: 0.3537, Contrastive Loss: 0.0334
Epoch 22/30, Step 40/1,Classification Loss: 0.3305, Contrastive Loss: 0.0274
Epoch 22/30, Step 60/1,Classification Loss: 0.3167, Contrastive Loss: 0.0252
Epoch 22/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0419
Epoch 22/30, Step 100/1,Classification Loss: 0.3232, Contrastive Loss: 0.0225
Epoch 22/30, Step 120/1,Classification Loss: 0.3485, Contrastive Loss: 0.0294
Epoch 22/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0233
Accuracy: 0.9965, Precision: 0.9951, Recall: 0.9904, F1: 0.9928
Accuracy: 0.9926, Precision: 0.9838, Recall: 0.9863, F1: 0.9850
Epoch 22/30
Training - Loss: 50.6990
Training Metrics: {'accuracy': 0.9964735243055556, 'precision': 0.9951302841875092, 'recall': 0.9904039433099334, 'f1': 0.992750374176432}
Validation Metrics: {'accuracy': 0.9926351131809813, 'precision': 0.9838372418741992, 'recall': 0.9862683684005258, 'f1': 0.9850482575463143}
Epoch 23/30, Step 0/1,Classification Loss: 0.3339, Contrastive Loss: 0.0272
Epoch 23/30, Step 20/1,Classification Loss: 0.3357, Contrastive Loss: 0.0264
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 23/30, Step 60/1,Classification Loss: 0.3252, Contrastive Loss: 0.0227
Epoch 23/30, Step 80/1,Classification Loss: 0.3281, Contrastive Loss: 0.0251
Epoch 23/30, Step 100/1,Classification Loss: 0.3440, Contrastive Loss: 0.0372
Epoch 23/30, Step 120/1,Classification Loss: 0.3243, Contrastive Loss: 0.0228
Epoch 23/30, Step 140/1,Classification Loss: 0.3442, Contrastive Loss: 0.0310
Accuracy: 0.9970, Precision: 0.9956, Recall: 0.9921, F1: 0.9938
Accuracy: 0.9925, Precision: 0.9820, Recall: 0.9878, F1: 0.9849
Epoch 23/30
Training - Loss: 50.4353
Training Metrics: {'accuracy': 0.9970160590277778, 'precision': 0.9955914518178199, 'recall': 0.992089103547268, 'f1': 0.9938311409186089}
Validation Metrics: {'accuracy': 0.992526806021878, 'precision': 0.9820344800576052, 'recall': 0.9877772712184176, 'f1': 0.9848804344738255}
Epoch 24/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0380
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 24/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0252
Epoch 24/30, Step 60/1,Classification Loss: 0.3293, Contrastive Loss: 0.0225
Epoch 24/30, Step 80/1,Classification Loss: 0.3593, Contrastive Loss: 0.0285
Epoch 24/30, Step 100/1,Classification Loss: 0.3444, Contrastive Loss: 0.0363
Epoch 24/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0208
Epoch 24/30, Step 140/1,Classification Loss: 0.3158, Contrastive Loss: 0.0225
Accuracy: 0.9969, Precision: 0.9954, Recall: 0.9918, F1: 0.9936
Accuracy: 0.9924, Precision: 0.9822, Recall: 0.9871, F1: 0.9846
Epoch 24/30
Training - Loss: 50.5037
Training Metrics: {'accuracy': 0.9969075520833334, 'precision': 0.9954365536090848, 'recall': 0.9917620207134632, 'f1': 0.9935892413207611}
Validation Metrics: {'accuracy': 0.9924184988627748, 'precision': 0.9822448475978148, 'recall': 0.9870852033268154, 'f1': 0.9846469523567359}
Epoch 25/30, Step 0/1,Classification Loss: 0.3593, Contrastive Loss: 0.0369
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 25/30, Step 40/1,Classification Loss: 0.3410, Contrastive Loss: 0.0286
Epoch 25/30, Step 60/1,Classification Loss: 0.3144, Contrastive Loss: 0.0235
Epoch 25/30, Step 80/1,Classification Loss: 0.3152, Contrastive Loss: 0.0205
Epoch 25/30, Step 100/1,Classification Loss: 0.3297, Contrastive Loss: 0.0227
Epoch 25/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 25/30, Step 140/1,Classification Loss: 0.3317, Contrastive Loss: 0.0229
Accuracy: 0.9969, Precision: 0.9954, Recall: 0.9920, F1: 0.9937
Accuracy: 0.9922, Precision: 0.9821, Recall: 0.9863, F1: 0.9842
Epoch 25/30
Training - Loss: 50.1108
Training Metrics: {'accuracy': 0.9969346788194444, 'precision': 0.9953980583336675, 'recall': 0.9919968535639874, 'f1': 0.9936888143367208}
Validation Metrics: {'accuracy': 0.9922018845445684, 'precision': 0.982094635211213, 'recall': 0.9863299163177519, 'f1': 0.9841984292557534}
Epoch 26/30, Step 0/1,Classification Loss: 0.3305, Contrastive Loss: 0.0280
Epoch 26/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0205
Epoch 26/30, Step 40/1,Classification Loss: 0.3509, Contrastive Loss: 0.0244
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 26/30, Step 80/1,Classification Loss: 0.3690, Contrastive Loss: 0.0327
Epoch 26/30, Step 100/1,Classification Loss: 0.3345, Contrastive Loss: 0.0235
Epoch 26/30, Step 120/1,Classification Loss: 0.3162, Contrastive Loss: 0.0215
Epoch 26/30, Step 140/1,Classification Loss: 0.3176, Contrastive Loss: 0.0207
Accuracy: 0.9969, Precision: 0.9953, Recall: 0.9918, F1: 0.9935
Accuracy: 0.9918, Precision: 0.9827, Recall: 0.9839, F1: 0.9833
Epoch 26/30
Training - Loss: 50.1565
Training Metrics: {'accuracy': 0.9968532986111112, 'precision': 0.9952739451771614, 'recall': 0.9918001007272308, 'f1': 0.9935279989887499}
Validation Metrics: {'accuracy': 0.9917686559081555, 'precision': 0.9826627191879472, 'recall': 0.9838760691384132, 'f1': 0.9832682574445272}
Epoch 27/30, Step 0/1,Classification Loss: 0.3527, Contrastive Loss: 0.0276
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 27/30, Step 40/1,Classification Loss: 0.3269, Contrastive Loss: 0.0201
Epoch 27/30, Step 60/1,Classification Loss: 0.3191, Contrastive Loss: 0.0199
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 27/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0196
Epoch 27/30, Step 120/1,Classification Loss: 0.3189, Contrastive Loss: 0.0188
Epoch 27/30, Step 140/1,Classification Loss: 0.3456, Contrastive Loss: 0.0214
Accuracy: 0.9964, Precision: 0.9952, Recall: 0.9901, F1: 0.9926
Accuracy: 0.9918, Precision: 0.9841, Recall: 0.9823, F1: 0.9832
Epoch 27/30
Training - Loss: 50.2207
Training Metrics: {'accuracy': 0.9964192708333334, 'precision': 0.9951628255944628, 'recall': 0.9900918039155198, 'f1': 0.9926080885040236}
Validation Metrics: {'accuracy': 0.9917686559081555, 'precision': 0.9841322875736798, 'recall': 0.9823039472030601, 'f1': 0.9832155412795864}
Epoch 28/30, Step 0/1,Classification Loss: 0.3285, Contrastive Loss: 0.0195
Epoch 28/30, Step 20/1,Classification Loss: 0.3231, Contrastive Loss: 0.0208
Epoch 28/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0190
Epoch 28/30, Step 60/1,Classification Loss: 0.3234, Contrastive Loss: 0.0203
Epoch 28/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0225
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 28/30, Step 120/1,Classification Loss: 0.3157, Contrastive Loss: 0.0190
Epoch 28/30, Step 140/1,Classification Loss: 0.3172, Contrastive Loss: 0.0184
Accuracy: 0.9937, Precision: 0.9954, Recall: 0.9787, F1: 0.9869
Accuracy: 0.9887, Precision: 0.9849, Recall: 0.9689, F1: 0.9767
Epoch 28/30
Training - Loss: 49.9843
Training Metrics: {'accuracy': 0.9937065972222222, 'precision': 0.9954356456452016, 'recall': 0.9787463299002372, 'f1': 0.9868812674981793}
Validation Metrics: {'accuracy': 0.9887360554532655, 'precision': 0.9848809921638427, 'recall': 0.9689001095925365, 'f1': 0.9766925608007277}
Epoch 29/30, Step 0/1,Classification Loss: 0.3141, Contrastive Loss: 0.0197
Epoch 29/30, Step 20/1,Classification Loss: 0.3295, Contrastive Loss: 0.0209
Epoch 29/30, Step 40/1,Classification Loss: 0.3178, Contrastive Loss: 0.0196
Epoch 29/30, Step 60/1,Classification Loss: 0.3272, Contrastive Loss: 0.0195
Epoch 29/30, Step 80/1,Classification Loss: 0.3525, Contrastive Loss: 0.0238
Epoch 29/30, Step 100/1,Classification Loss: 0.3174, Contrastive Loss: 0.0202
Epoch 29/30, Step 120/1,Classification Loss: 0.3160, Contrastive Loss: 0.0181
Epoch 29/30, Step 140/1,Classification Loss: 0.3170, Contrastive Loss: 0.0187
Accuracy: 0.9959, Precision: 0.9950, Recall: 0.9882, F1: 0.9916
Accuracy: 0.9918, Precision: 0.9841, Recall: 0.9823, F1: 0.9832
Epoch 29/30
Training - Loss: 49.9006
Training Metrics: {'accuracy': 0.9959309895833334, 'precision': 0.9950257267999929, 'recall': 0.9881981370516566, 'f1': 0.9915770550791381}
Validation Metrics: {'accuracy': 0.9917686559081555, 'precision': 0.9841322875736798, 'recall': 0.9823039472030601, 'f1': 0.9832155412795864}
Epoch 30/30, Step 0/1,Classification Loss: 0.3303, Contrastive Loss: 0.0289
Epoch 30/30, Step 20/1,Classification Loss: 0.3291, Contrastive Loss: 0.0221
Epoch 30/30, Step 40/1,Classification Loss: 0.3299, Contrastive Loss: 0.0245
Epoch 30/30, Step 60/1,Classification Loss: 0.3154, Contrastive Loss: 0.0182
Epoch 30/30, Step 80/1,Classification Loss: 0.3439, Contrastive Loss: 0.0205
Epoch 30/30, Step 100/1,Classification Loss: 0.3411, Contrastive Loss: 0.0214
Epoch 30/30, Step 120/1,Classification Loss: 0.3473, Contrastive Loss: 0.0377
Epoch 30/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0214
Accuracy: 0.9918, Precision: 0.9942, Recall: 0.9720, F1: 0.9828
Accuracy: 0.9873, Precision: 0.9840, Recall: 0.9640, F1: 0.9737
Epoch 30/30
Training - Loss: 49.9298
Training Metrics: {'accuracy': 0.9918077256944444, 'precision': 0.9942435947232874, 'recall': 0.9720326128175958, 'f1': 0.9827652365814695}
Validation Metrics: {'accuracy': 0.9873280623849237, 'precision': 0.9839683000729336, 'recall': 0.9639907440336242, 'f1': 0.9736687330985883}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1516, 5814), y shape: (1516,), y distribution: Counter({np.float64(0.0): 1370, np.float64(1.0): 146}), env shape: (1516,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8813, Precision: 0.4995, Recall: 0.4998, F1: 0.4896
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12115]))
original train data shape: torch.Size([46262]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1516, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46262]), new train data shape: torch.Size([46262])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12115]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3194, Contrastive Loss: 1.6120
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 1.1003
Epoch 1/30, Step 40/1,Classification Loss: 0.3225, Contrastive Loss: 0.4780
Epoch 1/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.2692
Epoch 1/30, Step 80/1,Classification Loss: 0.3602, Contrastive Loss: 0.2519
Epoch 1/30, Step 100/1,Classification Loss: 0.3429, Contrastive Loss: 0.2133
Epoch 1/30, Step 120/1,Classification Loss: 0.3162, Contrastive Loss: 0.1669
Epoch 1/30, Step 140/1,Classification Loss: 0.3416, Contrastive Loss: 0.1663
Accuracy: 0.9959, Precision: 0.9944, Recall: 0.9889, F1: 0.9916
Accuracy: 0.9920, Precision: 0.9843, Recall: 0.9831, F1: 0.9837
Epoch 1/30
Training - Loss: 115.1148
Training Metrics: {'accuracy': 0.9959309895833334, 'precision': 0.9944037946404544, 'recall': 0.9888931534841086, 'f1': 0.9916256738230971}
Validation Metrics: {'accuracy': 0.9920025937533773, 'precision': 0.9843037747470572, 'recall': 0.9830864728886382, 'f1': 0.9836939831183018}
Epoch 2/30, Step 0/1,Classification Loss: 0.3351, Contrastive Loss: 0.1646
Epoch 2/30, Step 20/1,Classification Loss: 0.3167, Contrastive Loss: 0.1319
Epoch 2/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.1445
Epoch 2/30, Step 60/1,Classification Loss: 0.3161, Contrastive Loss: 0.1278
Epoch 2/30, Step 80/1,Classification Loss: 0.3273, Contrastive Loss: 0.1263
Epoch 2/30, Step 100/1,Classification Loss: 0.3172, Contrastive Loss: 0.1164
Epoch 2/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1232
Epoch 2/30, Step 140/1,Classification Loss: 0.3448, Contrastive Loss: 0.1622
Accuracy: 0.9965, Precision: 0.9950, Recall: 0.9907, F1: 0.9928
Accuracy: 0.9925, Precision: 0.9841, Recall: 0.9856, F1: 0.9848
Epoch 2/30
Training - Loss: 66.4343
Training Metrics: {'accuracy': 0.9965277777777778, 'precision': 0.9949879997896516, 'recall': 0.9907104396577691, 'f1': 0.9928355424262447}
Validation Metrics: {'accuracy': 0.9925429590403112, 'precision': 0.9840809841863504, 'recall': 0.9855998391049854, 'f1': 0.984838637448599}
Epoch 3/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1171
Epoch 3/30, Step 20/1,Classification Loss: 0.3195, Contrastive Loss: 0.1102
Epoch 3/30, Step 40/1,Classification Loss: 0.3165, Contrastive Loss: 0.1070
Epoch 3/30, Step 60/1,Classification Loss: 0.3248, Contrastive Loss: 0.1075
Epoch 3/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.1165
Epoch 3/30, Step 100/1,Classification Loss: 0.3284, Contrastive Loss: 0.1025
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0946
Epoch 3/30, Step 140/1,Classification Loss: 0.3266, Contrastive Loss: 0.0982
Accuracy: 0.9963, Precision: 0.9949, Recall: 0.9897, F1: 0.9923
Accuracy: 0.9923, Precision: 0.9845, Recall: 0.9842, F1: 0.9844
Epoch 3/30
Training - Loss: 62.9354
Training Metrics: {'accuracy': 0.9962836371527778, 'precision': 0.994903673043298, 'recall': 0.9897218419054985, 'f1': 0.9922927241076691}
Validation Metrics: {'accuracy': 0.9923268129255377, 'precision': 0.9845220189250423, 'recall': 0.9842176946080952, 'f1': 0.9843697855459005}
Epoch 4/30, Step 0/1,Classification Loss: 0.3444, Contrastive Loss: 0.1061
Epoch 4/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0927
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0903
Epoch 4/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0899
Epoch 4/30, Step 80/1,Classification Loss: 0.3597, Contrastive Loss: 0.1113
Epoch 4/30, Step 100/1,Classification Loss: 0.3579, Contrastive Loss: 0.1016
Epoch 4/30, Step 120/1,Classification Loss: 0.3176, Contrastive Loss: 0.0846
Epoch 4/30, Step 140/1,Classification Loss: 0.3139, Contrastive Loss: 0.0864
Accuracy: 0.9963, Precision: 0.9946, Recall: 0.9902, F1: 0.9924
Accuracy: 0.9925, Precision: 0.9835, Recall: 0.9862, F1: 0.9849
Epoch 4/30
Training - Loss: 60.7345
Training Metrics: {'accuracy': 0.996337890625, 'precision': 0.9946194503149892, 'recall': 0.9902441605608849, 'f1': 0.9924175127402886}
Validation Metrics: {'accuracy': 0.9925429590403112, 'precision': 0.9834988406446981, 'recall': 0.986227835788904, 'f1': 0.9848576062567793}
Epoch 5/30, Step 0/1,Classification Loss: 0.3292, Contrastive Loss: 0.0895
Epoch 5/30, Step 20/1,Classification Loss: 0.3293, Contrastive Loss: 0.0985
Epoch 5/30, Step 40/1,Classification Loss: 0.3536, Contrastive Loss: 0.0942
Epoch 5/30, Step 60/1,Classification Loss: 0.3255, Contrastive Loss: 0.0829
Epoch 5/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0845
Epoch 5/30, Step 100/1,Classification Loss: 0.3554, Contrastive Loss: 0.0861
Epoch 5/30, Step 120/1,Classification Loss: 0.3444, Contrastive Loss: 0.0847
Epoch 5/30, Step 140/1,Classification Loss: 0.3223, Contrastive Loss: 0.0779
Accuracy: 0.9935, Precision: 0.9932, Recall: 0.9802, F1: 0.9865
Accuracy: 0.9899, Precision: 0.9835, Recall: 0.9753, F1: 0.9794
Epoch 5/30
Training - Loss: 59.2378
Training Metrics: {'accuracy': 0.9935438368055556, 'precision': 0.9931807740059757, 'recall': 0.9801588269171333, 'f1': 0.9865419899334771}
Validation Metrics: {'accuracy': 0.9899492056630282, 'precision': 0.983526234276652, 'recall': 0.9752940719814918, 'f1': 0.9793576870833971}
Epoch 6/30, Step 0/1,Classification Loss: 0.3426, Contrastive Loss: 0.0846
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0721
Epoch 6/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0738
Epoch 6/30, Step 60/1,Classification Loss: 0.3230, Contrastive Loss: 0.0748
Epoch 6/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.0719
Epoch 6/30, Step 100/1,Classification Loss: 0.3188, Contrastive Loss: 0.0707
Epoch 6/30, Step 120/1,Classification Loss: 0.3141, Contrastive Loss: 0.0710
Epoch 6/30, Step 140/1,Classification Loss: 0.3282, Contrastive Loss: 0.0738
Accuracy: 0.9964, Precision: 0.9948, Recall: 0.9905, F1: 0.9926
Accuracy: 0.9921, Precision: 0.9820, Recall: 0.9860, F1: 0.9840
Epoch 6/30
Training - Loss: 57.9162
Training Metrics: {'accuracy': 0.9964192708333334, 'precision': 0.9947569805032168, 'recall': 0.9904723480505778, 'f1': 0.9926009464989967}
Validation Metrics: {'accuracy': 0.9921106668107641, 'precision': 0.9820478659404883, 'recall': 0.9859755335307989, 'f1': 0.9839997924970387}
Epoch 7/30, Step 0/1,Classification Loss: 0.3183, Contrastive Loss: 0.0706
Epoch 7/30, Step 20/1,Classification Loss: 0.3190, Contrastive Loss: 0.0676
Epoch 7/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0650
Epoch 7/30, Step 60/1,Classification Loss: 0.3280, Contrastive Loss: 0.0673
Epoch 7/30, Step 80/1,Classification Loss: 0.3549, Contrastive Loss: 0.0742
Epoch 7/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0635
Epoch 7/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0624
Epoch 7/30, Step 140/1,Classification Loss: 0.3223, Contrastive Loss: 0.0639
Accuracy: 0.9958, Precision: 0.9946, Recall: 0.9882, F1: 0.9914
Accuracy: 0.9917, Precision: 0.9826, Recall: 0.9835, F1: 0.9831
Epoch 7/30
Training - Loss: 56.7898
Training Metrics: {'accuracy': 0.9958224826388888, 'precision': 0.9945573904258513, 'recall': 0.9882106024787416, 'f1': 0.9913538394175904}
Validation Metrics: {'accuracy': 0.9916783745812169, 'precision': 0.9826164115910784, 'recall': 0.983525242878978, 'f1': 0.9830701895393317}
Epoch 8/30, Step 0/1,Classification Loss: 0.3275, Contrastive Loss: 0.0667
Epoch 8/30, Step 20/1,Classification Loss: 0.3158, Contrastive Loss: 0.0606
Epoch 8/30, Step 40/1,Classification Loss: 0.3240, Contrastive Loss: 0.0596
Epoch 8/30, Step 60/1,Classification Loss: 0.3139, Contrastive Loss: 0.0596
Epoch 8/30, Step 80/1,Classification Loss: 0.3229, Contrastive Loss: 0.0594
Epoch 8/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0578
Epoch 8/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0564
Epoch 8/30, Step 140/1,Classification Loss: 0.3284, Contrastive Loss: 0.0580
Accuracy: 0.9960, Precision: 0.9945, Recall: 0.9887, F1: 0.9916
Accuracy: 0.9929, Precision: 0.9864, Recall: 0.9845, F1: 0.9854
Epoch 8/30
Training - Loss: 56.3231
Training Metrics: {'accuracy': 0.9959581163194444, 'precision': 0.9945393606003219, 'recall': 0.988708538392495, 'f1': 0.9915985780623473}
Validation Metrics: {'accuracy': 0.9928671782124716, 'precision': 0.9863673607370822, 'recall': 0.9845330724307267, 'f1': 0.9854476384921349}
Epoch 9/30, Step 0/1,Classification Loss: 0.3325, Contrastive Loss: 0.0602
Epoch 9/30, Step 20/1,Classification Loss: 0.3335, Contrastive Loss: 0.0596
Epoch 9/30, Step 40/1,Classification Loss: 0.3366, Contrastive Loss: 0.0618
Epoch 9/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0526
Epoch 9/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0552
Epoch 9/30, Step 100/1,Classification Loss: 0.3368, Contrastive Loss: 0.0587
Epoch 9/30, Step 120/1,Classification Loss: 0.3291, Contrastive Loss: 0.0560
Epoch 9/30, Step 140/1,Classification Loss: 0.3366, Contrastive Loss: 0.0678
Accuracy: 0.9946, Precision: 0.9939, Recall: 0.9839, F1: 0.9888
Accuracy: 0.9910, Precision: 0.9845, Recall: 0.9788, F1: 0.9816
Epoch 9/30
Training - Loss: 55.2768
Training Metrics: {'accuracy': 0.99462890625, 'precision': 0.9939076234011351, 'recall': 0.9838694816421352, 'f1': 0.9888129643194741}
Validation Metrics: {'accuracy': 0.9910299362368962, 'precision': 0.9845490631001802, 'recall': 0.9787508127043891, 'f1': 0.9816240085894472}
Epoch 10/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0509
Epoch 10/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0526
Epoch 10/30, Step 40/1,Classification Loss: 0.3195, Contrastive Loss: 0.0514
Epoch 10/30, Step 60/1,Classification Loss: 0.3170, Contrastive Loss: 0.0511
Epoch 10/30, Step 80/1,Classification Loss: 0.3543, Contrastive Loss: 0.0546
Epoch 10/30, Step 100/1,Classification Loss: 0.3172, Contrastive Loss: 0.0498
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0474
Epoch 10/30, Step 140/1,Classification Loss: 0.3317, Contrastive Loss: 0.0525
Accuracy: 0.9963, Precision: 0.9947, Recall: 0.9899, F1: 0.9923
Accuracy: 0.9923, Precision: 0.9854, Recall: 0.9833, F1: 0.9843
Epoch 10/30
Training - Loss: 54.5324
Training Metrics: {'accuracy': 0.9962565104166666, 'precision': 0.9946650689288176, 'recall': 0.9899153657088091, 'f1': 0.9922733352374256}
Validation Metrics: {'accuracy': 0.9923268129255377, 'precision': 0.985411821523016, 'recall': 0.9832756995822172, 'f1': 0.984340255592387}
Epoch 11/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0585
Epoch 11/30, Step 20/1,Classification Loss: 0.3442, Contrastive Loss: 0.0561
Epoch 11/30, Step 40/1,Classification Loss: 0.3541, Contrastive Loss: 0.0678
Epoch 11/30, Step 60/1,Classification Loss: 0.3144, Contrastive Loss: 0.0460
Epoch 11/30, Step 80/1,Classification Loss: 0.3309, Contrastive Loss: 0.0679
Epoch 11/30, Step 100/1,Classification Loss: 0.3269, Contrastive Loss: 0.0482
Epoch 11/30, Step 120/1,Classification Loss: 0.3285, Contrastive Loss: 0.0468
Epoch 11/30, Step 140/1,Classification Loss: 0.3369, Contrastive Loss: 0.0496
Accuracy: 0.9963, Precision: 0.9946, Recall: 0.9901, F1: 0.9923
Accuracy: 0.9925, Precision: 0.9832, Recall: 0.9865, F1: 0.9849
Epoch 11/30
Training - Loss: 54.2151
Training Metrics: {'accuracy': 0.9962836371527778, 'precision': 0.9945900328537617, 'recall': 0.9900609136629297, 'f1': 0.9923101479032226}
Validation Metrics: {'accuracy': 0.9925429590403112, 'precision': 0.9832094036750125, 'recall': 0.9865418341308634, 'f1': 0.984867068568458}
Epoch 12/30, Step 0/1,Classification Loss: 0.3236, Contrastive Loss: 0.0462
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0424
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0414
Epoch 12/30, Step 60/1,Classification Loss: 0.3385, Contrastive Loss: 0.0453
Epoch 12/30, Step 80/1,Classification Loss: 0.3137, Contrastive Loss: 0.0420
Epoch 12/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0429
Epoch 12/30, Step 120/1,Classification Loss: 0.3207, Contrastive Loss: 0.0415
Epoch 12/30, Step 140/1,Classification Loss: 0.3136, Contrastive Loss: 0.0410
Accuracy: 0.9961, Precision: 0.9946, Recall: 0.9894, F1: 0.9920
Accuracy: 0.9931, Precision: 0.9856, Recall: 0.9862, F1: 0.9859
Epoch 12/30
Training - Loss: 53.7162
Training Metrics: {'accuracy': 0.9961208767361112, 'precision': 0.9945670881194661, 'recall': 0.9893936675522746, 'f1': 0.9919603857961039}
Validation Metrics: {'accuracy': 0.9930833243272452, 'precision': 0.9856194652426742, 'recall': 0.9862292152695762, 'f1': 0.9859240552351147}
Epoch 13/30, Step 0/1,Classification Loss: 0.3303, Contrastive Loss: 0.0425
Epoch 13/30, Step 20/1,Classification Loss: 0.3284, Contrastive Loss: 0.0433
Epoch 13/30, Step 40/1,Classification Loss: 0.3286, Contrastive Loss: 0.0414
Epoch 13/30, Step 60/1,Classification Loss: 0.3191, Contrastive Loss: 0.0394
Epoch 13/30, Step 80/1,Classification Loss: 0.3283, Contrastive Loss: 0.0406
Epoch 13/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0410
Epoch 13/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0380
Epoch 13/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Accuracy: 0.9970, Precision: 0.9952, Recall: 0.9923, F1: 0.9937
Accuracy: 0.9927, Precision: 0.9819, Recall: 0.9885, F1: 0.9851
Epoch 13/30
Training - Loss: 53.3451
Training Metrics: {'accuracy': 0.9969618055555556, 'precision': 0.995173634925728, 'recall': 0.9923248106238042, 'f1': 0.9937431617962766}
Validation Metrics: {'accuracy': 0.992651032097698, 'precision': 0.9818538298826758, 'recall': 0.9884888997471459, 'f1': 0.9851374170752513}
Epoch 14/30, Step 0/1,Classification Loss: 0.3228, Contrastive Loss: 0.0391
Epoch 14/30, Step 20/1,Classification Loss: 0.3291, Contrastive Loss: 0.0385
Epoch 14/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0519
Epoch 14/30, Step 60/1,Classification Loss: 0.3238, Contrastive Loss: 0.0401
Epoch 14/30, Step 80/1,Classification Loss: 0.3187, Contrastive Loss: 0.0369
Epoch 14/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0356
Epoch 14/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0421
Epoch 14/30, Step 140/1,Classification Loss: 0.3221, Contrastive Loss: 0.0349
Accuracy: 0.9968, Precision: 0.9951, Recall: 0.9916, F1: 0.9933
Accuracy: 0.9931, Precision: 0.9842, Recall: 0.9878, F1: 0.9860
Epoch 14/30
Training - Loss: 52.4640
Training Metrics: {'accuracy': 0.9967990451388888, 'precision': 0.9951195155078928, 'recall': 0.9915931008073042, 'f1': 0.9933470653459064}
Validation Metrics: {'accuracy': 0.9930833243272452, 'precision': 0.9841572500040131, 'recall': 0.9877992069793731, 'f1': 0.9859680410115961}
Epoch 15/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0512
Epoch 15/30, Step 20/1,Classification Loss: 0.3257, Contrastive Loss: 0.0382
Epoch 15/30, Step 40/1,Classification Loss: 0.3321, Contrastive Loss: 0.0394
Epoch 15/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0327
Epoch 15/30, Step 80/1,Classification Loss: 0.3512, Contrastive Loss: 0.0471
Epoch 15/30, Step 100/1,Classification Loss: 0.3391, Contrastive Loss: 0.0393
Epoch 15/30, Step 120/1,Classification Loss: 0.3464, Contrastive Loss: 0.0399
Epoch 15/30, Step 140/1,Classification Loss: 0.3329, Contrastive Loss: 0.0380
Accuracy: 0.9967, Precision: 0.9949, Recall: 0.9914, F1: 0.9932
Accuracy: 0.9925, Precision: 0.9841, Recall: 0.9856, F1: 0.9848
Epoch 15/30
Training - Loss: 52.2449
Training Metrics: {'accuracy': 0.9966905381944444, 'precision': 0.9949229680263558, 'recall': 0.9914335778640828, 'f1': 0.9931691804272893}
Validation Metrics: {'accuracy': 0.9925429590403112, 'precision': 0.9840809841863504, 'recall': 0.9855998391049854, 'f1': 0.984838637448599}
Epoch 16/30, Step 0/1,Classification Loss: 0.3343, Contrastive Loss: 0.0348
Epoch 16/30, Step 20/1,Classification Loss: 0.3343, Contrastive Loss: 0.0390
Epoch 16/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Epoch 16/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0306
Epoch 16/30, Step 80/1,Classification Loss: 0.3142, Contrastive Loss: 0.0320
Epoch 16/30, Step 100/1,Classification Loss: 0.3397, Contrastive Loss: 0.0524
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0293
Epoch 16/30, Step 140/1,Classification Loss: 0.3176, Contrastive Loss: 0.0308
Accuracy: 0.9966, Precision: 0.9950, Recall: 0.9909, F1: 0.9930
Accuracy: 0.9923, Precision: 0.9842, Recall: 0.9845, F1: 0.9844
Epoch 16/30
Training - Loss: 51.9870
Training Metrics: {'accuracy': 0.99658203125, 'precision': 0.995028586422309, 'recall': 0.9909210323606699, 'f1': 0.9929621849382493}
Validation Metrics: {'accuracy': 0.9923268129255377, 'precision': 0.984227645662088, 'recall': 0.9845316929500546, 'f1': 0.9843795981878267}
Epoch 17/30, Step 0/1,Classification Loss: 0.3199, Contrastive Loss: 0.0345
Epoch 17/30, Step 20/1,Classification Loss: 0.3243, Contrastive Loss: 0.0322
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0281
Epoch 17/30, Step 60/1,Classification Loss: 0.3138, Contrastive Loss: 0.0292
Epoch 17/30, Step 80/1,Classification Loss: 0.3478, Contrastive Loss: 0.0354
Epoch 17/30, Step 100/1,Classification Loss: 0.3449, Contrastive Loss: 0.0492
Epoch 17/30, Step 120/1,Classification Loss: 0.3221, Contrastive Loss: 0.0292
Epoch 17/30, Step 140/1,Classification Loss: 0.3292, Contrastive Loss: 0.0371
Accuracy: 0.9966, Precision: 0.9954, Recall: 0.9904, F1: 0.9929
Accuracy: 0.9922, Precision: 0.9847, Recall: 0.9835, F1: 0.9841
Epoch 17/30
Training - Loss: 51.6952
Training Metrics: {'accuracy': 0.9965549045138888, 'precision': 0.9954120175146561, 'recall': 0.9904343085013356, 'f1': 0.9929046237904888}
Validation Metrics: {'accuracy': 0.9922187398681509, 'precision': 0.9847450333254425, 'recall': 0.9835266223596502, 'f1': 0.9841346862772666}
Epoch 18/30, Step 0/1,Classification Loss: 0.3554, Contrastive Loss: 0.0367
Epoch 18/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0274
Epoch 18/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0283
Epoch 18/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0288
Epoch 18/30, Step 80/1,Classification Loss: 0.3142, Contrastive Loss: 0.0270
Epoch 18/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0338
Epoch 18/30, Step 120/1,Classification Loss: 0.3353, Contrastive Loss: 0.0338
Epoch 18/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0249
Accuracy: 0.9964, Precision: 0.9950, Recall: 0.9902, F1: 0.9926
Accuracy: 0.9920, Precision: 0.9849, Recall: 0.9825, F1: 0.9837
Epoch 18/30
Training - Loss: 51.4718
Training Metrics: {'accuracy': 0.9963921440972222, 'precision': 0.9949955999692135, 'recall': 0.9901803288969226, 'f1': 0.9925705999817936}
Validation Metrics: {'accuracy': 0.9920025937533773, 'precision': 0.9848975410032004, 'recall': 0.9824584762047195, 'f1': 0.9836734325997432}
Epoch 19/30, Step 0/1,Classification Loss: 0.3352, Contrastive Loss: 0.0281
Epoch 19/30, Step 20/1,Classification Loss: 0.3295, Contrastive Loss: 0.0291
Epoch 19/30, Step 40/1,Classification Loss: 0.3230, Contrastive Loss: 0.0271
Epoch 19/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0421
Epoch 19/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0359
Epoch 19/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0252
Epoch 19/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0275
Epoch 19/30, Step 140/1,Classification Loss: 0.3446, Contrastive Loss: 0.0409
Accuracy: 0.9965, Precision: 0.9949, Recall: 0.9907, F1: 0.9928
Accuracy: 0.9929, Precision: 0.9858, Recall: 0.9852, F1: 0.9855
Epoch 19/30
Training - Loss: 51.0306
Training Metrics: {'accuracy': 0.9965006510416666, 'precision': 0.9948986391694725, 'recall': 0.9907110672225486, 'f1': 0.992791730123359}
Validation Metrics: {'accuracy': 0.9928671782124716, 'precision': 0.9857713796042598, 'recall': 0.9851610691146455, 'f1': 0.9854659387316033}
Epoch 20/30, Step 0/1,Classification Loss: 0.3149, Contrastive Loss: 0.0283
Epoch 20/30, Step 20/1,Classification Loss: 0.3217, Contrastive Loss: 0.0256
Epoch 20/30, Step 40/1,Classification Loss: 0.3160, Contrastive Loss: 0.0261
Epoch 20/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0243
Epoch 20/30, Step 80/1,Classification Loss: 0.3531, Contrastive Loss: 0.0363
Epoch 20/30, Step 100/1,Classification Loss: 0.3372, Contrastive Loss: 0.0291
Epoch 20/30, Step 120/1,Classification Loss: 0.3233, Contrastive Loss: 0.0271
Epoch 20/30, Step 140/1,Classification Loss: 0.3414, Contrastive Loss: 0.0351
Accuracy: 0.9965, Precision: 0.9946, Recall: 0.9908, F1: 0.9927
Accuracy: 0.9923, Precision: 0.9848, Recall: 0.9839, F1: 0.9844
Epoch 20/30
Training - Loss: 50.9680
Training Metrics: {'accuracy': 0.9964735243055556, 'precision': 0.9945986756030469, 'recall': 0.9907524124494111, 'f1': 0.9926645363812864}
Validation Metrics: {'accuracy': 0.9923268129255377, 'precision': 0.9848175027331936, 'recall': 0.9839036962661358, 'f1': 0.9843599575890534}
Epoch 21/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0238
Epoch 21/30, Step 20/1,Classification Loss: 0.3233, Contrastive Loss: 0.0259
Epoch 21/30, Step 40/1,Classification Loss: 0.3227, Contrastive Loss: 0.0249
Epoch 21/30, Step 60/1,Classification Loss: 0.3222, Contrastive Loss: 0.0233
Epoch 21/30, Step 80/1,Classification Loss: 0.3273, Contrastive Loss: 0.0240
Epoch 21/30, Step 100/1,Classification Loss: 0.3205, Contrastive Loss: 0.0234
Epoch 21/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 21/30, Step 140/1,Classification Loss: 0.3171, Contrastive Loss: 0.0224
Accuracy: 0.9958, Precision: 0.9946, Recall: 0.9881, F1: 0.9914
Accuracy: 0.9921, Precision: 0.9865, Recall: 0.9813, F1: 0.9838
Epoch 21/30
Training - Loss: 50.7818
Training Metrics: {'accuracy': 0.995849609375, 'precision': 0.9946314146853754, 'recall': 0.9881492544410126, 'f1': 0.9913589922927761}
Validation Metrics: {'accuracy': 0.9921106668107641, 'precision': 0.9864724865502367, 'recall': 0.9812655584014083, 'f1': 0.9838482155165396}
Epoch 22/30, Step 0/1,Classification Loss: 0.3140, Contrastive Loss: 0.0232
Epoch 22/30, Step 20/1,Classification Loss: 0.3229, Contrastive Loss: 0.0229
Epoch 22/30, Step 40/1,Classification Loss: 0.3248, Contrastive Loss: 0.0228
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 22/30, Step 100/1,Classification Loss: 0.3299, Contrastive Loss: 0.0247
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 22/30, Step 140/1,Classification Loss: 0.3172, Contrastive Loss: 0.0214
Accuracy: 0.9968, Precision: 0.9950, Recall: 0.9918, F1: 0.9934
Accuracy: 0.9932, Precision: 0.9848, Recall: 0.9875, F1: 0.9862
Epoch 22/30
Training - Loss: 50.5671
Training Metrics: {'accuracy': 0.9967719184027778, 'precision': 0.9949996292882113, 'recall': 0.9917784267573581, 'f1': 0.993381250952315}
Validation Metrics: {'accuracy': 0.993191397384632, 'precision': 0.9848118779285429, 'recall': 0.98754828420194, 'f1': 0.9861743361474943}
Epoch 23/30, Step 0/1,Classification Loss: 0.3381, Contrastive Loss: 0.0287
Epoch 23/30, Step 20/1,Classification Loss: 0.3143, Contrastive Loss: 0.0231
Epoch 23/30, Step 40/1,Classification Loss: 0.3181, Contrastive Loss: 0.0218
Epoch 23/30, Step 60/1,Classification Loss: 0.3158, Contrastive Loss: 0.0228
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 23/30, Step 100/1,Classification Loss: 0.3573, Contrastive Loss: 0.0367
Epoch 23/30, Step 120/1,Classification Loss: 0.3162, Contrastive Loss: 0.0228
Epoch 23/30, Step 140/1,Classification Loss: 0.3217, Contrastive Loss: 0.0233
Accuracy: 0.9968, Precision: 0.9952, Recall: 0.9915, F1: 0.9933
Accuracy: 0.9929, Precision: 0.9849, Recall: 0.9861, F1: 0.9855
Epoch 23/30
Training - Loss: 50.3388
Training Metrics: {'accuracy': 0.9967719184027778, 'precision': 0.9951988315236047, 'recall': 0.9914522783600265, 'f1': 0.9933150979375038}
Validation Metrics: {'accuracy': 0.9928671782124716, 'precision': 0.9848857755900543, 'recall': 0.9861030641405235, 'f1': 0.9854932822773745}
Epoch 24/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0230
Epoch 24/30, Step 20/1,Classification Loss: 0.3364, Contrastive Loss: 0.0275
Epoch 24/30, Step 40/1,Classification Loss: 0.3235, Contrastive Loss: 0.0228
Epoch 24/30, Step 60/1,Classification Loss: 0.3258, Contrastive Loss: 0.0223
Epoch 24/30, Step 80/1,Classification Loss: 0.3140, Contrastive Loss: 0.0201
Epoch 24/30, Step 100/1,Classification Loss: 0.3224, Contrastive Loss: 0.0209
Epoch 24/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0207
Epoch 24/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Accuracy: 0.9969, Precision: 0.9954, Recall: 0.9916, F1: 0.9935
Accuracy: 0.9925, Precision: 0.9838, Recall: 0.9859, F1: 0.9848
Epoch 24/30
Training - Loss: 50.5284
Training Metrics: {'accuracy': 0.9968532986111112, 'precision': 0.9954128117116927, 'recall': 0.9915919675249503, 'f1': 0.9934915101684652}
Validation Metrics: {'accuracy': 0.9925429590403112, 'precision': 0.9837893659020815, 'recall': 0.9859138374469447, 'f1': 0.9848481292278435}
Epoch 25/30, Step 0/1,Classification Loss: 0.3285, Contrastive Loss: 0.0203
Epoch 25/30, Step 20/1,Classification Loss: 0.3439, Contrastive Loss: 0.0249
Epoch 25/30, Step 40/1,Classification Loss: 0.3251, Contrastive Loss: 0.0214
Epoch 25/30, Step 60/1,Classification Loss: 0.3179, Contrastive Loss: 0.0196
Epoch 25/30, Step 80/1,Classification Loss: 0.3178, Contrastive Loss: 0.0202
Epoch 25/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0208
Epoch 25/30, Step 120/1,Classification Loss: 0.3439, Contrastive Loss: 0.0241
Epoch 25/30, Step 140/1,Classification Loss: 0.3185, Contrastive Loss: 0.0200
Accuracy: 0.9966, Precision: 0.9951, Recall: 0.9907, F1: 0.9929
Accuracy: 0.9924, Precision: 0.9849, Recall: 0.9843, F1: 0.9846
Epoch 25/30
Training - Loss: 50.4200
Training Metrics: {'accuracy': 0.9965549045138888, 'precision': 0.995077108409715, 'recall': 0.990708084171283, 'f1': 0.9928783457213279}
Validation Metrics: {'accuracy': 0.9924348859829245, 'precision': 0.9848899732863301, 'recall': 0.9842807701726215, 'f1': 0.9845850865335186}
Epoch 26/30, Step 0/1,Classification Loss: 0.3471, Contrastive Loss: 0.0268
Epoch 26/30, Step 20/1,Classification Loss: 0.3275, Contrastive Loss: 0.0221
Epoch 26/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0205
Epoch 26/30, Step 60/1,Classification Loss: 0.3293, Contrastive Loss: 0.0211
Epoch 26/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0193
Epoch 26/30, Step 100/1,Classification Loss: 0.3569, Contrastive Loss: 0.0387
Epoch 26/30, Step 120/1,Classification Loss: 0.3245, Contrastive Loss: 0.0218
Epoch 26/30, Step 140/1,Classification Loss: 0.3556, Contrastive Loss: 0.0267
Accuracy: 0.9960, Precision: 0.9948, Recall: 0.9884, F1: 0.9916
Accuracy: 0.9910, Precision: 0.9839, Recall: 0.9794, F1: 0.9816
Epoch 26/30
Training - Loss: 50.1205
Training Metrics: {'accuracy': 0.9959581163194444, 'precision': 0.9947729099463523, 'recall': 0.9884374854516573, 'f1': 0.9915752943640911}
Validation Metrics: {'accuracy': 0.9910299362368962, 'precision': 0.9839479341165478, 'recall': 0.9793788093883078, 'f1': 0.9816472577801092}
Epoch 27/30, Step 0/1,Classification Loss: 0.3172, Contrastive Loss: 0.0206
Epoch 27/30, Step 20/1,Classification Loss: 0.3366, Contrastive Loss: 0.0234
Epoch 27/30, Step 40/1,Classification Loss: 0.3331, Contrastive Loss: 0.0215
Epoch 27/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 27/30, Step 80/1,Classification Loss: 0.3415, Contrastive Loss: 0.0251
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 27/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0246
Epoch 27/30, Step 140/1,Classification Loss: 0.3294, Contrastive Loss: 0.0205
Accuracy: 0.9965, Precision: 0.9951, Recall: 0.9905, F1: 0.9928
Accuracy: 0.9918, Precision: 0.9836, Recall: 0.9830, F1: 0.9833
Epoch 27/30
Training - Loss: 50.0531
Training Metrics: {'accuracy': 0.9965277777777778, 'precision': 0.9951442771724655, 'recall': 0.990542303374808, 'f1': 0.9928274706037217}
Validation Metrics: {'accuracy': 0.9917864476386037, 'precision': 0.9835678638094356, 'recall': 0.9829603217595857, 'f1': 0.9832638082363916}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0193
Epoch 28/30, Step 40/1,Classification Loss: 0.3390, Contrastive Loss: 0.0231
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 28/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0189
Epoch 28/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0242
Epoch 28/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0181
Epoch 28/30, Step 140/1,Classification Loss: 0.3444, Contrastive Loss: 0.0228
Accuracy: 0.9966, Precision: 0.9951, Recall: 0.9907, F1: 0.9929
Accuracy: 0.9921, Precision: 0.9847, Recall: 0.9831, F1: 0.9839
Epoch 28/30
Training - Loss: 49.8953
Training Metrics: {'accuracy': 0.9965549045138888, 'precision': 0.995076477768193, 'recall': 0.9907064294364719, 'f1': 0.9928771977401818}
Validation Metrics: {'accuracy': 0.9921106668107641, 'precision': 0.9846725650237464, 'recall': 0.9831495484531645, 'f1': 0.9839092724315692}
Epoch 29/30, Step 0/1,Classification Loss: 0.3349, Contrastive Loss: 0.0229
Epoch 29/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0331
Epoch 29/30, Step 40/1,Classification Loss: 0.3256, Contrastive Loss: 0.0203
Epoch 29/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0187
Epoch 29/30, Step 80/1,Classification Loss: 0.3322, Contrastive Loss: 0.0220
Epoch 29/30, Step 100/1,Classification Loss: 0.3331, Contrastive Loss: 0.0193
Epoch 29/30, Step 120/1,Classification Loss: 0.3165, Contrastive Loss: 0.0196
Epoch 29/30, Step 140/1,Classification Loss: 0.3234, Contrastive Loss: 0.0191
Accuracy: 0.9969, Precision: 0.9950, Recall: 0.9921, F1: 0.9936
Accuracy: 0.9924, Precision: 0.9840, Recall: 0.9852, F1: 0.9846
Epoch 29/30
Training - Loss: 50.0502
Training Metrics: {'accuracy': 0.9968804253472222, 'precision': 0.9950485318736708, 'recall': 0.992124642422658, 'f1': 0.9935801972247622}
Validation Metrics: {'accuracy': 0.9924348859829245, 'precision': 0.9840076810731866, 'recall': 0.9852227651984997, 'f1': 0.984614087263882}
Epoch 30/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0180
Epoch 30/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0187
Epoch 30/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0183
Epoch 30/30, Step 60/1,Classification Loss: 0.3195, Contrastive Loss: 0.0211
Epoch 30/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0265
Epoch 30/30, Step 100/1,Classification Loss: 0.3447, Contrastive Loss: 0.0251
Epoch 30/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0181
Epoch 30/30, Step 140/1,Classification Loss: 0.3139, Contrastive Loss: 0.0179
Accuracy: 0.9964, Precision: 0.9950, Recall: 0.9901, F1: 0.9925
Accuracy: 0.9919, Precision: 0.9851, Recall: 0.9818, F1: 0.9834
Epoch 30/30
Training - Loss: 49.8891
Training Metrics: {'accuracy': 0.9963650173611112, 'precision': 0.994967962286927, 'recall': 0.990053091461979, 'f1': 0.9924924668975728}
Validation Metrics: {'accuracy': 0.9918945206959905, 'precision': 0.985124208816043, 'recall': 0.9817674039562745, 'f1': 0.9834371393524953}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1537, 5814), y shape: (1537,), y distribution: Counter({np.float64(0.0): 1396, np.float64(1.0): 141}), env shape: (1537,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8979, Precision: 0.5042, Recall: 0.5006, F1: 0.4855
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12215]))
original train data shape: torch.Size([46362]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1537, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46362]), new train data shape: torch.Size([46362])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12215]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3145, Contrastive Loss: 1.5621
Epoch 1/30, Step 20/1,Classification Loss: 0.3314, Contrastive Loss: 0.7894
Epoch 1/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.3309
Epoch 1/30, Step 60/1,Classification Loss: 0.3334, Contrastive Loss: 0.2275
Epoch 1/30, Step 80/1,Classification Loss: 0.3207, Contrastive Loss: 0.1786
Epoch 1/30, Step 100/1,Classification Loss: 0.3329, Contrastive Loss: 0.2027
Epoch 1/30, Step 120/1,Classification Loss: 0.3415, Contrastive Loss: 0.1662
Epoch 1/30, Step 140/1,Classification Loss: 0.3431, Contrastive Loss: 0.1559
Accuracy: 0.9962, Precision: 0.9943, Recall: 0.9902, F1: 0.9922
Accuracy: 0.9940, Precision: 0.9880, Recall: 0.9874, F1: 0.9877
Epoch 1/30
Training - Loss: 102.0320
Training Metrics: {'accuracy': 0.9962293836805556, 'precision': 0.9943382239931342, 'recall': 0.9901563766208281, 'f1': 0.992234194542346}
Validation Metrics: {'accuracy': 0.9939609619324922, 'precision': 0.9879869624255776, 'recall': 0.9873741291775248, 'f1': 0.9876802595475569}
Epoch 2/30, Step 0/1,Classification Loss: 0.3178, Contrastive Loss: 0.1373
Epoch 2/30, Step 20/1,Classification Loss: 0.3185, Contrastive Loss: 0.1308
Epoch 2/30, Step 40/1,Classification Loss: 0.3292, Contrastive Loss: 0.1349
Epoch 2/30, Step 60/1,Classification Loss: 0.3285, Contrastive Loss: 0.1288
Epoch 2/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.1273
Epoch 2/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.1158
Epoch 2/30, Step 120/1,Classification Loss: 0.3181, Contrastive Loss: 0.1165
Epoch 2/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.1136
Accuracy: 0.9967, Precision: 0.9969, Recall: 0.9894, F1: 0.9931
Accuracy: 0.9933, Precision: 0.9882, Recall: 0.9845, F1: 0.9863
Epoch 2/30
Training - Loss: 65.4494
Training Metrics: {'accuracy': 0.9966905381944444, 'precision': 0.9969287048817849, 'recall': 0.9893943133672796, 'f1': 0.9931193064366244}
Validation Metrics: {'accuracy': 0.993313922139545, 'precision': 0.9881695918782735, 'recall': 0.9844856606509917, 'f1': 0.9863172696283682}
Epoch 3/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.1144
Epoch 3/30, Step 20/1,Classification Loss: 0.3221, Contrastive Loss: 0.1080
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1016
Epoch 3/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.1143
Epoch 3/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0989
Epoch 3/30, Step 100/1,Classification Loss: 0.3443, Contrastive Loss: 0.1169
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0939
Epoch 3/30, Step 140/1,Classification Loss: 0.3415, Contrastive Loss: 0.1033
Accuracy: 0.9965, Precision: 0.9961, Recall: 0.9893, F1: 0.9927
Accuracy: 0.9932, Precision: 0.9869, Recall: 0.9854, F1: 0.9861
Epoch 3/30
Training - Loss: 62.5780
Training Metrics: {'accuracy': 0.9964735243055556, 'precision': 0.9961475200408803, 'recall': 0.9892640132615416, 'f1': 0.9926704957200664}
Validation Metrics: {'accuracy': 0.9932060821740537, 'precision': 0.9868936742083841, 'recall': 0.9853643309369138, 'f1': 0.9861272143272828}
Epoch 4/30, Step 0/1,Classification Loss: 0.3282, Contrastive Loss: 0.0957
Epoch 4/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0903
Epoch 4/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0965
Epoch 4/30, Step 60/1,Classification Loss: 0.3255, Contrastive Loss: 0.0933
Epoch 4/30, Step 80/1,Classification Loss: 0.3502, Contrastive Loss: 0.0976
Epoch 4/30, Step 100/1,Classification Loss: 0.3396, Contrastive Loss: 0.0931
Epoch 4/30, Step 120/1,Classification Loss: 0.3403, Contrastive Loss: 0.0905
Epoch 4/30, Step 140/1,Classification Loss: 0.3292, Contrastive Loss: 0.0866
Accuracy: 0.9965, Precision: 0.9965, Recall: 0.9891, F1: 0.9927
Accuracy: 0.9929, Precision: 0.9885, Recall: 0.9824, F1: 0.9854
Epoch 4/30
Training - Loss: 60.5237
Training Metrics: {'accuracy': 0.9965006510416666, 'precision': 0.9964929602478863, 'recall': 0.9890630845731565, 'f1': 0.992736902356063}
Validation Metrics: {'accuracy': 0.9928825622775801, 'precision': 0.9885022535523489, 'recall': 0.9823507716270963, 'f1': 0.9853976197102285}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0801
Epoch 5/30, Step 20/1,Classification Loss: 0.3187, Contrastive Loss: 0.0816
Epoch 5/30, Step 40/1,Classification Loss: 0.3303, Contrastive Loss: 0.0840
Epoch 5/30, Step 60/1,Classification Loss: 0.3287, Contrastive Loss: 0.0821
Epoch 5/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0816
Epoch 5/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0755
Epoch 5/30, Step 120/1,Classification Loss: 0.3182, Contrastive Loss: 0.0760
Epoch 5/30, Step 140/1,Classification Loss: 0.3351, Contrastive Loss: 0.0798
Accuracy: 0.9963, Precision: 0.9941, Recall: 0.9905, F1: 0.9923
Accuracy: 0.9929, Precision: 0.9858, Recall: 0.9852, F1: 0.9855
Epoch 5/30
Training - Loss: 58.9516
Training Metrics: {'accuracy': 0.9962565104166666, 'precision': 0.9941177208918378, 'recall': 0.9904907724146235, 'f1': 0.9922943860459831}
Validation Metrics: {'accuracy': 0.9928825622775801, 'precision': 0.9857856254332407, 'recall': 0.9851755567108882, 'f1': 0.9854803058953349}
Epoch 6/30, Step 0/1,Classification Loss: 0.3234, Contrastive Loss: 0.0733
Epoch 6/30, Step 20/1,Classification Loss: 0.3211, Contrastive Loss: 0.0730
Epoch 6/30, Step 40/1,Classification Loss: 0.3429, Contrastive Loss: 0.0744
Epoch 6/30, Step 60/1,Classification Loss: 0.3284, Contrastive Loss: 0.0720
Epoch 6/30, Step 80/1,Classification Loss: 0.3205, Contrastive Loss: 0.0706
Epoch 6/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0720
Epoch 6/30, Step 120/1,Classification Loss: 0.3275, Contrastive Loss: 0.0721
Epoch 6/30, Step 140/1,Classification Loss: 0.3186, Contrastive Loss: 0.0696
Accuracy: 0.9966, Precision: 0.9967, Recall: 0.9893, F1: 0.9930
Accuracy: 0.9934, Precision: 0.9876, Recall: 0.9855, F1: 0.9866
Epoch 6/30
Training - Loss: 57.7783
Training Metrics: {'accuracy': 0.9966362847222222, 'precision': 0.9967300629535257, 'recall': 0.9893368088422445, 'f1': 0.9929928357732736}
Validation Metrics: {'accuracy': 0.9934217621050361, 'precision': 0.9876351691185716, 'recall': 0.985490180420931, 'f1': 0.9865591620774442}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0655
Epoch 7/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0657
Epoch 7/30, Step 40/1,Classification Loss: 0.3295, Contrastive Loss: 0.0709
Epoch 7/30, Step 60/1,Classification Loss: 0.3345, Contrastive Loss: 0.0724
Epoch 7/30, Step 80/1,Classification Loss: 0.3401, Contrastive Loss: 0.0666
Epoch 7/30, Step 100/1,Classification Loss: 0.3348, Contrastive Loss: 0.0701
Epoch 7/30, Step 120/1,Classification Loss: 0.3215, Contrastive Loss: 0.0627
Epoch 7/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0787
Accuracy: 0.9963, Precision: 0.9943, Recall: 0.9903, F1: 0.9923
Accuracy: 0.9931, Precision: 0.9862, Recall: 0.9856, F1: 0.9859
Epoch 7/30
Training - Loss: 57.0526
Training Metrics: {'accuracy': 0.9962565104166666, 'precision': 0.9942586425945382, 'recall': 0.9902941171909408, 'f1': 0.9922646258853147}
Validation Metrics: {'accuracy': 0.9930982422085625, 'precision': 0.986225892831708, 'recall': 0.9856152712042154, 'f1': 0.9859202966257792}
Epoch 8/30, Step 0/1,Classification Loss: 0.3336, Contrastive Loss: 0.0634
Epoch 8/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0590
Epoch 8/30, Step 40/1,Classification Loss: 0.3149, Contrastive Loss: 0.0592
Epoch 8/30, Step 60/1,Classification Loss: 0.3299, Contrastive Loss: 0.0626
Epoch 8/30, Step 80/1,Classification Loss: 0.3231, Contrastive Loss: 0.0587
Epoch 8/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0578
Epoch 8/30, Step 120/1,Classification Loss: 0.3253, Contrastive Loss: 0.0569
Epoch 8/30, Step 140/1,Classification Loss: 0.3507, Contrastive Loss: 0.0885
Accuracy: 0.9964, Precision: 0.9949, Recall: 0.9904, F1: 0.9926
Accuracy: 0.9935, Precision: 0.9853, Recall: 0.9884, F1: 0.9868
Epoch 8/30
Training - Loss: 55.8114
Training Metrics: {'accuracy': 0.9964192708333334, 'precision': 0.9948565632867867, 'recall': 0.9904432457786116, 'f1': 0.9926353091940947}
Validation Metrics: {'accuracy': 0.9935296020705273, 'precision': 0.9853358939579463, 'recall': 0.9883778902467313, 'f1': 0.9868498078736084}
Epoch 9/30, Step 0/1,Classification Loss: 0.3295, Contrastive Loss: 0.0781
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0543
Epoch 9/30, Step 40/1,Classification Loss: 0.3441, Contrastive Loss: 0.0616
Epoch 9/30, Step 60/1,Classification Loss: 0.3175, Contrastive Loss: 0.0541
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0523
Epoch 9/30, Step 100/1,Classification Loss: 0.3405, Contrastive Loss: 0.0563
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0494
Epoch 9/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0500
Accuracy: 0.9956, Precision: 0.9962, Recall: 0.9857, F1: 0.9909
Accuracy: 0.9922, Precision: 0.9881, Recall: 0.9801, F1: 0.9840
Epoch 9/30
Training - Loss: 55.2129
Training Metrics: {'accuracy': 0.99560546875, 'precision': 0.9962109198495763, 'recall': 0.985658277281054, 'f1': 0.9908514426564832}
Validation Metrics: {'accuracy': 0.9922355224846328, 'precision': 0.9880873892597959, 'recall': 0.9800900331191837, 'f1': 0.9840397792109217}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0485
Epoch 10/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0490
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0485
Epoch 10/30, Step 60/1,Classification Loss: 0.3203, Contrastive Loss: 0.0495
Epoch 10/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0511
Epoch 10/30, Step 100/1,Classification Loss: 0.3283, Contrastive Loss: 0.0513
Epoch 10/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0496
Epoch 10/30, Step 140/1,Classification Loss: 0.3176, Contrastive Loss: 0.0460
Accuracy: 0.9963, Precision: 0.9946, Recall: 0.9901, F1: 0.9923
Accuracy: 0.9932, Precision: 0.9866, Recall: 0.9857, F1: 0.9861
Epoch 10/30
Training - Loss: 54.4704
Training Metrics: {'accuracy': 0.9962836371527778, 'precision': 0.9946040675011341, 'recall': 0.9900960990896943, 'f1': 0.9923348711775071}
Validation Metrics: {'accuracy': 0.9932060821740537, 'precision': 0.9865949620674701, 'recall': 0.9856781959462241, 'f1': 0.986135936168241}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0461
Epoch 11/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0607
Epoch 11/30, Step 40/1,Classification Loss: 0.3169, Contrastive Loss: 0.0464
Epoch 11/30, Step 60/1,Classification Loss: 0.3300, Contrastive Loss: 0.0482
Epoch 11/30, Step 80/1,Classification Loss: 0.3460, Contrastive Loss: 0.0497
Epoch 11/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0437
Epoch 11/30, Step 120/1,Classification Loss: 0.3326, Contrastive Loss: 0.0494
Epoch 11/30, Step 140/1,Classification Loss: 0.3431, Contrastive Loss: 0.0547
Accuracy: 0.9966, Precision: 0.9966, Recall: 0.9894, F1: 0.9930
Accuracy: 0.9928, Precision: 0.9866, Recall: 0.9839, F1: 0.9852
Epoch 11/30
Training - Loss: 54.1824
Training Metrics: {'accuracy': 0.9966362847222222, 'precision': 0.996644915228986, 'recall': 0.9893936038702225, 'f1': 0.992980244775928}
Validation Metrics: {'accuracy': 0.9927747223120889, 'precision': 0.9866100476027426, 'recall': 0.9838571719316387, 'f1': 0.9852278078360327}
Epoch 12/30, Step 0/1,Classification Loss: 0.3344, Contrastive Loss: 0.0469
Epoch 12/30, Step 20/1,Classification Loss: 0.3742, Contrastive Loss: 0.0533
Epoch 12/30, Step 40/1,Classification Loss: 0.3346, Contrastive Loss: 0.0602
Epoch 12/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0448
Epoch 12/30, Step 80/1,Classification Loss: 0.3284, Contrastive Loss: 0.0424
Epoch 12/30, Step 100/1,Classification Loss: 0.3281, Contrastive Loss: 0.0426
Epoch 12/30, Step 120/1,Classification Loss: 0.3534, Contrastive Loss: 0.0455
Epoch 12/30, Step 140/1,Classification Loss: 0.3528, Contrastive Loss: 0.0454
Accuracy: 0.9963, Precision: 0.9967, Recall: 0.9880, F1: 0.9923
Accuracy: 0.9931, Precision: 0.9893, Recall: 0.9825, F1: 0.9858
Epoch 12/30
Training - Loss: 53.4810
Training Metrics: {'accuracy': 0.9962836371527778, 'precision': 0.996697493086722, 'recall': 0.9880397746605536, 'f1': 0.992312629090188}
Validation Metrics: {'accuracy': 0.9930982422085625, 'precision': 0.989255729815815, 'recall': 0.9824766211111133, 'f1': 0.9858311371952513}
Epoch 13/30, Step 0/1,Classification Loss: 0.3179, Contrastive Loss: 0.0400
Epoch 13/30, Step 20/1,Classification Loss: 0.3218, Contrastive Loss: 0.0422
Epoch 13/30, Step 40/1,Classification Loss: 0.3278, Contrastive Loss: 0.0411
Epoch 13/30, Step 60/1,Classification Loss: 0.3195, Contrastive Loss: 0.0396
Epoch 13/30, Step 80/1,Classification Loss: 0.3372, Contrastive Loss: 0.0409
Epoch 13/30, Step 100/1,Classification Loss: 0.3427, Contrastive Loss: 0.0475
Epoch 13/30, Step 120/1,Classification Loss: 0.3141, Contrastive Loss: 0.0382
Epoch 13/30, Step 140/1,Classification Loss: 0.3183, Contrastive Loss: 0.0380
Accuracy: 0.9963, Precision: 0.9946, Recall: 0.9903, F1: 0.9925
Accuracy: 0.9930, Precision: 0.9865, Recall: 0.9849, F1: 0.9857
Epoch 13/30
Training - Loss: 52.9887
Training Metrics: {'accuracy': 0.996337890625, 'precision': 0.9946384200588203, 'recall': 0.990290697618571, 'f1': 0.9924504085552073}
Validation Metrics: {'accuracy': 0.9929904022430713, 'precision': 0.9864525742106864, 'recall': 0.9849246164435865, 'f1': 0.9856868084329109}
Epoch 14/30, Step 0/1,Classification Loss: 0.3230, Contrastive Loss: 0.0372
Epoch 14/30, Step 20/1,Classification Loss: 0.3510, Contrastive Loss: 0.0561
Epoch 14/30, Step 40/1,Classification Loss: 0.3517, Contrastive Loss: 0.0415
Epoch 14/30, Step 60/1,Classification Loss: 0.3218, Contrastive Loss: 0.0360
Epoch 14/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0374
Epoch 14/30, Step 100/1,Classification Loss: 0.3371, Contrastive Loss: 0.0365
Epoch 14/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0336
Epoch 14/30, Step 140/1,Classification Loss: 0.3882, Contrastive Loss: 0.0536
Accuracy: 0.9966, Precision: 0.9949, Recall: 0.9911, F1: 0.9930
Accuracy: 0.9936, Precision: 0.9854, Recall: 0.9888, F1: 0.9871
Epoch 14/30
Training - Loss: 52.4283
Training Metrics: {'accuracy': 0.99658203125, 'precision': 0.9948762001010611, 'recall': 0.991094351732991, 'f1': 0.9929745626041822}
Validation Metrics: {'accuracy': 0.9936374420360186, 'precision': 0.985408489944928, 'recall': 0.9887546799980501, 'f1': 0.9870730159690276}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0328
Epoch 15/30, Step 20/1,Classification Loss: 0.3282, Contrastive Loss: 0.0361
Epoch 15/30, Step 40/1,Classification Loss: 0.3229, Contrastive Loss: 0.0331
Epoch 15/30, Step 60/1,Classification Loss: 0.3396, Contrastive Loss: 0.0348
Epoch 15/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0388
Epoch 15/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0321
Epoch 15/30, Step 120/1,Classification Loss: 0.3205, Contrastive Loss: 0.0330
Epoch 15/30, Step 140/1,Classification Loss: 0.3276, Contrastive Loss: 0.0316
Accuracy: 0.9965, Precision: 0.9949, Recall: 0.9905, F1: 0.9927
Accuracy: 0.9928, Precision: 0.9857, Recall: 0.9848, F1: 0.9853
Epoch 15/30
Training - Loss: 52.4934
Training Metrics: {'accuracy': 0.9964735243055556, 'precision': 0.9949460898824319, 'recall': 0.9904954926270235, 'f1': 0.9927060027750041}
Validation Metrics: {'accuracy': 0.9927747223120889, 'precision': 0.9857138730707353, 'recall': 0.9847987669595695, 'f1': 0.985255678147177}
Epoch 16/30, Step 0/1,Classification Loss: 0.3210, Contrastive Loss: 0.0312
Epoch 16/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0299
Epoch 16/30, Step 40/1,Classification Loss: 0.3463, Contrastive Loss: 0.0361
Epoch 16/30, Step 60/1,Classification Loss: 0.3506, Contrastive Loss: 0.0376
Epoch 16/30, Step 80/1,Classification Loss: 0.3402, Contrastive Loss: 0.0400
Epoch 16/30, Step 100/1,Classification Loss: 0.3294, Contrastive Loss: 0.0333
Epoch 16/30, Step 120/1,Classification Loss: 0.3141, Contrastive Loss: 0.0292
Epoch 16/30, Step 140/1,Classification Loss: 0.3410, Contrastive Loss: 0.0342
Accuracy: 0.9965, Precision: 0.9947, Recall: 0.9909, F1: 0.9928
Accuracy: 0.9937, Precision: 0.9872, Recall: 0.9872, F1: 0.9872
Epoch 16/30
Training - Loss: 51.8913
Training Metrics: {'accuracy': 0.9965006510416666, 'precision': 0.994658073172521, 'recall': 0.9909437227506079, 'f1': 0.9927905742062648}
Validation Metrics: {'accuracy': 0.9937452820015098, 'precision': 0.9872482796935076, 'recall': 0.9872482796935076, 'f1': 0.9872482796935076}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 17/30, Step 20/1,Classification Loss: 0.3342, Contrastive Loss: 0.0334
Epoch 17/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0279
Epoch 17/30, Step 60/1,Classification Loss: 0.3282, Contrastive Loss: 0.0309
Epoch 17/30, Step 80/1,Classification Loss: 0.3336, Contrastive Loss: 0.0471
Epoch 17/30, Step 100/1,Classification Loss: 0.3172, Contrastive Loss: 0.0275
Epoch 17/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0268
Epoch 17/30, Step 140/1,Classification Loss: 0.3141, Contrastive Loss: 0.0272
Accuracy: 0.9964, Precision: 0.9967, Recall: 0.9885, F1: 0.9925
Accuracy: 0.9930, Precision: 0.9898, Recall: 0.9815, F1: 0.9856
Epoch 17/30
Training - Loss: 51.7780
Training Metrics: {'accuracy': 0.9963921440972222, 'precision': 0.9966781273379942, 'recall': 0.9884818425754123, 'f1': 0.9925298458848768}
Validation Metrics: {'accuracy': 0.9929904022430713, 'precision': 0.9898075717083619, 'recall': 0.9814721013411742, 'f1': 0.9855868880172374}
Epoch 18/30, Step 0/1,Classification Loss: 0.3139, Contrastive Loss: 0.0290
Epoch 18/30, Step 20/1,Classification Loss: 0.3244, Contrastive Loss: 0.0290
Epoch 18/30, Step 40/1,Classification Loss: 0.3205, Contrastive Loss: 0.0278
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Epoch 18/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0280
Epoch 18/30, Step 100/1,Classification Loss: 0.3161, Contrastive Loss: 0.0270
Epoch 18/30, Step 120/1,Classification Loss: 0.3277, Contrastive Loss: 0.0275
Epoch 18/30, Step 140/1,Classification Loss: 0.3336, Contrastive Loss: 0.0300
Accuracy: 0.9964, Precision: 0.9948, Recall: 0.9902, F1: 0.9925
Accuracy: 0.9931, Precision: 0.9883, Recall: 0.9834, F1: 0.9859
Epoch 18/30
Training - Loss: 51.3416
Training Metrics: {'accuracy': 0.9963650173611112, 'precision': 0.9947931355033055, 'recall': 0.9901726912660302, 'f1': 0.9924669848199446}
Validation Metrics: {'accuracy': 0.9930982422085625, 'precision': 0.9883347502467383, 'recall': 0.9834182161390441, 'f1': 0.9858580316730221}
Epoch 19/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0318
Epoch 19/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0257
Epoch 19/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0262
Epoch 19/30, Step 60/1,Classification Loss: 0.3490, Contrastive Loss: 0.0296
Epoch 19/30, Step 80/1,Classification Loss: 0.3294, Contrastive Loss: 0.0294
Epoch 19/30, Step 100/1,Classification Loss: 0.3439, Contrastive Loss: 0.0416
Epoch 19/30, Step 120/1,Classification Loss: 0.3359, Contrastive Loss: 0.0278
Epoch 19/30, Step 140/1,Classification Loss: 0.3434, Contrastive Loss: 0.0296
Accuracy: 0.9966, Precision: 0.9948, Recall: 0.9913, F1: 0.9930
Accuracy: 0.9937, Precision: 0.9858, Recall: 0.9888, F1: 0.9873
Epoch 19/30
Training - Loss: 51.2409
Training Metrics: {'accuracy': 0.9966362847222222, 'precision': 0.9947814504916161, 'recall': 0.9912591128098529, 'f1': 0.9930110510663437}
Validation Metrics: {'accuracy': 0.9937452820015098, 'precision': 0.9857728695683644, 'recall': 0.9888176047400588, 'f1': 0.9872881476111548}
Epoch 20/30, Step 0/1,Classification Loss: 0.3168, Contrastive Loss: 0.0249
Epoch 20/30, Step 20/1,Classification Loss: 0.3328, Contrastive Loss: 0.0272
Epoch 20/30, Step 40/1,Classification Loss: 0.3506, Contrastive Loss: 0.0278
Epoch 20/30, Step 60/1,Classification Loss: 0.3373, Contrastive Loss: 0.0275
Epoch 20/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0274
Epoch 20/30, Step 100/1,Classification Loss: 0.3178, Contrastive Loss: 0.0250
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0226
Epoch 20/30, Step 140/1,Classification Loss: 0.3428, Contrastive Loss: 0.0295
Accuracy: 0.9959, Precision: 0.9945, Recall: 0.9887, F1: 0.9915
Accuracy: 0.9930, Precision: 0.9880, Recall: 0.9834, F1: 0.9856
Epoch 20/30
Training - Loss: 50.9596
Training Metrics: {'accuracy': 0.9959038628472222, 'precision': 0.9944505264348144, 'recall': 0.9886700306390168, 'f1': 0.991535249507232}
Validation Metrics: {'accuracy': 0.9929904022430713, 'precision': 0.9879603137704848, 'recall': 0.9833552913970355, 'f1': 0.9856416033960944}
Epoch 21/30, Step 0/1,Classification Loss: 0.3489, Contrastive Loss: 0.0290
Epoch 21/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0239
Epoch 21/30, Step 40/1,Classification Loss: 0.3304, Contrastive Loss: 0.0300
Epoch 21/30, Step 60/1,Classification Loss: 0.3542, Contrastive Loss: 0.0283
Epoch 21/30, Step 80/1,Classification Loss: 0.3202, Contrastive Loss: 0.0239
Epoch 21/30, Step 100/1,Classification Loss: 0.3156, Contrastive Loss: 0.0246
Epoch 21/30, Step 120/1,Classification Loss: 0.3139, Contrastive Loss: 0.0227
Epoch 21/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0243
Accuracy: 0.9957, Precision: 0.9964, Recall: 0.9859, F1: 0.9911
Accuracy: 0.9913, Precision: 0.9881, Recall: 0.9761, F1: 0.9820
Epoch 21/30
Training - Loss: 50.6488
Training Metrics: {'accuracy': 0.9957139756944444, 'precision': 0.996354952205341, 'recall': 0.9859354301336654, 'f1': 0.9910642328954996}
Validation Metrics: {'accuracy': 0.9912649627952119, 'precision': 0.9880907816285971, 'recall': 0.9760711953386945, 'f1': 0.9819702150034453}
Epoch 22/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 20/1,Classification Loss: 0.3462, Contrastive Loss: 0.0333
Epoch 22/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0228
Epoch 22/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0216
Epoch 22/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Epoch 22/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0222
Epoch 22/30, Step 120/1,Classification Loss: 0.3163, Contrastive Loss: 0.0229
Epoch 22/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Accuracy: 0.9964, Precision: 0.9948, Recall: 0.9904, F1: 0.9926
Accuracy: 0.9928, Precision: 0.9866, Recall: 0.9839, F1: 0.9852
Epoch 22/30
Training - Loss: 50.5928
Training Metrics: {'accuracy': 0.9964192708333334, 'precision': 0.9948306919425738, 'recall': 0.9903769337900676, 'f1': 0.9925890052150774}
Validation Metrics: {'accuracy': 0.9927747223120889, 'precision': 0.9866100476027426, 'recall': 0.9838571719316387, 'f1': 0.9852278078360327}
Epoch 23/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0259
Epoch 23/30, Step 20/1,Classification Loss: 0.3291, Contrastive Loss: 0.0230
Epoch 23/30, Step 40/1,Classification Loss: 0.3605, Contrastive Loss: 0.0274
Epoch 23/30, Step 60/1,Classification Loss: 0.3347, Contrastive Loss: 0.0235
Epoch 23/30, Step 80/1,Classification Loss: 0.3314, Contrastive Loss: 0.0232
Epoch 23/30, Step 100/1,Classification Loss: 0.3359, Contrastive Loss: 0.0269
Epoch 23/30, Step 120/1,Classification Loss: 0.3174, Contrastive Loss: 0.0218
Epoch 23/30, Step 140/1,Classification Loss: 0.3291, Contrastive Loss: 0.0236
Accuracy: 0.9965, Precision: 0.9950, Recall: 0.9906, F1: 0.9927
Accuracy: 0.9935, Precision: 0.9871, Recall: 0.9865, F1: 0.9868
Epoch 23/30
Training - Loss: 50.2648
Training Metrics: {'accuracy': 0.9964735243055556, 'precision': 0.9949673717178729, 'recall': 0.9905509939504435, 'f1': 0.9927445739516785}
Validation Metrics: {'accuracy': 0.9935296020705273, 'precision': 0.9871064276286428, 'recall': 0.9864947001908702, 'f1': 0.986800278086668}
Epoch 24/30, Step 0/1,Classification Loss: 0.3433, Contrastive Loss: 0.0235
Epoch 24/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0200
Epoch 24/30, Step 40/1,Classification Loss: 0.3712, Contrastive Loss: 0.0430
Epoch 24/30, Step 60/1,Classification Loss: 0.3155, Contrastive Loss: 0.0200
Epoch 24/30, Step 80/1,Classification Loss: 0.3145, Contrastive Loss: 0.0220
Epoch 24/30, Step 100/1,Classification Loss: 0.3366, Contrastive Loss: 0.0398
Epoch 24/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0212
Epoch 24/30, Step 140/1,Classification Loss: 0.3232, Contrastive Loss: 0.0210
Accuracy: 0.9966, Precision: 0.9949, Recall: 0.9912, F1: 0.9930
Accuracy: 0.9934, Precision: 0.9850, Recall: 0.9883, F1: 0.9866
Epoch 24/30
Training - Loss: 50.4387
Training Metrics: {'accuracy': 0.9966091579861112, 'precision': 0.994887236173337, 'recall': 0.9911772728413825, 'f1': 0.9930219535051763}
Validation Metrics: {'accuracy': 0.9934217621050361, 'precision': 0.9849717858949254, 'recall': 0.9883149655047228, 'f1': 0.98663481312052}
Epoch 25/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0223
Epoch 25/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0194
Epoch 25/30, Step 40/1,Classification Loss: 0.3217, Contrastive Loss: 0.0210
Epoch 25/30, Step 60/1,Classification Loss: 0.3144, Contrastive Loss: 0.0194
Epoch 25/30, Step 80/1,Classification Loss: 0.3403, Contrastive Loss: 0.0261
Epoch 25/30, Step 100/1,Classification Loss: 0.3355, Contrastive Loss: 0.0216
Epoch 25/30, Step 120/1,Classification Loss: 0.3170, Contrastive Loss: 0.0191
Epoch 25/30, Step 140/1,Classification Loss: 0.3216, Contrastive Loss: 0.0197
Accuracy: 0.9967, Precision: 0.9947, Recall: 0.9915, F1: 0.9931
Accuracy: 0.9931, Precision: 0.9862, Recall: 0.9856, F1: 0.9859
Epoch 25/30
Training - Loss: 50.4010
Training Metrics: {'accuracy': 0.9966634114583334, 'precision': 0.9947498882358801, 'recall': 0.991502211747636, 'f1': 0.9931181690133823}
Validation Metrics: {'accuracy': 0.9930982422085625, 'precision': 0.986225892831708, 'recall': 0.9856152712042154, 'f1': 0.9859202966257792}
Epoch 26/30, Step 0/1,Classification Loss: 0.3261, Contrastive Loss: 0.0205
Epoch 26/30, Step 20/1,Classification Loss: 0.3177, Contrastive Loss: 0.0197
Epoch 26/30, Step 40/1,Classification Loss: 0.3302, Contrastive Loss: 0.0249
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0208
Epoch 26/30, Step 120/1,Classification Loss: 0.3330, Contrastive Loss: 0.0201
Epoch 26/30, Step 140/1,Classification Loss: 0.3467, Contrastive Loss: 0.0242
Accuracy: 0.9966, Precision: 0.9944, Recall: 0.9913, F1: 0.9929
Accuracy: 0.9937, Precision: 0.9864, Recall: 0.9882, F1: 0.9873
Epoch 26/30
Training - Loss: 50.0202
Training Metrics: {'accuracy': 0.9965549045138888, 'precision': 0.9944337205776861, 'recall': 0.9913350106852485, 'f1': 0.9928771977401818}
Validation Metrics: {'accuracy': 0.9937452820015098, 'precision': 0.9863597196528351, 'recall': 0.9881898747214383, 'f1': 0.9872722376254119}
Epoch 27/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0199
Epoch 27/30, Step 20/1,Classification Loss: 0.3394, Contrastive Loss: 0.0247
Epoch 27/30, Step 40/1,Classification Loss: 0.3195, Contrastive Loss: 0.0199
Epoch 27/30, Step 60/1,Classification Loss: 0.3297, Contrastive Loss: 0.0221
Epoch 27/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0185
Epoch 27/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0187
Epoch 27/30, Step 120/1,Classification Loss: 0.3287, Contrastive Loss: 0.0192
Epoch 27/30, Step 140/1,Classification Loss: 0.3179, Contrastive Loss: 0.0193
Accuracy: 0.9959, Precision: 0.9959, Recall: 0.9871, F1: 0.9914
Accuracy: 0.9923, Precision: 0.9882, Recall: 0.9805, F1: 0.9843
Epoch 27/30
Training - Loss: 50.0975
Training Metrics: {'accuracy': 0.9958767361111112, 'precision': 0.9958787547562512, 'recall': 0.9870939083689247, 'f1': 0.9914287256198766}
Validation Metrics: {'accuracy': 0.992343362450124, 'precision': 0.9881565201505226, 'recall': 0.9804668228705025, 'f1': 0.9842664470476159}
Epoch 28/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0204
Epoch 28/30, Step 20/1,Classification Loss: 0.3483, Contrastive Loss: 0.0224
Epoch 28/30, Step 40/1,Classification Loss: 0.3235, Contrastive Loss: 0.0199
Epoch 28/30, Step 60/1,Classification Loss: 0.3235, Contrastive Loss: 0.0200
Epoch 28/30, Step 80/1,Classification Loss: 0.3137, Contrastive Loss: 0.0185
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 28/30, Step 120/1,Classification Loss: 0.3278, Contrastive Loss: 0.0187
Epoch 28/30, Step 140/1,Classification Loss: 0.3275, Contrastive Loss: 0.0199
Accuracy: 0.9960, Precision: 0.9945, Recall: 0.9889, F1: 0.9917
Accuracy: 0.9926, Precision: 0.9859, Recall: 0.9837, F1: 0.9848
Epoch 28/30
Training - Loss: 50.0167
Training Metrics: {'accuracy': 0.9959852430555556, 'precision': 0.9944779916068482, 'recall': 0.9888933993040562, 'f1': 0.991662412196539}
Validation Metrics: {'accuracy': 0.9925590423811065, 'precision': 0.9858685401735194, 'recall': 0.9837313224476216, 'f1': 0.9847964292351419}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 20/1,Classification Loss: 0.3660, Contrastive Loss: 0.0238
Epoch 29/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0204
Epoch 29/30, Step 60/1,Classification Loss: 0.3192, Contrastive Loss: 0.0187
Epoch 29/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0210
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0173
Epoch 29/30, Step 120/1,Classification Loss: 0.3717, Contrastive Loss: 0.0266
Epoch 29/30, Step 140/1,Classification Loss: 0.3386, Contrastive Loss: 0.0198
Accuracy: 0.9967, Precision: 0.9946, Recall: 0.9916, F1: 0.9931
Accuracy: 0.9939, Precision: 0.9856, Recall: 0.9895, F1: 0.9875
Epoch 29/30
Training - Loss: 49.9976
Training Metrics: {'accuracy': 0.9966634114583334, 'precision': 0.994570895025647, 'recall': 0.9916228518103967, 'f1': 0.9930903953471679}
Validation Metrics: {'accuracy': 0.9938531219670009, 'precision': 0.9855536856245684, 'recall': 0.9895082595006877, 'f1': 0.9875190124189321}
Epoch 30/30, Step 0/1,Classification Loss: 0.3614, Contrastive Loss: 0.0261
Epoch 30/30, Step 20/1,Classification Loss: 0.3252, Contrastive Loss: 0.0184
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0179
Epoch 30/30, Step 60/1,Classification Loss: 0.3138, Contrastive Loss: 0.0178
Epoch 30/30, Step 80/1,Classification Loss: 0.3533, Contrastive Loss: 0.0206
Epoch 30/30, Step 100/1,Classification Loss: 0.3172, Contrastive Loss: 0.0192
Epoch 30/30, Step 120/1,Classification Loss: 0.3284, Contrastive Loss: 0.0185
Epoch 30/30, Step 140/1,Classification Loss: 0.3193, Contrastive Loss: 0.0181
Accuracy: 0.9964, Precision: 0.9967, Recall: 0.9886, F1: 0.9926
Accuracy: 0.9926, Precision: 0.9883, Recall: 0.9812, F1: 0.9847
Epoch 30/30
Training - Loss: 50.0598
Training Metrics: {'accuracy': 0.9964463975694444, 'precision': 0.996707124213029, 'recall': 0.9886455102327132, 'f1': 0.992627881330082}
Validation Metrics: {'accuracy': 0.9925590423811065, 'precision': 0.988294797632236, 'recall': 0.98122040237314, 'f1': 0.9847193489070895}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1499, 5814), y shape: (1499,), y distribution: Counter({np.float64(0.0): 1362, np.float64(1.0): 137}), env shape: (1499,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8993, Precision: 0.4539, Recall: 0.4949, F1: 0.4735
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12315]))
original train data shape: torch.Size([46462]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1499, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46462]), new train data shape: torch.Size([46462])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12315]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3391, Contrastive Loss: 1.5592
Epoch 1/30, Step 20/1,Classification Loss: 0.3443, Contrastive Loss: 0.7477
Epoch 1/30, Step 40/1,Classification Loss: 0.3513, Contrastive Loss: 0.3301
Epoch 1/30, Step 60/1,Classification Loss: 0.3342, Contrastive Loss: 0.2005
Epoch 1/30, Step 80/1,Classification Loss: 0.3358, Contrastive Loss: 0.1742
Epoch 1/30, Step 100/1,Classification Loss: 0.3317, Contrastive Loss: 0.1631
Epoch 1/30, Step 120/1,Classification Loss: 0.3287, Contrastive Loss: 0.1326
Epoch 1/30, Step 140/1,Classification Loss: 0.3156, Contrastive Loss: 0.1251
Accuracy: 0.9960, Precision: 0.9966, Recall: 0.9871, F1: 0.9918
Accuracy: 0.9930, Precision: 0.9886, Recall: 0.9828, F1: 0.9857
Epoch 1/30
Training - Loss: 99.6488
Training Metrics: {'accuracy': 0.9960398706896552, 'precision': 0.9965542831083805, 'recall': 0.98708233765556, 'f1': 0.9917514749066056}
Validation Metrics: {'accuracy': 0.9930054880017217, 'precision': 0.9885971506064082, 'recall': 0.982766346986391, 'f1': 0.9856557987753483}
Epoch 2/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1181
Epoch 2/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1248
Epoch 2/30, Step 40/1,Classification Loss: 0.3252, Contrastive Loss: 0.1201
Epoch 2/30, Step 60/1,Classification Loss: 0.3522, Contrastive Loss: 0.1417
Epoch 2/30, Step 80/1,Classification Loss: 0.3485, Contrastive Loss: 0.1366
Epoch 2/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1158
Epoch 2/30, Step 120/1,Classification Loss: 0.3206, Contrastive Loss: 0.1054
Epoch 2/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.1072
Accuracy: 0.9958, Precision: 0.9943, Recall: 0.9885, F1: 0.9913
Accuracy: 0.9934, Precision: 0.9874, Recall: 0.9858, F1: 0.9866
Epoch 2/30
Training - Loss: 64.9527
Training Metrics: {'accuracy': 0.9958243534482759, 'precision': 0.9942522003321136, 'recall': 0.9884893698947643, 'f1': 0.9913459422855964}
Validation Metrics: {'accuracy': 0.9934359195093081, 'precision': 0.9873631791316209, 'recall': 0.9858358536048775, 'f1': 0.9865977347461587}
Epoch 3/30, Step 0/1,Classification Loss: 0.3514, Contrastive Loss: 0.1198
Epoch 3/30, Step 20/1,Classification Loss: 0.3162, Contrastive Loss: 0.1047
Epoch 3/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1033
Epoch 3/30, Step 60/1,Classification Loss: 0.3453, Contrastive Loss: 0.1080
Epoch 3/30, Step 80/1,Classification Loss: 0.3301, Contrastive Loss: 0.1008
Epoch 3/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0897
Epoch 3/30, Step 120/1,Classification Loss: 0.3362, Contrastive Loss: 0.1006
Epoch 3/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0880
Accuracy: 0.9958, Precision: 0.9941, Recall: 0.9884, F1: 0.9912
Accuracy: 0.9941, Precision: 0.9887, Recall: 0.9872, F1: 0.9879
Epoch 3/30
Training - Loss: 62.2491
Training Metrics: {'accuracy': 0.9957704741379311, 'precision': 0.9941420602893107, 'recall': 0.9883845595797824, 'f1': 0.9912384993445931}
Validation Metrics: {'accuracy': 0.9940815667706876, 'precision': 0.988683507615367, 'recall': 0.9871520443706276, 'f1': 0.9879159903448972}
Epoch 4/30, Step 0/1,Classification Loss: 0.3167, Contrastive Loss: 0.0931
Epoch 4/30, Step 20/1,Classification Loss: 0.3280, Contrastive Loss: 0.0942
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0839
Epoch 4/30, Step 60/1,Classification Loss: 0.3142, Contrastive Loss: 0.0897
Epoch 4/30, Step 80/1,Classification Loss: 0.3230, Contrastive Loss: 0.0872
Epoch 4/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0860
Epoch 4/30, Step 120/1,Classification Loss: 0.3385, Contrastive Loss: 0.0989
Epoch 4/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0787
Accuracy: 0.9961, Precision: 0.9973, Recall: 0.9864, F1: 0.9918
Accuracy: 0.9935, Precision: 0.9896, Recall: 0.9840, F1: 0.9868
Epoch 4/30
Training - Loss: 60.6527
Training Metrics: {'accuracy': 0.99609375, 'precision': 0.9973222551534113, 'recall': 0.9864238346294207, 'f1': 0.9917850876235927}
Validation Metrics: {'accuracy': 0.9935435273862047, 'precision': 0.9895536483752572, 'recall': 0.9840197473465153, 'f1': 0.9867633803854748}
Epoch 5/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0824
Epoch 5/30, Step 20/1,Classification Loss: 0.3146, Contrastive Loss: 0.0828
Epoch 5/30, Step 40/1,Classification Loss: 0.3216, Contrastive Loss: 0.0770
Epoch 5/30, Step 60/1,Classification Loss: 0.3235, Contrastive Loss: 0.0768
Epoch 5/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0750
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0720
Epoch 5/30, Step 120/1,Classification Loss: 0.3348, Contrastive Loss: 0.0826
Epoch 5/30, Step 140/1,Classification Loss: 0.3446, Contrastive Loss: 0.0934
Accuracy: 0.9960, Precision: 0.9965, Recall: 0.9868, F1: 0.9916
Accuracy: 0.9933, Precision: 0.9894, Recall: 0.9833, F1: 0.9863
Epoch 5/30
Training - Loss: 59.4478
Training Metrics: {'accuracy': 0.9959859913793103, 'precision': 0.9965142767982524, 'recall': 0.9867899671072144, 'f1': 0.991581941390993}
Validation Metrics: {'accuracy': 0.9933283116324115, 'precision': 0.9894167759159971, 'recall': 0.983267867647267, 'f1': 0.9863135145510036}
Epoch 6/30, Step 0/1,Classification Loss: 0.3174, Contrastive Loss: 0.0739
Epoch 6/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0709
Epoch 6/30, Step 40/1,Classification Loss: 0.3498, Contrastive Loss: 0.0937
Epoch 6/30, Step 60/1,Classification Loss: 0.3453, Contrastive Loss: 0.0809
Epoch 6/30, Step 80/1,Classification Loss: 0.3378, Contrastive Loss: 0.0770
Epoch 6/30, Step 100/1,Classification Loss: 0.3400, Contrastive Loss: 0.0878
Epoch 6/30, Step 120/1,Classification Loss: 0.3145, Contrastive Loss: 0.0677
Epoch 6/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0667
Accuracy: 0.9964, Precision: 0.9951, Recall: 0.9900, F1: 0.9925
Accuracy: 0.9938, Precision: 0.9873, Recall: 0.9873, F1: 0.9873
Epoch 6/30
Training - Loss: 58.1036
Training Metrics: {'accuracy': 0.9963900862068965, 'precision': 0.9950700286101539, 'recall': 0.9900062868301762, 'f1': 0.9925190284490064}
Validation Metrics: {'accuracy': 0.9937587431399979, 'precision': 0.9872768225977477, 'recall': 0.9872768225977477, 'f1': 0.9872768225977477}
Epoch 7/30, Step 0/1,Classification Loss: 0.3197, Contrastive Loss: 0.0661
Epoch 7/30, Step 20/1,Classification Loss: 0.3437, Contrastive Loss: 0.0704
Epoch 7/30, Step 40/1,Classification Loss: 0.3326, Contrastive Loss: 0.0703
Epoch 7/30, Step 60/1,Classification Loss: 0.3149, Contrastive Loss: 0.0626
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0623
Epoch 7/30, Step 100/1,Classification Loss: 0.3482, Contrastive Loss: 0.0859
Epoch 7/30, Step 120/1,Classification Loss: 0.3271, Contrastive Loss: 0.0607
Epoch 7/30, Step 140/1,Classification Loss: 0.3141, Contrastive Loss: 0.0588
Accuracy: 0.9962, Precision: 0.9967, Recall: 0.9878, F1: 0.9922
Accuracy: 0.9933, Precision: 0.9888, Recall: 0.9839, F1: 0.9863
Epoch 7/30
Training - Loss: 57.0635
Training Metrics: {'accuracy': 0.9962284482758621, 'precision': 0.9966734022976457, 'recall': 0.987843825039981, 'f1': 0.9922003396550365}
Validation Metrics: {'accuracy': 0.9933283116324115, 'precision': 0.9888041821348772, 'recall': 0.9838941665352632, 'f1': 0.9863307914032544}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0567
Epoch 8/30, Step 20/1,Classification Loss: 0.3281, Contrastive Loss: 0.0616
Epoch 8/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0621
Epoch 8/30, Step 60/1,Classification Loss: 0.3301, Contrastive Loss: 0.0630
Epoch 8/30, Step 80/1,Classification Loss: 0.3173, Contrastive Loss: 0.0592
Epoch 8/30, Step 100/1,Classification Loss: 0.3261, Contrastive Loss: 0.0630
Epoch 8/30, Step 120/1,Classification Loss: 0.3330, Contrastive Loss: 0.0611
Epoch 8/30, Step 140/1,Classification Loss: 0.3329, Contrastive Loss: 0.0601
Accuracy: 0.9963, Precision: 0.9968, Recall: 0.9879, F1: 0.9923
Accuracy: 0.9930, Precision: 0.9880, Recall: 0.9834, F1: 0.9857
Epoch 8/30
Training - Loss: 56.3531
Training Metrics: {'accuracy': 0.9963092672413794, 'precision': 0.9967897682173316, 'recall': 0.9879052140384281, 'f1': 0.9922888712348381}
Validation Metrics: {'accuracy': 0.9930054880017217, 'precision': 0.9879874026195612, 'recall': 0.9833926458743871, 'f1': 0.9856738974495864}
Epoch 9/30, Step 0/1,Classification Loss: 0.3142, Contrastive Loss: 0.0561
Epoch 9/30, Step 20/1,Classification Loss: 0.3512, Contrastive Loss: 0.0829
Epoch 9/30, Step 40/1,Classification Loss: 0.3192, Contrastive Loss: 0.0544
Epoch 9/30, Step 60/1,Classification Loss: 0.3302, Contrastive Loss: 0.0607
Epoch 9/30, Step 80/1,Classification Loss: 0.3312, Contrastive Loss: 0.0595
Epoch 9/30, Step 100/1,Classification Loss: 0.3569, Contrastive Loss: 0.0558
Epoch 9/30, Step 120/1,Classification Loss: 0.3313, Contrastive Loss: 0.0545
Epoch 9/30, Step 140/1,Classification Loss: 0.3596, Contrastive Loss: 0.0588
Accuracy: 0.9963, Precision: 0.9967, Recall: 0.9881, F1: 0.9924
Accuracy: 0.9932, Precision: 0.9881, Recall: 0.9841, F1: 0.9861
Epoch 9/30
Training - Loss: 55.9375
Training Metrics: {'accuracy': 0.9963362068965518, 'precision': 0.9967275984433543, 'recall': 0.9881236813753104, 'f1': 0.9923705634638842}
Validation Metrics: {'accuracy': 0.9932207037555149, 'precision': 0.9881265855272727, 'recall': 0.9841445255736352, 'f1': 0.9861234509646987}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0497
Epoch 10/30, Step 20/1,Classification Loss: 0.3283, Contrastive Loss: 0.0514
Epoch 10/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0485
Epoch 10/30, Step 60/1,Classification Loss: 0.3157, Contrastive Loss: 0.0484
Epoch 10/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0520
Epoch 10/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0459
Epoch 10/30, Step 120/1,Classification Loss: 0.3423, Contrastive Loss: 0.0544
Epoch 10/30, Step 140/1,Classification Loss: 0.3143, Contrastive Loss: 0.0490
Accuracy: 0.9956, Precision: 0.9962, Recall: 0.9854, F1: 0.9907
Accuracy: 0.9917, Precision: 0.9878, Recall: 0.9783, F1: 0.9829
Epoch 10/30
Training - Loss: 54.9839
Training Metrics: {'accuracy': 0.9955549568965517, 'precision': 0.996186695058289, 'recall': 0.9854326713651687, 'f1': 0.9907234278199193}
Validation Metrics: {'accuracy': 0.9917141934789626, 'precision': 0.9877695030318159, 'recall': 0.9782550687909023, 'f1': 0.9829429143123399}
Epoch 11/30, Step 0/1,Classification Loss: 0.3522, Contrastive Loss: 0.0545
Epoch 11/30, Step 20/1,Classification Loss: 0.3321, Contrastive Loss: 0.0538
Epoch 11/30, Step 40/1,Classification Loss: 0.3676, Contrastive Loss: 0.0567
Epoch 11/30, Step 60/1,Classification Loss: 0.3345, Contrastive Loss: 0.0516
Epoch 11/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0429
Epoch 11/30, Step 100/1,Classification Loss: 0.3152, Contrastive Loss: 0.0458
Epoch 11/30, Step 120/1,Classification Loss: 0.3179, Contrastive Loss: 0.0432
Epoch 11/30, Step 140/1,Classification Loss: 0.3351, Contrastive Loss: 0.0462
Accuracy: 0.9962, Precision: 0.9967, Recall: 0.9877, F1: 0.9921
Accuracy: 0.9926, Precision: 0.9865, Recall: 0.9831, F1: 0.9848
Epoch 11/30
Training - Loss: 54.4814
Training Metrics: {'accuracy': 0.9962284482758621, 'precision': 0.9966605532306161, 'recall': 0.9877000617394972, 'f1': 0.992120654849998}
Validation Metrics: {'accuracy': 0.9925750564941354, 'precision': 0.9864986718586735, 'recall': 0.9831414842518831, 'f1': 0.9848114436437185}
Epoch 12/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0450
Epoch 12/30, Step 20/1,Classification Loss: 0.3332, Contrastive Loss: 0.0498
Epoch 12/30, Step 40/1,Classification Loss: 0.3209, Contrastive Loss: 0.0420
Epoch 12/30, Step 60/1,Classification Loss: 0.3354, Contrastive Loss: 0.0449
Epoch 12/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0377
Epoch 12/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0389
Epoch 12/30, Step 120/1,Classification Loss: 0.3507, Contrastive Loss: 0.0587
Epoch 12/30, Step 140/1,Classification Loss: 0.3252, Contrastive Loss: 0.0392
Accuracy: 0.9954, Precision: 0.9969, Recall: 0.9842, F1: 0.9904
Accuracy: 0.9910, Precision: 0.9867, Recall: 0.9762, F1: 0.9814
Epoch 12/30
Training - Loss: 53.8462
Training Metrics: {'accuracy': 0.995447198275862, 'precision': 0.9968642770975065, 'recall': 0.9842269135770267, 'f1': 0.9904269490710587}
Validation Metrics: {'accuracy': 0.9909609383406865, 'precision': 0.9866660549403556, 'recall': 0.97624978873153, 'f1': 0.9813745139696155}
Epoch 13/30, Step 0/1,Classification Loss: 0.3175, Contrastive Loss: 0.0409
Epoch 13/30, Step 20/1,Classification Loss: 0.3265, Contrastive Loss: 0.0403
Epoch 13/30, Step 40/1,Classification Loss: 0.3238, Contrastive Loss: 0.0401
Epoch 13/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0382
Epoch 13/30, Step 80/1,Classification Loss: 0.3304, Contrastive Loss: 0.0435
Epoch 13/30, Step 100/1,Classification Loss: 0.3589, Contrastive Loss: 0.0598
Epoch 13/30, Step 120/1,Classification Loss: 0.3161, Contrastive Loss: 0.0351
Epoch 13/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0336
Accuracy: 0.9960, Precision: 0.9973, Recall: 0.9863, F1: 0.9917
Accuracy: 0.9928, Precision: 0.9875, Recall: 0.9830, F1: 0.9852
Epoch 13/30
Training - Loss: 53.5086
Training Metrics: {'accuracy': 0.9960398706896552, 'precision': 0.9972919493304377, 'recall': 0.9863174938268102, 'f1': 0.9917152372618574}
Validation Metrics: {'accuracy': 0.9927902722479286, 'precision': 0.9875445021337195, 'recall': 0.9829539156191369, 'f1': 0.9852330942941889}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0343
Epoch 14/30, Step 20/1,Classification Loss: 0.3203, Contrastive Loss: 0.0392
Epoch 14/30, Step 40/1,Classification Loss: 0.3269, Contrastive Loss: 0.0372
Epoch 14/30, Step 60/1,Classification Loss: 0.3475, Contrastive Loss: 0.0423
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0331
Epoch 14/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0380
Epoch 14/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0320
Epoch 14/30, Step 140/1,Classification Loss: 0.3191, Contrastive Loss: 0.0365
Accuracy: 0.9962, Precision: 0.9947, Recall: 0.9897, F1: 0.9922
Accuracy: 0.9935, Precision: 0.9865, Recall: 0.9872, F1: 0.9868
Epoch 14/30
Training - Loss: 53.0255
Training Metrics: {'accuracy': 0.9962015086206897, 'precision': 0.9946522556390978, 'recall': 0.9896975989230709, 'f1': 0.9921565565765611}
Validation Metrics: {'accuracy': 0.9935435273862047, 'precision': 0.9865419841396478, 'recall': 0.9871512417864956, 'f1': 0.9868463292298826}
Epoch 15/30, Step 0/1,Classification Loss: 0.3242, Contrastive Loss: 0.0356
Epoch 15/30, Step 20/1,Classification Loss: 0.3239, Contrastive Loss: 0.0361
Epoch 15/30, Step 40/1,Classification Loss: 0.3319, Contrastive Loss: 0.0369
Epoch 15/30, Step 60/1,Classification Loss: 0.3378, Contrastive Loss: 0.0387
Epoch 15/30, Step 80/1,Classification Loss: 0.3305, Contrastive Loss: 0.0402
Epoch 15/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0355
Epoch 15/30, Step 120/1,Classification Loss: 0.3230, Contrastive Loss: 0.0366
Epoch 15/30, Step 140/1,Classification Loss: 0.3244, Contrastive Loss: 0.0336
Accuracy: 0.9963, Precision: 0.9964, Recall: 0.9881, F1: 0.9922
Accuracy: 0.9933, Precision: 0.9885, Recall: 0.9842, F1: 0.9863
Epoch 15/30
Training - Loss: 52.9796
Training Metrics: {'accuracy': 0.9962553879310345, 'precision': 0.9964330641312253, 'recall': 0.9880544056370031, 'f1': 0.992191526009357}
Validation Metrics: {'accuracy': 0.9933283116324115, 'precision': 0.9884996111541046, 'recall': 0.9842073159792613, 'f1': 0.9863394095962656}
Epoch 16/30, Step 0/1,Classification Loss: 0.3244, Contrastive Loss: 0.0309
Epoch 16/30, Step 20/1,Classification Loss: 0.3425, Contrastive Loss: 0.0430
Epoch 16/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0322
Epoch 16/30, Step 60/1,Classification Loss: 0.3329, Contrastive Loss: 0.0319
Epoch 16/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0287
Epoch 16/30, Step 100/1,Classification Loss: 0.3443, Contrastive Loss: 0.0336
Epoch 16/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0297
Epoch 16/30, Step 140/1,Classification Loss: 0.3207, Contrastive Loss: 0.0306
Accuracy: 0.9963, Precision: 0.9965, Recall: 0.9881, F1: 0.9922
Accuracy: 0.9927, Precision: 0.9869, Recall: 0.9832, F1: 0.9850
Epoch 16/30
Training - Loss: 52.3879
Training Metrics: {'accuracy': 0.9962553879310345, 'precision': 0.9965248513047398, 'recall': 0.9880679503501666, 'f1': 0.9922430026044486}
Validation Metrics: {'accuracy': 0.9926826643710319, 'precision': 0.9868700082294348, 'recall': 0.983204274657509, 'f1': 0.9850268544385931}
Epoch 17/30, Step 0/1,Classification Loss: 0.3231, Contrastive Loss: 0.0308
Epoch 17/30, Step 20/1,Classification Loss: 0.3651, Contrastive Loss: 0.0434
Epoch 17/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0268
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 17/30, Step 80/1,Classification Loss: 0.3347, Contrastive Loss: 0.0306
Epoch 17/30, Step 100/1,Classification Loss: 0.3383, Contrastive Loss: 0.0308
Epoch 17/30, Step 120/1,Classification Loss: 0.3393, Contrastive Loss: 0.0317
Epoch 17/30, Step 140/1,Classification Loss: 0.3328, Contrastive Loss: 0.0305
Accuracy: 0.9961, Precision: 0.9962, Recall: 0.9879, F1: 0.9920
Accuracy: 0.9934, Precision: 0.9883, Recall: 0.9849, F1: 0.9866
Epoch 17/30
Training - Loss: 52.0804
Training Metrics: {'accuracy': 0.9961476293103448, 'precision': 0.9962115426854634, 'recall': 0.9878699464595286, 'f1': 0.991988884686165}
Validation Metrics: {'accuracy': 0.9934359195093081, 'precision': 0.9882657872353534, 'recall': 0.9848964052728832, 'f1': 0.9865724356850265}
Epoch 18/30, Step 0/1,Classification Loss: 0.3169, Contrastive Loss: 0.0265
Epoch 18/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0297
Epoch 18/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0259
Epoch 18/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0284
Epoch 18/30, Step 80/1,Classification Loss: 0.3366, Contrastive Loss: 0.0337
Epoch 18/30, Step 100/1,Classification Loss: 0.3164, Contrastive Loss: 0.0255
Epoch 18/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0263
Epoch 18/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0332
Accuracy: 0.9962, Precision: 0.9964, Recall: 0.9880, F1: 0.9922
Accuracy: 0.9931, Precision: 0.9887, Recall: 0.9831, F1: 0.9859
Epoch 18/30
Training - Loss: 51.7807
Training Metrics: {'accuracy': 0.9962284482758621, 'precision': 0.9964221791581149, 'recall': 0.9880011951325589, 'f1': 0.992158848925782}
Validation Metrics: {'accuracy': 0.9931130958786183, 'precision': 0.9886661556715493, 'recall': 0.9831422868360151, 'f1': 0.9858809390778398}
Epoch 19/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0249
Epoch 19/30, Step 20/1,Classification Loss: 0.3209, Contrastive Loss: 0.0275
Epoch 19/30, Step 40/1,Classification Loss: 0.3144, Contrastive Loss: 0.0257
Epoch 19/30, Step 60/1,Classification Loss: 0.3283, Contrastive Loss: 0.0243
Epoch 19/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0255
Epoch 19/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 19/30, Step 120/1,Classification Loss: 0.3259, Contrastive Loss: 0.0249
Epoch 19/30, Step 140/1,Classification Loss: 0.3382, Contrastive Loss: 0.0334
Accuracy: 0.9964, Precision: 0.9966, Recall: 0.9888, F1: 0.9926
Accuracy: 0.9931, Precision: 0.9872, Recall: 0.9847, F1: 0.9859
Epoch 19/30
Training - Loss: 51.7931
Training Metrics: {'accuracy': 0.9964439655172413, 'precision': 0.996554377546998, 'recall': 0.9888037183226541, 'f1': 0.9926342340137335}
Validation Metrics: {'accuracy': 0.9931130958786183, 'precision': 0.9871517989474325, 'recall': 0.9847080340560053, 'f1': 0.9859253508202481}
Epoch 20/30, Step 0/1,Classification Loss: 0.3152, Contrastive Loss: 0.0255
Epoch 20/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0262
Epoch 20/30, Step 40/1,Classification Loss: 0.3222, Contrastive Loss: 0.0269
Epoch 20/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0242
Epoch 20/30, Step 80/1,Classification Loss: 0.3476, Contrastive Loss: 0.0324
Epoch 20/30, Step 100/1,Classification Loss: 0.3171, Contrastive Loss: 0.0235
Epoch 20/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0209
Epoch 20/30, Step 140/1,Classification Loss: 0.3168, Contrastive Loss: 0.0251
Accuracy: 0.9962, Precision: 0.9965, Recall: 0.9877, F1: 0.9920
Accuracy: 0.9928, Precision: 0.9872, Recall: 0.9833, F1: 0.9852
Epoch 20/30
Training - Loss: 51.3793
Training Metrics: {'accuracy': 0.9961745689655173, 'precision': 0.9964714227463654, 'recall': 0.9877284443450337, 'f1': 0.9920429793120119}
Validation Metrics: {'accuracy': 0.9927902722479286, 'precision': 0.9872419079562149, 'recall': 0.983267065063135, 'f1': 0.9852424002322986}
Epoch 21/30, Step 0/1,Classification Loss: 0.3442, Contrastive Loss: 0.0271
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Epoch 21/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0307
Epoch 21/30, Step 60/1,Classification Loss: 0.3237, Contrastive Loss: 0.0232
Epoch 21/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 21/30, Step 100/1,Classification Loss: 0.3171, Contrastive Loss: 0.0233
Epoch 21/30, Step 120/1,Classification Loss: 0.3142, Contrastive Loss: 0.0216
Epoch 21/30, Step 140/1,Classification Loss: 0.3463, Contrastive Loss: 0.0361
Accuracy: 0.9963, Precision: 0.9966, Recall: 0.9880, F1: 0.9923
Accuracy: 0.9927, Precision: 0.9875, Recall: 0.9826, F1: 0.9850
Epoch 21/30
Training - Loss: 51.2450
Training Metrics: {'accuracy': 0.9963092672413794, 'precision': 0.9966225178459813, 'recall': 0.9880320193728893, 'f1': 0.9922725322917485}
Validation Metrics: {'accuracy': 0.9926826643710319, 'precision': 0.9874746361405691, 'recall': 0.982577975769513, 'f1': 0.9850079647648595}
Epoch 22/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0307
Epoch 22/30, Step 20/1,Classification Loss: 0.3190, Contrastive Loss: 0.0252
Epoch 22/30, Step 40/1,Classification Loss: 0.3162, Contrastive Loss: 0.0224
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 22/30, Step 80/1,Classification Loss: 0.3512, Contrastive Loss: 0.0477
Epoch 22/30, Step 100/1,Classification Loss: 0.3144, Contrastive Loss: 0.0221
Epoch 22/30, Step 120/1,Classification Loss: 0.3518, Contrastive Loss: 0.0313
Epoch 22/30, Step 140/1,Classification Loss: 0.3225, Contrastive Loss: 0.0228
Accuracy: 0.9961, Precision: 0.9966, Recall: 0.9873, F1: 0.9919
Accuracy: 0.9928, Precision: 0.9885, Recall: 0.9820, F1: 0.9852
Epoch 22/30
Training - Loss: 51.0428
Training Metrics: {'accuracy': 0.9960668103448276, 'precision': 0.9965832538037198, 'recall': 0.9873342064237799, 'f1': 0.9918946022626388}
Validation Metrics: {'accuracy': 0.9927902722479286, 'precision': 0.9884591566632118, 'recall': 0.9820144672871429, 'f1': 0.985205089053397}
Epoch 23/30, Step 0/1,Classification Loss: 0.3153, Contrastive Loss: 0.0231
Epoch 23/30, Step 20/1,Classification Loss: 0.3453, Contrastive Loss: 0.0259
Epoch 23/30, Step 40/1,Classification Loss: 0.3387, Contrastive Loss: 0.0257
Epoch 23/30, Step 60/1,Classification Loss: 0.3447, Contrastive Loss: 0.0284
Epoch 23/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0234
Epoch 23/30, Step 100/1,Classification Loss: 0.3232, Contrastive Loss: 0.0233
Epoch 23/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0226
Epoch 23/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Accuracy: 0.9961, Precision: 0.9972, Recall: 0.9868, F1: 0.9919
Accuracy: 0.9931, Precision: 0.9887, Recall: 0.9831, F1: 0.9859
Epoch 23/30
Training - Loss: 51.1216
Training Metrics: {'accuracy': 0.9961206896551724, 'precision': 0.9971737571665071, 'recall': 0.9867676767676767, 'f1': 0.991890257029732}
Validation Metrics: {'accuracy': 0.9931130958786183, 'precision': 0.9886661556715493, 'recall': 0.9831422868360151, 'f1': 0.9858809390778398}
Epoch 24/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 24/30, Step 20/1,Classification Loss: 0.3352, Contrastive Loss: 0.0611
Epoch 24/30, Step 40/1,Classification Loss: 0.3173, Contrastive Loss: 0.0207
Epoch 24/30, Step 60/1,Classification Loss: 0.3329, Contrastive Loss: 0.0218
Epoch 24/30, Step 80/1,Classification Loss: 0.3307, Contrastive Loss: 0.0261
Epoch 24/30, Step 100/1,Classification Loss: 0.3264, Contrastive Loss: 0.0238
Epoch 24/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0192
Epoch 24/30, Step 140/1,Classification Loss: 0.3156, Contrastive Loss: 0.0202
Accuracy: 0.9963, Precision: 0.9973, Recall: 0.9873, F1: 0.9922
Accuracy: 0.9929, Precision: 0.9891, Recall: 0.9818, F1: 0.9854
Epoch 24/30
Training - Loss: 51.0384
Training Metrics: {'accuracy': 0.9962823275862069, 'precision': 0.9972674905774812, 'recall': 0.9873303760279462, 'f1': 0.9922256329848111}
Validation Metrics: {'accuracy': 0.9928978801248252, 'precision': 0.9891431060158822, 'recall': 0.9817641082487709, 'f1': 0.985412066349223}
Epoch 25/30, Step 0/1,Classification Loss: 0.3517, Contrastive Loss: 0.0283
Epoch 25/30, Step 20/1,Classification Loss: 0.3391, Contrastive Loss: 0.0216
Epoch 25/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0236
Epoch 25/30, Step 60/1,Classification Loss: 0.3291, Contrastive Loss: 0.0371
Epoch 25/30, Step 80/1,Classification Loss: 0.3841, Contrastive Loss: 0.0283
Epoch 25/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0244
Epoch 25/30, Step 120/1,Classification Loss: 0.3267, Contrastive Loss: 0.0209
Epoch 25/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0195
Accuracy: 0.9963, Precision: 0.9943, Recall: 0.9901, F1: 0.9922
Accuracy: 0.9929, Precision: 0.9855, Recall: 0.9855, F1: 0.9855
Epoch 25/30
Training - Loss: 50.8569
Training Metrics: {'accuracy': 0.9962553879310345, 'precision': 0.9943069571995182, 'recall': 0.9900622210625774, 'f1': 0.9921712084346126}
Validation Metrics: {'accuracy': 0.9928978801248252, 'precision': 0.9855219015767474, 'recall': 0.9855219015767474, 'f1': 0.9855219015767474}
Epoch 26/30, Step 0/1,Classification Loss: 0.3342, Contrastive Loss: 0.0222
Epoch 26/30, Step 20/1,Classification Loss: 0.3246, Contrastive Loss: 0.0199
Epoch 26/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 60/1,Classification Loss: 0.3432, Contrastive Loss: 0.0257
Epoch 26/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0191
Epoch 26/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0188
Epoch 26/30, Step 120/1,Classification Loss: 0.3246, Contrastive Loss: 0.0220
Epoch 26/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0197
Accuracy: 0.9960, Precision: 0.9944, Recall: 0.9892, F1: 0.9918
Accuracy: 0.9928, Precision: 0.9866, Recall: 0.9839, F1: 0.9853
Epoch 26/30
Training - Loss: 50.8850
Training Metrics: {'accuracy': 0.9960398706896552, 'precision': 0.9943716786607922, 'recall': 0.9892214041926939, 'f1': 0.9917767426995515}
Validation Metrics: {'accuracy': 0.9927902722479286, 'precision': 0.9866401253744654, 'recall': 0.9838933639511311, 'f1': 0.9852609685921103}
Epoch 27/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0213
Epoch 27/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0210
Epoch 27/30, Step 40/1,Classification Loss: 0.3179, Contrastive Loss: 0.0192
Epoch 27/30, Step 60/1,Classification Loss: 0.3423, Contrastive Loss: 0.0226
Epoch 27/30, Step 80/1,Classification Loss: 0.3311, Contrastive Loss: 0.0240
Epoch 27/30, Step 100/1,Classification Loss: 0.3188, Contrastive Loss: 0.0203
Epoch 27/30, Step 120/1,Classification Loss: 0.3213, Contrastive Loss: 0.0217
Epoch 27/30, Step 140/1,Classification Loss: 0.3477, Contrastive Loss: 0.0266
Accuracy: 0.9952, Precision: 0.9957, Recall: 0.9843, F1: 0.9899
Accuracy: 0.9911, Precision: 0.9870, Recall: 0.9763, F1: 0.9816
Epoch 27/30
Training - Loss: 50.7034
Training Metrics: {'accuracy': 0.9952047413793104, 'precision': 0.9957246524007013, 'recall': 0.9843245753619758, 'f1': 0.9899278812787542}
Validation Metrics: {'accuracy': 0.9910685462175831, 'precision': 0.9870451686280644, 'recall': 0.976312579137156, 'f1': 0.9815903884766738}
Epoch 28/30, Step 0/1,Classification Loss: 0.3185, Contrastive Loss: 0.0203
Epoch 28/30, Step 20/1,Classification Loss: 0.3149, Contrastive Loss: 0.0199
Epoch 28/30, Step 40/1,Classification Loss: 0.3499, Contrastive Loss: 0.0259
Epoch 28/30, Step 60/1,Classification Loss: 0.3414, Contrastive Loss: 0.0232
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0181
Epoch 28/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0169
Epoch 28/30, Step 140/1,Classification Loss: 0.3508, Contrastive Loss: 0.0267
Accuracy: 0.9966, Precision: 0.9945, Recall: 0.9915, F1: 0.9930
Accuracy: 0.9929, Precision: 0.9844, Recall: 0.9868, F1: 0.9856
Epoch 28/30
Training - Loss: 50.6790
Training Metrics: {'accuracy': 0.9966056034482759, 'precision': 0.994476243427642, 'recall': 0.9914663059522055, 'f1': 0.9929645234071115}
Validation Metrics: {'accuracy': 0.9928978801248252, 'precision': 0.984350640138522, 'recall': 0.9867744993527394, 'f1': 0.9855580596433785}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 29/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0209
Epoch 29/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0194
Epoch 29/30, Step 60/1,Classification Loss: 0.3439, Contrastive Loss: 0.0245
Epoch 29/30, Step 80/1,Classification Loss: 0.3142, Contrastive Loss: 0.0181
Epoch 29/30, Step 100/1,Classification Loss: 0.3295, Contrastive Loss: 0.0211
Epoch 29/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0231
Epoch 29/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0211
Accuracy: 0.9951, Precision: 0.9959, Recall: 0.9839, F1: 0.9898
Accuracy: 0.9906, Precision: 0.9877, Recall: 0.9739, F1: 0.9806
Epoch 29/30
Training - Loss: 50.3957
Training Metrics: {'accuracy': 0.9951239224137931, 'precision': 0.9959366591224887, 'recall': 0.983949134954452, 'f1': 0.9898354262110864}
Validation Metrics: {'accuracy': 0.9906381147099967, 'precision': 0.98770791465344, 'recall': 0.9738693714066656, 'f1': 0.980641514082707}
Epoch 30/30, Step 0/1,Classification Loss: 0.3447, Contrastive Loss: 0.0303
Epoch 30/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0187
Epoch 30/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0190
Epoch 30/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0211
Epoch 30/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0211
Epoch 30/30, Step 100/1,Classification Loss: 0.3245, Contrastive Loss: 0.0202
Epoch 30/30, Step 120/1,Classification Loss: 0.3443, Contrastive Loss: 0.0205
Epoch 30/30, Step 140/1,Classification Loss: 0.3147, Contrastive Loss: 0.0204
Accuracy: 0.9963, Precision: 0.9965, Recall: 0.9882, F1: 0.9923
Accuracy: 0.9926, Precision: 0.9865, Recall: 0.9831, F1: 0.9848
Epoch 30/30
Training - Loss: 50.4477
Training Metrics: {'accuracy': 0.9963092672413794, 'precision': 0.9964627143292424, 'recall': 0.9882283108274911, 'f1': 0.9922951328583771}
Validation Metrics: {'accuracy': 0.9925750564941354, 'precision': 0.9864986718586735, 'recall': 0.9831414842518831, 'f1': 0.9848114436437185}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1154, 5814), y shape: (1154,), y distribution: Counter({np.float64(0.0): 1054, np.float64(1.0): 100}), env shape: (1154,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8588, Precision: 0.4903, Recall: 0.4927, F1: 0.4907
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12415]))
original train data shape: torch.Size([46562]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1154, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46562]), new train data shape: torch.Size([46562])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12415]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3539, Contrastive Loss: 1.5979
Epoch 1/30, Step 20/1,Classification Loss: 0.3446, Contrastive Loss: 0.7771
Epoch 1/30, Step 40/1,Classification Loss: 0.3171, Contrastive Loss: 0.3344
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2198
Epoch 1/30, Step 80/1,Classification Loss: 0.3601, Contrastive Loss: 0.2184
Epoch 1/30, Step 100/1,Classification Loss: 0.3285, Contrastive Loss: 0.1770
Epoch 1/30, Step 120/1,Classification Loss: 0.3446, Contrastive Loss: 0.1892
Epoch 1/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.1370
Accuracy: 0.9962, Precision: 0.9945, Recall: 0.9898, F1: 0.9921
Accuracy: 0.9930, Precision: 0.9868, Recall: 0.9847, F1: 0.9857
Epoch 1/30
Training - Loss: 103.5698
Training Metrics: {'accuracy': 0.9962015086206897, 'precision': 0.9944547270969171, 'recall': 0.9897569939838395, 'f1': 0.9920894295765976}
Validation Metrics: {'accuracy': 0.9930205089659616, 'precision': 0.9868032237034797, 'recall': 0.9846696715510148, 'f1': 0.9857329663916725}
Epoch 2/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.1426
Epoch 2/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1468
Epoch 2/30, Step 40/1,Classification Loss: 0.3577, Contrastive Loss: 0.1624
Epoch 2/30, Step 60/1,Classification Loss: 0.3235, Contrastive Loss: 0.1277
Epoch 2/30, Step 80/1,Classification Loss: 0.3253, Contrastive Loss: 0.1236
Epoch 2/30, Step 100/1,Classification Loss: 0.3144, Contrastive Loss: 0.1224
Epoch 2/30, Step 120/1,Classification Loss: 0.3479, Contrastive Loss: 0.1511
Epoch 2/30, Step 140/1,Classification Loss: 0.3141, Contrastive Loss: 0.1137
Accuracy: 0.9963, Precision: 0.9966, Recall: 0.9882, F1: 0.9924
Accuracy: 0.9926, Precision: 0.9880, Recall: 0.9816, F1: 0.9848
Epoch 2/30
Training - Loss: 66.7509
Training Metrics: {'accuracy': 0.9963362068965518, 'precision': 0.9966499466357155, 'recall': 0.9882408594438716, 'f1': 0.9923927012872897}
Validation Metrics: {'accuracy': 0.9925910018254054, 'precision': 0.9880348848714595, 'recall': 0.9816045371270281, 'f1': 0.9847881080799314}
Epoch 3/30, Step 0/1,Classification Loss: 0.3652, Contrastive Loss: 0.1406
Epoch 3/30, Step 20/1,Classification Loss: 0.3291, Contrastive Loss: 0.1262
Epoch 3/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.1111
Epoch 3/30, Step 60/1,Classification Loss: 0.3279, Contrastive Loss: 0.1162
Epoch 3/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.1066
Epoch 3/30, Step 100/1,Classification Loss: 0.3329, Contrastive Loss: 0.1165
Epoch 3/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0982
Epoch 3/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0979
Accuracy: 0.9964, Precision: 0.9966, Recall: 0.9886, F1: 0.9926
Accuracy: 0.9925, Precision: 0.9865, Recall: 0.9828, F1: 0.9846
Epoch 3/30
Training - Loss: 64.1548
Training Metrics: {'accuracy': 0.9964439655172413, 'precision': 0.996621508446498, 'recall': 0.9886083351504287, 'f1': 0.9925672782190282}
Validation Metrics: {'accuracy': 0.9924836250402663, 'precision': 0.9864504073640192, 'recall': 0.9827927946741379, 'f1': 0.9846113527997324}
Epoch 4/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1013
Epoch 4/30, Step 20/1,Classification Loss: 0.3362, Contrastive Loss: 0.1026
Epoch 4/30, Step 40/1,Classification Loss: 0.3570, Contrastive Loss: 0.1162
Epoch 4/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0940
Epoch 4/30, Step 80/1,Classification Loss: 0.3562, Contrastive Loss: 0.1050
Epoch 4/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0936
Epoch 4/30, Step 120/1,Classification Loss: 0.3322, Contrastive Loss: 0.0954
Epoch 4/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0860
Accuracy: 0.9964, Precision: 0.9952, Recall: 0.9900, F1: 0.9925
Accuracy: 0.9928, Precision: 0.9843, Recall: 0.9864, F1: 0.9854
Epoch 4/30
Training - Loss: 62.1683
Training Metrics: {'accuracy': 0.9963900862068965, 'precision': 0.9951608710275357, 'recall': 0.9899607121460572, 'f1': 0.9925405827313423}
Validation Metrics: {'accuracy': 0.9928057553956835, 'precision': 0.9843026055741653, 'recall': 0.9864207334762403, 'f1': 0.9853582256629905}
Epoch 5/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0887
Epoch 5/30, Step 20/1,Classification Loss: 0.3259, Contrastive Loss: 0.0880
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0865
Epoch 5/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0863
Epoch 5/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0899
Epoch 5/30, Step 100/1,Classification Loss: 0.3220, Contrastive Loss: 0.0812
Epoch 5/30, Step 120/1,Classification Loss: 0.3356, Contrastive Loss: 0.0894
Epoch 5/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0757
Accuracy: 0.9958, Precision: 0.9944, Recall: 0.9882, F1: 0.9912
Accuracy: 0.9926, Precision: 0.9865, Recall: 0.9832, F1: 0.9848
Epoch 5/30
Training - Loss: 60.4877
Training Metrics: {'accuracy': 0.9957974137931035, 'precision': 0.9943755950304763, 'recall': 0.9881733005765763, 'f1': 0.9912457547718869}
Validation Metrics: {'accuracy': 0.9925910018254054, 'precision': 0.9865209645678987, 'recall': 0.9831681700495132, 'f1': 0.9848359589279582}
Epoch 6/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.0817
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0756
Epoch 6/30, Step 40/1,Classification Loss: 0.3316, Contrastive Loss: 0.0791
Epoch 6/30, Step 60/1,Classification Loss: 0.3607, Contrastive Loss: 0.0884
Epoch 6/30, Step 80/1,Classification Loss: 0.3230, Contrastive Loss: 0.0756
Epoch 6/30, Step 100/1,Classification Loss: 0.3551, Contrastive Loss: 0.0794
Epoch 6/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0717
Epoch 6/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0745
Accuracy: 0.9962, Precision: 0.9966, Recall: 0.9877, F1: 0.9921
Accuracy: 0.9925, Precision: 0.9880, Recall: 0.9812, F1: 0.9846
Epoch 6/30
Training - Loss: 59.2829
Training Metrics: {'accuracy': 0.9962015086206897, 'precision': 0.9965657319929169, 'recall': 0.9877143339835448, 'f1': 0.9920817408605701}
Validation Metrics: {'accuracy': 0.9924836250402663, 'precision': 0.9879657723773432, 'recall': 0.9812291617516526, 'f1': 0.9845627705676911}
Epoch 7/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0724
Epoch 7/30, Step 20/1,Classification Loss: 0.3346, Contrastive Loss: 0.0746
Epoch 7/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0719
Epoch 7/30, Step 60/1,Classification Loss: 0.3287, Contrastive Loss: 0.0716
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0654
Epoch 7/30, Step 100/1,Classification Loss: 0.3166, Contrastive Loss: 0.0692
Epoch 7/30, Step 120/1,Classification Loss: 0.3169, Contrastive Loss: 0.0660
Epoch 7/30, Step 140/1,Classification Loss: 0.3420, Contrastive Loss: 0.0709
Accuracy: 0.9965, Precision: 0.9968, Recall: 0.9886, F1: 0.9926
Accuracy: 0.9927, Precision: 0.9875, Recall: 0.9826, F1: 0.9850
Epoch 7/30
Training - Loss: 58.1694
Training Metrics: {'accuracy': 0.9964709051724138, 'precision': 0.9968042674843569, 'recall': 0.9885758073363604, 'f1': 0.9926397414014119}
Validation Metrics: {'accuracy': 0.9926983786105444, 'precision': 0.9874955958028333, 'recall': 0.9826053656713976, 'f1': 0.9850321949478116}
Epoch 8/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0640
Epoch 8/30, Step 20/1,Classification Loss: 0.3292, Contrastive Loss: 0.0747
Epoch 8/30, Step 40/1,Classification Loss: 0.3245, Contrastive Loss: 0.0697
Epoch 8/30, Step 60/1,Classification Loss: 0.3149, Contrastive Loss: 0.0648
Epoch 8/30, Step 80/1,Classification Loss: 0.3436, Contrastive Loss: 0.0793
Epoch 8/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0644
Epoch 8/30, Step 120/1,Classification Loss: 0.3320, Contrastive Loss: 0.0669
Epoch 8/30, Step 140/1,Classification Loss: 0.3151, Contrastive Loss: 0.0608
Accuracy: 0.9962, Precision: 0.9967, Recall: 0.9876, F1: 0.9921
Accuracy: 0.9929, Precision: 0.9889, Recall: 0.9821, F1: 0.9854
Epoch 8/30
Training - Loss: 57.4246
Training Metrics: {'accuracy': 0.9962284482758621, 'precision': 0.996741036369452, 'recall': 0.9876011992971745, 'f1': 0.9921091071423149}
Validation Metrics: {'accuracy': 0.9929131321808226, 'precision': 0.9888540842985407, 'recall': 0.9821052100841601, 'f1': 0.9854448979638231}
Epoch 9/30, Step 0/1,Classification Loss: 0.3251, Contrastive Loss: 0.0629
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0597
Epoch 9/30, Step 40/1,Classification Loss: 0.3446, Contrastive Loss: 0.0685
Epoch 9/30, Step 60/1,Classification Loss: 0.3374, Contrastive Loss: 0.0611
Epoch 9/30, Step 80/1,Classification Loss: 0.3195, Contrastive Loss: 0.0574
Epoch 9/30, Step 100/1,Classification Loss: 0.3377, Contrastive Loss: 0.0636
Epoch 9/30, Step 120/1,Classification Loss: 0.3221, Contrastive Loss: 0.0568
Epoch 9/30, Step 140/1,Classification Loss: 0.3434, Contrastive Loss: 0.0646
Accuracy: 0.9961, Precision: 0.9947, Recall: 0.9894, F1: 0.9920
Accuracy: 0.9928, Precision: 0.9849, Recall: 0.9858, F1: 0.9853
Epoch 9/30
Training - Loss: 56.6010
Training Metrics: {'accuracy': 0.9961476293103448, 'precision': 0.9946922742290181, 'recall': 0.9894094829493449, 'f1': 0.9920300128417276}
Validation Metrics: {'accuracy': 0.9928057553956835, 'precision': 0.9848858706010819, 'recall': 0.9857952803072463, 'f1': 0.9853399410981266}
Epoch 10/30, Step 0/1,Classification Loss: 0.3146, Contrastive Loss: 0.0546
Epoch 10/30, Step 20/1,Classification Loss: 0.3141, Contrastive Loss: 0.0563
Epoch 10/30, Step 40/1,Classification Loss: 0.3286, Contrastive Loss: 0.0576
Epoch 10/30, Step 60/1,Classification Loss: 0.3310, Contrastive Loss: 0.0573
Epoch 10/30, Step 80/1,Classification Loss: 0.3163, Contrastive Loss: 0.0536
Epoch 10/30, Step 100/1,Classification Loss: 0.3351, Contrastive Loss: 0.0562
Epoch 10/30, Step 120/1,Classification Loss: 0.3325, Contrastive Loss: 0.0588
Epoch 10/30, Step 140/1,Classification Loss: 0.3313, Contrastive Loss: 0.0538
Accuracy: 0.9963, Precision: 0.9949, Recall: 0.9899, F1: 0.9924
Accuracy: 0.9929, Precision: 0.9858, Recall: 0.9852, F1: 0.9855
Epoch 10/30
Training - Loss: 55.7950
Training Metrics: {'accuracy': 0.9963362068965518, 'precision': 0.9949496785810932, 'recall': 0.989871708369995, 'f1': 0.9923914755589174}
Validation Metrics: {'accuracy': 0.9929131321808226, 'precision': 0.9858403995708926, 'recall': 0.9852324759291304, 'f1': 0.9855361546951715}
Epoch 11/30, Step 0/1,Classification Loss: 0.3448, Contrastive Loss: 0.0634
Epoch 11/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0497
Epoch 11/30, Step 40/1,Classification Loss: 0.3200, Contrastive Loss: 0.0501
Epoch 11/30, Step 60/1,Classification Loss: 0.3184, Contrastive Loss: 0.0480
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0462
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0476
Epoch 11/30, Step 120/1,Classification Loss: 0.3294, Contrastive Loss: 0.0524
Epoch 11/30, Step 140/1,Classification Loss: 0.3308, Contrastive Loss: 0.0574
Accuracy: 0.9961, Precision: 0.9946, Recall: 0.9893, F1: 0.9919
Accuracy: 0.9928, Precision: 0.9861, Recall: 0.9845, F1: 0.9853
Epoch 11/30
Training - Loss: 55.1480
Training Metrics: {'accuracy': 0.99609375, 'precision': 0.9945761599330791, 'recall': 0.9892871868054625, 'f1': 0.991910765341617}
Validation Metrics: {'accuracy': 0.9928057553956835, 'precision': 0.9860655733064136, 'recall': 0.9845443739692581, 'f1': 0.985303201391795}
Epoch 12/30, Step 0/1,Classification Loss: 0.3231, Contrastive Loss: 0.0480
Epoch 12/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0458
Epoch 12/30, Step 40/1,Classification Loss: 0.3284, Contrastive Loss: 0.0460
Epoch 12/30, Step 60/1,Classification Loss: 0.3442, Contrastive Loss: 0.0522
Epoch 12/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0490
Epoch 12/30, Step 100/1,Classification Loss: 0.3329, Contrastive Loss: 0.0552
Epoch 12/30, Step 120/1,Classification Loss: 0.3176, Contrastive Loss: 0.0447
Epoch 12/30, Step 140/1,Classification Loss: 0.3160, Contrastive Loss: 0.0451
Accuracy: 0.9961, Precision: 0.9964, Recall: 0.9874, F1: 0.9919
Accuracy: 0.9922, Precision: 0.9871, Recall: 0.9807, F1: 0.9839
Epoch 12/30
Training - Loss: 54.5054
Training Metrics: {'accuracy': 0.9961206896551724, 'precision': 0.9964294242439229, 'recall': 0.9874393216581961, 'f1': 0.9918743852636986}
Validation Metrics: {'accuracy': 0.9921614946848492, 'precision': 0.9871471396071654, 'recall': 0.9807284887945207, 'f1': 0.9839062592729709}
Epoch 13/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0441
Epoch 13/30, Step 20/1,Classification Loss: 0.3444, Contrastive Loss: 0.0491
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0416
Epoch 13/30, Step 60/1,Classification Loss: 0.3228, Contrastive Loss: 0.0425
Epoch 13/30, Step 80/1,Classification Loss: 0.3491, Contrastive Loss: 0.0654
Epoch 13/30, Step 100/1,Classification Loss: 0.3153, Contrastive Loss: 0.0423
Epoch 13/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0383
Epoch 13/30, Step 140/1,Classification Loss: 0.3284, Contrastive Loss: 0.0427
Accuracy: 0.9963, Precision: 0.9967, Recall: 0.9878, F1: 0.9922
Accuracy: 0.9927, Precision: 0.9881, Recall: 0.9820, F1: 0.9850
Epoch 13/30
Training - Loss: 54.0781
Training Metrics: {'accuracy': 0.9962553879310345, 'precision': 0.9966749209237369, 'recall': 0.9877798787294861, 'f1': 0.9921686595894127}
Validation Metrics: {'accuracy': 0.9926983786105444, 'precision': 0.988104002243622, 'recall': 0.9819799125024034, 'f1': 0.9850133025977976}
Epoch 14/30, Step 0/1,Classification Loss: 0.3262, Contrastive Loss: 0.0412
Epoch 14/30, Step 20/1,Classification Loss: 0.3438, Contrastive Loss: 0.0440
Epoch 14/30, Step 40/1,Classification Loss: 0.3593, Contrastive Loss: 0.0477
Epoch 14/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0488
Epoch 14/30, Step 80/1,Classification Loss: 0.3293, Contrastive Loss: 0.0461
Epoch 14/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0404
Epoch 14/30, Step 120/1,Classification Loss: 0.3325, Contrastive Loss: 0.0443
Epoch 14/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Accuracy: 0.9959, Precision: 0.9964, Recall: 0.9866, F1: 0.9914
Accuracy: 0.9926, Precision: 0.9890, Recall: 0.9807, F1: 0.9848
Epoch 14/30
Training - Loss: 53.6181
Training Metrics: {'accuracy': 0.9958782327586206, 'precision': 0.9963753918495297, 'recall': 0.986564149947748, 'f1': 0.9913980876148342}
Validation Metrics: {'accuracy': 0.9925910018254054, 'precision': 0.9889570199915028, 'recall': 0.980666357373537, 'f1': 0.9847592176390324}
Epoch 15/30, Step 0/1,Classification Loss: 0.3213, Contrastive Loss: 0.0367
Epoch 15/30, Step 20/1,Classification Loss: 0.3151, Contrastive Loss: 0.0360
Epoch 15/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0387
Epoch 15/30, Step 60/1,Classification Loss: 0.3435, Contrastive Loss: 0.0425
Epoch 15/30, Step 80/1,Classification Loss: 0.3313, Contrastive Loss: 0.0387
Epoch 15/30, Step 100/1,Classification Loss: 0.3341, Contrastive Loss: 0.0395
Epoch 15/30, Step 120/1,Classification Loss: 0.3162, Contrastive Loss: 0.0368
Epoch 15/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0355
Accuracy: 0.9959, Precision: 0.9944, Recall: 0.9884, F1: 0.9914
Accuracy: 0.9927, Precision: 0.9872, Recall: 0.9829, F1: 0.9850
Epoch 15/30
Training - Loss: 53.2254
Training Metrics: {'accuracy': 0.9958782327586206, 'precision': 0.9944170235947272, 'recall': 0.9884379933911267, 'f1': 0.9914008786400441}
Validation Metrics: {'accuracy': 0.9926983786105444, 'precision': 0.987193105326641, 'recall': 0.9829180922558945, 'f1': 0.9850416190323221}
Epoch 16/30, Step 0/1,Classification Loss: 0.3315, Contrastive Loss: 0.0384
Epoch 16/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0362
Epoch 16/30, Step 40/1,Classification Loss: 0.3273, Contrastive Loss: 0.0364
Epoch 16/30, Step 60/1,Classification Loss: 0.3338, Contrastive Loss: 0.0500
Epoch 16/30, Step 80/1,Classification Loss: 0.3291, Contrastive Loss: 0.0372
Epoch 16/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0323
Epoch 16/30, Step 120/1,Classification Loss: 0.3633, Contrastive Loss: 0.0430
Epoch 16/30, Step 140/1,Classification Loss: 0.3183, Contrastive Loss: 0.0339
Accuracy: 0.9960, Precision: 0.9945, Recall: 0.9890, F1: 0.9918
Accuracy: 0.9928, Precision: 0.9864, Recall: 0.9842, F1: 0.9853
Epoch 16/30
Training - Loss: 52.8870
Training Metrics: {'accuracy': 0.9960398706896552, 'precision': 0.9945190403291411, 'recall': 0.9890261928473085, 'f1': 0.991750139722801}
Validation Metrics: {'accuracy': 0.9928057553956835, 'precision': 0.9863632713220775, 'recall': 0.984231647384761, 'f1': 0.9852939807421855}
Epoch 17/30, Step 0/1,Classification Loss: 0.3181, Contrastive Loss: 0.0331
Epoch 17/30, Step 20/1,Classification Loss: 0.3594, Contrastive Loss: 0.0393
Epoch 17/30, Step 40/1,Classification Loss: 0.3317, Contrastive Loss: 0.0392
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 17/30, Step 80/1,Classification Loss: 0.3177, Contrastive Loss: 0.0307
Epoch 17/30, Step 100/1,Classification Loss: 0.3214, Contrastive Loss: 0.0308
Epoch 17/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0318
Epoch 17/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0297
Accuracy: 0.9963, Precision: 0.9948, Recall: 0.9899, F1: 0.9923
Accuracy: 0.9925, Precision: 0.9844, Recall: 0.9850, F1: 0.9847
Epoch 17/30
Training - Loss: 52.6168
Training Metrics: {'accuracy': 0.9963092672413794, 'precision': 0.9947670217705122, 'recall': 0.9899180328006725, 'f1': 0.9923250153986336}
Validation Metrics: {'accuracy': 0.9924836250402663, 'precision': 0.9843761538205706, 'recall': 0.9849818807656171, 'f1': 0.984678735473342}
Epoch 18/30, Step 0/1,Classification Loss: 0.3158, Contrastive Loss: 0.0303
Epoch 18/30, Step 20/1,Classification Loss: 0.3591, Contrastive Loss: 0.0344
Epoch 18/30, Step 40/1,Classification Loss: 0.3200, Contrastive Loss: 0.0332
Epoch 18/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0301
Epoch 18/30, Step 80/1,Classification Loss: 0.3163, Contrastive Loss: 0.0296
Epoch 18/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0262
Epoch 18/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 18/30, Step 140/1,Classification Loss: 0.3188, Contrastive Loss: 0.0286
Accuracy: 0.9960, Precision: 0.9945, Recall: 0.9889, F1: 0.9917
Accuracy: 0.9927, Precision: 0.9857, Recall: 0.9845, F1: 0.9851
Epoch 18/30
Training - Loss: 52.3181
Training Metrics: {'accuracy': 0.9959859913793103, 'precision': 0.9944986714666668, 'recall': 0.9888702786916318, 'f1': 0.9916608305663368}
Validation Metrics: {'accuracy': 0.9926983786105444, 'precision': 0.9856975805539, 'recall': 0.9844817251783797, 'f1': 0.9850885198716446}
Epoch 19/30, Step 0/1,Classification Loss: 0.3209, Contrastive Loss: 0.0285
Epoch 19/30, Step 20/1,Classification Loss: 0.3379, Contrastive Loss: 0.0321
Epoch 19/30, Step 40/1,Classification Loss: 0.3152, Contrastive Loss: 0.0276
Epoch 19/30, Step 60/1,Classification Loss: 0.3281, Contrastive Loss: 0.0309
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0268
Epoch 19/30, Step 100/1,Classification Loss: 0.3195, Contrastive Loss: 0.0273
Epoch 19/30, Step 120/1,Classification Loss: 0.3272, Contrastive Loss: 0.0289
Epoch 19/30, Step 140/1,Classification Loss: 0.3174, Contrastive Loss: 0.0269
Accuracy: 0.9960, Precision: 0.9963, Recall: 0.9869, F1: 0.9915
Accuracy: 0.9926, Precision: 0.9886, Recall: 0.9810, F1: 0.9848
Epoch 19/30
Training - Loss: 51.9629
Training Metrics: {'accuracy': 0.9959590517241379, 'precision': 0.9962520342542898, 'recall': 0.9869427962843378, 'f1': 0.9915330547323111}
Validation Metrics: {'accuracy': 0.9925910018254054, 'precision': 0.9886484811219436, 'recall': 0.9809790839580339, 'f1': 0.9847688628594666}
Epoch 20/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0319
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0247
Epoch 20/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0284
Epoch 20/30, Step 60/1,Classification Loss: 0.3152, Contrastive Loss: 0.0271
Epoch 20/30, Step 80/1,Classification Loss: 0.3449, Contrastive Loss: 0.0341
Epoch 20/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0243
Epoch 20/30, Step 120/1,Classification Loss: 0.3364, Contrastive Loss: 0.0319
Epoch 20/30, Step 140/1,Classification Loss: 0.3446, Contrastive Loss: 0.0314
Accuracy: 0.9957, Precision: 0.9964, Recall: 0.9856, F1: 0.9909
Accuracy: 0.9918, Precision: 0.9888, Recall: 0.9777, F1: 0.9832
Epoch 20/30
Training - Loss: 51.7407
Training Metrics: {'accuracy': 0.9956627155172414, 'precision': 0.9964126521857272, 'recall': 0.985633526876091, 'f1': 0.9909365430852283}
Validation Metrics: {'accuracy': 0.991839364329432, 'precision': 0.9887913723461101, 'recall': 0.9777260031614122, 'f1': 0.9831650379432892}
Epoch 21/30, Step 0/1,Classification Loss: 0.3380, Contrastive Loss: 0.0275
Epoch 21/30, Step 20/1,Classification Loss: 0.3294, Contrastive Loss: 0.0285
Epoch 21/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0244
Epoch 21/30, Step 60/1,Classification Loss: 0.3286, Contrastive Loss: 0.0257
Epoch 21/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0260
Epoch 21/30, Step 100/1,Classification Loss: 0.3203, Contrastive Loss: 0.0257
Epoch 21/30, Step 120/1,Classification Loss: 0.3197, Contrastive Loss: 0.0237
Epoch 21/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0246
Accuracy: 0.9959, Precision: 0.9943, Recall: 0.9885, F1: 0.9914
Accuracy: 0.9928, Precision: 0.9867, Recall: 0.9839, F1: 0.9853
Epoch 21/30
Training - Loss: 51.6633
Training Metrics: {'accuracy': 0.9958512931034482, 'precision': 0.9942550038189344, 'recall': 0.9885459179014604, 'f1': 0.9913761256409281}
Validation Metrics: {'accuracy': 0.9928057553956835, 'precision': 0.9866620880030499, 'recall': 0.983918920800264, 'f1': 0.9852847457391286}
Epoch 22/30, Step 0/1,Classification Loss: 0.3298, Contrastive Loss: 0.0412
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 40/1,Classification Loss: 0.3332, Contrastive Loss: 0.0250
Epoch 22/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 22/30, Step 80/1,Classification Loss: 0.3181, Contrastive Loss: 0.0228
Epoch 22/30, Step 100/1,Classification Loss: 0.3448, Contrastive Loss: 0.0557
Epoch 22/30, Step 120/1,Classification Loss: 0.3347, Contrastive Loss: 0.0257
Epoch 22/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0249
Accuracy: 0.9964, Precision: 0.9947, Recall: 0.9902, F1: 0.9924
Accuracy: 0.9933, Precision: 0.9873, Recall: 0.9855, F1: 0.9864
Epoch 22/30
Training - Loss: 51.3364
Training Metrics: {'accuracy': 0.9963631465517241, 'precision': 0.9947197381279524, 'recall': 0.9901898262643605, 'f1': 0.9924395001483064}
Validation Metrics: {'accuracy': 0.9933426393213787, 'precision': 0.9873134718729398, 'recall': 0.9854830710926439, 'f1': 0.9863957127950408}
Epoch 23/30, Step 0/1,Classification Loss: 0.3597, Contrastive Loss: 0.0884
Epoch 23/30, Step 20/1,Classification Loss: 0.3301, Contrastive Loss: 0.0285
Epoch 23/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0314
Epoch 23/30, Step 60/1,Classification Loss: 0.3291, Contrastive Loss: 0.0264
Epoch 23/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 23/30, Step 100/1,Classification Loss: 0.3428, Contrastive Loss: 0.0297
Epoch 23/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0221
Epoch 23/30, Step 140/1,Classification Loss: 0.3474, Contrastive Loss: 0.0350
Accuracy: 0.9964, Precision: 0.9948, Recall: 0.9902, F1: 0.9925
Accuracy: 0.9933, Precision: 0.9873, Recall: 0.9855, F1: 0.9864
Epoch 23/30
Training - Loss: 51.1700
Training Metrics: {'accuracy': 0.9963900862068965, 'precision': 0.9948025638592214, 'recall': 0.9901704783053942, 'f1': 0.9924705754244902}
Validation Metrics: {'accuracy': 0.9933426393213787, 'precision': 0.9873134718729398, 'recall': 0.9854830710926439, 'f1': 0.9863957127950408}
Epoch 24/30, Step 0/1,Classification Loss: 0.3323, Contrastive Loss: 0.0270
Epoch 24/30, Step 20/1,Classification Loss: 0.3194, Contrastive Loss: 0.0213
Epoch 24/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0212
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 24/30, Step 80/1,Classification Loss: 0.3230, Contrastive Loss: 0.0217
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0213
Epoch 24/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0265
Epoch 24/30, Step 140/1,Classification Loss: 0.3248, Contrastive Loss: 0.0245
Accuracy: 0.9963, Precision: 0.9945, Recall: 0.9898, F1: 0.9922
Accuracy: 0.9932, Precision: 0.9872, Recall: 0.9851, F1: 0.9862
Epoch 24/30
Training - Loss: 50.9909
Training Metrics: {'accuracy': 0.9962553879310345, 'precision': 0.9945483035973621, 'recall': 0.9898196661909058, 'f1': 0.9921673844016516}
Validation Metrics: {'accuracy': 0.9932352625362396, 'precision': 0.9872431760848821, 'recall': 0.9851076957172684, 'f1': 0.9861719520411596}
Epoch 25/30, Step 0/1,Classification Loss: 0.3295, Contrastive Loss: 0.0239
Epoch 25/30, Step 20/1,Classification Loss: 0.3350, Contrastive Loss: 0.0243
Epoch 25/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0211
Epoch 25/30, Step 60/1,Classification Loss: 0.3269, Contrastive Loss: 0.0220
Epoch 25/30, Step 80/1,Classification Loss: 0.3595, Contrastive Loss: 0.0264
Epoch 25/30, Step 100/1,Classification Loss: 0.3191, Contrastive Loss: 0.0207
Epoch 25/30, Step 120/1,Classification Loss: 0.3243, Contrastive Loss: 0.0209
Epoch 25/30, Step 140/1,Classification Loss: 0.3490, Contrastive Loss: 0.0252
Accuracy: 0.9957, Precision: 0.9945, Recall: 0.9877, F1: 0.9911
Accuracy: 0.9927, Precision: 0.9872, Recall: 0.9829, F1: 0.9850
Epoch 25/30
Training - Loss: 50.8445
Training Metrics: {'accuracy': 0.9957165948275862, 'precision': 0.9944946166923054, 'recall': 0.9877497613129841, 'f1': 0.991088219079904}
Validation Metrics: {'accuracy': 0.9926983786105444, 'precision': 0.987193105326641, 'recall': 0.9829180922558945, 'f1': 0.9850416190323221}
Epoch 26/30, Step 0/1,Classification Loss: 0.3294, Contrastive Loss: 0.0240
Epoch 26/30, Step 20/1,Classification Loss: 0.3481, Contrastive Loss: 0.0491
Epoch 26/30, Step 40/1,Classification Loss: 0.3192, Contrastive Loss: 0.0223
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Epoch 26/30, Step 80/1,Classification Loss: 0.3153, Contrastive Loss: 0.0239
Epoch 26/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0339
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 26/30, Step 140/1,Classification Loss: 0.3454, Contrastive Loss: 0.0230
Accuracy: 0.9959, Precision: 0.9944, Recall: 0.9886, F1: 0.9915
Accuracy: 0.9927, Precision: 0.9863, Recall: 0.9839, F1: 0.9851
Epoch 26/30
Training - Loss: 50.7953
Training Metrics: {'accuracy': 0.9959051724137931, 'precision': 0.9943557468672022, 'recall': 0.9886226329505334, 'f1': 0.9914646958014159}
Validation Metrics: {'accuracy': 0.9926983786105444, 'precision': 0.9862924247426315, 'recall': 0.9838562720093857, 'f1': 0.9850698033209859}
Epoch 27/30, Step 0/1,Classification Loss: 0.3596, Contrastive Loss: 0.0269
Epoch 27/30, Step 20/1,Classification Loss: 0.3170, Contrastive Loss: 0.0210
Epoch 27/30, Step 40/1,Classification Loss: 0.3335, Contrastive Loss: 0.0228
Epoch 27/30, Step 60/1,Classification Loss: 0.3167, Contrastive Loss: 0.0201
Epoch 27/30, Step 80/1,Classification Loss: 0.3234, Contrastive Loss: 0.0190
Epoch 27/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0216
Epoch 27/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0221
Epoch 27/30, Step 140/1,Classification Loss: 0.3262, Contrastive Loss: 0.0201
Accuracy: 0.9965, Precision: 0.9950, Recall: 0.9905, F1: 0.9927
Accuracy: 0.9925, Precision: 0.9838, Recall: 0.9856, F1: 0.9847
Epoch 27/30
Training - Loss: 50.8083
Training Metrics: {'accuracy': 0.9964978448275862, 'precision': 0.9949662643819072, 'recall': 0.9905221349969766, 'f1': 0.9927294885940116}
Validation Metrics: {'accuracy': 0.9924836250402663, 'precision': 0.9837934314538613, 'recall': 0.9856073339346112, 'f1': 0.9846978535542029}
Epoch 28/30, Step 0/1,Classification Loss: 0.3448, Contrastive Loss: 0.0276
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 28/30, Step 40/1,Classification Loss: 0.3285, Contrastive Loss: 0.0221
Epoch 28/30, Step 60/1,Classification Loss: 0.3600, Contrastive Loss: 0.0391
Epoch 28/30, Step 80/1,Classification Loss: 0.3198, Contrastive Loss: 0.0192
Epoch 28/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0197
Epoch 28/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0197
Epoch 28/30, Step 140/1,Classification Loss: 0.3446, Contrastive Loss: 0.0243
Accuracy: 0.9963, Precision: 0.9968, Recall: 0.9878, F1: 0.9922
Accuracy: 0.9926, Precision: 0.9890, Recall: 0.9807, F1: 0.9848
Epoch 28/30
Training - Loss: 50.6644
Training Metrics: {'accuracy': 0.9962553879310345, 'precision': 0.9967632069873942, 'recall': 0.987775497263883, 'f1': 0.9922091978119914}
Validation Metrics: {'accuracy': 0.9925910018254054, 'precision': 0.9889570199915028, 'recall': 0.980666357373537, 'f1': 0.9847592176390324}
Epoch 29/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0210
Epoch 29/30, Step 20/1,Classification Loss: 0.3200, Contrastive Loss: 0.0185
Epoch 29/30, Step 40/1,Classification Loss: 0.3173, Contrastive Loss: 0.0189
Epoch 29/30, Step 60/1,Classification Loss: 0.3633, Contrastive Loss: 0.0268
Epoch 29/30, Step 80/1,Classification Loss: 0.3365, Contrastive Loss: 0.0216
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 29/30, Step 120/1,Classification Loss: 0.3334, Contrastive Loss: 0.0217
Epoch 29/30, Step 140/1,Classification Loss: 0.3233, Contrastive Loss: 0.0190
Accuracy: 0.9949, Precision: 0.9959, Recall: 0.9830, F1: 0.9893
Accuracy: 0.9898, Precision: 0.9881, Recall: 0.9700, F1: 0.9788
Epoch 29/30
Training - Loss: 50.5989
Training Metrics: {'accuracy': 0.9948814655172413, 'precision': 0.9958764066895245, 'recall': 0.9830088899070808, 'f1': 0.9893187533347092}
Validation Metrics: {'accuracy': 0.98979920541179, 'precision': 0.9881415291961246, 'recall': 0.9699684178602861, 'f1': 0.9788009763097643}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 30/30, Step 20/1,Classification Loss: 0.3172, Contrastive Loss: 0.0183
Epoch 30/30, Step 40/1,Classification Loss: 0.3344, Contrastive Loss: 0.0237
Epoch 30/30, Step 60/1,Classification Loss: 0.3178, Contrastive Loss: 0.0196
Epoch 30/30, Step 80/1,Classification Loss: 0.3276, Contrastive Loss: 0.0200
Epoch 30/30, Step 100/1,Classification Loss: 0.3336, Contrastive Loss: 0.0202
Epoch 30/30, Step 120/1,Classification Loss: 0.3149, Contrastive Loss: 0.0209
Epoch 30/30, Step 140/1,Classification Loss: 0.3510, Contrastive Loss: 0.0269
Accuracy: 0.9963, Precision: 0.9967, Recall: 0.9877, F1: 0.9921
Accuracy: 0.9927, Precision: 0.9887, Recall: 0.9814, F1: 0.9850
Epoch 30/30
Training - Loss: 50.5047
Training Metrics: {'accuracy': 0.9962553879310345, 'precision': 0.9966717811166732, 'recall': 0.9877453175228337, 'f1': 0.9921494780353383}
Validation Metrics: {'accuracy': 0.9926983786105444, 'precision': 0.9887170098199329, 'recall': 0.9813544593334094, 'f1': 0.9849943511178342}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (654, 5814), y shape: (654,), y distribution: Counter({np.float64(0.0): 597, np.float64(1.0): 57}), env shape: (654,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8869, Precision: 0.5224, Recall: 0.5096, F1: 0.5074
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12515]))
original train data shape: torch.Size([46662]), new train data shape: torch.Size([100])
original test data shape: torch.Size([654, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46662]), new train data shape: torch.Size([46662])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12515]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3284, Contrastive Loss: 1.6221
Epoch 1/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 1.0682
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4576
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2697
Epoch 1/30, Step 80/1,Classification Loss: 0.3491, Contrastive Loss: 0.2213
Epoch 1/30, Step 100/1,Classification Loss: 0.3412, Contrastive Loss: 0.1883
Epoch 1/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.1543
Epoch 1/30, Step 140/1,Classification Loss: 0.3324, Contrastive Loss: 0.1481
Accuracy: 0.9962, Precision: 0.9961, Recall: 0.9880, F1: 0.9920
Accuracy: 0.9931, Precision: 0.9899, Recall: 0.9819, F1: 0.9859
Epoch 1/30
Training - Loss: 114.4146
Training Metrics: {'accuracy': 0.9962015086206897, 'precision': 0.9961412571812726, 'recall': 0.9879961407098402, 'f1': 0.9920195626958768}
Validation Metrics: {'accuracy': 0.9931426122361513, 'precision': 0.9899332647403469, 'recall': 0.9819457848273013, 'f1': 0.9858909591706309}
Epoch 2/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.1463
Epoch 2/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.1418
Epoch 2/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.1258
Epoch 2/30, Step 60/1,Classification Loss: 0.3417, Contrastive Loss: 0.1352
Epoch 2/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.1203
Epoch 2/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.1229
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1129
Epoch 2/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.1256
Accuracy: 0.9963, Precision: 0.9945, Recall: 0.9900, F1: 0.9922
Accuracy: 0.9928, Precision: 0.9849, Recall: 0.9858, F1: 0.9854
Epoch 2/30
Training - Loss: 66.7357
Training Metrics: {'accuracy': 0.9962823275862069, 'precision': 0.9944936426506357, 'recall': 0.9900201927778164, 'f1': 0.9922420418957362}
Validation Metrics: {'accuracy': 0.9928211721847209, 'precision': 0.9849099942641477, 'recall': 0.9858182235298153, 'f1': 0.9853634764420602}
Epoch 3/30, Step 0/1,Classification Loss: 0.3451, Contrastive Loss: 0.1224
Epoch 3/30, Step 20/1,Classification Loss: 0.3468, Contrastive Loss: 0.1163
Epoch 3/30, Step 40/1,Classification Loss: 0.3286, Contrastive Loss: 0.1042
Epoch 3/30, Step 60/1,Classification Loss: 0.3183, Contrastive Loss: 0.1048
Epoch 3/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.1122
Epoch 3/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.1062
Epoch 3/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.1013
Epoch 3/30, Step 140/1,Classification Loss: 0.3495, Contrastive Loss: 0.1086
Accuracy: 0.9961, Precision: 0.9946, Recall: 0.9894, F1: 0.9920
Accuracy: 0.9930, Precision: 0.9874, Recall: 0.9841, F1: 0.9857
Epoch 3/30
Training - Loss: 63.1998
Training Metrics: {'accuracy': 0.9961476293103448, 'precision': 0.9945712506559318, 'recall': 0.9893738424938392, 'f1': 0.9919524657822617}
Validation Metrics: {'accuracy': 0.9930354655523411, 'precision': 0.9874238834110423, 'recall': 0.9840694104754099, 'f1': 0.9857380515142581}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0902
Epoch 4/30, Step 20/1,Classification Loss: 0.3438, Contrastive Loss: 0.1011
Epoch 4/30, Step 40/1,Classification Loss: 0.3594, Contrastive Loss: 0.1086
Epoch 4/30, Step 60/1,Classification Loss: 0.3274, Contrastive Loss: 0.0940
Epoch 4/30, Step 80/1,Classification Loss: 0.3443, Contrastive Loss: 0.0940
Epoch 4/30, Step 100/1,Classification Loss: 0.3489, Contrastive Loss: 0.1026
Epoch 4/30, Step 120/1,Classification Loss: 0.3440, Contrastive Loss: 0.0894
Epoch 4/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0807
Accuracy: 0.9960, Precision: 0.9946, Recall: 0.9886, F1: 0.9916
Accuracy: 0.9928, Precision: 0.9870, Recall: 0.9836, F1: 0.9853
Epoch 4/30
Training - Loss: 61.2025
Training Metrics: {'accuracy': 0.9959590517241379, 'precision': 0.9946462542462238, 'recall': 0.9886270487046107, 'f1': 0.9916095970080402}
Validation Metrics: {'accuracy': 0.9928211721847209, 'precision': 0.9869835324891505, 'recall': 0.98363209006823, 'f1': 0.9852992223300814}
Epoch 5/30, Step 0/1,Classification Loss: 0.3303, Contrastive Loss: 0.0895
Epoch 5/30, Step 20/1,Classification Loss: 0.3247, Contrastive Loss: 0.0824
Epoch 5/30, Step 40/1,Classification Loss: 0.3448, Contrastive Loss: 0.0921
Epoch 5/30, Step 60/1,Classification Loss: 0.3453, Contrastive Loss: 0.0951
Epoch 5/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0787
Epoch 5/30, Step 100/1,Classification Loss: 0.3301, Contrastive Loss: 0.0832
Epoch 5/30, Step 120/1,Classification Loss: 0.3328, Contrastive Loss: 0.0819
Epoch 5/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0814
Accuracy: 0.9957, Precision: 0.9963, Recall: 0.9860, F1: 0.9910
Accuracy: 0.9919, Precision: 0.9885, Recall: 0.9781, F1: 0.9832
Epoch 5/30
Training - Loss: 59.9904
Training Metrics: {'accuracy': 0.9957165948275862, 'precision': 0.9962777518312668, 'recall': 0.9859585992271218, 'f1': 0.9910389300995599}
Validation Metrics: {'accuracy': 0.9918568520304296, 'precision': 0.988499698359651, 'recall': 0.9780726432633164, 'f1': 0.9832030131081799}
Epoch 6/30, Step 0/1,Classification Loss: 0.3250, Contrastive Loss: 0.0770
Epoch 6/30, Step 20/1,Classification Loss: 0.3182, Contrastive Loss: 0.0747
Epoch 6/30, Step 40/1,Classification Loss: 0.3519, Contrastive Loss: 0.0851
Epoch 6/30, Step 60/1,Classification Loss: 0.3304, Contrastive Loss: 0.0762
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0694
Epoch 6/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0665
Epoch 6/30, Step 120/1,Classification Loss: 0.3260, Contrastive Loss: 0.0702
Epoch 6/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0698
Accuracy: 0.9954, Precision: 0.9967, Recall: 0.9841, F1: 0.9903
Accuracy: 0.9917, Precision: 0.9910, Recall: 0.9752, F1: 0.9829
Epoch 6/30
Training - Loss: 58.7567
Training Metrics: {'accuracy': 0.9953663793103448, 'precision': 0.9967355617301614, 'recall': 0.9841098414493983, 'f1': 0.9903038949790139}
Validation Metrics: {'accuracy': 0.9917497053466195, 'precision': 0.9909585937462179, 'recall': 0.9751993924278015, 'f1': 0.9828895949220091}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0665
Epoch 7/30, Step 20/1,Classification Loss: 0.3275, Contrastive Loss: 0.0714
Epoch 7/30, Step 40/1,Classification Loss: 0.3332, Contrastive Loss: 0.0732
Epoch 7/30, Step 60/1,Classification Loss: 0.3284, Contrastive Loss: 0.0709
Epoch 7/30, Step 80/1,Classification Loss: 0.3355, Contrastive Loss: 0.0698
Epoch 7/30, Step 100/1,Classification Loss: 0.3292, Contrastive Loss: 0.0711
Epoch 7/30, Step 120/1,Classification Loss: 0.3291, Contrastive Loss: 0.0682
Epoch 7/30, Step 140/1,Classification Loss: 0.3303, Contrastive Loss: 0.0717
Accuracy: 0.9960, Precision: 0.9946, Recall: 0.9885, F1: 0.9915
Accuracy: 0.9927, Precision: 0.9866, Recall: 0.9836, F1: 0.9851
Epoch 7/30
Training - Loss: 57.6808
Training Metrics: {'accuracy': 0.9959590517241379, 'precision': 0.9946165330998424, 'recall': 0.9885322079173187, 'f1': 0.9915468488665664}
Validation Metrics: {'accuracy': 0.9927140255009107, 'precision': 0.9866135774745859, 'recall': 0.9835695822547533, 'f1': 0.9850844893580298}
Epoch 8/30, Step 0/1,Classification Loss: 0.3400, Contrastive Loss: 0.0660
Epoch 8/30, Step 20/1,Classification Loss: 0.3188, Contrastive Loss: 0.0610
Epoch 8/30, Step 40/1,Classification Loss: 0.3204, Contrastive Loss: 0.0584
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0578
Epoch 8/30, Step 80/1,Classification Loss: 0.3380, Contrastive Loss: 0.0937
Epoch 8/30, Step 100/1,Classification Loss: 0.3360, Contrastive Loss: 0.0640
Epoch 8/30, Step 120/1,Classification Loss: 0.3217, Contrastive Loss: 0.0585
Epoch 8/30, Step 140/1,Classification Loss: 0.3627, Contrastive Loss: 0.0677
Accuracy: 0.9963, Precision: 0.9964, Recall: 0.9883, F1: 0.9923
Accuracy: 0.9925, Precision: 0.9886, Recall: 0.9806, F1: 0.9846
Epoch 8/30
Training - Loss: 56.5417
Training Metrics: {'accuracy': 0.9963092672413794, 'precision': 0.9963747721332993, 'recall': 0.9882603753697197, 'f1': 0.9922687496719539}
Validation Metrics: {'accuracy': 0.9924997321332905, 'precision': 0.9885995598616708, 'recall': 0.9806338236057618, 'f1': 0.9845682365928775}
Epoch 9/30, Step 0/1,Classification Loss: 0.3428, Contrastive Loss: 0.0601
Epoch 9/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0602
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0521
Epoch 9/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0551
Epoch 9/30, Step 80/1,Classification Loss: 0.3281, Contrastive Loss: 0.0563
Epoch 9/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0519
Epoch 9/30, Step 120/1,Classification Loss: 0.3456, Contrastive Loss: 0.0641
Epoch 9/30, Step 140/1,Classification Loss: 0.3237, Contrastive Loss: 0.0533
Accuracy: 0.9959, Precision: 0.9946, Recall: 0.9884, F1: 0.9915
Accuracy: 0.9929, Precision: 0.9871, Recall: 0.9840, F1: 0.9855
Epoch 9/30
Training - Loss: 55.9105
Training Metrics: {'accuracy': 0.9959051724137931, 'precision': 0.9946117686984601, 'recall': 0.988429783293515, 'f1': 0.9914922419754852}
Validation Metrics: {'accuracy': 0.9929283188685311, 'precision': 0.9870536507456302, 'recall': 0.9840069026619331, 'f1': 0.9855231808474996}
Epoch 10/30, Step 0/1,Classification Loss: 0.3508, Contrastive Loss: 0.0754
Epoch 10/30, Step 20/1,Classification Loss: 0.3383, Contrastive Loss: 0.0532
Epoch 10/30, Step 40/1,Classification Loss: 0.3204, Contrastive Loss: 0.0528
Epoch 10/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0491
Epoch 10/30, Step 80/1,Classification Loss: 0.3251, Contrastive Loss: 0.0504
Epoch 10/30, Step 100/1,Classification Loss: 0.3441, Contrastive Loss: 0.0605
Epoch 10/30, Step 120/1,Classification Loss: 0.3199, Contrastive Loss: 0.0483
Epoch 10/30, Step 140/1,Classification Loss: 0.3315, Contrastive Loss: 0.0526
Accuracy: 0.9961, Precision: 0.9947, Recall: 0.9889, F1: 0.9918
Accuracy: 0.9929, Precision: 0.9871, Recall: 0.9840, F1: 0.9855
Epoch 10/30
Training - Loss: 55.2613
Training Metrics: {'accuracy': 0.9960668103448276, 'precision': 0.9946907543660299, 'recall': 0.988945645469262, 'f1': 0.9917936368596243}
Validation Metrics: {'accuracy': 0.9929283188685311, 'precision': 0.9870536507456302, 'recall': 0.9840069026619331, 'f1': 0.9855231808474996}
Epoch 11/30, Step 0/1,Classification Loss: 0.3337, Contrastive Loss: 0.0526
Epoch 11/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0454
Epoch 11/30, Step 40/1,Classification Loss: 0.3342, Contrastive Loss: 0.0586
Epoch 11/30, Step 60/1,Classification Loss: 0.3201, Contrastive Loss: 0.0478
Epoch 11/30, Step 80/1,Classification Loss: 0.3143, Contrastive Loss: 0.0487
Epoch 11/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0437
Epoch 11/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0426
Epoch 11/30, Step 140/1,Classification Loss: 0.3255, Contrastive Loss: 0.0450
Accuracy: 0.9960, Precision: 0.9963, Recall: 0.9873, F1: 0.9917
Accuracy: 0.9923, Precision: 0.9888, Recall: 0.9796, F1: 0.9841
Epoch 11/30
Training - Loss: 54.8072
Training Metrics: {'accuracy': 0.9960398706896552, 'precision': 0.9963065033819792, 'recall': 0.9872933091611156, 'f1': 0.9917394390696366}
Validation Metrics: {'accuracy': 0.9922854387656702, 'precision': 0.9887718657137814, 'recall': 0.979571893638129, 'f1': 0.9841072285744072}
Epoch 12/30, Step 0/1,Classification Loss: 0.3367, Contrastive Loss: 0.0491
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0419
Epoch 12/30, Step 40/1,Classification Loss: 0.3331, Contrastive Loss: 0.0506
Epoch 12/30, Step 60/1,Classification Loss: 0.3292, Contrastive Loss: 0.0466
Epoch 12/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0406
Epoch 12/30, Step 100/1,Classification Loss: 0.3147, Contrastive Loss: 0.0423
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0393
Epoch 12/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0421
Accuracy: 0.9959, Precision: 0.9947, Recall: 0.9884, F1: 0.9915
Accuracy: 0.9922, Precision: 0.9872, Recall: 0.9808, F1: 0.9839
Epoch 12/30
Training - Loss: 54.0922
Training Metrics: {'accuracy': 0.9959321120689655, 'precision': 0.9946906490724541, 'recall': 0.9883868266228057, 'f1': 0.9915091528183877}
Validation Metrics: {'accuracy': 0.99217829208186, 'precision': 0.9871688353373991, 'recall': 0.9807586049455583, 'f1': 0.9839322604558202}
Epoch 13/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0432
Epoch 13/30, Step 20/1,Classification Loss: 0.3359, Contrastive Loss: 0.0468
Epoch 13/30, Step 40/1,Classification Loss: 0.3140, Contrastive Loss: 0.0391
Epoch 13/30, Step 60/1,Classification Loss: 0.3291, Contrastive Loss: 0.0429
Epoch 13/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.0404
Epoch 13/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0395
Epoch 13/30, Step 120/1,Classification Loss: 0.3311, Contrastive Loss: 0.0433
Epoch 13/30, Step 140/1,Classification Loss: 0.3285, Contrastive Loss: 0.0393
Accuracy: 0.9957, Precision: 0.9965, Recall: 0.9855, F1: 0.9909
Accuracy: 0.9909, Precision: 0.9882, Recall: 0.9744, F1: 0.9811
Epoch 13/30
Training - Loss: 53.8329
Training Metrics: {'accuracy': 0.9956896551724138, 'precision': 0.9965029548932891, 'recall': 0.9855181727598121, 'f1': 0.9909211087334255}
Validation Metrics: {'accuracy': 0.9908925318761385, 'precision': 0.988201769630878, 'recall': 0.9743870251397617, 'f1': 0.9811480483410138}
Epoch 14/30, Step 0/1,Classification Loss: 0.3488, Contrastive Loss: 0.0403
Epoch 14/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0365
Epoch 14/30, Step 40/1,Classification Loss: 0.3479, Contrastive Loss: 0.0451
Epoch 14/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0365
Epoch 14/30, Step 80/1,Classification Loss: 0.3335, Contrastive Loss: 0.0388
Epoch 14/30, Step 100/1,Classification Loss: 0.3296, Contrastive Loss: 0.0412
Epoch 14/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0392
Epoch 14/30, Step 140/1,Classification Loss: 0.3586, Contrastive Loss: 0.0543
Accuracy: 0.9944, Precision: 0.9958, Recall: 0.9809, F1: 0.9882
Accuracy: 0.9897, Precision: 0.9894, Recall: 0.9684, F1: 0.9786
Epoch 14/30
Training - Loss: 53.5404
Training Metrics: {'accuracy': 0.9943965517241379, 'precision': 0.9958356011437139, 'recall': 0.9808999247544404, 'f1': 0.9882013226824369}
Validation Metrics: {'accuracy': 0.989713918354227, 'precision': 0.9893883394814871, 'recall': 0.9683902579276682, 'f1': 0.9785507857012898}
Epoch 15/30, Step 0/1,Classification Loss: 0.3371, Contrastive Loss: 0.0377
Epoch 15/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0343
Epoch 15/30, Step 40/1,Classification Loss: 0.3408, Contrastive Loss: 0.0426
Epoch 15/30, Step 60/1,Classification Loss: 0.3429, Contrastive Loss: 0.0429
Epoch 15/30, Step 80/1,Classification Loss: 0.3153, Contrastive Loss: 0.0338
Epoch 15/30, Step 100/1,Classification Loss: 0.3271, Contrastive Loss: 0.0354
Epoch 15/30, Step 120/1,Classification Loss: 0.3224, Contrastive Loss: 0.0320
Epoch 15/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0322
Accuracy: 0.9959, Precision: 0.9965, Recall: 0.9866, F1: 0.9915
Accuracy: 0.9917, Precision: 0.9887, Recall: 0.9774, F1: 0.9830
Epoch 15/30
Training - Loss: 52.9171
Training Metrics: {'accuracy': 0.9959051724137931, 'precision': 0.996476362799734, 'recall': 0.9866200015866585, 'f1': 0.9914757405938346}
Validation Metrics: {'accuracy': 0.9917497053466195, 'precision': 0.9887433592012504, 'recall': 0.9773855258893869, 'f1': 0.9829657828744776}
Epoch 16/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0392
Epoch 16/30, Step 20/1,Classification Loss: 0.3389, Contrastive Loss: 0.0375
Epoch 16/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0316
Epoch 16/30, Step 60/1,Classification Loss: 0.3593, Contrastive Loss: 0.0444
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0310
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0292
Epoch 16/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0326
Epoch 16/30, Step 140/1,Classification Loss: 0.3200, Contrastive Loss: 0.0299
Accuracy: 0.9962, Precision: 0.9947, Recall: 0.9896, F1: 0.9921
Accuracy: 0.9925, Precision: 0.9859, Recall: 0.9834, F1: 0.9847
Epoch 16/30
Training - Loss: 52.6318
Training Metrics: {'accuracy': 0.9962284482758621, 'precision': 0.9946973361760668, 'recall': 0.9895727312374338, 'f1': 0.992115527667795}
Validation Metrics: {'accuracy': 0.9924997321332905, 'precision': 0.9858753398468647, 'recall': 0.9834445666278, 'f1': 0.9846554252681561}
Epoch 17/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0302
Epoch 17/30, Step 20/1,Classification Loss: 0.3201, Contrastive Loss: 0.0297
Epoch 17/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0309
Epoch 17/30, Step 60/1,Classification Loss: 0.3197, Contrastive Loss: 0.0314
Epoch 17/30, Step 80/1,Classification Loss: 0.3219, Contrastive Loss: 0.0309
Epoch 17/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0287
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0279
Epoch 17/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0313
Accuracy: 0.9961, Precision: 0.9964, Recall: 0.9873, F1: 0.9918
Accuracy: 0.9922, Precision: 0.9893, Recall: 0.9786, F1: 0.9839
Epoch 17/30
Training - Loss: 52.2402
Training Metrics: {'accuracy': 0.99609375, 'precision': 0.9964130759072283, 'recall': 0.9873383906366816, 'f1': 0.9918146181208736}
Validation Metrics: {'accuracy': 0.99217829208186, 'precision': 0.9893259651101756, 'recall': 0.978572471483973, 'f1': 0.983860931151566}
Epoch 18/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0275
Epoch 18/30, Step 20/1,Classification Loss: 0.3189, Contrastive Loss: 0.0285
Epoch 18/30, Step 40/1,Classification Loss: 0.3366, Contrastive Loss: 0.0323
Epoch 18/30, Step 60/1,Classification Loss: 0.3148, Contrastive Loss: 0.0277
Epoch 18/30, Step 80/1,Classification Loss: 0.3283, Contrastive Loss: 0.0299
Epoch 18/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0264
Epoch 18/30, Step 120/1,Classification Loss: 0.3748, Contrastive Loss: 0.0361
Epoch 18/30, Step 140/1,Classification Loss: 0.3139, Contrastive Loss: 0.0285
Accuracy: 0.9963, Precision: 0.9947, Recall: 0.9899, F1: 0.9923
Accuracy: 0.9926, Precision: 0.9862, Recall: 0.9835, F1: 0.9849
Epoch 18/30
Training - Loss: 51.9360
Training Metrics: {'accuracy': 0.9962823275862069, 'precision': 0.994685740396448, 'recall': 0.9899417663566619, 'f1': 0.9922969532231667}
Validation Metrics: {'accuracy': 0.9926068788171006, 'precision': 0.9862441803479539, 'recall': 0.9835070744412766, 'f1': 0.9848698903894834}
Epoch 19/30, Step 0/1,Classification Loss: 0.3460, Contrastive Loss: 0.0353
Epoch 19/30, Step 20/1,Classification Loss: 0.3343, Contrastive Loss: 0.0330
Epoch 19/30, Step 40/1,Classification Loss: 0.3405, Contrastive Loss: 0.0345
Epoch 19/30, Step 60/1,Classification Loss: 0.3284, Contrastive Loss: 0.0272
Epoch 19/30, Step 80/1,Classification Loss: 0.3600, Contrastive Loss: 0.0315
Epoch 19/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0261
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0242
Epoch 19/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0311
Accuracy: 0.9963, Precision: 0.9950, Recall: 0.9898, F1: 0.9924
Accuracy: 0.9922, Precision: 0.9845, Recall: 0.9836, F1: 0.9840
Epoch 19/30
Training - Loss: 51.8620
Training Metrics: {'accuracy': 0.9963362068965518, 'precision': 0.9950247754265295, 'recall': 0.9897770811563915, 'f1': 0.9923804220629646}
Validation Metrics: {'accuracy': 0.99217829208186, 'precision': 0.984477584585822, 'recall': 0.9835693479675964, 'f1': 0.984022832531691}
Epoch 20/30, Step 0/1,Classification Loss: 0.3416, Contrastive Loss: 0.0282
Epoch 20/30, Step 20/1,Classification Loss: 0.3294, Contrastive Loss: 0.0285
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Epoch 20/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0263
Epoch 20/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0230
Epoch 20/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0423
Epoch 20/30, Step 120/1,Classification Loss: 0.3320, Contrastive Loss: 0.0315
Epoch 20/30, Step 140/1,Classification Loss: 0.3207, Contrastive Loss: 0.0289
Accuracy: 0.9961, Precision: 0.9945, Recall: 0.9893, F1: 0.9919
Accuracy: 0.9921, Precision: 0.9844, Recall: 0.9832, F1: 0.9838
Epoch 20/30
Training - Loss: 51.5580
Training Metrics: {'accuracy': 0.99609375, 'precision': 0.9944701187243465, 'recall': 0.989294546945542, 'f1': 0.9918623827197697}
Validation Metrics: {'accuracy': 0.99207114539805, 'precision': 0.984405518983013, 'recall': 0.9831945353738932, 'f1': 0.9837989001374828}
Epoch 21/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0253
Epoch 21/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0236
Epoch 21/30, Step 40/1,Classification Loss: 0.3444, Contrastive Loss: 0.0275
Epoch 21/30, Step 60/1,Classification Loss: 0.3196, Contrastive Loss: 0.0272
Epoch 21/30, Step 80/1,Classification Loss: 0.3145, Contrastive Loss: 0.0236
Epoch 21/30, Step 100/1,Classification Loss: 0.3242, Contrastive Loss: 0.0244
Epoch 21/30, Step 120/1,Classification Loss: 0.3444, Contrastive Loss: 0.0263
Epoch 21/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0464
Accuracy: 0.9963, Precision: 0.9948, Recall: 0.9899, F1: 0.9923
Accuracy: 0.9920, Precision: 0.9849, Recall: 0.9822, F1: 0.9836
Epoch 21/30
Training - Loss: 51.5781
Training Metrics: {'accuracy': 0.9962823275862069, 'precision': 0.9947652924130859, 'recall': 0.9898620303236374, 'f1': 0.9922957158653947}
Validation Metrics: {'accuracy': 0.9919639987142398, 'precision': 0.9849247921889431, 'recall': 0.9821951132197372, 'f1': 0.983554228684221}
Epoch 22/30, Step 0/1,Classification Loss: 0.3341, Contrastive Loss: 0.0266
Epoch 22/30, Step 20/1,Classification Loss: 0.3292, Contrastive Loss: 0.0237
Epoch 22/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0228
Epoch 22/30, Step 60/1,Classification Loss: 0.3443, Contrastive Loss: 0.0254
Epoch 22/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0223
Epoch 22/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0258
Epoch 22/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0223
Epoch 22/30, Step 140/1,Classification Loss: 0.3178, Contrastive Loss: 0.0230
Accuracy: 0.9958, Precision: 0.9960, Recall: 0.9867, F1: 0.9913
Accuracy: 0.9911, Precision: 0.9880, Recall: 0.9754, F1: 0.9816
Epoch 22/30
Training - Loss: 51.3396
Training Metrics: {'accuracy': 0.9958243534482759, 'precision': 0.9960221892686125, 'recall': 0.9867396944760884, 'f1': 0.9913166232612278}
Validation Metrics: {'accuracy': 0.9911068252437587, 'precision': 0.9880236289549931, 'recall': 0.9754489551073944, 'f1': 0.9816150692641008}
Epoch 23/30, Step 0/1,Classification Loss: 0.3338, Contrastive Loss: 0.0236
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 23/30, Step 40/1,Classification Loss: 0.3470, Contrastive Loss: 0.0260
Epoch 23/30, Step 60/1,Classification Loss: 0.3230, Contrastive Loss: 0.0232
Epoch 23/30, Step 80/1,Classification Loss: 0.3601, Contrastive Loss: 0.0342
Epoch 23/30, Step 100/1,Classification Loss: 0.3360, Contrastive Loss: 0.0248
Epoch 23/30, Step 120/1,Classification Loss: 0.3189, Contrastive Loss: 0.0226
Epoch 23/30, Step 140/1,Classification Loss: 0.3393, Contrastive Loss: 0.0250
Accuracy: 0.9962, Precision: 0.9949, Recall: 0.9892, F1: 0.9921
Accuracy: 0.9919, Precision: 0.9849, Recall: 0.9818, F1: 0.9833
Epoch 23/30
Training - Loss: 51.1549
Training Metrics: {'accuracy': 0.9962015086206897, 'precision': 0.9949282423964199, 'recall': 0.9892497228299906, 'f1': 0.9920650187083839}
Validation Metrics: {'accuracy': 0.9918568520304296, 'precision': 0.9848532843904082, 'recall': 0.981820300626034, 'f1': 0.983329723400151}
Epoch 24/30, Step 0/1,Classification Loss: 0.3443, Contrastive Loss: 0.0394
Epoch 24/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0215
Epoch 24/30, Step 40/1,Classification Loss: 0.3322, Contrastive Loss: 0.0248
Epoch 24/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0225
Epoch 24/30, Step 80/1,Classification Loss: 0.3248, Contrastive Loss: 0.0228
Epoch 24/30, Step 100/1,Classification Loss: 0.3258, Contrastive Loss: 0.0246
Epoch 24/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0227
Epoch 24/30, Step 140/1,Classification Loss: 0.3385, Contrastive Loss: 0.0231
Accuracy: 0.9962, Precision: 0.9945, Recall: 0.9896, F1: 0.9920
Accuracy: 0.9912, Precision: 0.9821, Recall: 0.9821, F1: 0.9821
Epoch 24/30
Training - Loss: 51.2656
Training Metrics: {'accuracy': 0.9961745689655173, 'precision': 0.9945212593116726, 'recall': 0.9895880866624316, 'f1': 0.9920365471337138}
Validation Metrics: {'accuracy': 0.9912139719275689, 'precision': 0.9820698633056268, 'recall': 0.9820698633056268, 'f1': 0.9820698633056268}
Epoch 25/30, Step 0/1,Classification Loss: 0.3443, Contrastive Loss: 0.0233
Epoch 25/30, Step 20/1,Classification Loss: 0.3304, Contrastive Loss: 0.0244
Epoch 25/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0217
Epoch 25/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0195
Epoch 25/30, Step 80/1,Classification Loss: 0.3254, Contrastive Loss: 0.0204
Epoch 25/30, Step 100/1,Classification Loss: 0.3146, Contrastive Loss: 0.0224
Epoch 25/30, Step 120/1,Classification Loss: 0.3347, Contrastive Loss: 0.0239
Epoch 25/30, Step 140/1,Classification Loss: 0.3295, Contrastive Loss: 0.0235
Accuracy: 0.9960, Precision: 0.9945, Recall: 0.9889, F1: 0.9917
Accuracy: 0.9910, Precision: 0.9828, Recall: 0.9804, F1: 0.9816
Epoch 25/30
Training - Loss: 51.0019
Training Metrics: {'accuracy': 0.9959859913793103, 'precision': 0.9945074756211219, 'recall': 0.9888961143087514, 'f1': 0.9916782639743564}
Validation Metrics: {'accuracy': 0.9909996785599485, 'precision': 0.982798704979297, 'recall': 0.9803833237775412, 'f1': 0.9815865103217872}
Epoch 26/30, Step 0/1,Classification Loss: 0.3504, Contrastive Loss: 0.0247
Epoch 26/30, Step 20/1,Classification Loss: 0.3430, Contrastive Loss: 0.0240
Epoch 26/30, Step 40/1,Classification Loss: 0.3213, Contrastive Loss: 0.0189
Epoch 26/30, Step 60/1,Classification Loss: 0.3242, Contrastive Loss: 0.0232
Epoch 26/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0206
Epoch 26/30, Step 100/1,Classification Loss: 0.3348, Contrastive Loss: 0.0255
Epoch 26/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 26/30, Step 140/1,Classification Loss: 0.3165, Contrastive Loss: 0.0211
Accuracy: 0.9961, Precision: 0.9944, Recall: 0.9896, F1: 0.9920
Accuracy: 0.9920, Precision: 0.9843, Recall: 0.9828, F1: 0.9836
Epoch 26/30
Training - Loss: 50.8652
Training Metrics: {'accuracy': 0.9961476293103448, 'precision': 0.9944450129888365, 'recall': 0.9896241391860698, 'f1': 0.9920172162941588}
Validation Metrics: {'accuracy': 0.9919639987142398, 'precision': 0.9843334540404741, 'recall': 0.98281972278019, 'f1': 0.9835748268097215}
Epoch 27/30, Step 0/1,Classification Loss: 0.3243, Contrastive Loss: 0.0218
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 27/30, Step 40/1,Classification Loss: 0.3260, Contrastive Loss: 0.0207
Epoch 27/30, Step 60/1,Classification Loss: 0.3413, Contrastive Loss: 0.0237
Epoch 27/30, Step 80/1,Classification Loss: 0.3473, Contrastive Loss: 0.0254
Epoch 27/30, Step 100/1,Classification Loss: 0.3212, Contrastive Loss: 0.0208
Epoch 27/30, Step 120/1,Classification Loss: 0.3346, Contrastive Loss: 0.0243
Epoch 27/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0204
Accuracy: 0.9964, Precision: 0.9967, Recall: 0.9881, F1: 0.9924
Accuracy: 0.9916, Precision: 0.9862, Recall: 0.9795, F1: 0.9828
Epoch 27/30
Training - Loss: 50.7845
Training Metrics: {'accuracy': 0.9963631465517241, 'precision': 0.9967365333703104, 'recall': 0.9881460863697706, 'f1': 0.9923865835102068}
Validation Metrics: {'accuracy': 0.9916425586628094, 'precision': 0.9862124499408564, 'recall': 0.9795091515374954, 'f1': 0.9828263140462178}
Epoch 28/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0212
Epoch 28/30, Step 20/1,Classification Loss: 0.3401, Contrastive Loss: 0.0216
Epoch 28/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0195
Epoch 28/30, Step 60/1,Classification Loss: 0.3306, Contrastive Loss: 0.0220
Epoch 28/30, Step 80/1,Classification Loss: 0.3143, Contrastive Loss: 0.0194
Epoch 28/30, Step 100/1,Classification Loss: 0.3179, Contrastive Loss: 0.0195
Epoch 28/30, Step 120/1,Classification Loss: 0.3202, Contrastive Loss: 0.0199
Epoch 28/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0192
Accuracy: 0.9960, Precision: 0.9964, Recall: 0.9871, F1: 0.9916
Accuracy: 0.9916, Precision: 0.9893, Recall: 0.9764, F1: 0.9827
Epoch 28/30
Training - Loss: 50.8171
Training Metrics: {'accuracy': 0.9959859913793103, 'precision': 0.9963605746324693, 'recall': 0.9870630455165067, 'f1': 0.9916473588633188}
Validation Metrics: {'accuracy': 0.9916425586628094, 'precision': 0.989303176483679, 'recall': 0.9763861037352308, 'f1': 0.982717093405101}
Epoch 29/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0187
Epoch 29/30, Step 20/1,Classification Loss: 0.3349, Contrastive Loss: 0.0236
Epoch 29/30, Step 40/1,Classification Loss: 0.3342, Contrastive Loss: 0.0224
Epoch 29/30, Step 60/1,Classification Loss: 0.3336, Contrastive Loss: 0.0214
Epoch 29/30, Step 80/1,Classification Loss: 0.3212, Contrastive Loss: 0.0191
Epoch 29/30, Step 100/1,Classification Loss: 0.3501, Contrastive Loss: 0.0263
Epoch 29/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0238
Epoch 29/30, Step 140/1,Classification Loss: 0.3138, Contrastive Loss: 0.0182
Accuracy: 0.9956, Precision: 0.9961, Recall: 0.9857, F1: 0.9908
Accuracy: 0.9911, Precision: 0.9893, Recall: 0.9742, F1: 0.9816
Epoch 29/30
Training - Loss: 50.7183
Training Metrics: {'accuracy': 0.995635775862069, 'precision': 0.9961443996221387, 'recall': 0.9857109118951224, 'f1': 0.9908467318008578}
Validation Metrics: {'accuracy': 0.9911068252437587, 'precision': 0.989284816393468, 'recall': 0.9741997359864886, 'f1': 0.9815681041750853}
Epoch 30/30, Step 0/1,Classification Loss: 0.3363, Contrastive Loss: 0.0233
Epoch 30/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.0199
Epoch 30/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0186
Epoch 30/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0190
Epoch 30/30, Step 80/1,Classification Loss: 0.3476, Contrastive Loss: 0.0220
Epoch 30/30, Step 100/1,Classification Loss: 0.3385, Contrastive Loss: 0.0224
Epoch 30/30, Step 120/1,Classification Loss: 0.3512, Contrastive Loss: 0.0392
Epoch 30/30, Step 140/1,Classification Loss: 0.3232, Contrastive Loss: 0.0194
Accuracy: 0.9956, Precision: 0.9961, Recall: 0.9855, F1: 0.9907
Accuracy: 0.9908, Precision: 0.9878, Recall: 0.9743, F1: 0.9809
Epoch 30/30
Training - Loss: 50.6223
Training Metrics: {'accuracy': 0.9955549568965517, 'precision': 0.996099740881931, 'recall': 0.9854553421093318, 'f1': 0.9906931958258285}
Validation Metrics: {'accuracy': 0.9907853851923283, 'precision': 0.9878196843130962, 'recall': 0.9743245173262849, 'f1': 0.980932341095478}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (960, 5814), y shape: (960,), y distribution: Counter({np.float64(0.0): 875, np.float64(1.0): 85}), env shape: (960,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8802, Precision: 0.5087, Recall: 0.5041, F1: 0.5005
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12615]))
original train data shape: torch.Size([46762]), new train data shape: torch.Size([100])
original test data shape: torch.Size([960, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46762]), new train data shape: torch.Size([46762])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12615]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3447, Contrastive Loss: 1.6161
Epoch 1/30, Step 20/1,Classification Loss: 0.3293, Contrastive Loss: 0.8381
Epoch 1/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.3659
Epoch 1/30, Step 60/1,Classification Loss: 0.3287, Contrastive Loss: 0.2390
Epoch 1/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.1981
Epoch 1/30, Step 100/1,Classification Loss: 0.3294, Contrastive Loss: 0.1810
Epoch 1/30, Step 120/1,Classification Loss: 0.3168, Contrastive Loss: 0.1587
Epoch 1/30, Step 140/1,Classification Loss: 0.3584, Contrastive Loss: 0.1589
Accuracy: 0.9954, Precision: 0.9940, Recall: 0.9869, F1: 0.9904
Accuracy: 0.9925, Precision: 0.9871, Recall: 0.9822, F1: 0.9846
Epoch 1/30
Training - Loss: 107.6244
Training Metrics: {'accuracy': 0.9953981164383562, 'precision': 0.9940038465631775, 'recall': 0.9869186002486737, 'f1': 0.9904236843161642}
Validation Metrics: {'accuracy': 0.9925157703410671, 'precision': 0.9870962676685944, 'recall': 0.9822232639622838, 'f1': 0.9846416037983711}
Epoch 2/30, Step 0/1,Classification Loss: 0.3443, Contrastive Loss: 0.1544
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1324
Epoch 2/30, Step 40/1,Classification Loss: 0.3373, Contrastive Loss: 0.1415
Epoch 2/30, Step 60/1,Classification Loss: 0.3506, Contrastive Loss: 0.1621
Epoch 2/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.1386
Epoch 2/30, Step 100/1,Classification Loss: 0.3308, Contrastive Loss: 0.1297
Epoch 2/30, Step 120/1,Classification Loss: 0.3388, Contrastive Loss: 0.1265
Epoch 2/30, Step 140/1,Classification Loss: 0.3483, Contrastive Loss: 0.1267
Accuracy: 0.9957, Precision: 0.9941, Recall: 0.9880, F1: 0.9910
Accuracy: 0.9929, Precision: 0.9865, Recall: 0.9847, F1: 0.9856
Epoch 2/30
Training - Loss: 67.5960
Training Metrics: {'accuracy': 0.9956924229452054, 'precision': 0.9940730544007021, 'recall': 0.9879549524123064, 'f1': 0.9909861440494361}
Validation Metrics: {'accuracy': 0.9929434406072918, 'precision': 0.9864782547169368, 'recall': 0.9846559220339413, 'f1': 0.9855645488678904}
Epoch 3/30, Step 0/1,Classification Loss: 0.3286, Contrastive Loss: 0.1113
Epoch 3/30, Step 20/1,Classification Loss: 0.3574, Contrastive Loss: 0.1214
Epoch 3/30, Step 40/1,Classification Loss: 0.3253, Contrastive Loss: 0.1130
Epoch 3/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1104
Epoch 3/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.1004
Epoch 3/30, Step 100/1,Classification Loss: 0.3450, Contrastive Loss: 0.1203
Epoch 3/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1056
Epoch 3/30, Step 140/1,Classification Loss: 0.3381, Contrastive Loss: 0.1036
Accuracy: 0.9957, Precision: 0.9963, Recall: 0.9857, F1: 0.9909
Accuracy: 0.9916, Precision: 0.9889, Recall: 0.9764, F1: 0.9825
Epoch 3/30
Training - Loss: 64.0958
Training Metrics: {'accuracy': 0.9956656678082192, 'precision': 0.9962539165188493, 'recall': 0.9857398993210154, 'f1': 0.9909147146058366}
Validation Metrics: {'accuracy': 0.9915535122420613, 'precision': 0.9889410844734747, 'recall': 0.9763599282662068, 'f1': 0.9825294653470731}
Epoch 4/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0909
Epoch 4/30, Step 20/1,Classification Loss: 0.3471, Contrastive Loss: 0.1169
Epoch 4/30, Step 40/1,Classification Loss: 0.3231, Contrastive Loss: 0.0929
Epoch 4/30, Step 60/1,Classification Loss: 0.3323, Contrastive Loss: 0.0953
Epoch 4/30, Step 80/1,Classification Loss: 0.3223, Contrastive Loss: 0.0858
Epoch 4/30, Step 100/1,Classification Loss: 0.3296, Contrastive Loss: 0.0879
Epoch 4/30, Step 120/1,Classification Loss: 0.3350, Contrastive Loss: 0.0956
Epoch 4/30, Step 140/1,Classification Loss: 0.3447, Contrastive Loss: 0.0946
Accuracy: 0.9957, Precision: 0.9958, Recall: 0.9861, F1: 0.9909
Accuracy: 0.9921, Precision: 0.9890, Recall: 0.9785, F1: 0.9837
Epoch 4/30
Training - Loss: 61.9044
Training Metrics: {'accuracy': 0.9956656678082192, 'precision': 0.995837220773561, 'recall': 0.9860744910486469, 'f1': 0.9908851203911397}
Validation Metrics: {'accuracy': 0.9920881000748423, 'precision': 0.9889658877803007, 'recall': 0.9785430697791146, 'f1': 0.9836715094283714}
Epoch 5/30, Step 0/1,Classification Loss: 0.3295, Contrastive Loss: 0.1007
Epoch 5/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0831
Epoch 5/30, Step 40/1,Classification Loss: 0.3592, Contrastive Loss: 0.1347
Epoch 5/30, Step 60/1,Classification Loss: 0.3181, Contrastive Loss: 0.0812
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0786
Epoch 5/30, Step 100/1,Classification Loss: 0.3148, Contrastive Loss: 0.0803
Epoch 5/30, Step 120/1,Classification Loss: 0.3494, Contrastive Loss: 0.0921
Epoch 5/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0794
Accuracy: 0.9956, Precision: 0.9962, Recall: 0.9854, F1: 0.9907
Accuracy: 0.9919, Precision: 0.9891, Recall: 0.9775, F1: 0.9832
Epoch 5/30
Training - Loss: 60.5237
Training Metrics: {'accuracy': 0.9955854023972602, 'precision': 0.9962039691337183, 'recall': 0.9854181365424931, 'f1': 0.990724639452853}
Validation Metrics: {'accuracy': 0.9918742649417299, 'precision': 0.9891428727192386, 'recall': 0.9774826827572247, 'f1': 0.9832089122109202}
Epoch 6/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0780
Epoch 6/30, Step 20/1,Classification Loss: 0.3179, Contrastive Loss: 0.0759
Epoch 6/30, Step 40/1,Classification Loss: 0.3260, Contrastive Loss: 0.0791
Epoch 6/30, Step 60/1,Classification Loss: 0.3142, Contrastive Loss: 0.0716
Epoch 6/30, Step 80/1,Classification Loss: 0.3366, Contrastive Loss: 0.0746
Epoch 6/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0907
Epoch 6/30, Step 120/1,Classification Loss: 0.3280, Contrastive Loss: 0.0691
Epoch 6/30, Step 140/1,Classification Loss: 0.3352, Contrastive Loss: 0.0751
Accuracy: 0.9959, Precision: 0.9963, Recall: 0.9867, F1: 0.9914
Accuracy: 0.9922, Precision: 0.9887, Recall: 0.9792, F1: 0.9839
Epoch 6/30
Training - Loss: 59.1777
Training Metrics: {'accuracy': 0.9959064640410958, 'precision': 0.9963117050358532, 'recall': 0.9866586123149192, 'f1': 0.9914159711064188}
Validation Metrics: {'accuracy': 0.9921950176413985, 'precision': 0.9887234066863189, 'recall': 0.9792292053039984, 'f1': 0.9839074575515763}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0670
Epoch 7/30, Step 20/1,Classification Loss: 0.3339, Contrastive Loss: 0.0736
Epoch 7/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0655
Epoch 7/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0793
Epoch 7/30, Step 80/1,Classification Loss: 0.3490, Contrastive Loss: 0.0762
Epoch 7/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0652
Epoch 7/30, Step 120/1,Classification Loss: 0.3210, Contrastive Loss: 0.0615
Epoch 7/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0617
Accuracy: 0.9960, Precision: 0.9964, Recall: 0.9868, F1: 0.9915
Accuracy: 0.9928, Precision: 0.9897, Recall: 0.9809, F1: 0.9852
Epoch 7/30
Training - Loss: 58.1864
Training Metrics: {'accuracy': 0.9959599743150684, 'precision': 0.9964279033872888, 'recall': 0.9868018522481503, 'f1': 0.9915460108786637}
Validation Metrics: {'accuracy': 0.9928365230407356, 'precision': 0.9897485974392461, 'recall': 0.9808509462302786, 'f1': 0.9852394712655845}
Epoch 8/30, Step 0/1,Classification Loss: 0.3393, Contrastive Loss: 0.0695
Epoch 8/30, Step 20/1,Classification Loss: 0.3165, Contrastive Loss: 0.0630
Epoch 8/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0611
Epoch 8/30, Step 60/1,Classification Loss: 0.3435, Contrastive Loss: 0.0686
Epoch 8/30, Step 80/1,Classification Loss: 0.3426, Contrastive Loss: 0.0634
Epoch 8/30, Step 100/1,Classification Loss: 0.3251, Contrastive Loss: 0.0634
Epoch 8/30, Step 120/1,Classification Loss: 0.3301, Contrastive Loss: 0.0631
Epoch 8/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0553
Accuracy: 0.9961, Precision: 0.9966, Recall: 0.9873, F1: 0.9919
Accuracy: 0.9918, Precision: 0.9872, Recall: 0.9790, F1: 0.9830
Epoch 8/30
Training - Loss: 57.4790
Training Metrics: {'accuracy': 0.9961205051369864, 'precision': 0.9966038116840972, 'recall': 0.9872940579673554, 'f1': 0.9918845572397361}
Validation Metrics: {'accuracy': 0.9917673473751737, 'precision': 0.9872185029701044, 'recall': 0.9789797354274861, 'f1': 0.9830471233902787}
Epoch 9/30, Step 0/1,Classification Loss: 0.3507, Contrastive Loss: 0.1276
Epoch 9/30, Step 20/1,Classification Loss: 0.3218, Contrastive Loss: 0.0572
Epoch 9/30, Step 40/1,Classification Loss: 0.3173, Contrastive Loss: 0.0558
Epoch 9/30, Step 60/1,Classification Loss: 0.3314, Contrastive Loss: 0.0605
Epoch 9/30, Step 80/1,Classification Loss: 0.3291, Contrastive Loss: 0.0616
Epoch 9/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0541
Epoch 9/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0570
Epoch 9/30, Step 140/1,Classification Loss: 0.3291, Contrastive Loss: 0.0570
Accuracy: 0.9957, Precision: 0.9963, Recall: 0.9860, F1: 0.9910
Accuracy: 0.9919, Precision: 0.9879, Recall: 0.9787, F1: 0.9833
Epoch 9/30
Training - Loss: 56.6329
Training Metrics: {'accuracy': 0.9957191780821918, 'precision': 0.9962870793267964, 'recall': 0.9859517721795744, 'f1': 0.9910399557597815}
Validation Metrics: {'accuracy': 0.9918742649417299, 'precision': 0.98790133425543, 'recall': 0.9787302188687362, 'f1': 0.983251419002265}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0505
Epoch 10/30, Step 20/1,Classification Loss: 0.3447, Contrastive Loss: 0.0636
Epoch 10/30, Step 40/1,Classification Loss: 0.3385, Contrastive Loss: 0.0535
Epoch 10/30, Step 60/1,Classification Loss: 0.3336, Contrastive Loss: 0.0560
Epoch 10/30, Step 80/1,Classification Loss: 0.3344, Contrastive Loss: 0.0574
Epoch 10/30, Step 100/1,Classification Loss: 0.3354, Contrastive Loss: 0.0654
Epoch 10/30, Step 120/1,Classification Loss: 0.3220, Contrastive Loss: 0.0525
Epoch 10/30, Step 140/1,Classification Loss: 0.3391, Contrastive Loss: 0.0547
Accuracy: 0.9951, Precision: 0.9959, Recall: 0.9835, F1: 0.9896
Accuracy: 0.9909, Precision: 0.9885, Recall: 0.9741, F1: 0.9812
Epoch 10/30
Training - Loss: 56.0672
Training Metrics: {'accuracy': 0.9950770547945206, 'precision': 0.9959012827661495, 'recall': 0.9835355919277762, 'f1': 0.989604900848704}
Validation Metrics: {'accuracy': 0.9909120068427243, 'precision': 0.9885376837895747, 'recall': 0.9741144192841709, 'f1': 0.9811666533412693}
Epoch 11/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0479
Epoch 11/30, Step 20/1,Classification Loss: 0.3470, Contrastive Loss: 0.0621
Epoch 11/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0461
Epoch 11/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0466
Epoch 11/30, Step 80/1,Classification Loss: 0.3364, Contrastive Loss: 0.0537
Epoch 11/30, Step 100/1,Classification Loss: 0.3652, Contrastive Loss: 0.0548
Epoch 11/30, Step 120/1,Classification Loss: 0.3233, Contrastive Loss: 0.0443
Epoch 11/30, Step 140/1,Classification Loss: 0.3255, Contrastive Loss: 0.0445
Accuracy: 0.9951, Precision: 0.9958, Recall: 0.9838, F1: 0.9897
Accuracy: 0.9908, Precision: 0.9888, Recall: 0.9734, F1: 0.9809
Epoch 11/30
Training - Loss: 55.4434
Training Metrics: {'accuracy': 0.9951038099315068, 'precision': 0.9958374315333489, 'recall': 0.9837581003310942, 'f1': 0.9896892728574785}
Validation Metrics: {'accuracy': 0.9908050892761681, 'precision': 0.9887868533381299, 'recall': 0.9734282837592869, 'f1': 0.9809268407982425}
Epoch 12/30, Step 0/1,Classification Loss: 0.3292, Contrastive Loss: 0.0484
Epoch 12/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Epoch 12/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0449
Epoch 12/30, Step 60/1,Classification Loss: 0.3594, Contrastive Loss: 0.0623
Epoch 12/30, Step 80/1,Classification Loss: 0.3383, Contrastive Loss: 0.0485
Epoch 12/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0468
Epoch 12/30, Step 120/1,Classification Loss: 0.3541, Contrastive Loss: 0.0547
Epoch 12/30, Step 140/1,Classification Loss: 0.3222, Contrastive Loss: 0.0441
Accuracy: 0.9962, Precision: 0.9964, Recall: 0.9878, F1: 0.9920
Accuracy: 0.9918, Precision: 0.9872, Recall: 0.9790, F1: 0.9830
Epoch 12/30
Training - Loss: 54.8390
Training Metrics: {'accuracy': 0.9962007705479452, 'precision': 0.9963987743694342, 'recall': 0.987751045099883, 'f1': 0.9920195169522442}
Validation Metrics: {'accuracy': 0.9917673473751737, 'precision': 0.9872185029701044, 'recall': 0.9789797354274861, 'f1': 0.9830471233902787}
Epoch 13/30, Step 0/1,Classification Loss: 0.3527, Contrastive Loss: 0.0481
Epoch 13/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0394
Epoch 13/30, Step 40/1,Classification Loss: 0.3451, Contrastive Loss: 0.0496
Epoch 13/30, Step 60/1,Classification Loss: 0.3212, Contrastive Loss: 0.0402
Epoch 13/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0422
Epoch 13/30, Step 100/1,Classification Loss: 0.3501, Contrastive Loss: 0.0435
Epoch 13/30, Step 120/1,Classification Loss: 0.3507, Contrastive Loss: 0.0457
Epoch 13/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0416
Accuracy: 0.9949, Precision: 0.9960, Recall: 0.9829, F1: 0.9893
Accuracy: 0.9898, Precision: 0.9866, Recall: 0.9716, F1: 0.9789
Epoch 13/30
Training - Loss: 54.4391
Training Metrics: {'accuracy': 0.9948897688356164, 'precision': 0.9959676942011548, 'recall': 0.9828870824459364, 'f1': 0.9892996164545839}
Validation Metrics: {'accuracy': 0.9898428311771624, 'precision': 0.9866013122893857, 'recall': 0.9716194404256224, 'f1': 0.9789375354578016}
Epoch 14/30, Step 0/1,Classification Loss: 0.3690, Contrastive Loss: 0.0481
Epoch 14/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0363
Epoch 14/30, Step 40/1,Classification Loss: 0.3142, Contrastive Loss: 0.0381
Epoch 14/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0457
Epoch 14/30, Step 80/1,Classification Loss: 0.3425, Contrastive Loss: 0.0413
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0353
Epoch 14/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0377
Epoch 14/30, Step 140/1,Classification Loss: 0.3292, Contrastive Loss: 0.0405
Accuracy: 0.9958, Precision: 0.9963, Recall: 0.9862, F1: 0.9912
Accuracy: 0.9918, Precision: 0.9878, Recall: 0.9784, F1: 0.9830
Epoch 14/30
Training - Loss: 53.8609
Training Metrics: {'accuracy': 0.9957994434931506, 'precision': 0.9963324874935833, 'recall': 0.9862169985576567, 'f1': 0.9911986936904833}
Validation Metrics: {'accuracy': 0.9917673473751737, 'precision': 0.9878328686882536, 'recall': 0.9783559673717303, 'f1': 0.9830256744037175}
Epoch 15/30, Step 0/1,Classification Loss: 0.3209, Contrastive Loss: 0.0364
Epoch 15/30, Step 20/1,Classification Loss: 0.3310, Contrastive Loss: 0.0391
Epoch 15/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0330
Epoch 15/30, Step 60/1,Classification Loss: 0.3390, Contrastive Loss: 0.0453
Epoch 15/30, Step 80/1,Classification Loss: 0.3293, Contrastive Loss: 0.0368
Epoch 15/30, Step 100/1,Classification Loss: 0.3536, Contrastive Loss: 0.0374
Epoch 15/30, Step 120/1,Classification Loss: 0.3283, Contrastive Loss: 0.0346
Epoch 15/30, Step 140/1,Classification Loss: 0.3444, Contrastive Loss: 0.0377
Accuracy: 0.9956, Precision: 0.9961, Recall: 0.9856, F1: 0.9908
Accuracy: 0.9919, Precision: 0.9882, Recall: 0.9784, F1: 0.9832
Epoch 15/30
Training - Loss: 53.4502
Training Metrics: {'accuracy': 0.9956121575342466, 'precision': 0.9961391201323575, 'recall': 0.9856127781460408, 'f1': 0.9907935878092707}
Validation Metrics: {'accuracy': 0.9918742649417299, 'precision': 0.9882099632084769, 'recall': 0.9784183348408584, 'f1': 0.9832408172349664}
Epoch 16/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0346
Epoch 16/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0330
Epoch 16/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0327
Epoch 16/30, Step 60/1,Classification Loss: 0.3298, Contrastive Loss: 0.0362
Epoch 16/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0330
Epoch 16/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0388
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 16/30, Step 140/1,Classification Loss: 0.3402, Contrastive Loss: 0.0352
Accuracy: 0.9960, Precision: 0.9962, Recall: 0.9873, F1: 0.9917
Accuracy: 0.9923, Precision: 0.9885, Recall: 0.9799, F1: 0.9841
Epoch 16/30
Training - Loss: 53.0479
Training Metrics: {'accuracy': 0.9960402397260274, 'precision': 0.9962270585317461, 'recall': 0.9872964625545899, 'f1': 0.9917025545518254}
Validation Metrics: {'accuracy': 0.9923019352079546, 'precision': 0.988482693868397, 'recall': 0.9799153408288823, 'f1': 0.9841429513584934}
Epoch 17/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Epoch 17/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0298
Epoch 17/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0306
Epoch 17/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0290
Epoch 17/30, Step 100/1,Classification Loss: 0.3340, Contrastive Loss: 0.0392
Epoch 17/30, Step 120/1,Classification Loss: 0.3637, Contrastive Loss: 0.0363
Epoch 17/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0299
Accuracy: 0.9942, Precision: 0.9956, Recall: 0.9804, F1: 0.9878
Accuracy: 0.9897, Precision: 0.9878, Recall: 0.9700, F1: 0.9787
Epoch 17/30
Training - Loss: 52.7299
Training Metrics: {'accuracy': 0.994220890410959, 'precision': 0.9955702867213729, 'recall': 0.980364565674914, 'f1': 0.9877950563321467}
Validation Metrics: {'accuracy': 0.9897359136106062, 'precision': 0.9877987083145588, 'recall': 0.9699976528171049, 'f1': 0.9786544887934925}
Epoch 18/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0317
Epoch 18/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0299
Epoch 18/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0302
Epoch 18/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0299
Epoch 18/30, Step 80/1,Classification Loss: 0.3369, Contrastive Loss: 0.0341
Epoch 18/30, Step 100/1,Classification Loss: 0.3446, Contrastive Loss: 0.0360
Epoch 18/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0328
Epoch 18/30, Step 140/1,Classification Loss: 0.3161, Contrastive Loss: 0.0276
Accuracy: 0.9962, Precision: 0.9966, Recall: 0.9875, F1: 0.9920
Accuracy: 0.9916, Precision: 0.9862, Recall: 0.9792, F1: 0.9826
Epoch 18/30
Training - Loss: 52.6031
Training Metrics: {'accuracy': 0.996174015410959, 'precision': 0.9966372637016014, 'recall': 0.9875080492942199, 'f1': 0.9920107028642231}
Validation Metrics: {'accuracy': 0.9915535122420613, 'precision': 0.9861657534869446, 'recall': 0.9791668845171078, 'f1': 0.9826287264229713}
Epoch 19/30, Step 0/1,Classification Loss: 0.3142, Contrastive Loss: 0.0270
Epoch 19/30, Step 20/1,Classification Loss: 0.3216, Contrastive Loss: 0.0285
Epoch 19/30, Step 40/1,Classification Loss: 0.3147, Contrastive Loss: 0.0272
Epoch 19/30, Step 60/1,Classification Loss: 0.3294, Contrastive Loss: 0.0307
Epoch 19/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0274
Epoch 19/30, Step 100/1,Classification Loss: 0.3292, Contrastive Loss: 0.0311
Epoch 19/30, Step 120/1,Classification Loss: 0.3449, Contrastive Loss: 0.0374
Epoch 19/30, Step 140/1,Classification Loss: 0.3532, Contrastive Loss: 0.0319
Accuracy: 0.9958, Precision: 0.9964, Recall: 0.9862, F1: 0.9912
Accuracy: 0.9916, Precision: 0.9880, Recall: 0.9773, F1: 0.9826
Epoch 19/30
Training - Loss: 52.4504
Training Metrics: {'accuracy': 0.995826198630137, 'precision': 0.9964258608548211, 'recall': 0.9861781792784077, 'f1': 0.9912241388439702}
Validation Metrics: {'accuracy': 0.9915535122420613, 'precision': 0.9880054721176305, 'recall': 0.9772955803498404, 'f1': 0.9825627078030694}
Epoch 20/30, Step 0/1,Classification Loss: 0.3294, Contrastive Loss: 0.0292
Epoch 20/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0260
Epoch 20/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0271
Epoch 20/30, Step 60/1,Classification Loss: 0.3152, Contrastive Loss: 0.0259
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0237
Epoch 20/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0239
Epoch 20/30, Step 120/1,Classification Loss: 0.3386, Contrastive Loss: 0.0287
Epoch 20/30, Step 140/1,Classification Loss: 0.3644, Contrastive Loss: 0.0354
Accuracy: 0.9957, Precision: 0.9943, Recall: 0.9879, F1: 0.9911
Accuracy: 0.9914, Precision: 0.9837, Recall: 0.9813, F1: 0.9825
Epoch 20/30
Training - Loss: 52.0571
Training Metrics: {'accuracy': 0.995745933219178, 'precision': 0.994349707901663, 'recall': 0.9879167662681749, 'f1': 0.9911024363075116}
Validation Metrics: {'accuracy': 0.9914465946755052, 'precision': 0.9837043501107232, 'recall': 0.9812877052431248, 'f1': 0.9824915303035238}
Epoch 21/30, Step 0/1,Classification Loss: 0.3357, Contrastive Loss: 0.0423
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 21/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0234
Epoch 21/30, Step 60/1,Classification Loss: 0.3625, Contrastive Loss: 0.0337
Epoch 21/30, Step 80/1,Classification Loss: 0.3157, Contrastive Loss: 0.0252
Epoch 21/30, Step 100/1,Classification Loss: 0.3147, Contrastive Loss: 0.0246
Epoch 21/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0288
Epoch 21/30, Step 140/1,Classification Loss: 0.3447, Contrastive Loss: 0.0266
Accuracy: 0.9959, Precision: 0.9964, Recall: 0.9865, F1: 0.9913
Accuracy: 0.9908, Precision: 0.9860, Recall: 0.9762, F1: 0.9810
Epoch 21/30
Training - Loss: 51.9282
Training Metrics: {'accuracy': 0.9958529537671232, 'precision': 0.9963680695612047, 'recall': 0.9864559635047516, 'f1': 0.9913388750402057}
Validation Metrics: {'accuracy': 0.9908050892761681, 'precision': 0.9859821877046038, 'recall': 0.9762352400101879, 'f1': 0.9810356616079883}
Epoch 22/30, Step 0/1,Classification Loss: 0.3354, Contrastive Loss: 0.0265
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0230
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 22/30, Step 60/1,Classification Loss: 0.3336, Contrastive Loss: 0.0259
Epoch 22/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0307
Epoch 22/30, Step 100/1,Classification Loss: 0.3372, Contrastive Loss: 0.0399
Epoch 22/30, Step 120/1,Classification Loss: 0.3265, Contrastive Loss: 0.0258
Epoch 22/30, Step 140/1,Classification Loss: 0.3404, Contrastive Loss: 0.0262
Accuracy: 0.9954, Precision: 0.9960, Recall: 0.9848, F1: 0.9903
Accuracy: 0.9903, Precision: 0.9863, Recall: 0.9737, F1: 0.9799
Epoch 22/30
Training - Loss: 52.0916
Training Metrics: {'accuracy': 0.9953981164383562, 'precision': 0.9960093308520777, 'recall': 0.9848001147117968, 'f1': 0.9903114166909655}
Validation Metrics: {'accuracy': 0.9902705014433871, 'precision': 0.9862521813378106, 'recall': 0.9737402144694023, 'f1': 0.9798757132478944}
Epoch 23/30, Step 0/1,Classification Loss: 0.3369, Contrastive Loss: 0.0245
Epoch 23/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0241
Epoch 23/30, Step 40/1,Classification Loss: 0.3363, Contrastive Loss: 0.0298
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 23/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0254
Epoch 23/30, Step 100/1,Classification Loss: 0.3202, Contrastive Loss: 0.0222
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 23/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0205
Accuracy: 0.9962, Precision: 0.9963, Recall: 0.9879, F1: 0.9921
Accuracy: 0.9914, Precision: 0.9867, Recall: 0.9782, F1: 0.9824
Epoch 23/30
Training - Loss: 51.4154
Training Metrics: {'accuracy': 0.9962275256849316, 'precision': 0.9963310003683424, 'recall': 0.9879137213838252, 'f1': 0.9920699098613467}
Validation Metrics: {'accuracy': 0.9914465946755052, 'precision': 0.986705040264719, 'recall': 0.978168864964346, 'f1': 0.9823810570649927}
Epoch 24/30, Step 0/1,Classification Loss: 0.3602, Contrastive Loss: 0.0448
Epoch 24/30, Step 20/1,Classification Loss: 0.3147, Contrastive Loss: 0.0205
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 24/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0198
Epoch 24/30, Step 100/1,Classification Loss: 0.3577, Contrastive Loss: 0.0376
Epoch 24/30, Step 120/1,Classification Loss: 0.3172, Contrastive Loss: 0.0203
Epoch 24/30, Step 140/1,Classification Loss: 0.3246, Contrastive Loss: 0.0228
Accuracy: 0.9961, Precision: 0.9962, Recall: 0.9873, F1: 0.9917
Accuracy: 0.9917, Precision: 0.9871, Recall: 0.9786, F1: 0.9828
Epoch 24/30
Training - Loss: 51.4350
Training Metrics: {'accuracy': 0.9960669948630136, 'precision': 0.9962357676842541, 'recall': 0.9873330564324551, 'f1': 0.9917257188643851}
Validation Metrics: {'accuracy': 0.9916604298086176, 'precision': 0.9871494536656384, 'recall': 0.9786054839304801, 'f1': 0.9828215306383679}
Epoch 25/30, Step 0/1,Classification Loss: 0.3221, Contrastive Loss: 0.0213
Epoch 25/30, Step 20/1,Classification Loss: 0.3145, Contrastive Loss: 0.0200
Epoch 25/30, Step 40/1,Classification Loss: 0.3565, Contrastive Loss: 0.0299
Epoch 25/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0194
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0200
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 25/30, Step 120/1,Classification Loss: 0.3529, Contrastive Loss: 0.0266
Epoch 25/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Accuracy: 0.9951, Precision: 0.9961, Recall: 0.9834, F1: 0.9896
Accuracy: 0.9908, Precision: 0.9875, Recall: 0.9747, F1: 0.9810
Epoch 25/30
Training - Loss: 51.3787
Training Metrics: {'accuracy': 0.9950502996575342, 'precision': 0.9960591245702909, 'recall': 0.9834104891409969, 'f1': 0.9896155614173838}
Validation Metrics: {'accuracy': 0.9908050892761681, 'precision': 0.9875285112327497, 'recall': 0.9746758198707985, 'f1': 0.9809753953890125}
Epoch 26/30, Step 0/1,Classification Loss: 0.3294, Contrastive Loss: 0.0234
Epoch 26/30, Step 20/1,Classification Loss: 0.3232, Contrastive Loss: 0.0224
Epoch 26/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0223
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 26/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0221
Epoch 26/30, Step 100/1,Classification Loss: 0.3278, Contrastive Loss: 0.0198
Epoch 26/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0222
Epoch 26/30, Step 140/1,Classification Loss: 0.3692, Contrastive Loss: 0.0266
Accuracy: 0.9953, Precision: 0.9963, Recall: 0.9844, F1: 0.9902
Accuracy: 0.9911, Precision: 0.9884, Recall: 0.9752, F1: 0.9816
Epoch 26/30
Training - Loss: 51.3162
Training Metrics: {'accuracy': 0.9953446061643836, 'precision': 0.996312390719146, 'recall': 0.9843552782354383, 'f1': 0.9902274580277679}
Validation Metrics: {'accuracy': 0.9911258419758366, 'precision': 0.9883578593648947, 'recall': 0.9751748063060607, 'f1': 0.9816332028775647}
Epoch 27/30, Step 0/1,Classification Loss: 0.3216, Contrastive Loss: 0.0202
Epoch 27/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0185
Epoch 27/30, Step 40/1,Classification Loss: 0.3446, Contrastive Loss: 0.0383
Epoch 27/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0232
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Epoch 27/30, Step 100/1,Classification Loss: 0.3234, Contrastive Loss: 0.0259
Epoch 27/30, Step 120/1,Classification Loss: 0.3202, Contrastive Loss: 0.0186
Epoch 27/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Accuracy: 0.9947, Precision: 0.9959, Recall: 0.9821, F1: 0.9888
Accuracy: 0.9904, Precision: 0.9869, Recall: 0.9735, F1: 0.9801
Epoch 27/30
Training - Loss: 51.1354
Training Metrics: {'accuracy': 0.9947024828767124, 'precision': 0.9958510646224847, 'recall': 0.9820775539169919, 'f1': 0.9888231304518829}
Validation Metrics: {'accuracy': 0.9903774190099434, 'precision': 0.9869432592734271, 'recall': 0.9734906979106523, 'f1': 0.980077856749715}
Epoch 28/30, Step 0/1,Classification Loss: 0.3364, Contrastive Loss: 0.0247
Epoch 28/30, Step 20/1,Classification Loss: 0.3141, Contrastive Loss: 0.0196
Epoch 28/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0195
Epoch 28/30, Step 60/1,Classification Loss: 0.3232, Contrastive Loss: 0.0219
Epoch 28/30, Step 80/1,Classification Loss: 0.3214, Contrastive Loss: 0.0209
Epoch 28/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0363
Epoch 28/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0206
Epoch 28/30, Step 140/1,Classification Loss: 0.3382, Contrastive Loss: 0.0238
Accuracy: 0.9950, Precision: 0.9958, Recall: 0.9834, F1: 0.9895
Accuracy: 0.9909, Precision: 0.9873, Recall: 0.9754, F1: 0.9812
Epoch 28/30
Training - Loss: 51.0904
Training Metrics: {'accuracy': 0.9949967893835616, 'precision': 0.9957794032629058, 'recall': 0.9834404740241806, 'f1': 0.9894964718098798}
Validation Metrics: {'accuracy': 0.9909120068427243, 'precision': 0.9872853211788873, 'recall': 0.9753619553956824, 'f1': 0.9812145303913787}
Epoch 29/30, Step 0/1,Classification Loss: 0.3177, Contrastive Loss: 0.0188
Epoch 29/30, Step 20/1,Classification Loss: 0.3379, Contrastive Loss: 0.0231
Epoch 29/30, Step 40/1,Classification Loss: 0.3195, Contrastive Loss: 0.0202
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 29/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0212
Epoch 29/30, Step 120/1,Classification Loss: 0.3181, Contrastive Loss: 0.0208
Epoch 29/30, Step 140/1,Classification Loss: 0.3667, Contrastive Loss: 0.0397
Accuracy: 0.9963, Precision: 0.9968, Recall: 0.9878, F1: 0.9922
Accuracy: 0.9916, Precision: 0.9868, Recall: 0.9785, F1: 0.9826
Epoch 29/30
Training - Loss: 51.0538
Training Metrics: {'accuracy': 0.9963077910958904, 'precision': 0.996790204467277, 'recall': 0.9878201037417994, 'f1': 0.9922455810398336}
Validation Metrics: {'accuracy': 0.9915535122420613, 'precision': 0.9867743738696148, 'recall': 0.978543116461352, 'f1': 0.9826067889328833}
Epoch 30/30, Step 0/1,Classification Loss: 0.3504, Contrastive Loss: 0.0237
Epoch 30/30, Step 20/1,Classification Loss: 0.3583, Contrastive Loss: 0.0238
Epoch 30/30, Step 40/1,Classification Loss: 0.3580, Contrastive Loss: 0.0250
Epoch 30/30, Step 60/1,Classification Loss: 0.3291, Contrastive Loss: 0.0356
Epoch 30/30, Step 80/1,Classification Loss: 0.3208, Contrastive Loss: 0.0202
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Epoch 30/30, Step 120/1,Classification Loss: 0.3481, Contrastive Loss: 0.0253
Epoch 30/30, Step 140/1,Classification Loss: 0.3138, Contrastive Loss: 0.0193
Accuracy: 0.9952, Precision: 0.9966, Recall: 0.9831, F1: 0.9897
Accuracy: 0.9904, Precision: 0.9885, Recall: 0.9719, F1: 0.9800
Epoch 30/30
Training - Loss: 51.0156
Training Metrics: {'accuracy': 0.9951573202054794, 'precision': 0.9966133348516557, 'recall': 0.983082958134534, 'f1': 0.9897127390948163}
Validation Metrics: {'accuracy': 0.9903774190099434, 'precision': 0.9885193053614847, 'recall': 0.971931277771263, 'f1': 0.9800141904779633}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (1060, 5814), y shape: (1060,), y distribution: Counter({np.float64(0.0): 967, np.float64(1.0): 93}), env shape: (1060,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9075, Precision: 0.4559, Recall: 0.4974, F1: 0.4758
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12715]))
original train data shape: torch.Size([46862]), new train data shape: torch.Size([100])
original test data shape: torch.Size([1060, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46862]), new train data shape: torch.Size([46862])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12715]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.6019
Epoch 1/30, Step 20/1,Classification Loss: 0.3635, Contrastive Loss: 1.0572
Epoch 1/30, Step 40/1,Classification Loss: 0.3193, Contrastive Loss: 0.5840
Epoch 1/30, Step 60/1,Classification Loss: 0.3602, Contrastive Loss: 0.3453
Epoch 1/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.2184
Epoch 1/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.1889
Epoch 1/30, Step 120/1,Classification Loss: 0.3280, Contrastive Loss: 0.1762
Epoch 1/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.1734
Accuracy: 0.9959, Precision: 0.9963, Recall: 0.9865, F1: 0.9913
Accuracy: 0.9921, Precision: 0.9881, Recall: 0.9795, F1: 0.9837
Epoch 1/30
Training - Loss: 118.6844
Training Metrics: {'accuracy': 0.9958529537671232, 'precision': 0.99627903222297, 'recall': 0.986454812771147, 'f1': 0.9912952822104328}
Validation Metrics: {'accuracy': 0.9921049823962446, 'precision': 0.9880587794780228, 'recall': 0.9795104657035782, 'f1': 0.9837287681680822}
Epoch 2/30, Step 0/1,Classification Loss: 0.3265, Contrastive Loss: 0.1609
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1440
Epoch 2/30, Step 40/1,Classification Loss: 0.3447, Contrastive Loss: 0.1629
Epoch 2/30, Step 60/1,Classification Loss: 0.3449, Contrastive Loss: 0.1608
Epoch 2/30, Step 80/1,Classification Loss: 0.3321, Contrastive Loss: 0.1410
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1279
Epoch 2/30, Step 120/1,Classification Loss: 0.3393, Contrastive Loss: 0.1345
Epoch 2/30, Step 140/1,Classification Loss: 0.3758, Contrastive Loss: 0.1628
Accuracy: 0.9946, Precision: 0.9954, Recall: 0.9821, F1: 0.9886
Accuracy: 0.9907, Precision: 0.9875, Recall: 0.9743, F1: 0.9808
Epoch 2/30
Training - Loss: 69.1473
Training Metrics: {'accuracy': 0.9945687071917808, 'precision': 0.9954495534568439, 'recall': 0.9820513723168576, 'f1': 0.988616275570317}
Validation Metrics: {'accuracy': 0.9907180198442335, 'precision': 0.9874825184183936, 'recall': 0.974341004368965, 'f1': 0.980779237897069}
Epoch 3/30, Step 0/1,Classification Loss: 0.3162, Contrastive Loss: 0.1200
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1161
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1126
Epoch 3/30, Step 60/1,Classification Loss: 0.3208, Contrastive Loss: 0.1150
Epoch 3/30, Step 80/1,Classification Loss: 0.3571, Contrastive Loss: 0.1198
Epoch 3/30, Step 100/1,Classification Loss: 0.3220, Contrastive Loss: 0.1084
Epoch 3/30, Step 120/1,Classification Loss: 0.3324, Contrastive Loss: 0.1102
Epoch 3/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.1042
Accuracy: 0.9956, Precision: 0.9962, Recall: 0.9855, F1: 0.9908
Accuracy: 0.9921, Precision: 0.9893, Recall: 0.9783, F1: 0.9837
Epoch 3/30
Training - Loss: 65.4218
Training Metrics: {'accuracy': 0.9956389126712328, 'precision': 0.9962270099636545, 'recall': 0.9855060500749908, 'f1': 0.9907814711760241}
Validation Metrics: {'accuracy': 0.9921049823962446, 'precision': 0.989296272463606, 'recall': 0.9782646084069788, 'f1': 0.9836875679682708}
Epoch 4/30, Step 0/1,Classification Loss: 0.3159, Contrastive Loss: 0.1042
Epoch 4/30, Step 20/1,Classification Loss: 0.3306, Contrastive Loss: 0.1063
Epoch 4/30, Step 40/1,Classification Loss: 0.3212, Contrastive Loss: 0.0979
Epoch 4/30, Step 60/1,Classification Loss: 0.3365, Contrastive Loss: 0.1097
Epoch 4/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0996
Epoch 4/30, Step 100/1,Classification Loss: 0.3791, Contrastive Loss: 0.1155
Epoch 4/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0913
Epoch 4/30, Step 140/1,Classification Loss: 0.3407, Contrastive Loss: 0.0978
Accuracy: 0.9958, Precision: 0.9963, Recall: 0.9862, F1: 0.9912
Accuracy: 0.9925, Precision: 0.9893, Recall: 0.9801, F1: 0.9846
Epoch 4/30
Training - Loss: 63.1395
Training Metrics: {'accuracy': 0.9957994434931506, 'precision': 0.9963298549774797, 'recall': 0.986185984789743, 'f1': 0.9911815298082947}
Validation Metrics: {'accuracy': 0.9925317401045557, 'precision': 0.9892549260500028, 'recall': 0.9800708410420405, 'f1': 0.9845985737290085}
Epoch 5/30, Step 0/1,Classification Loss: 0.3701, Contrastive Loss: 0.1137
Epoch 5/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0911
Epoch 5/30, Step 40/1,Classification Loss: 0.3230, Contrastive Loss: 0.0959
Epoch 5/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0861
Epoch 5/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0876
Epoch 5/30, Step 100/1,Classification Loss: 0.3443, Contrastive Loss: 0.0881
Epoch 5/30, Step 120/1,Classification Loss: 0.3187, Contrastive Loss: 0.0863
Epoch 5/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0809
Accuracy: 0.9954, Precision: 0.9961, Recall: 0.9846, F1: 0.9903
Accuracy: 0.9922, Precision: 0.9903, Recall: 0.9777, F1: 0.9839
Epoch 5/30
Training - Loss: 61.2449
Training Metrics: {'accuracy': 0.9953713613013698, 'precision': 0.99607599157248, 'recall': 0.9846210855233037, 'f1': 0.99025110834132}
Validation Metrics: {'accuracy': 0.9922116718233223, 'precision': 0.9903029450749874, 'recall': 0.9777039075122571, 'f1': 0.983882474724389}
Epoch 6/30, Step 0/1,Classification Loss: 0.3456, Contrastive Loss: 0.1002
Epoch 6/30, Step 20/1,Classification Loss: 0.3286, Contrastive Loss: 0.0826
Epoch 6/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0877
Epoch 6/30, Step 60/1,Classification Loss: 0.3608, Contrastive Loss: 0.0986
Epoch 6/30, Step 80/1,Classification Loss: 0.3185, Contrastive Loss: 0.0772
Epoch 6/30, Step 100/1,Classification Loss: 0.3444, Contrastive Loss: 0.0912
Epoch 6/30, Step 120/1,Classification Loss: 0.3194, Contrastive Loss: 0.0791
Epoch 6/30, Step 140/1,Classification Loss: 0.3223, Contrastive Loss: 0.0757
Accuracy: 0.9957, Precision: 0.9961, Recall: 0.9859, F1: 0.9909
Accuracy: 0.9920, Precision: 0.9880, Recall: 0.9791, F1: 0.9835
Epoch 6/30
Training - Loss: 60.0265
Training Metrics: {'accuracy': 0.9956924229452054, 'precision': 0.9960926853980989, 'recall': 0.9858604123500375, 'f1': 0.9908990649332534}
Validation Metrics: {'accuracy': 0.9919982929691668, 'precision': 0.9879904613360495, 'recall': 0.9791367736258503, 'f1': 0.9835036812856078}
Epoch 7/30, Step 0/1,Classification Loss: 0.3337, Contrastive Loss: 0.0868
Epoch 7/30, Step 20/1,Classification Loss: 0.3183, Contrastive Loss: 0.0740
Epoch 7/30, Step 40/1,Classification Loss: 0.3320, Contrastive Loss: 0.0771
Epoch 7/30, Step 60/1,Classification Loss: 0.3294, Contrastive Loss: 0.0742
Epoch 7/30, Step 80/1,Classification Loss: 0.3446, Contrastive Loss: 0.0970
Epoch 7/30, Step 100/1,Classification Loss: 0.3145, Contrastive Loss: 0.0692
Epoch 7/30, Step 120/1,Classification Loss: 0.3331, Contrastive Loss: 0.0722
Epoch 7/30, Step 140/1,Classification Loss: 0.3275, Contrastive Loss: 0.0687
Accuracy: 0.9952, Precision: 0.9955, Recall: 0.9842, F1: 0.9898
Accuracy: 0.9918, Precision: 0.9891, Recall: 0.9771, F1: 0.9830
Epoch 7/30
Training - Loss: 58.8196
Training Metrics: {'accuracy': 0.9951573202054794, 'precision': 0.9955298614610478, 'recall': 0.9841846641058903, 'f1': 0.9897617928214242}
Validation Metrics: {'accuracy': 0.9917849141150112, 'precision': 0.9890949059917854, 'recall': 0.9771435321737949, 'f1': 0.9830101075030827}
Epoch 8/30, Step 0/1,Classification Loss: 0.3224, Contrastive Loss: 0.0685
Epoch 8/30, Step 20/1,Classification Loss: 0.3292, Contrastive Loss: 0.0699
Epoch 8/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0680
Epoch 8/30, Step 60/1,Classification Loss: 0.3198, Contrastive Loss: 0.0651
Epoch 8/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0618
Epoch 8/30, Step 100/1,Classification Loss: 0.3446, Contrastive Loss: 0.0842
Epoch 8/30, Step 120/1,Classification Loss: 0.3139, Contrastive Loss: 0.0622
Epoch 8/30, Step 140/1,Classification Loss: 0.3443, Contrastive Loss: 0.0682
Accuracy: 0.9954, Precision: 0.9961, Recall: 0.9844, F1: 0.9901
Accuracy: 0.9920, Precision: 0.9902, Recall: 0.9770, F1: 0.9834
Epoch 8/30
Training - Loss: 58.0437
Training Metrics: {'accuracy': 0.9953713613013698, 'precision': 0.9960608184649611, 'recall': 0.9844185434857651, 'f1': 0.990139683491466}
Validation Metrics: {'accuracy': 0.9919982929691668, 'precision': 0.9901704997892173, 'recall': 0.9769565233568013, 'f1': 0.9834303774974733}
Epoch 9/30, Step 0/1,Classification Loss: 0.3592, Contrastive Loss: 0.0673
Epoch 9/30, Step 20/1,Classification Loss: 0.3261, Contrastive Loss: 0.0610
Epoch 9/30, Step 40/1,Classification Loss: 0.3162, Contrastive Loss: 0.0588
Epoch 9/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0587
Epoch 9/30, Step 80/1,Classification Loss: 0.3177, Contrastive Loss: 0.0593
Epoch 9/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0569
Epoch 9/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0560
Epoch 9/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0538
Accuracy: 0.9956, Precision: 0.9962, Recall: 0.9855, F1: 0.9907
Accuracy: 0.9920, Precision: 0.9902, Recall: 0.9770, F1: 0.9834
Epoch 9/30
Training - Loss: 57.1985
Training Metrics: {'accuracy': 0.9956121575342466, 'precision': 0.9962148572151321, 'recall': 0.9854537103615761, 'f1': 0.9907484502850068}
Validation Metrics: {'accuracy': 0.9919982929691668, 'precision': 0.9901704997892173, 'recall': 0.9769565233568013, 'f1': 0.9834303774974733}
Epoch 10/30, Step 0/1,Classification Loss: 0.3199, Contrastive Loss: 0.0575
Epoch 10/30, Step 20/1,Classification Loss: 0.3286, Contrastive Loss: 0.0569
Epoch 10/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0538
Epoch 10/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0539
Epoch 10/30, Step 80/1,Classification Loss: 0.3474, Contrastive Loss: 0.0598
Epoch 10/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0520
Epoch 10/30, Step 120/1,Classification Loss: 0.3584, Contrastive Loss: 0.0597
Epoch 10/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0524
Accuracy: 0.9956, Precision: 0.9960, Recall: 0.9856, F1: 0.9907
Accuracy: 0.9921, Precision: 0.9881, Recall: 0.9795, F1: 0.9837
Epoch 10/30
Training - Loss: 56.5336
Training Metrics: {'accuracy': 0.9956121575342466, 'precision': 0.9960480919078625, 'recall': 0.9855985020535486, 'f1': 0.9907423908793374}
Validation Metrics: {'accuracy': 0.9921049823962446, 'precision': 0.9880587794780228, 'recall': 0.9795104657035782, 'f1': 0.9837287681680822}
Epoch 11/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0534
Epoch 11/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0520
Epoch 11/30, Step 40/1,Classification Loss: 0.3540, Contrastive Loss: 0.0602
Epoch 11/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0538
Epoch 11/30, Step 80/1,Classification Loss: 0.3194, Contrastive Loss: 0.0496
Epoch 11/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0485
Epoch 11/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0473
Epoch 11/30, Step 140/1,Classification Loss: 0.3333, Contrastive Loss: 0.0509
Accuracy: 0.9956, Precision: 0.9961, Recall: 0.9854, F1: 0.9907
Accuracy: 0.9913, Precision: 0.9884, Recall: 0.9756, F1: 0.9819
Epoch 11/30
Training - Loss: 55.7835
Training Metrics: {'accuracy': 0.995558647260274, 'precision': 0.9961057758894135, 'recall': 0.9853998460859954, 'f1': 0.9906676655866733}
Validation Metrics: {'accuracy': 0.9912514669796223, 'precision': 0.9884458919321286, 'recall': 0.975586536109305, 'f1': 0.9818896332355365}
Epoch 12/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0490
Epoch 12/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0507
Epoch 12/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0487
Epoch 12/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0488
Epoch 12/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0459
Epoch 12/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0460
Epoch 12/30, Step 120/1,Classification Loss: 0.3383, Contrastive Loss: 0.0475
Epoch 12/30, Step 140/1,Classification Loss: 0.3476, Contrastive Loss: 0.0475
Accuracy: 0.9956, Precision: 0.9966, Recall: 0.9850, F1: 0.9907
Accuracy: 0.9923, Precision: 0.9879, Recall: 0.9806, F1: 0.9842
Epoch 12/30
Training - Loss: 55.1543
Training Metrics: {'accuracy': 0.9956121575342466, 'precision': 0.9966275499585961, 'recall': 0.985011282687825, 'f1': 0.9907195812242034}
Validation Metrics: {'accuracy': 0.9923183612504001, 'precision': 0.9878895429313833, 'recall': 0.9805693141831839, 'f1': 0.9841884809099481}
Epoch 13/30, Step 0/1,Classification Loss: 0.3296, Contrastive Loss: 0.0455
Epoch 13/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.0466
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0420
Epoch 13/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0423
Epoch 13/30, Step 80/1,Classification Loss: 0.3214, Contrastive Loss: 0.0425
Epoch 13/30, Step 100/1,Classification Loss: 0.3328, Contrastive Loss: 0.0436
Epoch 13/30, Step 120/1,Classification Loss: 0.3542, Contrastive Loss: 0.0506
Epoch 13/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0387
Accuracy: 0.9956, Precision: 0.9960, Recall: 0.9855, F1: 0.9907
Accuracy: 0.9918, Precision: 0.9879, Recall: 0.9784, F1: 0.9831
Epoch 13/30
Training - Loss: 54.6083
Training Metrics: {'accuracy': 0.995558647260274, 'precision': 0.9960263914581614, 'recall': 0.9855098220807776, 'f1': 0.9906858532430889}
Validation Metrics: {'accuracy': 0.9917849141150112, 'precision': 0.9878538400961767, 'recall': 0.9783893894703943, 'f1': 0.9830530785757063}
Epoch 14/30, Step 0/1,Classification Loss: 0.3490, Contrastive Loss: 0.0471
Epoch 14/30, Step 20/1,Classification Loss: 0.3286, Contrastive Loss: 0.0405
Epoch 14/30, Step 40/1,Classification Loss: 0.3475, Contrastive Loss: 0.0422
Epoch 14/30, Step 60/1,Classification Loss: 0.3135, Contrastive Loss: 0.0388
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0372
Epoch 14/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0373
Epoch 14/30, Step 120/1,Classification Loss: 0.3300, Contrastive Loss: 0.0407
Epoch 14/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0408
Accuracy: 0.9959, Precision: 0.9961, Recall: 0.9868, F1: 0.9914
Accuracy: 0.9923, Precision: 0.9885, Recall: 0.9799, F1: 0.9842
Epoch 14/30
Training - Loss: 54.1313
Training Metrics: {'accuracy': 0.9959064640410958, 'precision': 0.9961422670315022, 'recall': 0.9867668248804538, 'f1': 0.9913893973200145}
Validation Metrics: {'accuracy': 0.9923183612504001, 'precision': 0.9885024705255275, 'recall': 0.9799463855348842, 'f1': 0.9841685311905666}
Epoch 15/30, Step 0/1,Classification Loss: 0.3274, Contrastive Loss: 0.0380
Epoch 15/30, Step 20/1,Classification Loss: 0.3523, Contrastive Loss: 0.0420
Epoch 15/30, Step 40/1,Classification Loss: 0.3390, Contrastive Loss: 0.0409
Epoch 15/30, Step 60/1,Classification Loss: 0.3162, Contrastive Loss: 0.0371
Epoch 15/30, Step 80/1,Classification Loss: 0.3260, Contrastive Loss: 0.0354
Epoch 15/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0380
Epoch 15/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0355
Epoch 15/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0352
Accuracy: 0.9945, Precision: 0.9966, Recall: 0.9806, F1: 0.9884
Accuracy: 0.9907, Precision: 0.9900, Recall: 0.9718, F1: 0.9807
Epoch 15/30
Training - Loss: 53.9136
Training Metrics: {'accuracy': 0.9945151969178082, 'precision': 0.9965793011669671, 'recall': 0.9806379826826188, 'f1': 0.9884194530137338}
Validation Metrics: {'accuracy': 0.9907180198442335, 'precision': 0.9900174609789237, 'recall': 0.9718492897757662, 'f1': 0.9806809082475636}
Epoch 16/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0331
Epoch 16/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0347
Epoch 16/30, Step 40/1,Classification Loss: 0.3196, Contrastive Loss: 0.0365
Epoch 16/30, Step 60/1,Classification Loss: 0.3321, Contrastive Loss: 0.0488
Epoch 16/30, Step 80/1,Classification Loss: 0.3253, Contrastive Loss: 0.0337
Epoch 16/30, Step 100/1,Classification Loss: 0.3285, Contrastive Loss: 0.0341
Epoch 16/30, Step 120/1,Classification Loss: 0.3386, Contrastive Loss: 0.0394
Epoch 16/30, Step 140/1,Classification Loss: 0.3444, Contrastive Loss: 0.0351
Accuracy: 0.9954, Precision: 0.9969, Recall: 0.9840, F1: 0.9904
Accuracy: 0.9917, Precision: 0.9897, Recall: 0.9761, F1: 0.9828
Epoch 16/30
Training - Loss: 53.5013
Training Metrics: {'accuracy': 0.9954248715753424, 'precision': 0.996937685608692, 'recall': 0.9840492163726058, 'f1': 0.9903701037980452}
Validation Metrics: {'accuracy': 0.9916782246879334, 'precision': 0.9896560013146837, 'recall': 0.9761469114477673, 'f1': 0.9827621151423764}
Epoch 17/30, Step 0/1,Classification Loss: 0.3174, Contrastive Loss: 0.0320
Epoch 17/30, Step 20/1,Classification Loss: 0.3500, Contrastive Loss: 0.0374
Epoch 17/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0333
Epoch 17/30, Step 60/1,Classification Loss: 0.3237, Contrastive Loss: 0.0302
Epoch 17/30, Step 80/1,Classification Loss: 0.3295, Contrastive Loss: 0.0328
Epoch 17/30, Step 100/1,Classification Loss: 0.3217, Contrastive Loss: 0.0317
Epoch 17/30, Step 120/1,Classification Loss: 0.3136, Contrastive Loss: 0.0301
Epoch 17/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0292
Accuracy: 0.9960, Precision: 0.9972, Recall: 0.9861, F1: 0.9915
Accuracy: 0.9923, Precision: 0.9888, Recall: 0.9796, F1: 0.9842
Epoch 17/30
Training - Loss: 53.1675
Training Metrics: {'accuracy': 0.9959867294520548, 'precision': 0.9971792124625003, 'recall': 0.986060608958421, 'f1': 0.9915285121384314}
Validation Metrics: {'accuracy': 0.9923183612504001, 'precision': 0.9888106667728377, 'recall': 0.9796349212107345, 'f1': 0.9841585329784087}
Epoch 18/30, Step 0/1,Classification Loss: 0.3617, Contrastive Loss: 0.0374
Epoch 18/30, Step 20/1,Classification Loss: 0.3314, Contrastive Loss: 0.0327
Epoch 18/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0325
Epoch 18/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0310
Epoch 18/30, Step 80/1,Classification Loss: 0.3156, Contrastive Loss: 0.0288
Epoch 18/30, Step 100/1,Classification Loss: 0.3440, Contrastive Loss: 0.0643
Epoch 18/30, Step 120/1,Classification Loss: 0.3536, Contrastive Loss: 0.0325
Epoch 18/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0297
Accuracy: 0.9951, Precision: 0.9967, Recall: 0.9828, F1: 0.9896
Accuracy: 0.9908, Precision: 0.9901, Recall: 0.9722, F1: 0.9809
Epoch 18/30
Training - Loss: 52.8601
Training Metrics: {'accuracy': 0.9950770547945206, 'precision': 0.9966516732358848, 'recall': 0.982758429537753, 'f1': 0.9895620765810361}
Validation Metrics: {'accuracy': 0.9908247092713112, 'precision': 0.9900829613554925, 'recall': 0.9722229818534941, 'f1': 0.9809090776462099}
Epoch 19/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0291
Epoch 19/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0304
Epoch 19/30, Step 40/1,Classification Loss: 0.3325, Contrastive Loss: 0.0294
Epoch 19/30, Step 60/1,Classification Loss: 0.3155, Contrastive Loss: 0.0266
Epoch 19/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0289
Epoch 19/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0269
Epoch 19/30, Step 120/1,Classification Loss: 0.3294, Contrastive Loss: 0.0309
Epoch 19/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0270
Accuracy: 0.9957, Precision: 0.9962, Recall: 0.9858, F1: 0.9909
Accuracy: 0.9919, Precision: 0.9882, Recall: 0.9785, F1: 0.9833
Epoch 19/30
Training - Loss: 52.6360
Training Metrics: {'accuracy': 0.9957191780821918, 'precision': 0.9961841051305775, 'recall': 0.9857981878136532, 'f1': 0.9909115490634344}
Validation Metrics: {'accuracy': 0.9918916035420889, 'precision': 0.9882303662416845, 'recall': 0.9784516172239724, 'f1': 0.9832678813261374}
Epoch 20/30, Step 0/1,Classification Loss: 0.3329, Contrastive Loss: 0.0281
Epoch 20/30, Step 20/1,Classification Loss: 0.3291, Contrastive Loss: 0.0276
Epoch 20/30, Step 40/1,Classification Loss: 0.3536, Contrastive Loss: 0.0311
Epoch 20/30, Step 60/1,Classification Loss: 0.3481, Contrastive Loss: 0.0339
Epoch 20/30, Step 80/1,Classification Loss: 0.3359, Contrastive Loss: 0.0296
Epoch 20/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0281
Epoch 20/30, Step 120/1,Classification Loss: 0.3357, Contrastive Loss: 0.0301
Epoch 20/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0260
Accuracy: 0.9949, Precision: 0.9958, Recall: 0.9829, F1: 0.9892
Accuracy: 0.9913, Precision: 0.9888, Recall: 0.9753, F1: 0.9819
Epoch 20/30
Training - Loss: 52.4529
Training Metrics: {'accuracy': 0.9948897688356164, 'precision': 0.9957930040877682, 'recall': 0.9828859380610773, 'f1': 0.9892156230116076}
Validation Metrics: {'accuracy': 0.9912514669796223, 'precision': 0.9887594260923764, 'recall': 0.9752750717851552, 'f1': 0.9818781210471138}
Epoch 21/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0258
Epoch 21/30, Step 20/1,Classification Loss: 0.3150, Contrastive Loss: 0.0243
Epoch 21/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0258
Epoch 21/30, Step 60/1,Classification Loss: 0.3335, Contrastive Loss: 0.0279
Epoch 21/30, Step 80/1,Classification Loss: 0.3159, Contrastive Loss: 0.0249
Epoch 21/30, Step 100/1,Classification Loss: 0.3449, Contrastive Loss: 0.0301
Epoch 21/30, Step 120/1,Classification Loss: 0.3403, Contrastive Loss: 0.0290
Epoch 21/30, Step 140/1,Classification Loss: 0.3287, Contrastive Loss: 0.0254
Accuracy: 0.9958, Precision: 0.9962, Recall: 0.9861, F1: 0.9911
Accuracy: 0.9920, Precision: 0.9883, Recall: 0.9788, F1: 0.9835
Epoch 21/30
Training - Loss: 52.2961
Training Metrics: {'accuracy': 0.9957726883561644, 'precision': 0.9962236264028895, 'recall': 0.9860791704507056, 'f1': 0.9910752367974316}
Validation Metrics: {'accuracy': 0.9919982929691668, 'precision': 0.9882983841608186, 'recall': 0.9788253093017004, 'f1': 0.9834932583529608}
Epoch 22/30, Step 0/1,Classification Loss: 0.3175, Contrastive Loss: 0.0241
Epoch 22/30, Step 20/1,Classification Loss: 0.3294, Contrastive Loss: 0.0715
Epoch 22/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0400
Epoch 22/30, Step 60/1,Classification Loss: 0.3460, Contrastive Loss: 0.0290
Epoch 22/30, Step 80/1,Classification Loss: 0.3295, Contrastive Loss: 0.0257
Epoch 22/30, Step 100/1,Classification Loss: 0.3455, Contrastive Loss: 0.0292
Epoch 22/30, Step 120/1,Classification Loss: 0.3216, Contrastive Loss: 0.0232
Epoch 22/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0229
Accuracy: 0.9957, Precision: 0.9962, Recall: 0.9856, F1: 0.9909
Accuracy: 0.9919, Precision: 0.9882, Recall: 0.9785, F1: 0.9833
Epoch 22/30
Training - Loss: 51.9984
Training Metrics: {'accuracy': 0.9956656678082192, 'precision': 0.9962449263010391, 'recall': 0.9856295801528121, 'f1': 0.9908537906723188}
Validation Metrics: {'accuracy': 0.9918916035420889, 'precision': 0.9882303662416845, 'recall': 0.9784516172239724, 'f1': 0.9832678813261374}
Epoch 23/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0216
Epoch 23/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0242
Epoch 23/30, Step 40/1,Classification Loss: 0.3570, Contrastive Loss: 0.0268
Epoch 23/30, Step 60/1,Classification Loss: 0.3293, Contrastive Loss: 0.0253
Epoch 23/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0239
Epoch 23/30, Step 100/1,Classification Loss: 0.3705, Contrastive Loss: 0.0283
Epoch 23/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0216
Epoch 23/30, Step 140/1,Classification Loss: 0.3177, Contrastive Loss: 0.0218
Accuracy: 0.9957, Precision: 0.9960, Recall: 0.9862, F1: 0.9910
Accuracy: 0.9921, Precision: 0.9890, Recall: 0.9786, F1: 0.9837
Epoch 23/30
Training - Loss: 51.7911
Training Metrics: {'accuracy': 0.9957191780821918, 'precision': 0.9959544553681965, 'recall': 0.9862168406918514, 'f1': 0.9910152150707652}
Validation Metrics: {'accuracy': 0.9921049823962446, 'precision': 0.988985148797146, 'recall': 0.9785760727311287, 'f1': 0.9836978921642179}
Epoch 24/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0253
Epoch 24/30, Step 20/1,Classification Loss: 0.3279, Contrastive Loss: 0.0212
Epoch 24/30, Step 40/1,Classification Loss: 0.3369, Contrastive Loss: 0.0259
Epoch 24/30, Step 60/1,Classification Loss: 0.3185, Contrastive Loss: 0.0229
Epoch 24/30, Step 80/1,Classification Loss: 0.3349, Contrastive Loss: 0.0259
Epoch 24/30, Step 100/1,Classification Loss: 0.3359, Contrastive Loss: 0.0236
Epoch 24/30, Step 120/1,Classification Loss: 0.3454, Contrastive Loss: 0.0274
Epoch 24/30, Step 140/1,Classification Loss: 0.3550, Contrastive Loss: 0.0301
Accuracy: 0.9960, Precision: 0.9961, Recall: 0.9872, F1: 0.9916
Accuracy: 0.9918, Precision: 0.9879, Recall: 0.9784, F1: 0.9831
Epoch 24/30
Training - Loss: 51.6153
Training Metrics: {'accuracy': 0.996013484589041, 'precision': 0.9961242825034482, 'recall': 0.987238183842361, 'f1': 0.991622704671023}
Validation Metrics: {'accuracy': 0.9917849141150112, 'precision': 0.9878538400961767, 'recall': 0.9783893894703943, 'f1': 0.9830530785757063}
Epoch 25/30, Step 0/1,Classification Loss: 0.3139, Contrastive Loss: 0.0214
Epoch 25/30, Step 20/1,Classification Loss: 0.3153, Contrastive Loss: 0.0221
Epoch 25/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0206
Epoch 25/30, Step 60/1,Classification Loss: 0.3331, Contrastive Loss: 0.0237
Epoch 25/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0252
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 25/30, Step 120/1,Classification Loss: 0.3160, Contrastive Loss: 0.0204
Epoch 25/30, Step 140/1,Classification Loss: 0.3147, Contrastive Loss: 0.0201
Accuracy: 0.9960, Precision: 0.9960, Recall: 0.9871, F1: 0.9915
Accuracy: 0.9915, Precision: 0.9864, Recall: 0.9785, F1: 0.9824
Epoch 25/30
Training - Loss: 51.4068
Training Metrics: {'accuracy': 0.9959599743150684, 'precision': 0.9960111291483208, 'recall': 0.9871291410965854, 'f1': 0.9915116397417019}
Validation Metrics: {'accuracy': 0.9914648458337779, 'precision': 0.9864229325327306, 'recall': 0.97851417053381, 'f1': 0.9824205709141378}
Epoch 26/30, Step 0/1,Classification Loss: 0.3189, Contrastive Loss: 0.0205
Epoch 26/30, Step 20/1,Classification Loss: 0.3362, Contrastive Loss: 0.0225
Epoch 26/30, Step 40/1,Classification Loss: 0.3231, Contrastive Loss: 0.0201
Epoch 26/30, Step 60/1,Classification Loss: 0.3297, Contrastive Loss: 0.0232
Epoch 26/30, Step 80/1,Classification Loss: 0.3169, Contrastive Loss: 0.0228
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 26/30, Step 120/1,Classification Loss: 0.3437, Contrastive Loss: 0.0259
Epoch 26/30, Step 140/1,Classification Loss: 0.3322, Contrastive Loss: 0.0213
Accuracy: 0.9956, Precision: 0.9959, Recall: 0.9855, F1: 0.9907
Accuracy: 0.9918, Precision: 0.9882, Recall: 0.9781, F1: 0.9830
Epoch 26/30
Training - Loss: 51.7043
Training Metrics: {'accuracy': 0.995558647260274, 'precision': 0.9959384282806547, 'recall': 0.9855303209466585, 'f1': 0.9906539675194426}
Validation Metrics: {'accuracy': 0.9917849141150112, 'precision': 0.9881623537099407, 'recall': 0.9780779251462445, 'f1': 0.9830423609797776}
Epoch 27/30, Step 0/1,Classification Loss: 0.3386, Contrastive Loss: 0.0231
Epoch 27/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0197
Epoch 27/30, Step 40/1,Classification Loss: 0.3138, Contrastive Loss: 0.0202
Epoch 27/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0191
Epoch 27/30, Step 80/1,Classification Loss: 0.3143, Contrastive Loss: 0.0197
Epoch 27/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0193
Epoch 27/30, Step 120/1,Classification Loss: 0.3341, Contrastive Loss: 0.0219
Epoch 27/30, Step 140/1,Classification Loss: 0.3149, Contrastive Loss: 0.0199
Accuracy: 0.9961, Precision: 0.9965, Recall: 0.9871, F1: 0.9917
Accuracy: 0.9920, Precision: 0.9880, Recall: 0.9791, F1: 0.9835
Epoch 27/30
Training - Loss: 51.4203
Training Metrics: {'accuracy': 0.9960669948630136, 'precision': 0.9964813872803086, 'recall': 0.9870818958472987, 'f1': 0.9917162596888673}
Validation Metrics: {'accuracy': 0.9919982929691668, 'precision': 0.9879904613360495, 'recall': 0.9791367736258503, 'f1': 0.9835036812856078}
Epoch 28/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0240
Epoch 28/30, Step 20/1,Classification Loss: 0.3446, Contrastive Loss: 0.0227
Epoch 28/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0201
Epoch 28/30, Step 60/1,Classification Loss: 0.3434, Contrastive Loss: 0.0227
Epoch 28/30, Step 80/1,Classification Loss: 0.3139, Contrastive Loss: 0.0184
Epoch 28/30, Step 100/1,Classification Loss: 0.3342, Contrastive Loss: 0.0218
Epoch 28/30, Step 120/1,Classification Loss: 0.3310, Contrastive Loss: 0.0210
Epoch 28/30, Step 140/1,Classification Loss: 0.3169, Contrastive Loss: 0.0206
Accuracy: 0.9957, Precision: 0.9961, Recall: 0.9859, F1: 0.9909
Accuracy: 0.9915, Precision: 0.9873, Recall: 0.9776, F1: 0.9824
Epoch 28/30
Training - Loss: 51.2955
Training Metrics: {'accuracy': 0.9956924229452054, 'precision': 0.9960992125477164, 'recall': 0.9859267371188822, 'f1': 0.9909362138589828}
Validation Metrics: {'accuracy': 0.9914648458337779, 'precision': 0.9873407076378515, 'recall': 0.9775797775613604, 'f1': 0.9823872435011973}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 29/30, Step 20/1,Classification Loss: 0.3754, Contrastive Loss: 0.0465
Epoch 29/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0286
Epoch 29/30, Step 60/1,Classification Loss: 0.3198, Contrastive Loss: 0.0182
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0177
Epoch 29/30, Step 100/1,Classification Loss: 0.3151, Contrastive Loss: 0.0184
Epoch 29/30, Step 120/1,Classification Loss: 0.3319, Contrastive Loss: 0.0215
Epoch 29/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0199
Accuracy: 0.9959, Precision: 0.9962, Recall: 0.9867, F1: 0.9914
Accuracy: 0.9916, Precision: 0.9865, Recall: 0.9789, F1: 0.9826
Epoch 29/30
Training - Loss: 51.2201
Training Metrics: {'accuracy': 0.9959064640410958, 'precision': 0.9962283321493469, 'recall': 0.9867237505497992, 'f1': 0.9914089975338933}
Validation Metrics: {'accuracy': 0.9915715352608556, 'precision': 0.9864923961378769, 'recall': 0.9788878626115378, 'f1': 0.9826457839621383}
Epoch 30/30, Step 0/1,Classification Loss: 0.3394, Contrastive Loss: 0.0212
Epoch 30/30, Step 20/1,Classification Loss: 0.3285, Contrastive Loss: 0.0193
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 30/30, Step 60/1,Classification Loss: 0.3444, Contrastive Loss: 0.0203
Epoch 30/30, Step 80/1,Classification Loss: 0.3475, Contrastive Loss: 0.0391
Epoch 30/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0197
Epoch 30/30, Step 120/1,Classification Loss: 0.3143, Contrastive Loss: 0.0185
Epoch 30/30, Step 140/1,Classification Loss: 0.3273, Contrastive Loss: 0.0191
Accuracy: 0.9960, Precision: 0.9961, Recall: 0.9870, F1: 0.9915
Accuracy: 0.9925, Precision: 0.9883, Recall: 0.9810, F1: 0.9846
Epoch 30/30
Training - Loss: 51.1072
Training Metrics: {'accuracy': 0.9959599743150684, 'precision': 0.9960896688782054, 'recall': 0.9870221602889082, 'f1': 0.9914950193668913}
Validation Metrics: {'accuracy': 0.9925317401045557, 'precision': 0.9883321028722154, 'recall': 0.9810052340144901, 'f1': 0.9846276897735606}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (991, 5814), y shape: (991,), y distribution: Counter({np.float64(0.0): 901, np.float64(1.0): 90}), env shape: (991,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9072, Precision: 0.4545, Recall: 0.4989, F1: 0.4757
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12815]))
original train data shape: torch.Size([46962]), new train data shape: torch.Size([100])
original test data shape: torch.Size([991, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([46962]), new train data shape: torch.Size([46962])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12815]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3519, Contrastive Loss: 1.6073
Epoch 1/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 1.1710
Epoch 1/30, Step 40/1,Classification Loss: 0.3472, Contrastive Loss: 0.7566
Epoch 1/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.3761
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2500
Epoch 1/30, Step 100/1,Classification Loss: 0.3244, Contrastive Loss: 0.2171
Epoch 1/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1815
Epoch 1/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.1855
Accuracy: 0.9946, Precision: 0.9954, Recall: 0.9822, F1: 0.9887
Accuracy: 0.9914, Precision: 0.9882, Recall: 0.9763, F1: 0.9822
Epoch 1/30
Training - Loss: 127.1344
Training Metrics: {'accuracy': 0.9946222174657534, 'precision': 0.9953894010124917, 'recall': 0.9822014208951733, 'f1': 0.9886658459056948}
Validation Metrics: {'accuracy': 0.9913765570105397, 'precision': 0.9882219198661967, 'recall': 0.976308078383693, 'f1': 0.9821563830906229}
Epoch 2/30, Step 0/1,Classification Loss: 0.3292, Contrastive Loss: 0.1743
Epoch 2/30, Step 20/1,Classification Loss: 0.3598, Contrastive Loss: 0.1873
Epoch 2/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.1538
Epoch 2/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.1379
Epoch 2/30, Step 80/1,Classification Loss: 0.3473, Contrastive Loss: 0.1509
Epoch 2/30, Step 100/1,Classification Loss: 0.3312, Contrastive Loss: 0.1498
Epoch 2/30, Step 120/1,Classification Loss: 0.3161, Contrastive Loss: 0.1277
Epoch 2/30, Step 140/1,Classification Loss: 0.3440, Contrastive Loss: 0.1390
Accuracy: 0.9955, Precision: 0.9959, Recall: 0.9851, F1: 0.9904
Accuracy: 0.9923, Precision: 0.9885, Recall: 0.9800, F1: 0.9842
Epoch 2/30
Training - Loss: 70.3192
Training Metrics: {'accuracy': 0.9954516267123288, 'precision': 0.995871515324904, 'recall': 0.9851077052153768, 'f1': 0.9904036978627277}
Validation Metrics: {'accuracy': 0.9923347173427021, 'precision': 0.9885221771333541, 'recall': 0.979977333004665, 'f1': 0.9841940266108447}
Epoch 3/30, Step 0/1,Classification Loss: 0.3186, Contrastive Loss: 0.1262
Epoch 3/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.1196
Epoch 3/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.1232
Epoch 3/30, Step 60/1,Classification Loss: 0.3317, Contrastive Loss: 0.1215
Epoch 3/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.1091
Epoch 3/30, Step 100/1,Classification Loss: 0.3724, Contrastive Loss: 0.1474
Epoch 3/30, Step 120/1,Classification Loss: 0.3618, Contrastive Loss: 0.1337
Epoch 3/30, Step 140/1,Classification Loss: 0.3173, Contrastive Loss: 0.1055
Accuracy: 0.9955, Precision: 0.9960, Recall: 0.9848, F1: 0.9903
Accuracy: 0.9925, Precision: 0.9893, Recall: 0.9801, F1: 0.9846
Epoch 3/30
Training - Loss: 66.2372
Training Metrics: {'accuracy': 0.9954516267123288, 'precision': 0.9960278173904364, 'recall': 0.9848378432588203, 'f1': 0.990340328057657}
Validation Metrics: {'accuracy': 0.9925476418609603, 'precision': 0.9892735011658622, 'recall': 0.9801015103298854, 'f1': 0.9846233898653896}
Epoch 4/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1100
Epoch 4/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.1054
Epoch 4/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.1062
Epoch 4/30, Step 60/1,Classification Loss: 0.3267, Contrastive Loss: 0.1029
Epoch 4/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0996
Epoch 4/30, Step 100/1,Classification Loss: 0.3482, Contrastive Loss: 0.1232
Epoch 4/30, Step 120/1,Classification Loss: 0.3348, Contrastive Loss: 0.0994
Epoch 4/30, Step 140/1,Classification Loss: 0.3404, Contrastive Loss: 0.1113
Accuracy: 0.9955, Precision: 0.9959, Recall: 0.9852, F1: 0.9905
Accuracy: 0.9923, Precision: 0.9882, Recall: 0.9803, F1: 0.9842
Epoch 4/30
Training - Loss: 63.6343
Training Metrics: {'accuracy': 0.9955051369863014, 'precision': 0.995896300466627, 'recall': 0.9852333334911072, 'f1': 0.9904807099226552}
Validation Metrics: {'accuracy': 0.9923347173427021, 'precision': 0.9882155438786278, 'recall': 0.9802883786704131, 'f1': 0.9842039795649717}
Epoch 5/30, Step 0/1,Classification Loss: 0.3601, Contrastive Loss: 0.1122
Epoch 5/30, Step 20/1,Classification Loss: 0.3443, Contrastive Loss: 0.0987
Epoch 5/30, Step 40/1,Classification Loss: 0.3156, Contrastive Loss: 0.0866
Epoch 5/30, Step 60/1,Classification Loss: 0.3757, Contrastive Loss: 0.1110
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0837
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0795
Epoch 5/30, Step 120/1,Classification Loss: 0.3591, Contrastive Loss: 0.0928
Epoch 5/30, Step 140/1,Classification Loss: 0.3350, Contrastive Loss: 0.0863
Accuracy: 0.9956, Precision: 0.9957, Recall: 0.9859, F1: 0.9907
Accuracy: 0.9930, Precision: 0.9889, Recall: 0.9822, F1: 0.9855
Epoch 5/30
Training - Loss: 61.6231
Training Metrics: {'accuracy': 0.9955854023972602, 'precision': 0.9957097472961396, 'recall': 0.9858829950967427, 'f1': 0.990724639452853}
Validation Metrics: {'accuracy': 0.9929734908974769, 'precision': 0.9889295630399753, 'recall': 0.9822161389748143, 'f1': 0.985538519160486}
Epoch 6/30, Step 0/1,Classification Loss: 0.3459, Contrastive Loss: 0.1059
Epoch 6/30, Step 20/1,Classification Loss: 0.3149, Contrastive Loss: 0.0815
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0740
Epoch 6/30, Step 60/1,Classification Loss: 0.3227, Contrastive Loss: 0.0799
Epoch 6/30, Step 80/1,Classification Loss: 0.3291, Contrastive Loss: 0.0878
Epoch 6/30, Step 100/1,Classification Loss: 0.3139, Contrastive Loss: 0.0765
Epoch 6/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0803
Epoch 6/30, Step 140/1,Classification Loss: 0.3427, Contrastive Loss: 0.0814
Accuracy: 0.9954, Precision: 0.9959, Recall: 0.9850, F1: 0.9904
Accuracy: 0.9929, Precision: 0.9889, Recall: 0.9818, F1: 0.9853
Epoch 6/30
Training - Loss: 60.3061
Training Metrics: {'accuracy': 0.9954248715753424, 'precision': 0.9958579770678706, 'recall': 0.9850340899766452, 'f1': 0.9903590870417625}
Validation Metrics: {'accuracy': 0.9928670286383477, 'precision': 0.9888616514411497, 'recall': 0.981843004646456, 'f1': 0.9853147911038013}
Epoch 7/30, Step 0/1,Classification Loss: 0.3450, Contrastive Loss: 0.0819
Epoch 7/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0771
Epoch 7/30, Step 40/1,Classification Loss: 0.3433, Contrastive Loss: 0.0776
Epoch 7/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0678
Epoch 7/30, Step 80/1,Classification Loss: 0.3220, Contrastive Loss: 0.0719
Epoch 7/30, Step 100/1,Classification Loss: 0.3304, Contrastive Loss: 0.0703
Epoch 7/30, Step 120/1,Classification Loss: 0.3364, Contrastive Loss: 0.0849
Epoch 7/30, Step 140/1,Classification Loss: 0.3632, Contrastive Loss: 0.0999
Accuracy: 0.9958, Precision: 0.9963, Recall: 0.9860, F1: 0.9911
Accuracy: 0.9925, Precision: 0.9893, Recall: 0.9801, F1: 0.9846
Epoch 7/30
Training - Loss: 58.9957
Training Metrics: {'accuracy': 0.9957726883561644, 'precision': 0.9963077220967295, 'recall': 0.9860142695161511, 'f1': 0.9910825442043456}
Validation Metrics: {'accuracy': 0.9925476418609603, 'precision': 0.9892735011658622, 'recall': 0.9801015103298854, 'f1': 0.9846233898653896}
Epoch 8/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0659
Epoch 8/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0669
Epoch 8/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0668
Epoch 8/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0608
Epoch 8/30, Step 80/1,Classification Loss: 0.3411, Contrastive Loss: 0.0748
Epoch 8/30, Step 100/1,Classification Loss: 0.3373, Contrastive Loss: 0.0633
Epoch 8/30, Step 120/1,Classification Loss: 0.3315, Contrastive Loss: 0.0669
Epoch 8/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0615
Accuracy: 0.9957, Precision: 0.9960, Recall: 0.9861, F1: 0.9910
Accuracy: 0.9922, Precision: 0.9872, Recall: 0.9808, F1: 0.9840
Epoch 8/30
Training - Loss: 58.1804
Training Metrics: {'accuracy': 0.9957191780821918, 'precision': 0.9960279635612477, 'recall': 0.9860585865708632, 'f1': 0.9909696650170589}
Validation Metrics: {'accuracy': 0.9922282550835728, 'precision': 0.9872334713603489, 'recall': 0.9808483813392987, 'f1': 0.9840097498016228}
Epoch 9/30, Step 0/1,Classification Loss: 0.3233, Contrastive Loss: 0.0644
Epoch 9/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0637
Epoch 9/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0579
Epoch 9/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0608
Epoch 9/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0575
Epoch 9/30, Step 100/1,Classification Loss: 0.3169, Contrastive Loss: 0.0590
Epoch 9/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0567
Epoch 9/30, Step 140/1,Classification Loss: 0.3478, Contrastive Loss: 0.0620
Accuracy: 0.9954, Precision: 0.9961, Recall: 0.9848, F1: 0.9903
Accuracy: 0.9928, Precision: 0.9888, Recall: 0.9815, F1: 0.9851
Epoch 9/30
Training - Loss: 57.2948
Training Metrics: {'accuracy': 0.9954248715753424, 'precision': 0.9961049934935329, 'recall': 0.9847812800061487, 'f1': 0.9903480393360782}
Validation Metrics: {'accuracy': 0.9927605663792186, 'precision': 0.9887937454583223, 'recall': 0.9814698703180978, 'f1': 0.9850909216531345}
Epoch 10/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0542
Epoch 10/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0543
Epoch 10/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0589
Epoch 10/30, Step 60/1,Classification Loss: 0.3437, Contrastive Loss: 0.0565
Epoch 10/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0552
Epoch 10/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0507
Epoch 10/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0518
Epoch 10/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0548
Accuracy: 0.9955, Precision: 0.9959, Recall: 0.9854, F1: 0.9906
Accuracy: 0.9930, Precision: 0.9883, Recall: 0.9828, F1: 0.9856
Epoch 10/30
Training - Loss: 56.9554
Training Metrics: {'accuracy': 0.9955318921232876, 'precision': 0.9959176627721749, 'recall': 0.9853851211100204, 'f1': 0.9905691829334531}
Validation Metrics: {'accuracy': 0.9929734908974769, 'precision': 0.9883209361095767, 'recall': 0.9828382303063102, 'f1': 0.985556667233896}
Epoch 11/30, Step 0/1,Classification Loss: 0.3336, Contrastive Loss: 0.0639
Epoch 11/30, Step 20/1,Classification Loss: 0.3585, Contrastive Loss: 0.0613
Epoch 11/30, Step 40/1,Classification Loss: 0.3227, Contrastive Loss: 0.0497
Epoch 11/30, Step 60/1,Classification Loss: 0.3223, Contrastive Loss: 0.0525
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0473
Epoch 11/30, Step 100/1,Classification Loss: 0.3755, Contrastive Loss: 0.0780
Epoch 11/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0481
Epoch 11/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0481
Accuracy: 0.9949, Precision: 0.9959, Recall: 0.9828, F1: 0.9892
Accuracy: 0.9917, Precision: 0.9878, Recall: 0.9780, F1: 0.9829
Epoch 11/30
Training - Loss: 56.1647
Training Metrics: {'accuracy': 0.9948897688356164, 'precision': 0.9958730757618339, 'recall': 0.9827534116020231, 'f1': 0.9891854858341051}
Validation Metrics: {'accuracy': 0.9916959437879271, 'precision': 0.9878065905261186, 'recall': 0.9780495727002638, 'f1': 0.9828552469841874}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0469
Epoch 12/30, Step 20/1,Classification Loss: 0.3138, Contrastive Loss: 0.0455
Epoch 12/30, Step 40/1,Classification Loss: 0.3217, Contrastive Loss: 0.0481
Epoch 12/30, Step 60/1,Classification Loss: 0.3454, Contrastive Loss: 0.0534
Epoch 12/30, Step 80/1,Classification Loss: 0.3353, Contrastive Loss: 0.0484
Epoch 12/30, Step 100/1,Classification Loss: 0.3371, Contrastive Loss: 0.0479
Epoch 12/30, Step 120/1,Classification Loss: 0.3354, Contrastive Loss: 0.0940
Epoch 12/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0451
Accuracy: 0.9933, Precision: 0.9949, Recall: 0.9768, F1: 0.9856
Accuracy: 0.9891, Precision: 0.9881, Recall: 0.9672, F1: 0.9773
Epoch 12/30
Training - Loss: 55.4499
Training Metrics: {'accuracy': 0.993257705479452, 'precision': 0.994916996901543, 'recall': 0.9768096087141931, 'f1': 0.9856190793447324}
Validation Metrics: {'accuracy': 0.9891408495688279, 'precision': 0.9880842644158053, 'recall': 0.9672280748251787, 'f1': 0.9773215231524097}
Epoch 13/30, Step 0/1,Classification Loss: 0.3744, Contrastive Loss: 0.0508
Epoch 13/30, Step 20/1,Classification Loss: 0.3137, Contrastive Loss: 0.0441
Epoch 13/30, Step 40/1,Classification Loss: 0.3384, Contrastive Loss: 0.0495
Epoch 13/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0428
Epoch 13/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0496
Epoch 13/30, Step 100/1,Classification Loss: 0.3469, Contrastive Loss: 0.0523
Epoch 13/30, Step 120/1,Classification Loss: 0.3225, Contrastive Loss: 0.0417
Epoch 13/30, Step 140/1,Classification Loss: 0.3185, Contrastive Loss: 0.0394
Accuracy: 0.9955, Precision: 0.9941, Recall: 0.9871, F1: 0.9906
Accuracy: 0.9939, Precision: 0.9889, Recall: 0.9862, F1: 0.9876
Epoch 13/30
Training - Loss: 54.9171
Training Metrics: {'accuracy': 0.9955051369863014, 'precision': 0.9941054090110432, 'recall': 0.987075419658586, 'f1': 0.9905536899395937}
Validation Metrics: {'accuracy': 0.9939316512296391, 'precision': 0.988937583837953, 'recall': 0.9861964392615341, 'f1': 0.9875613003829993}
Epoch 14/30, Step 0/1,Classification Loss: 0.3192, Contrastive Loss: 0.0417
Epoch 14/30, Step 20/1,Classification Loss: 0.3441, Contrastive Loss: 0.0439
Epoch 14/30, Step 40/1,Classification Loss: 0.3147, Contrastive Loss: 0.0406
Epoch 14/30, Step 60/1,Classification Loss: 0.3287, Contrastive Loss: 0.0399
Epoch 14/30, Step 80/1,Classification Loss: 0.3717, Contrastive Loss: 0.0454
Epoch 14/30, Step 100/1,Classification Loss: 0.3215, Contrastive Loss: 0.0384
Epoch 14/30, Step 120/1,Classification Loss: 0.3491, Contrastive Loss: 0.0490
Epoch 14/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0403
Accuracy: 0.9950, Precision: 0.9958, Recall: 0.9831, F1: 0.9893
Accuracy: 0.9922, Precision: 0.9885, Recall: 0.9796, F1: 0.9840
Epoch 14/30
Training - Loss: 54.6187
Training Metrics: {'accuracy': 0.9949700342465754, 'precision': 0.9958345224003067, 'recall': 0.9830906949994707, 'f1': 0.9893421956812556}
Validation Metrics: {'accuracy': 0.9922282550835728, 'precision': 0.9884542988147235, 'recall': 0.9796041986763068, 'f1': 0.9839694477132483}
Epoch 15/30, Step 0/1,Classification Loss: 0.3172, Contrastive Loss: 0.0373
Epoch 15/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0370
Epoch 15/30, Step 40/1,Classification Loss: 0.3178, Contrastive Loss: 0.0374
Epoch 15/30, Step 60/1,Classification Loss: 0.3372, Contrastive Loss: 0.0417
Epoch 15/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0429
Epoch 15/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0354
Epoch 15/30, Step 120/1,Classification Loss: 0.3180, Contrastive Loss: 0.0370
Epoch 15/30, Step 140/1,Classification Loss: 0.3212, Contrastive Loss: 0.0357
Accuracy: 0.9953, Precision: 0.9937, Recall: 0.9866, F1: 0.9901
Accuracy: 0.9931, Precision: 0.9872, Recall: 0.9845, F1: 0.9858
Epoch 15/30
Training - Loss: 54.0971
Training Metrics: {'accuracy': 0.9953178510273972, 'precision': 0.9937225794419247, 'recall': 0.9865591152492079, 'f1': 0.9901028064773264}
Validation Metrics: {'accuracy': 0.993079953156606, 'precision': 0.987186876836001, 'recall': 0.9844555472976605, 'f1': 0.9858155179806132}
Epoch 16/30, Step 0/1,Classification Loss: 0.3347, Contrastive Loss: 0.0382
Epoch 16/30, Step 20/1,Classification Loss: 0.3144, Contrastive Loss: 0.0328
Epoch 16/30, Step 40/1,Classification Loss: 0.3501, Contrastive Loss: 0.0395
Epoch 16/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0369
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 16/30, Step 100/1,Classification Loss: 0.3565, Contrastive Loss: 0.0435
Epoch 16/30, Step 120/1,Classification Loss: 0.3138, Contrastive Loss: 0.0326
Epoch 16/30, Step 140/1,Classification Loss: 0.3293, Contrastive Loss: 0.0362
Accuracy: 0.9954, Precision: 0.9960, Recall: 0.9847, F1: 0.9903
Accuracy: 0.9924, Precision: 0.9889, Recall: 0.9800, F1: 0.9844
Epoch 16/30
Training - Loss: 53.6246
Training Metrics: {'accuracy': 0.9953713613013698, 'precision': 0.9959952589327266, 'recall': 0.9847243824985987, 'f1': 0.9902654154812452}
Validation Metrics: {'accuracy': 0.9924411796018312, 'precision': 0.9888975529427487, 'recall': 0.9800394216672752, 'f1': 0.984408640926584}
Epoch 17/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0323
Epoch 17/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0323
Epoch 17/30, Step 40/1,Classification Loss: 0.3380, Contrastive Loss: 0.0357
Epoch 17/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0318
Epoch 17/30, Step 80/1,Classification Loss: 0.3452, Contrastive Loss: 0.0432
Epoch 17/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0332
Epoch 17/30, Step 120/1,Classification Loss: 0.3277, Contrastive Loss: 0.0330
Epoch 17/30, Step 140/1,Classification Loss: 0.3445, Contrastive Loss: 0.0345
Accuracy: 0.9930, Precision: 0.9949, Recall: 0.9761, F1: 0.9852
Accuracy: 0.9886, Precision: 0.9881, Recall: 0.9651, F1: 0.9762
Epoch 17/30
Training - Loss: 53.3070
Training Metrics: {'accuracy': 0.9930436643835616, 'precision': 0.9948825800795478, 'recall': 0.976111668758231, 'f1': 0.9852337073184569}
Validation Metrics: {'accuracy': 0.9886085382731822, 'precision': 0.9880779562571971, 'recall': 0.9650513575176396, 'f1': 0.9761562250268406}
Epoch 18/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0310
Epoch 18/30, Step 20/1,Classification Loss: 0.3459, Contrastive Loss: 0.0339
Epoch 18/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 60/1,Classification Loss: 0.3302, Contrastive Loss: 0.0327
Epoch 18/30, Step 80/1,Classification Loss: 0.3447, Contrastive Loss: 0.0471
Epoch 18/30, Step 100/1,Classification Loss: 0.3845, Contrastive Loss: 0.0411
Epoch 18/30, Step 120/1,Classification Loss: 0.3456, Contrastive Loss: 0.0348
Epoch 18/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0313
Accuracy: 0.9956, Precision: 0.9960, Recall: 0.9856, F1: 0.9907
Accuracy: 0.9928, Precision: 0.9879, Recall: 0.9824, F1: 0.9851
Epoch 18/30
Training - Loss: 52.9712
Training Metrics: {'accuracy': 0.9955854023972602, 'precision': 0.9959530791081261, 'recall': 0.9856154144026184, 'f1': 0.9907049607320899}
Validation Metrics: {'accuracy': 0.9927605663792186, 'precision': 0.9878807710915098, 'recall': 0.9824030073153418, 'f1': 0.985118990483408}
Epoch 19/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0283
Epoch 19/30, Step 20/1,Classification Loss: 0.3448, Contrastive Loss: 0.0406
Epoch 19/30, Step 40/1,Classification Loss: 0.3138, Contrastive Loss: 0.0300
Epoch 19/30, Step 60/1,Classification Loss: 0.3305, Contrastive Loss: 0.0332
Epoch 19/30, Step 80/1,Classification Loss: 0.3354, Contrastive Loss: 0.0312
Epoch 19/30, Step 100/1,Classification Loss: 0.3216, Contrastive Loss: 0.0280
Epoch 19/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0272
Epoch 19/30, Step 140/1,Classification Loss: 0.3447, Contrastive Loss: 0.0327
Accuracy: 0.9957, Precision: 0.9939, Recall: 0.9882, F1: 0.9911
Accuracy: 0.9933, Precision: 0.9867, Recall: 0.9858, F1: 0.9863
Epoch 19/30
Training - Loss: 52.7265
Training Metrics: {'accuracy': 0.9957191780821918, 'precision': 0.9939345450298592, 'recall': 0.9882257563156815, 'f1': 0.9910558754840795}
Validation Metrics: {'accuracy': 0.9932928776748643, 'precision': 0.986732689795218, 'recall': 0.985823907285873, 'f1': 0.9862776681077197}
Epoch 20/30, Step 0/1,Classification Loss: 0.3143, Contrastive Loss: 0.0265
Epoch 20/30, Step 20/1,Classification Loss: 0.3419, Contrastive Loss: 0.0302
Epoch 20/30, Step 40/1,Classification Loss: 0.3296, Contrastive Loss: 0.0301
Epoch 20/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0248
Epoch 20/30, Step 80/1,Classification Loss: 0.3514, Contrastive Loss: 0.0360
Epoch 20/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.0239
Epoch 20/30, Step 120/1,Classification Loss: 0.3327, Contrastive Loss: 0.0264
Epoch 20/30, Step 140/1,Classification Loss: 0.3626, Contrastive Loss: 0.0321
Accuracy: 0.9951, Precision: 0.9958, Recall: 0.9836, F1: 0.9896
Accuracy: 0.9920, Precision: 0.9880, Recall: 0.9792, F1: 0.9835
Epoch 20/30
Training - Loss: 52.4606
Training Metrics: {'accuracy': 0.9950770547945206, 'precision': 0.9958163798099244, 'recall': 0.983591321370299, 'f1': 0.9895929534524708}
Validation Metrics: {'accuracy': 0.9920153305653145, 'precision': 0.9880110446866981, 'recall': 0.9791689756853383, 'f1': 0.9835302544999127}
Epoch 21/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0268
Epoch 21/30, Step 20/1,Classification Loss: 0.3448, Contrastive Loss: 0.0315
Epoch 21/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.0315
Epoch 21/30, Step 60/1,Classification Loss: 0.3498, Contrastive Loss: 0.0289
Epoch 21/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0252
Epoch 21/30, Step 100/1,Classification Loss: 0.3448, Contrastive Loss: 0.0332
Epoch 21/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0236
Epoch 21/30, Step 140/1,Classification Loss: 0.3206, Contrastive Loss: 0.0247
Accuracy: 0.9946, Precision: 0.9958, Recall: 0.9816, F1: 0.9886
Accuracy: 0.9908, Precision: 0.9870, Recall: 0.9754, F1: 0.9811
Epoch 21/30
Training - Loss: 52.2683
Training Metrics: {'accuracy': 0.9945954623287672, 'precision': 0.9957857173415093, 'recall': 0.981635368738746, 'f1': 0.9885617196713887}
Validation Metrics: {'accuracy': 0.990844245714894, 'precision': 0.9869519925137278, 'recall': 0.975375543739146, 'f1': 0.9810609229275655}
Epoch 22/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0272
Epoch 22/30, Step 20/1,Classification Loss: 0.3340, Contrastive Loss: 0.0286
Epoch 22/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0241
Epoch 22/30, Step 60/1,Classification Loss: 0.3444, Contrastive Loss: 0.0289
Epoch 22/30, Step 80/1,Classification Loss: 0.3447, Contrastive Loss: 0.0275
Epoch 22/30, Step 100/1,Classification Loss: 0.3232, Contrastive Loss: 0.0249
Epoch 22/30, Step 120/1,Classification Loss: 0.3301, Contrastive Loss: 0.0286
Epoch 22/30, Step 140/1,Classification Loss: 0.3233, Contrastive Loss: 0.0233
Accuracy: 0.9945, Precision: 0.9956, Recall: 0.9813, F1: 0.9883
Accuracy: 0.9900, Precision: 0.9870, Recall: 0.9718, F1: 0.9792
Epoch 22/30
Training - Loss: 52.0960
Training Metrics: {'accuracy': 0.9944616866438356, 'precision': 0.9956286482450138, 'recall': 0.981327478820921, 'f1': 0.9883256039744581}
Validation Metrics: {'accuracy': 0.989992547641861, 'precision': 0.9870300692537073, 'recall': 0.9717683777807844, 'f1': 0.979220141641806}
Epoch 23/30, Step 0/1,Classification Loss: 0.3333, Contrastive Loss: 0.0260
Epoch 23/30, Step 20/1,Classification Loss: 0.3221, Contrastive Loss: 0.0254
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 23/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0281
Epoch 23/30, Step 80/1,Classification Loss: 0.3446, Contrastive Loss: 0.0276
Epoch 23/30, Step 100/1,Classification Loss: 0.3492, Contrastive Loss: 0.0274
Epoch 23/30, Step 120/1,Classification Loss: 0.3147, Contrastive Loss: 0.0224
Epoch 23/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0249
Accuracy: 0.9953, Precision: 0.9960, Recall: 0.9844, F1: 0.9901
Accuracy: 0.9917, Precision: 0.9875, Recall: 0.9784, F1: 0.9829
Epoch 23/30
Training - Loss: 51.9448
Training Metrics: {'accuracy': 0.995291095890411, 'precision': 0.9960350873566536, 'recall': 0.9844186301318492, 'f1': 0.9901263628436774}
Validation Metrics: {'accuracy': 0.9916959437879271, 'precision': 0.98749935072478, 'recall': 0.9783606183660117, 'f1': 0.9828660629928625}
Epoch 24/30, Step 0/1,Classification Loss: 0.3239, Contrastive Loss: 0.0240
Epoch 24/30, Step 20/1,Classification Loss: 0.3285, Contrastive Loss: 0.0243
Epoch 24/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0226
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Epoch 24/30, Step 80/1,Classification Loss: 0.3267, Contrastive Loss: 0.0225
Epoch 24/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0196
Epoch 24/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0206
Accuracy: 0.9957, Precision: 0.9962, Recall: 0.9858, F1: 0.9909
Accuracy: 0.9919, Precision: 0.9861, Recall: 0.9807, F1: 0.9834
Epoch 24/30
Training - Loss: 51.8578
Training Metrics: {'accuracy': 0.9956924229452054, 'precision': 0.9961812977625586, 'recall': 0.9858437281386065, 'f1': 0.9909332556227208}
Validation Metrics: {'accuracy': 0.9919088683061854, 'precision': 0.9861201110192428, 'recall': 0.9806621153514682, 'f1': 0.9833682834814559}
Epoch 25/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0225
Epoch 25/30, Step 20/1,Classification Loss: 0.3634, Contrastive Loss: 0.0259
Epoch 25/30, Step 40/1,Classification Loss: 0.3350, Contrastive Loss: 0.0243
Epoch 25/30, Step 60/1,Classification Loss: 0.3287, Contrastive Loss: 0.0230
Epoch 25/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0256
Epoch 25/30, Step 100/1,Classification Loss: 0.3287, Contrastive Loss: 0.0232
Epoch 25/30, Step 120/1,Classification Loss: 0.3147, Contrastive Loss: 0.0197
Epoch 25/30, Step 140/1,Classification Loss: 0.3443, Contrastive Loss: 0.0257
Accuracy: 0.9959, Precision: 0.9963, Recall: 0.9865, F1: 0.9913
Accuracy: 0.9922, Precision: 0.9860, Recall: 0.9821, F1: 0.9840
Epoch 25/30
Training - Loss: 51.6809
Training Metrics: {'accuracy': 0.9958529537671232, 'precision': 0.9962838146280322, 'recall': 0.9865053395770076, 'f1': 0.991323468118621}
Validation Metrics: {'accuracy': 0.9922282550835728, 'precision': 0.9860307979141936, 'recall': 0.9820925640022908, 'f1': 0.9840498022615962}
Epoch 26/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 26/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0214
Epoch 26/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0231
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 26/30, Step 80/1,Classification Loss: 0.3503, Contrastive Loss: 0.0311
Epoch 26/30, Step 100/1,Classification Loss: 0.3558, Contrastive Loss: 0.0246
Epoch 26/30, Step 120/1,Classification Loss: 0.3312, Contrastive Loss: 0.0271
Epoch 26/30, Step 140/1,Classification Loss: 0.3437, Contrastive Loss: 0.0239
Accuracy: 0.9955, Precision: 0.9960, Recall: 0.9850, F1: 0.9904
Accuracy: 0.9920, Precision: 0.9868, Recall: 0.9804, F1: 0.9836
Epoch 26/30
Training - Loss: 51.7410
Training Metrics: {'accuracy': 0.9954516267123288, 'precision': 0.9959516143252782, 'recall': 0.9849988569322383, 'f1': 0.9903863727608553}
Validation Metrics: {'accuracy': 0.9920153305653145, 'precision': 0.9867924691298439, 'recall': 0.9804131583483304, 'f1': 0.983571660755092}
Epoch 27/30, Step 0/1,Classification Loss: 0.3380, Contrastive Loss: 0.0233
Epoch 27/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0205
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 27/30, Step 60/1,Classification Loss: 0.3170, Contrastive Loss: 0.0206
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 27/30, Step 100/1,Classification Loss: 0.3138, Contrastive Loss: 0.0199
Epoch 27/30, Step 120/1,Classification Loss: 0.3384, Contrastive Loss: 0.0221
Epoch 27/30, Step 140/1,Classification Loss: 0.3757, Contrastive Loss: 0.0266
Accuracy: 0.9957, Precision: 0.9960, Recall: 0.9861, F1: 0.9910
Accuracy: 0.9923, Precision: 0.9870, Recall: 0.9815, F1: 0.9842
Epoch 27/30
Training - Loss: 51.5859
Training Metrics: {'accuracy': 0.995745933219178, 'precision': 0.9960431597770705, 'recall': 0.9861495907756354, 'f1': 0.9910239000632406}
Validation Metrics: {'accuracy': 0.9923347173427021, 'precision': 0.9870004410553763, 'recall': 0.9815325613334049, 'f1': 0.984243636982432}
Epoch 28/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 28/30, Step 20/1,Classification Loss: 0.3277, Contrastive Loss: 0.0201
Epoch 28/30, Step 40/1,Classification Loss: 0.3411, Contrastive Loss: 0.0242
Epoch 28/30, Step 60/1,Classification Loss: 0.3163, Contrastive Loss: 0.0206
Epoch 28/30, Step 80/1,Classification Loss: 0.3382, Contrastive Loss: 0.0221
Epoch 28/30, Step 100/1,Classification Loss: 0.3483, Contrastive Loss: 0.0245
Epoch 28/30, Step 120/1,Classification Loss: 0.3529, Contrastive Loss: 0.0275
Epoch 28/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0195
Accuracy: 0.9949, Precision: 0.9959, Recall: 0.9828, F1: 0.9892
Accuracy: 0.9915, Precision: 0.9877, Recall: 0.9773, F1: 0.9824
Epoch 28/30
Training - Loss: 51.5497
Training Metrics: {'accuracy': 0.9948897688356164, 'precision': 0.995873650113315, 'recall': 0.9827632157747772, 'f1': 0.9891908191425488}
Validation Metrics: {'accuracy': 0.9914830192696689, 'precision': 0.9876703123819428, 'recall': 0.9773033040435473, 'f1': 0.9824045272797264}
Epoch 29/30, Step 0/1,Classification Loss: 0.3602, Contrastive Loss: 0.0245
Epoch 29/30, Step 20/1,Classification Loss: 0.3190, Contrastive Loss: 0.0194
Epoch 29/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0205
Epoch 29/30, Step 60/1,Classification Loss: 0.3298, Contrastive Loss: 0.0216
Epoch 29/30, Step 80/1,Classification Loss: 0.3294, Contrastive Loss: 0.0215
Epoch 29/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 29/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 29/30, Step 140/1,Classification Loss: 0.3337, Contrastive Loss: 0.0197
Accuracy: 0.9951, Precision: 0.9939, Recall: 0.9857, F1: 0.9898
Accuracy: 0.9916, Precision: 0.9859, Recall: 0.9795, F1: 0.9827
Epoch 29/30
Training - Loss: 51.4127
Training Metrics: {'accuracy': 0.9951305650684932, 'precision': 0.9938835524261878, 'recall': 0.98574798945771, 'f1': 0.9897664974345597}
Validation Metrics: {'accuracy': 0.991589481528798, 'precision': 0.9859104646688337, 'recall': 0.9795427123663936, 'f1': 0.9826954826620302}
Epoch 30/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 30/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0222
Epoch 30/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 30/30, Step 60/1,Classification Loss: 0.3192, Contrastive Loss: 0.0198
Epoch 30/30, Step 80/1,Classification Loss: 0.3245, Contrastive Loss: 0.0194
Epoch 30/30, Step 100/1,Classification Loss: 0.3239, Contrastive Loss: 0.0206
Epoch 30/30, Step 120/1,Classification Loss: 0.3457, Contrastive Loss: 0.0222
Epoch 30/30, Step 140/1,Classification Loss: 0.3446, Contrastive Loss: 0.0268
Accuracy: 0.9951, Precision: 0.9958, Recall: 0.9839, F1: 0.9897
Accuracy: 0.9913, Precision: 0.9872, Recall: 0.9769, F1: 0.9820
Epoch 30/30
Training - Loss: 51.1770
Training Metrics: {'accuracy': 0.9951305650684932, 'precision': 0.9957705204842047, 'recall': 0.9839340848387153, 'f1': 0.9897481269636961}
Validation Metrics: {'accuracy': 0.9912700947514106, 'precision': 0.9872256363653235, 'recall': 0.9768680810525789, 'f1': 0.9819646404617196}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (562, 5814), y shape: (562,), y distribution: Counter({np.float64(0.0): 512, np.float64(1.0): 50}), env shape: (562,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9075, Precision: 0.4554, Recall: 0.4980, F1: 0.4757
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12915]))
original train data shape: torch.Size([47062]), new train data shape: torch.Size([100])
original test data shape: torch.Size([562, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([47062]), new train data shape: torch.Size([47062])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 12915]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3377, Contrastive Loss: 1.5997
Epoch 1/30, Step 20/1,Classification Loss: 0.3287, Contrastive Loss: 0.8163
Epoch 1/30, Step 40/1,Classification Loss: 0.3446, Contrastive Loss: 0.3735
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2353
Epoch 1/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.1947
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1637
Epoch 1/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1617
Epoch 1/30, Step 140/1,Classification Loss: 0.3453, Contrastive Loss: 0.1658
Accuracy: 0.9954, Precision: 0.9937, Recall: 0.9871, F1: 0.9903
Accuracy: 0.9924, Precision: 0.9861, Recall: 0.9825, F1: 0.9843
Epoch 1/30
Training - Loss: 107.4412
Training Metrics: {'accuracy': 0.9954028486394558, 'precision': 0.9936552240206316, 'recall': 0.987059224124914, 'f1': 0.9903249037996207}
Validation Metrics: {'accuracy': 0.992351003930734, 'precision': 0.9861237592310604, 'recall': 0.9824932080985427, 'f1': 0.9842983959035007}
Epoch 2/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.1453
Epoch 2/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1304
Epoch 2/30, Step 40/1,Classification Loss: 0.3453, Contrastive Loss: 0.1389
Epoch 2/30, Step 60/1,Classification Loss: 0.3187, Contrastive Loss: 0.1319
Epoch 2/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.1214
Epoch 2/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1305
Epoch 2/30, Step 120/1,Classification Loss: 0.3403, Contrastive Loss: 0.1279
Epoch 2/30, Step 140/1,Classification Loss: 0.3601, Contrastive Loss: 0.1307
Accuracy: 0.9948, Precision: 0.9956, Recall: 0.9824, F1: 0.9889
Accuracy: 0.9907, Precision: 0.9884, Recall: 0.9731, F1: 0.9806
Epoch 2/30
Training - Loss: 68.1531
Training Metrics: {'accuracy': 0.9947650935374149, 'precision': 0.9956377771673302, 'recall': 0.9823927860886499, 'f1': 0.9888852310779902}
Validation Metrics: {'accuracy': 0.9906512270264528, 'precision': 0.9883988135335405, 'recall': 0.9731150476924153, 'f1': 0.9805779769568519}
Epoch 3/30, Step 0/1,Classification Loss: 0.3343, Contrastive Loss: 0.1194
Epoch 3/30, Step 20/1,Classification Loss: 0.3207, Contrastive Loss: 0.1114
Epoch 3/30, Step 40/1,Classification Loss: 0.3785, Contrastive Loss: 0.1318
Epoch 3/30, Step 60/1,Classification Loss: 0.3444, Contrastive Loss: 0.1152
Epoch 3/30, Step 80/1,Classification Loss: 0.3442, Contrastive Loss: 0.1117
Epoch 3/30, Step 100/1,Classification Loss: 0.3464, Contrastive Loss: 0.1107
Epoch 3/30, Step 120/1,Classification Loss: 0.3769, Contrastive Loss: 0.1287
Epoch 3/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0991
Accuracy: 0.9954, Precision: 0.9959, Recall: 0.9849, F1: 0.9903
Accuracy: 0.9920, Precision: 0.9871, Recall: 0.9801, F1: 0.9836
Epoch 3/30
Training - Loss: 64.8127
Training Metrics: {'accuracy': 0.9954028486394558, 'precision': 0.9959367054108772, 'recall': 0.984860586393846, 'f1': 0.9903076182213144}
Validation Metrics: {'accuracy': 0.9920322957611813, 'precision': 0.9871171149905966, 'recall': 0.9801329611767102, 'f1': 0.9835877267650299}
Epoch 4/30, Step 0/1,Classification Loss: 0.3279, Contrastive Loss: 0.1016
Epoch 4/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.1046
Epoch 4/30, Step 40/1,Classification Loss: 0.3265, Contrastive Loss: 0.0955
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0924
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0894
Epoch 4/30, Step 100/1,Classification Loss: 0.3368, Contrastive Loss: 0.0935
Epoch 4/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0926
Epoch 4/30, Step 140/1,Classification Loss: 0.3316, Contrastive Loss: 0.0902
Accuracy: 0.9954, Precision: 0.9959, Recall: 0.9849, F1: 0.9903
Accuracy: 0.9920, Precision: 0.9883, Recall: 0.9789, F1: 0.9835
Epoch 4/30
Training - Loss: 62.9444
Training Metrics: {'accuracy': 0.9954028486394558, 'precision': 0.9958516586371075, 'recall': 0.9849095310907238, 'f1': 0.9902918382138439}
Validation Metrics: {'accuracy': 0.9920322957611813, 'precision': 0.9883386610946888, 'recall': 0.9788904489791699, 'f1': 0.9835463791441432}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0845
Epoch 5/30, Step 20/1,Classification Loss: 0.3469, Contrastive Loss: 0.0960
Epoch 5/30, Step 40/1,Classification Loss: 0.3534, Contrastive Loss: 0.0913
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0808
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0789
Epoch 5/30, Step 100/1,Classification Loss: 0.3264, Contrastive Loss: 0.0844
Epoch 5/30, Step 120/1,Classification Loss: 0.3480, Contrastive Loss: 0.0837
Epoch 5/30, Step 140/1,Classification Loss: 0.3501, Contrastive Loss: 0.0828
Accuracy: 0.9951, Precision: 0.9959, Recall: 0.9835, F1: 0.9896
Accuracy: 0.9914, Precision: 0.9886, Recall: 0.9760, F1: 0.9822
Epoch 5/30
Training - Loss: 61.2727
Training Metrics: {'accuracy': 0.9950573979591837, 'precision': 0.9959030935765427, 'recall': 0.9835289662706477, 'f1': 0.9896020858718866}
Validation Metrics: {'accuracy': 0.9913948794220758, 'precision': 0.988553742986354, 'recall': 0.9760337234318154, 'f1': 0.9821738777600659}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0777
Epoch 6/30, Step 20/1,Classification Loss: 0.3182, Contrastive Loss: 0.0795
Epoch 6/30, Step 40/1,Classification Loss: 0.3363, Contrastive Loss: 0.0812
Epoch 6/30, Step 60/1,Classification Loss: 0.3469, Contrastive Loss: 0.0939
Epoch 6/30, Step 80/1,Classification Loss: 0.3432, Contrastive Loss: 0.0814
Epoch 6/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0883
Epoch 6/30, Step 120/1,Classification Loss: 0.3191, Contrastive Loss: 0.0709
Epoch 6/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0768
Accuracy: 0.9953, Precision: 0.9961, Recall: 0.9840, F1: 0.9899
Accuracy: 0.9915, Precision: 0.9892, Recall: 0.9758, F1: 0.9824
Epoch 6/30
Training - Loss: 59.9719
Training Metrics: {'accuracy': 0.9952699829931972, 'precision': 0.9960949578407923, 'recall': 0.9839815774974943, 'f1': 0.9899299237126584}
Validation Metrics: {'accuracy': 0.9915011154785934, 'precision': 0.9892461695181078, 'recall': 0.9757850455744759, 'f1': 0.982377213379314}
Epoch 7/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0715
Epoch 7/30, Step 20/1,Classification Loss: 0.3605, Contrastive Loss: 0.0904
Epoch 7/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0713
Epoch 7/30, Step 60/1,Classification Loss: 0.3225, Contrastive Loss: 0.0700
Epoch 7/30, Step 80/1,Classification Loss: 0.3390, Contrastive Loss: 0.0786
Epoch 7/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0768
Epoch 7/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0635
Epoch 7/30, Step 140/1,Classification Loss: 0.3265, Contrastive Loss: 0.0652
Accuracy: 0.9955, Precision: 0.9957, Recall: 0.9856, F1: 0.9906
Accuracy: 0.9918, Precision: 0.9879, Recall: 0.9785, F1: 0.9831
Epoch 7/30
Training - Loss: 59.3529
Training Metrics: {'accuracy': 0.9955357142857143, 'precision': 0.9956798541829971, 'recall': 0.9855955861388077, 'f1': 0.9905624275352096}
Validation Metrics: {'accuracy': 0.9918198236481461, 'precision': 0.9878955596842018, 'recall': 0.9784559205456935, 'f1': 0.9831076159213203}
Epoch 8/30, Step 0/1,Classification Loss: 0.3337, Contrastive Loss: 0.0672
Epoch 8/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0681
Epoch 8/30, Step 40/1,Classification Loss: 0.3365, Contrastive Loss: 0.0674
Epoch 8/30, Step 60/1,Classification Loss: 0.3592, Contrastive Loss: 0.0843
Epoch 8/30, Step 80/1,Classification Loss: 0.3206, Contrastive Loss: 0.0637
Epoch 8/30, Step 100/1,Classification Loss: 0.3274, Contrastive Loss: 0.0649
Epoch 8/30, Step 120/1,Classification Loss: 0.3340, Contrastive Loss: 0.0650
Epoch 8/30, Step 140/1,Classification Loss: 0.3508, Contrastive Loss: 0.0675
Accuracy: 0.9943, Precision: 0.9955, Recall: 0.9807, F1: 0.9879
Accuracy: 0.9891, Precision: 0.9871, Recall: 0.9678, F1: 0.9772
Epoch 8/30
Training - Loss: 58.3286
Training Metrics: {'accuracy': 0.9942867772108843, 'precision': 0.9955325543375357, 'recall': 0.9806591539429897, 'f1': 0.9879310118529738}
Validation Metrics: {'accuracy': 0.989057686178689, 'precision': 0.9870793508959487, 'recall': 0.96783700212034, 'f1': 0.9771729795927112}
Epoch 9/30, Step 0/1,Classification Loss: 0.3341, Contrastive Loss: 0.0632
Epoch 9/30, Step 20/1,Classification Loss: 0.3295, Contrastive Loss: 0.0597
Epoch 9/30, Step 40/1,Classification Loss: 0.3183, Contrastive Loss: 0.0571
Epoch 9/30, Step 60/1,Classification Loss: 0.3254, Contrastive Loss: 0.0592
Epoch 9/30, Step 80/1,Classification Loss: 0.3541, Contrastive Loss: 0.0650
Epoch 9/30, Step 100/1,Classification Loss: 0.3446, Contrastive Loss: 0.0614
Epoch 9/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0738
Epoch 9/30, Step 140/1,Classification Loss: 0.3285, Contrastive Loss: 0.0575
Accuracy: 0.9938, Precision: 0.9952, Recall: 0.9786, F1: 0.9867
Accuracy: 0.9892, Precision: 0.9878, Recall: 0.9676, F1: 0.9774
Epoch 9/30
Training - Loss: 57.5592
Training Metrics: {'accuracy': 0.9937553146258503, 'precision': 0.9952160343742708, 'recall': 0.9786154482304694, 'f1': 0.9867107106995012}
Validation Metrics: {'accuracy': 0.9891639222352067, 'precision': 0.9877851009919085, 'recall': 0.9675883242630005, 'f1': 0.9773728862450481}
Epoch 10/30, Step 0/1,Classification Loss: 0.3251, Contrastive Loss: 0.0543
Epoch 10/30, Step 20/1,Classification Loss: 0.3351, Contrastive Loss: 0.0553
Epoch 10/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0511
Epoch 10/30, Step 60/1,Classification Loss: 0.3320, Contrastive Loss: 0.0577
Epoch 10/30, Step 80/1,Classification Loss: 0.3377, Contrastive Loss: 0.0569
Epoch 10/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0538
Epoch 10/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0532
Epoch 10/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0501
Accuracy: 0.9952, Precision: 0.9961, Recall: 0.9837, F1: 0.9898
Accuracy: 0.9921, Precision: 0.9890, Recall: 0.9786, F1: 0.9838
Epoch 10/30
Training - Loss: 56.7451
Training Metrics: {'accuracy': 0.9951902636054422, 'precision': 0.9961359883361908, 'recall': 0.9836828526018115, 'f1': 0.9897946530730459}
Validation Metrics: {'accuracy': 0.992138531817699, 'precision': 0.9890234630716495, 'recall': 0.9786417711218303, 'f1': 0.9837503965810053}
Epoch 11/30, Step 0/1,Classification Loss: 0.3172, Contrastive Loss: 0.0499
Epoch 11/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0505
Epoch 11/30, Step 40/1,Classification Loss: 0.3145, Contrastive Loss: 0.0493
Epoch 11/30, Step 60/1,Classification Loss: 0.3142, Contrastive Loss: 0.0491
Epoch 11/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0491
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0473
Epoch 11/30, Step 120/1,Classification Loss: 0.3301, Contrastive Loss: 0.0490
Epoch 11/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0461
Accuracy: 0.9956, Precision: 0.9963, Recall: 0.9852, F1: 0.9907
Accuracy: 0.9924, Precision: 0.9885, Recall: 0.9800, F1: 0.9842
Epoch 11/30
Training - Loss: 56.0533
Training Metrics: {'accuracy': 0.9956154336734694, 'precision': 0.9962974435614063, 'recall': 0.9852398198918153, 'f1': 0.99067843148991}
Validation Metrics: {'accuracy': 0.992351003930734, 'precision': 0.9885418140766763, 'recall': 0.980008183703462, 'f1': 0.9842194380490421}
Epoch 12/30, Step 0/1,Classification Loss: 0.3597, Contrastive Loss: 0.0528
Epoch 12/30, Step 20/1,Classification Loss: 0.3569, Contrastive Loss: 0.0703
Epoch 12/30, Step 40/1,Classification Loss: 0.3356, Contrastive Loss: 0.0477
Epoch 12/30, Step 60/1,Classification Loss: 0.3785, Contrastive Loss: 0.0641
Epoch 12/30, Step 80/1,Classification Loss: 0.3685, Contrastive Loss: 0.0596
Epoch 12/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0415
Epoch 12/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0424
Epoch 12/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0451
Accuracy: 0.9957, Precision: 0.9963, Recall: 0.9856, F1: 0.9909
Accuracy: 0.9920, Precision: 0.9883, Recall: 0.9789, F1: 0.9835
Epoch 12/30
Training - Loss: 55.3985
Training Metrics: {'accuracy': 0.9956685799319728, 'precision': 0.9962564720593777, 'recall': 0.9856490113458237, 'f1': 0.9908693550342229}
Validation Metrics: {'accuracy': 0.9920322957611813, 'precision': 0.9883386610946888, 'recall': 0.9788904489791699, 'f1': 0.9835463791441432}
Epoch 13/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0455
Epoch 13/30, Step 20/1,Classification Loss: 0.3156, Contrastive Loss: 0.0425
Epoch 13/30, Step 40/1,Classification Loss: 0.3160, Contrastive Loss: 0.0407
Epoch 13/30, Step 60/1,Classification Loss: 0.3354, Contrastive Loss: 0.0550
Epoch 13/30, Step 80/1,Classification Loss: 0.3316, Contrastive Loss: 0.0416
Epoch 13/30, Step 100/1,Classification Loss: 0.3165, Contrastive Loss: 0.0410
Epoch 13/30, Step 120/1,Classification Loss: 0.3275, Contrastive Loss: 0.0394
Epoch 13/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0431
Accuracy: 0.9953, Precision: 0.9960, Recall: 0.9844, F1: 0.9901
Accuracy: 0.9911, Precision: 0.9874, Recall: 0.9758, F1: 0.9815
Epoch 13/30
Training - Loss: 54.9053
Training Metrics: {'accuracy': 0.9952965561224489, 'precision': 0.9959578109315418, 'recall': 0.9844167022736487, 'f1': 0.9900883478370431}
Validation Metrics: {'accuracy': 0.9910761712525231, 'precision': 0.9874197286662476, 'recall': 0.9758478728556785, 'f1': 0.9815311868463907}
Epoch 14/30, Step 0/1,Classification Loss: 0.3280, Contrastive Loss: 0.0402
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0381
Epoch 14/30, Step 40/1,Classification Loss: 0.3197, Contrastive Loss: 0.0397
Epoch 14/30, Step 60/1,Classification Loss: 0.3260, Contrastive Loss: 0.0434
Epoch 14/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0357
Epoch 14/30, Step 100/1,Classification Loss: 0.3417, Contrastive Loss: 0.0459
Epoch 14/30, Step 120/1,Classification Loss: 0.3220, Contrastive Loss: 0.0423
Epoch 14/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0390
Accuracy: 0.9955, Precision: 0.9958, Recall: 0.9855, F1: 0.9905
Accuracy: 0.9915, Precision: 0.9862, Recall: 0.9789, F1: 0.9825
Epoch 14/30
Training - Loss: 54.6266
Training Metrics: {'accuracy': 0.9955091411564626, 'precision': 0.9957504178700347, 'recall': 0.9854547729203482, 'f1': 0.9905240196392999}
Validation Metrics: {'accuracy': 0.9915011154785934, 'precision': 0.9861659860477018, 'recall': 0.978891326068327, 'f1': 0.982488077176735}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0361
Epoch 15/30, Step 20/1,Classification Loss: 0.3381, Contrastive Loss: 0.0422
Epoch 15/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0363
Epoch 15/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0396
Epoch 15/30, Step 80/1,Classification Loss: 0.3448, Contrastive Loss: 0.0447
Epoch 15/30, Step 100/1,Classification Loss: 0.3261, Contrastive Loss: 0.0339
Epoch 15/30, Step 120/1,Classification Loss: 0.3378, Contrastive Loss: 0.0382
Epoch 15/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0329
Accuracy: 0.9951, Precision: 0.9956, Recall: 0.9840, F1: 0.9897
Accuracy: 0.9914, Precision: 0.9882, Recall: 0.9763, F1: 0.9822
Epoch 15/30
Training - Loss: 54.1444
Training Metrics: {'accuracy': 0.9951371173469388, 'precision': 0.9956102930307356, 'recall': 0.9840070821549577, 'f1': 0.9897088731800456}
Validation Metrics: {'accuracy': 0.9913948794220758, 'precision': 0.9882425361941001, 'recall': 0.9763443514812005, 'f1': 0.9821851551955554}
Epoch 16/30, Step 0/1,Classification Loss: 0.3342, Contrastive Loss: 0.0396
Epoch 16/30, Step 20/1,Classification Loss: 0.3482, Contrastive Loss: 0.0383
Epoch 16/30, Step 40/1,Classification Loss: 0.3344, Contrastive Loss: 0.0359
Epoch 16/30, Step 60/1,Classification Loss: 0.3410, Contrastive Loss: 0.0390
Epoch 16/30, Step 80/1,Classification Loss: 0.3286, Contrastive Loss: 0.0343
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0309
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0300
Epoch 16/30, Step 140/1,Classification Loss: 0.3587, Contrastive Loss: 0.0386
Accuracy: 0.9941, Precision: 0.9935, Recall: 0.9819, F1: 0.9876
Accuracy: 0.9900, Precision: 0.9861, Recall: 0.9727, F1: 0.9793
Epoch 16/30
Training - Loss: 53.7943
Training Metrics: {'accuracy': 0.9941273384353742, 'precision': 0.9934541450993488, 'recall': 0.9819283720074805, 'f1': 0.9875921810160244}
Validation Metrics: {'accuracy': 0.9900138106873473, 'precision': 0.986118413370207, 'recall': 0.9727433465401418, 'f1': 0.9792932257206939}
Epoch 17/30, Step 0/1,Classification Loss: 0.3326, Contrastive Loss: 0.0356
Epoch 17/30, Step 20/1,Classification Loss: 0.3164, Contrastive Loss: 0.0307
Epoch 17/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0328
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 17/30, Step 80/1,Classification Loss: 0.3293, Contrastive Loss: 0.0325
Epoch 17/30, Step 100/1,Classification Loss: 0.3161, Contrastive Loss: 0.0314
Epoch 17/30, Step 120/1,Classification Loss: 0.3188, Contrastive Loss: 0.0321
Epoch 17/30, Step 140/1,Classification Loss: 0.3499, Contrastive Loss: 0.0456
Accuracy: 0.9955, Precision: 0.9941, Recall: 0.9870, F1: 0.9905
Accuracy: 0.9916, Precision: 0.9841, Recall: 0.9814, F1: 0.9828
Epoch 17/30
Training - Loss: 53.4191
Training Metrics: {'accuracy': 0.9954825680272109, 'precision': 0.9941098472808976, 'recall': 0.9869591686487711, 'f1': 0.9904965300979609}
Validation Metrics: {'accuracy': 0.991607351535111, 'precision': 0.9841489456522546, 'recall': 0.9814383006554533, 'f1': 0.9827879758609894}
Epoch 18/30, Step 0/1,Classification Loss: 0.3602, Contrastive Loss: 0.0475
Epoch 18/30, Step 20/1,Classification Loss: 0.3291, Contrastive Loss: 0.0331
Epoch 18/30, Step 40/1,Classification Loss: 0.3398, Contrastive Loss: 0.0316
Epoch 18/30, Step 60/1,Classification Loss: 0.3217, Contrastive Loss: 0.0295
Epoch 18/30, Step 80/1,Classification Loss: 0.3426, Contrastive Loss: 0.0328
Epoch 18/30, Step 100/1,Classification Loss: 0.3377, Contrastive Loss: 0.0302
Epoch 18/30, Step 120/1,Classification Loss: 0.3143, Contrastive Loss: 0.0319
Epoch 18/30, Step 140/1,Classification Loss: 0.4150, Contrastive Loss: 0.0437
Accuracy: 0.9953, Precision: 0.9961, Recall: 0.9844, F1: 0.9901
Accuracy: 0.9918, Precision: 0.9873, Recall: 0.9791, F1: 0.9831
Epoch 18/30
Training - Loss: 53.3147
Training Metrics: {'accuracy': 0.9953231292517006, 'precision': 0.9960542877127933, 'recall': 0.9844146348290048, 'f1': 0.9901339307366912}
Validation Metrics: {'accuracy': 0.9918198236481461, 'precision': 0.9872836272768848, 'recall': 0.9790771766444637, 'f1': 0.9831288740193933}
Epoch 19/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0295
Epoch 19/30, Step 20/1,Classification Loss: 0.3322, Contrastive Loss: 0.0299
Epoch 19/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0290
Epoch 19/30, Step 60/1,Classification Loss: 0.3216, Contrastive Loss: 0.0268
Epoch 19/30, Step 80/1,Classification Loss: 0.3293, Contrastive Loss: 0.0297
Epoch 19/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0262
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 19/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Accuracy: 0.9952, Precision: 0.9959, Recall: 0.9841, F1: 0.9899
Accuracy: 0.9915, Precision: 0.9880, Recall: 0.9770, F1: 0.9824
Epoch 19/30
Training - Loss: 52.9576
Training Metrics: {'accuracy': 0.9952168367346939, 'precision': 0.995908238812675, 'recall': 0.9840952289476941, 'f1': 0.9898981997739442}
Validation Metrics: {'accuracy': 0.9915011154785934, 'precision': 0.9880001798306004, 'recall': 0.9770275577720163, 'f1': 0.9824217663090267}
Epoch 20/30, Step 0/1,Classification Loss: 0.3283, Contrastive Loss: 0.0264
Epoch 20/30, Step 20/1,Classification Loss: 0.3505, Contrastive Loss: 0.0343
Epoch 20/30, Step 40/1,Classification Loss: 0.3599, Contrastive Loss: 0.0318
Epoch 20/30, Step 60/1,Classification Loss: 0.3344, Contrastive Loss: 0.0284
Epoch 20/30, Step 80/1,Classification Loss: 0.3208, Contrastive Loss: 0.0272
Epoch 20/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0250
Epoch 20/30, Step 120/1,Classification Loss: 0.3362, Contrastive Loss: 0.0292
Epoch 20/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0249
Accuracy: 0.9952, Precision: 0.9942, Recall: 0.9855, F1: 0.9898
Accuracy: 0.9918, Precision: 0.9855, Recall: 0.9809, F1: 0.9832
Epoch 20/30
Training - Loss: 52.6451
Training Metrics: {'accuracy': 0.9951902636054422, 'precision': 0.9942451275391886, 'recall': 0.985539881415239, 'f1': 0.9898362835300619}
Validation Metrics: {'accuracy': 0.9918198236481461, 'precision': 0.985475095250548, 'recall': 0.9809409449407743, 'f1': 0.9831922536617497}
Epoch 21/30, Step 0/1,Classification Loss: 0.3350, Contrastive Loss: 0.0300
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0231
Epoch 21/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0275
Epoch 21/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0259
Epoch 21/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0275
Epoch 21/30, Step 100/1,Classification Loss: 0.3428, Contrastive Loss: 0.0262
Epoch 21/30, Step 120/1,Classification Loss: 0.3395, Contrastive Loss: 0.0293
Epoch 21/30, Step 140/1,Classification Loss: 0.3445, Contrastive Loss: 0.0270
Accuracy: 0.9955, Precision: 0.9959, Recall: 0.9855, F1: 0.9906
Accuracy: 0.9915, Precision: 0.9865, Recall: 0.9786, F1: 0.9825
Epoch 21/30
Training - Loss: 52.4752
Training Metrics: {'accuracy': 0.9955357142857143, 'precision': 0.9958539447269207, 'recall': 0.9855242279788448, 'f1': 0.9906098564757855}
Validation Metrics: {'accuracy': 0.9915011154785934, 'precision': 0.9864688242446356, 'recall': 0.9785806980189418, 'f1': 0.9824770682848898}
Epoch 22/30, Step 0/1,Classification Loss: 0.3170, Contrastive Loss: 0.0250
Epoch 22/30, Step 20/1,Classification Loss: 0.3178, Contrastive Loss: 0.0238
Epoch 22/30, Step 40/1,Classification Loss: 0.3297, Contrastive Loss: 0.0273
Epoch 22/30, Step 60/1,Classification Loss: 0.3595, Contrastive Loss: 0.0344
Epoch 22/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0247
Epoch 22/30, Step 100/1,Classification Loss: 0.3226, Contrastive Loss: 0.0233
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 22/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0230
Accuracy: 0.9945, Precision: 0.9963, Recall: 0.9807, F1: 0.9883
Accuracy: 0.9908, Precision: 0.9891, Recall: 0.9729, F1: 0.9808
Epoch 22/30
Training - Loss: 52.3303
Training Metrics: {'accuracy': 0.9944727891156463, 'precision': 0.9963061813194196, 'recall': 0.9806729215405718, 'f1': 0.9883077564809271}
Validation Metrics: {'accuracy': 0.9907574630829704, 'precision': 0.9890975183339388, 'recall': 0.9728663698350759, 'f1': 0.9807803483978578}
Epoch 23/30, Step 0/1,Classification Loss: 0.3355, Contrastive Loss: 0.0277
Epoch 23/30, Step 20/1,Classification Loss: 0.3431, Contrastive Loss: 0.0263
Epoch 23/30, Step 40/1,Classification Loss: 0.3347, Contrastive Loss: 0.0248
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 23/30, Step 80/1,Classification Loss: 0.3259, Contrastive Loss: 0.0254
Epoch 23/30, Step 100/1,Classification Loss: 0.3217, Contrastive Loss: 0.0224
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0224
Epoch 23/30, Step 140/1,Classification Loss: 0.3284, Contrastive Loss: 0.0238
Accuracy: 0.9954, Precision: 0.9959, Recall: 0.9849, F1: 0.9903
Accuracy: 0.9917, Precision: 0.9881, Recall: 0.9778, F1: 0.9829
Epoch 23/30
Training - Loss: 52.2013
Training Metrics: {'accuracy': 0.9954294217687075, 'precision': 0.9958570712520693, 'recall': 0.9849005948986534, 'f1': 0.9902901556577379}
Validation Metrics: {'accuracy': 0.9917135875916286, 'precision': 0.9881355564485244, 'recall': 0.9777727142548778, 'f1': 0.9828720396394379}
Epoch 24/30, Step 0/1,Classification Loss: 0.3163, Contrastive Loss: 0.0205
Epoch 24/30, Step 20/1,Classification Loss: 0.3432, Contrastive Loss: 0.0308
Epoch 24/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0215
Epoch 24/30, Step 60/1,Classification Loss: 0.3301, Contrastive Loss: 0.0259
Epoch 24/30, Step 80/1,Classification Loss: 0.3586, Contrastive Loss: 0.0256
Epoch 24/30, Step 100/1,Classification Loss: 0.3137, Contrastive Loss: 0.0211
Epoch 24/30, Step 120/1,Classification Loss: 0.3430, Contrastive Loss: 0.0243
Epoch 24/30, Step 140/1,Classification Loss: 0.3302, Contrastive Loss: 0.0220
Accuracy: 0.9957, Precision: 0.9963, Recall: 0.9854, F1: 0.9908
Accuracy: 0.9919, Precision: 0.9886, Recall: 0.9782, F1: 0.9833
Epoch 24/30
Training - Loss: 52.3525
Training Metrics: {'accuracy': 0.9956685799319728, 'precision': 0.9963287501758541, 'recall': 0.9854352185568617, 'f1': 0.9907944478118925}
Validation Metrics: {'accuracy': 0.9919260597046637, 'precision': 0.9885795097600869, 'recall': 0.9782072426883539, 'f1': 0.9833112181102215}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 25/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0199
Epoch 25/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0250
Epoch 25/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0244
Epoch 25/30, Step 100/1,Classification Loss: 0.3203, Contrastive Loss: 0.0236
Epoch 25/30, Step 120/1,Classification Loss: 0.3307, Contrastive Loss: 0.0216
Epoch 25/30, Step 140/1,Classification Loss: 0.3439, Contrastive Loss: 0.0233
Accuracy: 0.9952, Precision: 0.9960, Recall: 0.9842, F1: 0.9900
Accuracy: 0.9914, Precision: 0.9879, Recall: 0.9767, F1: 0.9822
Epoch 25/30
Training - Loss: 52.0357
Training Metrics: {'accuracy': 0.9952434098639455, 'precision': 0.9960100797604707, 'recall': 0.9841641675894545, 'f1': 0.9899828567196689}
Validation Metrics: {'accuracy': 0.9913948794220758, 'precision': 0.9879324993809624, 'recall': 0.9766549795305857, 'f1': 0.9821964150452906}
Epoch 26/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0204
Epoch 26/30, Step 20/1,Classification Loss: 0.3354, Contrastive Loss: 0.0224
Epoch 26/30, Step 40/1,Classification Loss: 0.3293, Contrastive Loss: 0.0223
Epoch 26/30, Step 60/1,Classification Loss: 0.3196, Contrastive Loss: 0.0191
Epoch 26/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0212
Epoch 26/30, Step 100/1,Classification Loss: 0.3299, Contrastive Loss: 0.0239
Epoch 26/30, Step 120/1,Classification Loss: 0.3388, Contrastive Loss: 0.0353
Epoch 26/30, Step 140/1,Classification Loss: 0.3697, Contrastive Loss: 0.0247
Accuracy: 0.9956, Precision: 0.9944, Recall: 0.9871, F1: 0.9907
Accuracy: 0.9919, Precision: 0.9844, Recall: 0.9826, F1: 0.9835
Epoch 26/30
Training - Loss: 51.9946
Training Metrics: {'accuracy': 0.9956154336734694, 'precision': 0.9944156318881108, 'recall': 0.987138306049371, 'f1': 0.9907377532825148}
Validation Metrics: {'accuracy': 0.9919260597046637, 'precision': 0.9843631265388005, 'recall': 0.9825560353797455, 'f1': 0.9834570736001915}
Epoch 27/30, Step 0/1,Classification Loss: 0.3201, Contrastive Loss: 0.0205
Epoch 27/30, Step 20/1,Classification Loss: 0.3296, Contrastive Loss: 0.0210
Epoch 27/30, Step 40/1,Classification Loss: 0.3441, Contrastive Loss: 0.0253
Epoch 27/30, Step 60/1,Classification Loss: 0.3555, Contrastive Loss: 0.0237
Epoch 27/30, Step 80/1,Classification Loss: 0.3291, Contrastive Loss: 0.0216
Epoch 27/30, Step 100/1,Classification Loss: 0.3508, Contrastive Loss: 0.0256
Epoch 27/30, Step 120/1,Classification Loss: 0.3589, Contrastive Loss: 0.0247
Epoch 27/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0218
Accuracy: 0.9955, Precision: 0.9962, Recall: 0.9850, F1: 0.9905
Accuracy: 0.9918, Precision: 0.9885, Recall: 0.9778, F1: 0.9831
Epoch 27/30
Training - Loss: 51.8148
Training Metrics: {'accuracy': 0.9955091411564626, 'precision': 0.9962424278203024, 'recall': 0.9849571234212398, 'f1': 0.9905054771293829}
Validation Metrics: {'accuracy': 0.9918198236481461, 'precision': 0.9885121036850861, 'recall': 0.9778346644469234, 'f1': 0.9830862915538942}
Epoch 28/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0186
Epoch 28/30, Step 20/1,Classification Loss: 0.3548, Contrastive Loss: 0.0240
Epoch 28/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0189
Epoch 28/30, Step 60/1,Classification Loss: 0.3380, Contrastive Loss: 0.0214
Epoch 28/30, Step 80/1,Classification Loss: 0.3395, Contrastive Loss: 0.0227
Epoch 28/30, Step 100/1,Classification Loss: 0.3523, Contrastive Loss: 0.0255
Epoch 28/30, Step 120/1,Classification Loss: 0.3188, Contrastive Loss: 0.0206
Epoch 28/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Accuracy: 0.9946, Precision: 0.9960, Recall: 0.9815, F1: 0.9886
Accuracy: 0.9898, Precision: 0.9875, Recall: 0.9704, F1: 0.9788
Epoch 28/30
Training - Loss: 51.8568
Training Metrics: {'accuracy': 0.9946056547619048, 'precision': 0.9959653533752064, 'recall': 0.981502609515529, 'f1': 0.9885785615198062}
Validation Metrics: {'accuracy': 0.9898013385743121, 'precision': 0.9875481781156489, 'recall': 0.9704450498103548, 'f1': 0.9787718310113261}
Epoch 29/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0237
Epoch 29/30, Step 20/1,Classification Loss: 0.3502, Contrastive Loss: 0.0262
Epoch 29/30, Step 40/1,Classification Loss: 0.3679, Contrastive Loss: 0.0267
Epoch 29/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0192
Epoch 29/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0201
Epoch 29/30, Step 100/1,Classification Loss: 0.3261, Contrastive Loss: 0.0199
Epoch 29/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0211
Epoch 29/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0203
Accuracy: 0.9953, Precision: 0.9942, Recall: 0.9862, F1: 0.9902
Accuracy: 0.9915, Precision: 0.9856, Recall: 0.9795, F1: 0.9825
Epoch 29/30
Training - Loss: 51.7848
Training Metrics: {'accuracy': 0.9952965561224489, 'precision': 0.9941839868236952, 'recall': 0.9862275196977918, 'f1': 0.9901585442431811}
Validation Metrics: {'accuracy': 0.9915011154785934, 'precision': 0.9855637022963637, 'recall': 0.9795125821670971, 'f1': 0.982510043764839}
Epoch 30/30, Step 0/1,Classification Loss: 0.3550, Contrastive Loss: 0.0241
Epoch 30/30, Step 20/1,Classification Loss: 0.3348, Contrastive Loss: 0.0226
Epoch 30/30, Step 40/1,Classification Loss: 0.3181, Contrastive Loss: 0.0193
Epoch 30/30, Step 60/1,Classification Loss: 0.3205, Contrastive Loss: 0.0206
Epoch 30/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0206
Epoch 30/30, Step 100/1,Classification Loss: 0.3293, Contrastive Loss: 0.0202
Epoch 30/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0200
Epoch 30/30, Step 140/1,Classification Loss: 0.3499, Contrastive Loss: 0.0223
Accuracy: 0.9954, Precision: 0.9964, Recall: 0.9844, F1: 0.9903
Accuracy: 0.9917, Precision: 0.9894, Recall: 0.9765, F1: 0.9828
Epoch 30/30
Training - Loss: 51.6997
Training Metrics: {'accuracy': 0.9954028486394558, 'precision': 0.9964313073266595, 'recall': 0.9843957118239661, 'f1': 0.990306043049028}
Validation Metrics: {'accuracy': 0.9917135875916286, 'precision': 0.9893791540642274, 'recall': 0.9765302020573372, 'f1': 0.9828286682709777}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (887, 5814), y shape: (887,), y distribution: Counter({np.float64(0.0): 804, np.float64(1.0): 83}), env shape: (887,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9053, Precision: 0.6203, Recall: 0.5048, F1: 0.4867
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13015]))
original train data shape: torch.Size([47162]), new train data shape: torch.Size([100])
original test data shape: torch.Size([887, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([47162]), new train data shape: torch.Size([47162])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13015]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.6150
Epoch 1/30, Step 20/1,Classification Loss: 0.3648, Contrastive Loss: 1.2160
Epoch 1/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.6767
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.3679
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2554
Epoch 1/30, Step 100/1,Classification Loss: 0.3168, Contrastive Loss: 0.2087
Epoch 1/30, Step 120/1,Classification Loss: 0.3319, Contrastive Loss: 0.1908
Epoch 1/30, Step 140/1,Classification Loss: 0.3204, Contrastive Loss: 0.1622
Accuracy: 0.9955, Precision: 0.9944, Recall: 0.9867, F1: 0.9905
Accuracy: 0.9906, Precision: 0.9823, Recall: 0.9790, F1: 0.9806
Epoch 1/30
Training - Loss: 126.9411
Training Metrics: {'accuracy': 0.9955091411564626, 'precision': 0.9944277049451563, 'recall': 0.9866540883813049, 'f1': 0.990496172499605}
Validation Metrics: {'accuracy': 0.9905650376338386, 'precision': 0.9822743215997135, 'recall': 0.9789745758577875, 'f1': 0.9806160454896773}
Epoch 2/30, Step 0/1,Classification Loss: 0.3361, Contrastive Loss: 0.1626
Epoch 2/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.1454
Epoch 2/30, Step 40/1,Classification Loss: 0.3670, Contrastive Loss: 0.1741
Epoch 2/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1283
Epoch 2/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1298
Epoch 2/30, Step 100/1,Classification Loss: 0.3446, Contrastive Loss: 0.1431
Epoch 2/30, Step 120/1,Classification Loss: 0.3332, Contrastive Loss: 0.1192
Epoch 2/30, Step 140/1,Classification Loss: 0.3457, Contrastive Loss: 0.1291
Accuracy: 0.9956, Precision: 0.9946, Recall: 0.9871, F1: 0.9908
Accuracy: 0.9901, Precision: 0.9835, Recall: 0.9759, F1: 0.9797
Epoch 2/30
Training - Loss: 68.8040
Training Metrics: {'accuracy': 0.9956420068027211, 'precision': 0.9946011778326169, 'recall': 0.9871014037683921, 'f1': 0.9908096061116806}
Validation Metrics: {'accuracy': 0.9901409943814269, 'precision': 0.9834664258192878, 'recall': 0.9759328919720163, 'f1': 0.9796558816766715}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1122
Epoch 3/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1197
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1074
Epoch 3/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1177
Epoch 3/30, Step 80/1,Classification Loss: 0.3643, Contrastive Loss: 0.1204
Epoch 3/30, Step 100/1,Classification Loss: 0.3144, Contrastive Loss: 0.1021
Epoch 3/30, Step 120/1,Classification Loss: 0.3378, Contrastive Loss: 0.1053
Epoch 3/30, Step 140/1,Classification Loss: 0.3293, Contrastive Loss: 0.1121
Accuracy: 0.9952, Precision: 0.9946, Recall: 0.9853, F1: 0.9898
Accuracy: 0.9898, Precision: 0.9830, Recall: 0.9751, F1: 0.9790
Epoch 3/30
Training - Loss: 64.5924
Training Metrics: {'accuracy': 0.9951902636054422, 'precision': 0.994577585086404, 'recall': 0.9852506194193886, 'f1': 0.9898495176633823}
Validation Metrics: {'accuracy': 0.989822961942118, 'precision': 0.9829542158818618, 'recall': 0.9751264856367357, 'f1': 0.9789930212424806}
Epoch 4/30, Step 0/1,Classification Loss: 0.3171, Contrastive Loss: 0.0985
Epoch 4/30, Step 20/1,Classification Loss: 0.3601, Contrastive Loss: 0.1073
Epoch 4/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.1043
Epoch 4/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0887
Epoch 4/30, Step 80/1,Classification Loss: 0.3918, Contrastive Loss: 0.1161
Epoch 4/30, Step 100/1,Classification Loss: 0.3280, Contrastive Loss: 0.0882
Epoch 4/30, Step 120/1,Classification Loss: 0.3291, Contrastive Loss: 0.0953
Epoch 4/30, Step 140/1,Classification Loss: 0.3444, Contrastive Loss: 0.1015
Accuracy: 0.9959, Precision: 0.9949, Recall: 0.9880, F1: 0.9915
Accuracy: 0.9906, Precision: 0.9826, Recall: 0.9787, F1: 0.9806
Epoch 4/30
Training - Loss: 62.5853
Training Metrics: {'accuracy': 0.9959343112244898, 'precision': 0.9949472427665274, 'recall': 0.9880272014696464, 'f1': 0.9914517223902033}
Validation Metrics: {'accuracy': 0.9905650376338386, 'precision': 0.9825673031152483, 'recall': 0.9786640797358828, 'f1': 0.9806039378762846}
Epoch 5/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0848
Epoch 5/30, Step 20/1,Classification Loss: 0.3601, Contrastive Loss: 0.1064
Epoch 5/30, Step 40/1,Classification Loss: 0.3441, Contrastive Loss: 0.0919
Epoch 5/30, Step 60/1,Classification Loss: 0.3166, Contrastive Loss: 0.0842
Epoch 5/30, Step 80/1,Classification Loss: 0.3669, Contrastive Loss: 0.1031
Epoch 5/30, Step 100/1,Classification Loss: 0.3444, Contrastive Loss: 0.0909
Epoch 5/30, Step 120/1,Classification Loss: 0.3195, Contrastive Loss: 0.0795
Epoch 5/30, Step 140/1,Classification Loss: 0.3339, Contrastive Loss: 0.0858
Accuracy: 0.9957, Precision: 0.9945, Recall: 0.9874, F1: 0.9909
Accuracy: 0.9909, Precision: 0.9834, Recall: 0.9792, F1: 0.9813
Epoch 5/30
Training - Loss: 61.1618
Training Metrics: {'accuracy': 0.9956951530612245, 'precision': 0.9945497607644733, 'recall': 0.9873641988740269, 'f1': 0.9909187317008179}
Validation Metrics: {'accuracy': 0.9908830700731475, 'precision': 0.9833710855938265, 'recall': 0.9791599899492585, 'f1': 0.9812518811950016}
Epoch 6/30, Step 0/1,Classification Loss: 0.3459, Contrastive Loss: 0.0865
Epoch 6/30, Step 20/1,Classification Loss: 0.3180, Contrastive Loss: 0.0761
Epoch 6/30, Step 40/1,Classification Loss: 0.3141, Contrastive Loss: 0.0763
Epoch 6/30, Step 60/1,Classification Loss: 0.3303, Contrastive Loss: 0.0772
Epoch 6/30, Step 80/1,Classification Loss: 0.3446, Contrastive Loss: 0.0939
Epoch 6/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0788
Epoch 6/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0903
Epoch 6/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0680
Accuracy: 0.9961, Precision: 0.9949, Recall: 0.9885, F1: 0.9917
Accuracy: 0.9908, Precision: 0.9839, Recall: 0.9782, F1: 0.9810
Epoch 6/30
Training - Loss: 59.9426
Training Metrics: {'accuracy': 0.9960671768707483, 'precision': 0.9949264886811024, 'recall': 0.9885142878828128, 'f1': 0.9916900141517271}
Validation Metrics: {'accuracy': 0.9907770592600446, 'precision': 0.9838921469897124, 'recall': 0.978166696886387, 'f1': 0.9810041878600597}
Epoch 7/30, Step 0/1,Classification Loss: 0.3364, Contrastive Loss: 0.0805
Epoch 7/30, Step 20/1,Classification Loss: 0.3452, Contrastive Loss: 0.0872
Epoch 7/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0707
Epoch 7/30, Step 60/1,Classification Loss: 0.3326, Contrastive Loss: 0.0730
Epoch 7/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0693
Epoch 7/30, Step 100/1,Classification Loss: 0.3310, Contrastive Loss: 0.0699
Epoch 7/30, Step 120/1,Classification Loss: 0.3273, Contrastive Loss: 0.0684
Epoch 7/30, Step 140/1,Classification Loss: 0.3604, Contrastive Loss: 0.0776
Accuracy: 0.9943, Precision: 0.9955, Recall: 0.9805, F1: 0.9879
Accuracy: 0.9876, Precision: 0.9871, Recall: 0.9617, F1: 0.9739
Epoch 7/30
Training - Loss: 58.8548
Training Metrics: {'accuracy': 0.9942867772108843, 'precision': 0.9955258989919077, 'recall': 0.9805237909611477, 'f1': 0.9878577072365453}
Validation Metrics: {'accuracy': 0.9875967348669564, 'precision': 0.9871362636167482, 'recall': 0.9617192382421511, 'f1': 0.9739288093152063}
Epoch 8/30, Step 0/1,Classification Loss: 0.3277, Contrastive Loss: 0.0661
Epoch 8/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0653
Epoch 8/30, Step 40/1,Classification Loss: 0.3449, Contrastive Loss: 0.0698
Epoch 8/30, Step 60/1,Classification Loss: 0.3188, Contrastive Loss: 0.0626
Epoch 8/30, Step 80/1,Classification Loss: 0.3401, Contrastive Loss: 0.0669
Epoch 8/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0633
Epoch 8/30, Step 120/1,Classification Loss: 0.3168, Contrastive Loss: 0.0614
Epoch 8/30, Step 140/1,Classification Loss: 0.3186, Contrastive Loss: 0.0601
Accuracy: 0.9952, Precision: 0.9948, Recall: 0.9852, F1: 0.9899
Accuracy: 0.9893, Precision: 0.9832, Recall: 0.9726, F1: 0.9778
Epoch 8/30
Training - Loss: 58.0833
Training Metrics: {'accuracy': 0.9952434098639455, 'precision': 0.9947519362150137, 'recall': 0.9851720937067847, 'f1': 0.989894157458214}
Validation Metrics: {'accuracy': 0.9892929078766034, 'precision': 0.983200705716302, 'recall': 0.972643989297617, 'f1': 0.9778361844383393}
Epoch 9/30, Step 0/1,Classification Loss: 0.3569, Contrastive Loss: 0.0728
Epoch 9/30, Step 20/1,Classification Loss: 0.3207, Contrastive Loss: 0.0613
Epoch 9/30, Step 40/1,Classification Loss: 0.3201, Contrastive Loss: 0.0577
Epoch 9/30, Step 60/1,Classification Loss: 0.3186, Contrastive Loss: 0.0565
Epoch 9/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0582
Epoch 9/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0546
Epoch 9/30, Step 120/1,Classification Loss: 0.3444, Contrastive Loss: 0.0587
Epoch 9/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0547
Accuracy: 0.9959, Precision: 0.9949, Recall: 0.9878, F1: 0.9913
Accuracy: 0.9901, Precision: 0.9835, Recall: 0.9759, F1: 0.9797
Epoch 9/30
Training - Loss: 57.3099
Training Metrics: {'accuracy': 0.9958811649659864, 'precision': 0.994902256368779, 'recall': 0.9877850640777279, 'f1': 0.9913061833389343}
Validation Metrics: {'accuracy': 0.9901409943814269, 'precision': 0.9834664258192878, 'recall': 0.9759328919720163, 'f1': 0.9796558816766715}
Epoch 10/30, Step 0/1,Classification Loss: 0.3324, Contrastive Loss: 0.0589
Epoch 10/30, Step 20/1,Classification Loss: 0.3303, Contrastive Loss: 0.0687
Epoch 10/30, Step 40/1,Classification Loss: 0.3160, Contrastive Loss: 0.0550
Epoch 10/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0539
Epoch 10/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0521
Epoch 10/30, Step 100/1,Classification Loss: 0.3288, Contrastive Loss: 0.0529
Epoch 10/30, Step 120/1,Classification Loss: 0.3515, Contrastive Loss: 0.0558
Epoch 10/30, Step 140/1,Classification Loss: 0.3801, Contrastive Loss: 0.0783
Accuracy: 0.9949, Precision: 0.9968, Recall: 0.9819, F1: 0.9892
Accuracy: 0.9896, Precision: 0.9894, Recall: 0.9679, F1: 0.9783
Epoch 10/30
Training - Loss: 56.6656
Training Metrics: {'accuracy': 0.9949245323129252, 'precision': 0.996819107784064, 'recall': 0.9818594350496793, 'f1': 0.9891739438650263}
Validation Metrics: {'accuracy': 0.9896109403159122, 'precision': 0.9893541194954023, 'recall': 0.9678614654386108, 'f1': 0.9782537285344625}
Epoch 11/30, Step 0/1,Classification Loss: 0.3331, Contrastive Loss: 0.0564
Epoch 11/30, Step 20/1,Classification Loss: 0.3427, Contrastive Loss: 0.0540
Epoch 11/30, Step 40/1,Classification Loss: 0.3194, Contrastive Loss: 0.0489
Epoch 11/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0518
Epoch 11/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0477
Epoch 11/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0516
Epoch 11/30, Step 120/1,Classification Loss: 0.3154, Contrastive Loss: 0.0463
Epoch 11/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0492
Accuracy: 0.9958, Precision: 0.9948, Recall: 0.9877, F1: 0.9912
Accuracy: 0.9904, Precision: 0.9830, Recall: 0.9773, F1: 0.9801
Epoch 11/30
Training - Loss: 56.0794
Training Metrics: {'accuracy': 0.9958280187074829, 'precision': 0.9947927925731355, 'recall': 0.9876871673134239, 'f1': 0.9912025939809099}
Validation Metrics: {'accuracy': 0.9903530160076328, 'precision': 0.98301354021249, 'recall': 0.9772984858539495, 'f1': 0.9801308171869589}
Epoch 12/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0455
Epoch 12/30, Step 20/1,Classification Loss: 0.3141, Contrastive Loss: 0.0474
Epoch 12/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0445
Epoch 12/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0430
Epoch 12/30, Step 80/1,Classification Loss: 0.3251, Contrastive Loss: 0.0458
Epoch 12/30, Step 100/1,Classification Loss: 0.3321, Contrastive Loss: 0.0479
Epoch 12/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0430
Epoch 12/30, Step 140/1,Classification Loss: 0.3167, Contrastive Loss: 0.0438
Accuracy: 0.9959, Precision: 0.9953, Recall: 0.9877, F1: 0.9915
Accuracy: 0.9901, Precision: 0.9811, Recall: 0.9784, F1: 0.9798
Epoch 12/30
Training - Loss: 55.5109
Training Metrics: {'accuracy': 0.9959343112244898, 'precision': 0.9952742517589458, 'recall': 0.9877247842284613, 'f1': 0.9914572516395455}
Validation Metrics: {'accuracy': 0.9901409943814269, 'precision': 0.9811093342080657, 'recall': 0.9784168609472548, 'f1': 0.9797574887766388}
Epoch 13/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0479
Epoch 13/30, Step 20/1,Classification Loss: 0.3430, Contrastive Loss: 0.0471
Epoch 13/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0444
Epoch 13/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0466
Epoch 13/30, Step 80/1,Classification Loss: 0.3581, Contrastive Loss: 0.0596
Epoch 13/30, Step 100/1,Classification Loss: 0.3431, Contrastive Loss: 0.0442
Epoch 13/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0391
Epoch 13/30, Step 140/1,Classification Loss: 0.3296, Contrastive Loss: 0.0425
Accuracy: 0.9959, Precision: 0.9948, Recall: 0.9881, F1: 0.9914
Accuracy: 0.9908, Precision: 0.9845, Recall: 0.9775, F1: 0.9810
Epoch 13/30
Training - Loss: 55.2548
Training Metrics: {'accuracy': 0.9959077380952381, 'precision': 0.994765927655665, 'recall': 0.9880767572808593, 'f1': 0.9913881844375008}
Validation Metrics: {'accuracy': 0.9907770592600446, 'precision': 0.9844891662838169, 'recall': 0.9775457046425774, 'f1': 0.9809803514084783}
Epoch 14/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0393
Epoch 14/30, Step 20/1,Classification Loss: 0.3528, Contrastive Loss: 0.0448
Epoch 14/30, Step 40/1,Classification Loss: 0.3160, Contrastive Loss: 0.0380
Epoch 14/30, Step 60/1,Classification Loss: 0.3446, Contrastive Loss: 0.0624
Epoch 14/30, Step 80/1,Classification Loss: 0.3298, Contrastive Loss: 0.0425
Epoch 14/30, Step 100/1,Classification Loss: 0.3196, Contrastive Loss: 0.0394
Epoch 14/30, Step 120/1,Classification Loss: 0.3555, Contrastive Loss: 0.0440
Epoch 14/30, Step 140/1,Classification Loss: 0.3139, Contrastive Loss: 0.0374
Accuracy: 0.9959, Precision: 0.9948, Recall: 0.9881, F1: 0.9914
Accuracy: 0.9906, Precision: 0.9843, Recall: 0.9768, F1: 0.9805
Epoch 14/30
Training - Loss: 54.4897
Training Metrics: {'accuracy': 0.9959077380952381, 'precision': 0.9947592541519276, 'recall': 0.9880529345502335, 'f1': 0.9913728003359722}
Validation Metrics: {'accuracy': 0.9905650376338386, 'precision': 0.9843483797497469, 'recall': 0.9768011030044539, 'f1': 0.9805308975185352}
Epoch 15/30, Step 0/1,Classification Loss: 0.3165, Contrastive Loss: 0.0377
Epoch 15/30, Step 20/1,Classification Loss: 0.3134, Contrastive Loss: 0.0356
Epoch 15/30, Step 40/1,Classification Loss: 0.3499, Contrastive Loss: 0.0444
Epoch 15/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0368
Epoch 15/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0354
Epoch 15/30, Step 100/1,Classification Loss: 0.3280, Contrastive Loss: 0.0377
Epoch 15/30, Step 120/1,Classification Loss: 0.3601, Contrastive Loss: 0.0438
Epoch 15/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0333
Accuracy: 0.9955, Precision: 0.9949, Recall: 0.9860, F1: 0.9904
Accuracy: 0.9894, Precision: 0.9821, Recall: 0.9743, F1: 0.9781
Epoch 15/30
Training - Loss: 54.3291
Training Metrics: {'accuracy': 0.9954825680272109, 'precision': 0.994889603036152, 'recall': 0.9860138791159516, 'f1': 0.9903935898258545}
Validation Metrics: {'accuracy': 0.9893989186897063, 'precision': 0.9820717010335706, 'recall': 0.974258274604298, 'f1': 0.9781177304609172}
Epoch 16/30, Step 0/1,Classification Loss: 0.3272, Contrastive Loss: 0.0375
Epoch 16/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0359
Epoch 16/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0332
Epoch 16/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0466
Epoch 16/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0376
Epoch 16/30, Step 100/1,Classification Loss: 0.3308, Contrastive Loss: 0.0342
Epoch 16/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0330
Epoch 16/30, Step 140/1,Classification Loss: 0.3255, Contrastive Loss: 0.0346
Accuracy: 0.9960, Precision: 0.9949, Recall: 0.9881, F1: 0.9915
Accuracy: 0.9905, Precision: 0.9834, Recall: 0.9774, F1: 0.9803
Epoch 16/30
Training - Loss: 53.7498
Training Metrics: {'accuracy': 0.9959608843537415, 'precision': 0.9949466769861097, 'recall': 0.9880598487278319, 'f1': 0.9914682011482121}
Validation Metrics: {'accuracy': 0.9904590268207357, 'precision': 0.9833816113100946, 'recall': 0.9773602905511065, 'f1': 0.980343002417271}
Epoch 17/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0327
Epoch 17/30, Step 20/1,Classification Loss: 0.3519, Contrastive Loss: 0.0357
Epoch 17/30, Step 40/1,Classification Loss: 0.3342, Contrastive Loss: 0.0361
Epoch 17/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0307
Epoch 17/30, Step 80/1,Classification Loss: 0.3387, Contrastive Loss: 0.0349
Epoch 17/30, Step 100/1,Classification Loss: 0.3334, Contrastive Loss: 0.0310
Epoch 17/30, Step 120/1,Classification Loss: 0.3275, Contrastive Loss: 0.0320
Epoch 17/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0298
Accuracy: 0.9949, Precision: 0.9943, Recall: 0.9842, F1: 0.9892
Accuracy: 0.9882, Precision: 0.9837, Recall: 0.9677, F1: 0.9755
Epoch 17/30
Training - Loss: 53.5170
Training Metrics: {'accuracy': 0.9948979591836735, 'precision': 0.994303498857613, 'recall': 0.9841881455079741, 'f1': 0.989169998201331}
Validation Metrics: {'accuracy': 0.9882327997455741, 'precision': 0.9837246905365049, 'recall': 0.9676789966193797, 'f1': 0.9755024210784982}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0287
Epoch 18/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0328
Epoch 18/30, Step 40/1,Classification Loss: 0.3601, Contrastive Loss: 0.0359
Epoch 18/30, Step 60/1,Classification Loss: 0.3402, Contrastive Loss: 0.0326
Epoch 18/30, Step 80/1,Classification Loss: 0.3177, Contrastive Loss: 0.0296
Epoch 18/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0297
Epoch 18/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0326
Epoch 18/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0269
Accuracy: 0.9958, Precision: 0.9950, Recall: 0.9875, F1: 0.9912
Accuracy: 0.9900, Precision: 0.9849, Recall: 0.9740, F1: 0.9794
Epoch 18/30
Training - Loss: 53.2048
Training Metrics: {'accuracy': 0.9958280187074829, 'precision': 0.9949548358336007, 'recall': 0.9875263361858417, 'f1': 0.991199733288745}
Validation Metrics: {'accuracy': 0.990034983568324, 'precision': 0.9849063836013545, 'recall': 0.9740081105434304, 'f1': 0.9793657789651031}
Epoch 19/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0335
Epoch 19/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.0331
Epoch 19/30, Step 40/1,Classification Loss: 0.3451, Contrastive Loss: 0.0331
Epoch 19/30, Step 60/1,Classification Loss: 0.3295, Contrastive Loss: 0.0332
Epoch 19/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0263
Epoch 19/30, Step 100/1,Classification Loss: 0.3513, Contrastive Loss: 0.0402
Epoch 19/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 19/30, Step 140/1,Classification Loss: 0.3293, Contrastive Loss: 0.0291
Accuracy: 0.9959, Precision: 0.9948, Recall: 0.9878, F1: 0.9913
Accuracy: 0.9901, Precision: 0.9838, Recall: 0.9756, F1: 0.9796
Epoch 19/30
Training - Loss: 52.9748
Training Metrics: {'accuracy': 0.9958545918367347, 'precision': 0.9948128770413727, 'recall': 0.9877985622062955, 'f1': 0.9912692675419164}
Validation Metrics: {'accuracy': 0.9901409943814269, 'precision': 0.983766059300661, 'recall': 0.9756223958501113, 'f1': 0.9796430920175198}
Epoch 20/30, Step 0/1,Classification Loss: 0.3360, Contrastive Loss: 0.0307
Epoch 20/30, Step 20/1,Classification Loss: 0.3180, Contrastive Loss: 0.0286
Epoch 20/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0526
Epoch 20/30, Step 60/1,Classification Loss: 0.3210, Contrastive Loss: 0.0274
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 20/30, Step 100/1,Classification Loss: 0.3493, Contrastive Loss: 0.0317
Epoch 20/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0399
Epoch 20/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Accuracy: 0.9956, Precision: 0.9947, Recall: 0.9868, F1: 0.9907
Accuracy: 0.9897, Precision: 0.9847, Recall: 0.9729, F1: 0.9787
Epoch 20/30
Training - Loss: 52.7286
Training Metrics: {'accuracy': 0.9956154336734694, 'precision': 0.9947422110605761, 'recall': 0.9868231400422286, 'f1': 0.9907362437449956}
Validation Metrics: {'accuracy': 0.9897169511290151, 'precision': 0.9846978118181742, 'recall': 0.9728912080862449, 'f1': 0.9786870506131682}
Epoch 21/30, Step 0/1,Classification Loss: 0.3171, Contrastive Loss: 0.0265
Epoch 21/30, Step 20/1,Classification Loss: 0.3218, Contrastive Loss: 0.0245
Epoch 21/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0242
Epoch 21/30, Step 60/1,Classification Loss: 0.3528, Contrastive Loss: 0.0311
Epoch 21/30, Step 80/1,Classification Loss: 0.3603, Contrastive Loss: 0.0318
Epoch 21/30, Step 100/1,Classification Loss: 0.3455, Contrastive Loss: 0.0330
Epoch 21/30, Step 120/1,Classification Loss: 0.3444, Contrastive Loss: 0.0312
Epoch 21/30, Step 140/1,Classification Loss: 0.3299, Contrastive Loss: 0.0270
Accuracy: 0.9955, Precision: 0.9947, Recall: 0.9866, F1: 0.9906
Accuracy: 0.9897, Precision: 0.9835, Recall: 0.9741, F1: 0.9787
Epoch 21/30
Training - Loss: 52.4341
Training Metrics: {'accuracy': 0.9955357142857143, 'precision': 0.9947045761640836, 'recall': 0.9865795564736592, 'f1': 0.9905930938328094}
Validation Metrics: {'accuracy': 0.9897169511290151, 'precision': 0.9834833790594093, 'recall': 0.9741331925738642, 'f1': 0.9787407843433831}
Epoch 22/30, Step 0/1,Classification Loss: 0.3263, Contrastive Loss: 0.0267
Epoch 22/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0223
Epoch 22/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0234
Epoch 22/30, Step 60/1,Classification Loss: 0.3194, Contrastive Loss: 0.0255
Epoch 22/30, Step 80/1,Classification Loss: 0.3372, Contrastive Loss: 0.0280
Epoch 22/30, Step 100/1,Classification Loss: 0.3354, Contrastive Loss: 0.0300
Epoch 22/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0240
Epoch 22/30, Step 140/1,Classification Loss: 0.3285, Contrastive Loss: 0.0236
Accuracy: 0.9952, Precision: 0.9954, Recall: 0.9844, F1: 0.9898
Accuracy: 0.9877, Precision: 0.9818, Recall: 0.9674, F1: 0.9744
Epoch 22/30
Training - Loss: 52.1800
Training Metrics: {'accuracy': 0.9951902636054422, 'precision': 0.9953885254900849, 'recall': 0.9843899247150147, 'f1': 0.9897996707584316}
Validation Metrics: {'accuracy': 0.9877027456800593, 'precision': 0.9818344939750691, 'recall': 0.9673699731335947, 'f1': 0.9744395771925571}
Epoch 23/30, Step 0/1,Classification Loss: 0.3517, Contrastive Loss: 0.0340
Epoch 23/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0384
Epoch 23/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0237
Epoch 23/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0247
Epoch 23/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0333
Epoch 23/30, Step 100/1,Classification Loss: 0.3441, Contrastive Loss: 0.0267
Epoch 23/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0221
Epoch 23/30, Step 140/1,Classification Loss: 0.3240, Contrastive Loss: 0.0241
Accuracy: 0.9957, Precision: 0.9950, Recall: 0.9868, F1: 0.9909
Accuracy: 0.9894, Precision: 0.9833, Recall: 0.9730, F1: 0.9781
Epoch 23/30
Training - Loss: 52.0930
Training Metrics: {'accuracy': 0.9956685799319728, 'precision': 0.9950233849766907, 'recall': 0.9867977448397856, 'f1': 0.9908604449775497}
Validation Metrics: {'accuracy': 0.9893989186897063, 'precision': 0.9832713735420313, 'recall': 0.9730162901166788, 'f1': 0.9780625498958966}
Epoch 24/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0263
Epoch 24/30, Step 20/1,Classification Loss: 0.3450, Contrastive Loss: 0.0254
Epoch 24/30, Step 40/1,Classification Loss: 0.3286, Contrastive Loss: 0.0252
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 24/30, Step 80/1,Classification Loss: 0.3138, Contrastive Loss: 0.0218
Epoch 24/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0241
Epoch 24/30, Step 120/1,Classification Loss: 0.3204, Contrastive Loss: 0.0263
Epoch 24/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0235
Accuracy: 0.9953, Precision: 0.9947, Recall: 0.9855, F1: 0.9900
Accuracy: 0.9884, Precision: 0.9832, Recall: 0.9690, F1: 0.9760
Epoch 24/30
Training - Loss: 52.2010
Training Metrics: {'accuracy': 0.9952699829931972, 'precision': 0.9947088178087486, 'recall': 0.9854680971821134, 'f1': 0.990025060291946}
Validation Metrics: {'accuracy': 0.9884448213717799, 'precision': 0.9832472022327517, 'recall': 0.969044590501313, 'f1': 0.9759896381045041}
Epoch 25/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0203
Epoch 25/30, Step 20/1,Classification Loss: 0.3338, Contrastive Loss: 0.0242
Epoch 25/30, Step 40/1,Classification Loss: 0.3244, Contrastive Loss: 0.0227
Epoch 25/30, Step 60/1,Classification Loss: 0.3199, Contrastive Loss: 0.0216
Epoch 25/30, Step 80/1,Classification Loss: 0.3450, Contrastive Loss: 0.0259
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 25/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0216
Epoch 25/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0235
Accuracy: 0.9954, Precision: 0.9946, Recall: 0.9860, F1: 0.9902
Accuracy: 0.9891, Precision: 0.9825, Recall: 0.9725, F1: 0.9774
Epoch 25/30
Training - Loss: 51.8848
Training Metrics: {'accuracy': 0.9953762755102041, 'precision': 0.9946072243201234, 'recall': 0.9859980277756164, 'f1': 0.9902476310161665}
Validation Metrics: {'accuracy': 0.9890808862503976, 'precision': 0.9824555756766433, 'recall': 0.9725203799033031, 'f1': 0.9774115502376497}
Epoch 26/30, Step 0/1,Classification Loss: 0.3298, Contrastive Loss: 0.0228
Epoch 26/30, Step 20/1,Classification Loss: 0.3199, Contrastive Loss: 0.0214
Epoch 26/30, Step 40/1,Classification Loss: 0.3442, Contrastive Loss: 0.0285
Epoch 26/30, Step 60/1,Classification Loss: 0.3172, Contrastive Loss: 0.0211
Epoch 26/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0198
Epoch 26/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0230
Epoch 26/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0219
Epoch 26/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Accuracy: 0.9957, Precision: 0.9947, Recall: 0.9873, F1: 0.9910
Accuracy: 0.9894, Precision: 0.9821, Recall: 0.9743, F1: 0.9781
Epoch 26/30
Training - Loss: 51.7682
Training Metrics: {'accuracy': 0.9956951530612245, 'precision': 0.9947298672092525, 'recall': 0.9872753105711911, 'f1': 0.9909613122451257}
Validation Metrics: {'accuracy': 0.9893989186897063, 'precision': 0.9820717010335706, 'recall': 0.974258274604298, 'f1': 0.9781177304609172}
Epoch 27/30, Step 0/1,Classification Loss: 0.3410, Contrastive Loss: 0.0233
Epoch 27/30, Step 20/1,Classification Loss: 0.3442, Contrastive Loss: 0.0224
Epoch 27/30, Step 40/1,Classification Loss: 0.3209, Contrastive Loss: 0.0210
Epoch 27/30, Step 60/1,Classification Loss: 0.3318, Contrastive Loss: 0.0338
Epoch 27/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 27/30, Step 100/1,Classification Loss: 0.3225, Contrastive Loss: 0.0231
Epoch 27/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0209
Epoch 27/30, Step 140/1,Classification Loss: 0.3333, Contrastive Loss: 0.0247
Accuracy: 0.9952, Precision: 0.9946, Recall: 0.9850, F1: 0.9898
Accuracy: 0.9886, Precision: 0.9830, Recall: 0.9697, F1: 0.9762
Epoch 27/30
Training - Loss: 51.9470
Training Metrics: {'accuracy': 0.9951636904761905, 'precision': 0.9946342075986143, 'recall': 0.9850277995493282, 'f1': 0.9897625999950124}
Validation Metrics: {'accuracy': 0.9885508321848828, 'precision': 0.9830110847310627, 'recall': 0.9697273874422796, 'f1': 0.9762325363159522}
Epoch 28/30, Step 0/1,Classification Loss: 0.3250, Contrastive Loss: 0.0208
Epoch 28/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Epoch 28/30, Step 40/1,Classification Loss: 0.3316, Contrastive Loss: 0.0213
Epoch 28/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0243
Epoch 28/30, Step 80/1,Classification Loss: 0.3449, Contrastive Loss: 0.0244
Epoch 28/30, Step 100/1,Classification Loss: 0.3317, Contrastive Loss: 0.0229
Epoch 28/30, Step 120/1,Classification Loss: 0.3322, Contrastive Loss: 0.0242
Epoch 28/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0219
Accuracy: 0.9958, Precision: 0.9949, Recall: 0.9874, F1: 0.9911
Accuracy: 0.9895, Precision: 0.9810, Recall: 0.9759, F1: 0.9784
Epoch 28/30
Training - Loss: 51.6276
Training Metrics: {'accuracy': 0.9957748724489796, 'precision': 0.9949301020041728, 'recall': 0.9873647119249891, 'f1': 0.9911049762305713}
Validation Metrics: {'accuracy': 0.9895049295028093, 'precision': 0.9809628142894964, 'recall': 0.9758725599109792, 'f1': 0.9783976064840283}
Epoch 29/30, Step 0/1,Classification Loss: 0.3252, Contrastive Loss: 0.0206
Epoch 29/30, Step 20/1,Classification Loss: 0.3308, Contrastive Loss: 0.0226
Epoch 29/30, Step 40/1,Classification Loss: 0.3192, Contrastive Loss: 0.0184
Epoch 29/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 29/30, Step 80/1,Classification Loss: 0.3387, Contrastive Loss: 0.0237
Epoch 29/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0351
Epoch 29/30, Step 120/1,Classification Loss: 0.3598, Contrastive Loss: 0.0368
Epoch 29/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0202
Accuracy: 0.9940, Precision: 0.9940, Recall: 0.9809, F1: 0.9873
Accuracy: 0.9871, Precision: 0.9830, Recall: 0.9636, F1: 0.9730
Epoch 29/30
Training - Loss: 51.7480
Training Metrics: {'accuracy': 0.9940210459183674, 'precision': 0.9940436853835053, 'recall': 0.9808875149969205, 'f1': 0.9873366293083721}
Validation Metrics: {'accuracy': 0.9870666808014418, 'precision': 0.9829602953926593, 'recall': 0.9635836876096999, 'f1': 0.972980083850945}
Epoch 30/30, Step 0/1,Classification Loss: 0.3647, Contrastive Loss: 0.0271
Epoch 30/30, Step 20/1,Classification Loss: 0.3807, Contrastive Loss: 0.0263
Epoch 30/30, Step 40/1,Classification Loss: 0.3234, Contrastive Loss: 0.0203
Epoch 30/30, Step 60/1,Classification Loss: 0.3273, Contrastive Loss: 0.0196
Epoch 30/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0186
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 30/30, Step 120/1,Classification Loss: 0.3757, Contrastive Loss: 0.0275
Epoch 30/30, Step 140/1,Classification Loss: 0.3294, Contrastive Loss: 0.0215
Accuracy: 0.9954, Precision: 0.9948, Recall: 0.9859, F1: 0.9903
Accuracy: 0.9895, Precision: 0.9833, Recall: 0.9734, F1: 0.9783
Epoch 30/30
Training - Loss: 51.7410
Training Metrics: {'accuracy': 0.9954028486394558, 'precision': 0.9947814865706639, 'recall': 0.9859124722800917, 'f1': 0.9902886746537882}
Validation Metrics: {'accuracy': 0.9895049295028093, 'precision': 0.9833420416816635, 'recall': 0.9733885909357406, 'f1': 0.9782887715876439}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (813, 5814), y shape: (813,), y distribution: Counter({np.float64(0.0): 733, np.float64(1.0): 80}), env shape: (813,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8991, Precision: 0.4507, Recall: 0.4986, F1: 0.4734
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13115]))
original train data shape: torch.Size([47262]), new train data shape: torch.Size([100])
original test data shape: torch.Size([813, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([47262]), new train data shape: torch.Size([47262])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13115]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3328, Contrastive Loss: 1.5618
Epoch 1/30, Step 20/1,Classification Loss: 0.3244, Contrastive Loss: 0.9993
Epoch 1/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.4307
Epoch 1/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.2491
Epoch 1/30, Step 80/1,Classification Loss: 0.3396, Contrastive Loss: 0.2083
Epoch 1/30, Step 100/1,Classification Loss: 0.3303, Contrastive Loss: 0.1837
Epoch 1/30, Step 120/1,Classification Loss: 0.3532, Contrastive Loss: 0.1776
Epoch 1/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.1526
Accuracy: 0.9955, Precision: 0.9942, Recall: 0.9870, F1: 0.9906
Accuracy: 0.9905, Precision: 0.9855, Recall: 0.9752, F1: 0.9803
Epoch 1/30
Training - Loss: 111.9063
Training Metrics: {'accuracy': 0.9955357142857143, 'precision': 0.9942150169122721, 'recall': 0.9870443972302186, 'f1': 0.9905915663160092}
Validation Metrics: {'accuracy': 0.9904792129482703, 'precision': 0.9855137105844937, 'recall': 0.9752249831732577, 'f1': 0.9802879981464319}
Epoch 2/30, Step 0/1,Classification Loss: 0.3231, Contrastive Loss: 0.1466
Epoch 2/30, Step 20/1,Classification Loss: 0.3310, Contrastive Loss: 0.1513
Epoch 2/30, Step 40/1,Classification Loss: 0.3197, Contrastive Loss: 0.1326
Epoch 2/30, Step 60/1,Classification Loss: 0.3199, Contrastive Loss: 0.1287
Epoch 2/30, Step 80/1,Classification Loss: 0.3598, Contrastive Loss: 0.1459
Epoch 2/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1217
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1226
Epoch 2/30, Step 140/1,Classification Loss: 0.3496, Contrastive Loss: 0.1264
Accuracy: 0.9930, Precision: 0.9932, Recall: 0.9772, F1: 0.9850
Accuracy: 0.9873, Precision: 0.9844, Recall: 0.9631, F1: 0.9734
Epoch 2/30
Training - Loss: 68.5243
Training Metrics: {'accuracy': 0.9929846938775511, 'precision': 0.9932457380915101, 'recall': 0.9772032416851215, 'f1': 0.9850325264823176}
Validation Metrics: {'accuracy': 0.9873056172643605, 'precision': 0.9843878123516464, 'recall': 0.9631423276473922, 'f1': 0.9734150907490441}
Epoch 3/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.1135
Epoch 3/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.1116
Epoch 3/30, Step 40/1,Classification Loss: 0.3601, Contrastive Loss: 0.1232
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1062
Epoch 3/30, Step 80/1,Classification Loss: 0.3257, Contrastive Loss: 0.1108
Epoch 3/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1067
Epoch 3/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1053
Epoch 3/30, Step 140/1,Classification Loss: 0.3291, Contrastive Loss: 0.1081
Accuracy: 0.9953, Precision: 0.9943, Recall: 0.9858, F1: 0.9900
Accuracy: 0.9901, Precision: 0.9840, Recall: 0.9750, F1: 0.9794
Epoch 3/30
Training - Loss: 64.9301
Training Metrics: {'accuracy': 0.9952699829931972, 'precision': 0.9942862456359534, 'recall': 0.9857989677794428, 'f1': 0.9899892337683066}
Validation Metrics: {'accuracy': 0.9900560668570824, 'precision': 0.9840234098679901, 'recall': 0.9749783132176583, 'f1': 0.9794378072474057}
Epoch 4/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1017
Epoch 4/30, Step 20/1,Classification Loss: 0.3418, Contrastive Loss: 0.1046
Epoch 4/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0955
Epoch 4/30, Step 60/1,Classification Loss: 0.3539, Contrastive Loss: 0.1018
Epoch 4/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0922
Epoch 4/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0901
Epoch 4/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0880
Epoch 4/30, Step 140/1,Classification Loss: 0.3671, Contrastive Loss: 0.1036
Accuracy: 0.9955, Precision: 0.9943, Recall: 0.9865, F1: 0.9904
Accuracy: 0.9905, Precision: 0.9846, Recall: 0.9762, F1: 0.9803
Epoch 4/30
Training - Loss: 62.8857
Training Metrics: {'accuracy': 0.9954559948979592, 'precision': 0.9943058937025485, 'recall': 0.9865104234776017, 'f1': 0.9903632248601757}
Validation Metrics: {'accuracy': 0.9904792129482703, 'precision': 0.9846049672649245, 'recall': 0.9761552223422458, 'f1': 0.9803251633476042}
Epoch 5/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0862
Epoch 5/30, Step 20/1,Classification Loss: 0.3625, Contrastive Loss: 0.1039
Epoch 5/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0847
Epoch 5/30, Step 60/1,Classification Loss: 0.3442, Contrastive Loss: 0.0890
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0826
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0794
Epoch 5/30, Step 120/1,Classification Loss: 0.3172, Contrastive Loss: 0.0801
Epoch 5/30, Step 140/1,Classification Loss: 0.3384, Contrastive Loss: 0.0868
Accuracy: 0.9952, Precision: 0.9942, Recall: 0.9856, F1: 0.9899
Accuracy: 0.9897, Precision: 0.9844, Recall: 0.9732, F1: 0.9787
Epoch 5/30
Training - Loss: 61.3228
Training Metrics: {'accuracy': 0.9952168367346939, 'precision': 0.9942498747704125, 'recall': 0.9855882481102598, 'f1': 0.9898634998723241}
Validation Metrics: {'accuracy': 0.9897387072886914, 'precision': 0.9844191573600058, 'recall': 0.9732429121359785, 'f1': 0.9787347444151863}
Epoch 6/30, Step 0/1,Classification Loss: 0.3293, Contrastive Loss: 0.0817
Epoch 6/30, Step 20/1,Classification Loss: 0.3346, Contrastive Loss: 0.0802
Epoch 6/30, Step 40/1,Classification Loss: 0.3522, Contrastive Loss: 0.0935
Epoch 6/30, Step 60/1,Classification Loss: 0.3357, Contrastive Loss: 0.0813
Epoch 6/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0757
Epoch 6/30, Step 100/1,Classification Loss: 0.3145, Contrastive Loss: 0.0724
Epoch 6/30, Step 120/1,Classification Loss: 0.3535, Contrastive Loss: 0.0869
Epoch 6/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0754
Accuracy: 0.9955, Precision: 0.9943, Recall: 0.9866, F1: 0.9904
Accuracy: 0.9896, Precision: 0.9840, Recall: 0.9732, F1: 0.9785
Epoch 6/30
Training - Loss: 60.1384
Training Metrics: {'accuracy': 0.9954825680272109, 'precision': 0.9943322933626343, 'recall': 0.9866459957584093, 'f1': 0.9904453993787932}
Validation Metrics: {'accuracy': 0.9896329207658944, 'precision': 0.9840454421632914, 'recall': 0.9731812446470786, 'f1': 0.9785222886485851}
Epoch 7/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0756
Epoch 7/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0728
Epoch 7/30, Step 40/1,Classification Loss: 0.3178, Contrastive Loss: 0.0702
Epoch 7/30, Step 60/1,Classification Loss: 0.3310, Contrastive Loss: 0.0703
Epoch 7/30, Step 80/1,Classification Loss: 0.3359, Contrastive Loss: 0.0709
Epoch 7/30, Step 100/1,Classification Loss: 0.3450, Contrastive Loss: 0.0789
Epoch 7/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0669
Epoch 7/30, Step 140/1,Classification Loss: 0.3166, Contrastive Loss: 0.0650
Accuracy: 0.9958, Precision: 0.9946, Recall: 0.9877, F1: 0.9911
Accuracy: 0.9903, Precision: 0.9827, Recall: 0.9773, F1: 0.9800
Epoch 7/30
Training - Loss: 59.1230
Training Metrics: {'accuracy': 0.9958014455782312, 'precision': 0.9946043661675975, 'recall': 0.9877142233691321, 'f1': 0.991124187800971}
Validation Metrics: {'accuracy': 0.9902676399026764, 'precision': 0.9826745803333741, 'recall': 0.9772722062564303, 'f1': 0.9799508719409771}
Epoch 8/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0690
Epoch 8/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0633
Epoch 8/30, Step 40/1,Classification Loss: 0.3316, Contrastive Loss: 0.0670
Epoch 8/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0648
Epoch 8/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0622
Epoch 8/30, Step 100/1,Classification Loss: 0.3164, Contrastive Loss: 0.0610
Epoch 8/30, Step 120/1,Classification Loss: 0.3223, Contrastive Loss: 0.0610
Epoch 8/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0619
Accuracy: 0.9955, Precision: 0.9943, Recall: 0.9867, F1: 0.9905
Accuracy: 0.9902, Precision: 0.9841, Recall: 0.9754, F1: 0.9797
Epoch 8/30
Training - Loss: 58.2263
Training Metrics: {'accuracy': 0.9954825680272109, 'precision': 0.9942557274575167, 'recall': 0.9867436180456475, 'f1': 0.9904578565473425}
Validation Metrics: {'accuracy': 0.9901618533798794, 'precision': 0.9840936351007238, 'recall': 0.9753500604295542, 'f1': 0.9796629471976981}
Epoch 9/30, Step 0/1,Classification Loss: 0.3446, Contrastive Loss: 0.0663
Epoch 9/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0598
Epoch 9/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0610
Epoch 9/30, Step 60/1,Classification Loss: 0.3495, Contrastive Loss: 0.0635
Epoch 9/30, Step 80/1,Classification Loss: 0.3364, Contrastive Loss: 0.0613
Epoch 9/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0651
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0531
Epoch 9/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0537
Accuracy: 0.9940, Precision: 0.9944, Recall: 0.9802, F1: 0.9872
Accuracy: 0.9877, Precision: 0.9828, Recall: 0.9665, F1: 0.9744
Epoch 9/30
Training - Loss: 57.3991
Training Metrics: {'accuracy': 0.993967899659864, 'precision': 0.994414943407903, 'recall': 0.9801989450439079, 'f1': 0.9871567658264595}
Validation Metrics: {'accuracy': 0.9877287633555485, 'precision': 0.9827867461594424, 'recall': 0.9664897948329522, 'f1': 0.9744321218288126}
Epoch 10/30, Step 0/1,Classification Loss: 0.3296, Contrastive Loss: 0.0611
Epoch 10/30, Step 20/1,Classification Loss: 0.3135, Contrastive Loss: 0.0538
Epoch 10/30, Step 40/1,Classification Loss: 0.3138, Contrastive Loss: 0.0553
Epoch 10/30, Step 60/1,Classification Loss: 0.3291, Contrastive Loss: 0.0551
Epoch 10/30, Step 80/1,Classification Loss: 0.3420, Contrastive Loss: 0.0549
Epoch 10/30, Step 100/1,Classification Loss: 0.3253, Contrastive Loss: 0.0509
Epoch 10/30, Step 120/1,Classification Loss: 0.3294, Contrastive Loss: 0.0551
Epoch 10/30, Step 140/1,Classification Loss: 0.3606, Contrastive Loss: 0.0599
Accuracy: 0.9956, Precision: 0.9946, Recall: 0.9868, F1: 0.9906
Accuracy: 0.9901, Precision: 0.9831, Recall: 0.9759, F1: 0.9795
Epoch 10/30
Training - Loss: 56.5811
Training Metrics: {'accuracy': 0.995562287414966, 'precision': 0.9945508007696712, 'recall': 0.9868043592174377, 'f1': 0.9906331136619484}
Validation Metrics: {'accuracy': 0.9900560668570824, 'precision': 0.9831248163813355, 'recall': 0.9759085523866464, 'f1': 0.9794765039782114}
Epoch 11/30, Step 0/1,Classification Loss: 0.3192, Contrastive Loss: 0.0506
Epoch 11/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.0511
Epoch 11/30, Step 40/1,Classification Loss: 0.3954, Contrastive Loss: 0.0600
Epoch 11/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.0483
Epoch 11/30, Step 80/1,Classification Loss: 0.3136, Contrastive Loss: 0.0483
Epoch 11/30, Step 100/1,Classification Loss: 0.3465, Contrastive Loss: 0.0510
Epoch 11/30, Step 120/1,Classification Loss: 0.3453, Contrastive Loss: 0.0610
Epoch 11/30, Step 140/1,Classification Loss: 0.3138, Contrastive Loss: 0.0464
Accuracy: 0.9955, Precision: 0.9946, Recall: 0.9865, F1: 0.9905
Accuracy: 0.9900, Precision: 0.9831, Recall: 0.9755, F1: 0.9793
Epoch 11/30
Training - Loss: 56.0261
Training Metrics: {'accuracy': 0.9955091411564626, 'precision': 0.9945994322102578, 'recall': 0.9865296851306733, 'f1': 0.99051630438231}
Validation Metrics: {'accuracy': 0.9899502803342854, 'precision': 0.9830537484770241, 'recall': 0.9755368051747505, 'f1': 0.9792516634700148}
Epoch 12/30, Step 0/1,Classification Loss: 0.3201, Contrastive Loss: 0.0467
Epoch 12/30, Step 20/1,Classification Loss: 0.3389, Contrastive Loss: 0.0485
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0427
Epoch 12/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0430
Epoch 12/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0458
Epoch 12/30, Step 100/1,Classification Loss: 0.3368, Contrastive Loss: 0.0452
Epoch 12/30, Step 120/1,Classification Loss: 0.3324, Contrastive Loss: 0.0460
Epoch 12/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0406
Accuracy: 0.9952, Precision: 0.9955, Recall: 0.9844, F1: 0.9898
Accuracy: 0.9891, Precision: 0.9819, Recall: 0.9732, F1: 0.9775
Epoch 12/30
Training - Loss: 55.2534
Training Metrics: {'accuracy': 0.9952168367346939, 'precision': 0.9954818042898563, 'recall': 0.9843613672871547, 'f1': 0.9898301799067983}
Validation Metrics: {'accuracy': 0.9891039881519095, 'precision': 0.9818867005120892, 'recall': 0.9731829869255754, 'f1': 0.9774761673264829}
Epoch 13/30, Step 0/1,Classification Loss: 0.3360, Contrastive Loss: 0.0452
Epoch 13/30, Step 20/1,Classification Loss: 0.3531, Contrastive Loss: 0.0458
Epoch 13/30, Step 40/1,Classification Loss: 0.3136, Contrastive Loss: 0.0424
Epoch 13/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0388
Epoch 13/30, Step 80/1,Classification Loss: 0.3420, Contrastive Loss: 0.0446
Epoch 13/30, Step 100/1,Classification Loss: 0.3351, Contrastive Loss: 0.0408
Epoch 13/30, Step 120/1,Classification Loss: 0.3190, Contrastive Loss: 0.0392
Epoch 13/30, Step 140/1,Classification Loss: 0.3382, Contrastive Loss: 0.0425
Accuracy: 0.9952, Precision: 0.9945, Recall: 0.9853, F1: 0.9898
Accuracy: 0.9897, Precision: 0.9853, Recall: 0.9723, F1: 0.9787
Epoch 13/30
Training - Loss: 54.9109
Training Metrics: {'accuracy': 0.9951636904761905, 'precision': 0.9944858821358268, 'recall': 0.985262259221281, 'f1': 0.9898108391368948}
Validation Metrics: {'accuracy': 0.9897387072886914, 'precision': 0.9853373847431572, 'recall': 0.9723126729669902, 'f1': 0.978694407326361}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0384
Epoch 14/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0408
Epoch 14/30, Step 40/1,Classification Loss: 0.3443, Contrastive Loss: 0.0527
Epoch 14/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0439
Epoch 14/30, Step 80/1,Classification Loss: 0.3647, Contrastive Loss: 0.0451
Epoch 14/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0377
Epoch 14/30, Step 120/1,Classification Loss: 0.3331, Contrastive Loss: 0.0393
Epoch 14/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0392
Accuracy: 0.9947, Precision: 0.9942, Recall: 0.9835, F1: 0.9888
Accuracy: 0.9879, Precision: 0.9820, Recall: 0.9682, F1: 0.9749
Epoch 14/30
Training - Loss: 54.4548
Training Metrics: {'accuracy': 0.9946853741496599, 'precision': 0.9941902007767148, 'recall': 0.9834947607030744, 'f1': 0.9887574581547376}
Validation Metrics: {'accuracy': 0.9879403364011425, 'precision': 0.9820074421882231, 'recall': 0.9681635284257322, 'f1': 0.9749366509935361}
Epoch 15/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0496
Epoch 15/30, Step 20/1,Classification Loss: 0.3262, Contrastive Loss: 0.0355
Epoch 15/30, Step 40/1,Classification Loss: 0.3246, Contrastive Loss: 0.0349
Epoch 15/30, Step 60/1,Classification Loss: 0.3143, Contrastive Loss: 0.0350
Epoch 15/30, Step 80/1,Classification Loss: 0.3386, Contrastive Loss: 0.0514
Epoch 15/30, Step 100/1,Classification Loss: 0.3219, Contrastive Loss: 0.0354
Epoch 15/30, Step 120/1,Classification Loss: 0.3414, Contrastive Loss: 0.0363
Epoch 15/30, Step 140/1,Classification Loss: 0.3354, Contrastive Loss: 0.0363
Accuracy: 0.9955, Precision: 0.9951, Recall: 0.9859, F1: 0.9904
Accuracy: 0.9896, Precision: 0.9819, Recall: 0.9754, F1: 0.9786
Epoch 15/30
Training - Loss: 53.9890
Training Metrics: {'accuracy': 0.9954825680272109, 'precision': 0.995060588696959, 'recall': 0.9858856834205039, 'f1': 0.9904109359074285}
Validation Metrics: {'accuracy': 0.9896329207658944, 'precision': 0.9819486630240453, 'recall': 0.975351802708051, 'f1': 0.9786165699020177}
Epoch 16/30, Step 0/1,Classification Loss: 0.3454, Contrastive Loss: 0.0367
Epoch 16/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0351
Epoch 16/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0457
Epoch 16/30, Step 60/1,Classification Loss: 0.3351, Contrastive Loss: 0.0344
Epoch 16/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0312
Epoch 16/30, Step 100/1,Classification Loss: 0.3193, Contrastive Loss: 0.0311
Epoch 16/30, Step 120/1,Classification Loss: 0.3347, Contrastive Loss: 0.0363
Epoch 16/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0306
Accuracy: 0.9951, Precision: 0.9943, Recall: 0.9851, F1: 0.9896
Accuracy: 0.9894, Precision: 0.9845, Recall: 0.9718, F1: 0.9780
Epoch 16/30
Training - Loss: 53.5530
Training Metrics: {'accuracy': 0.9951105442176871, 'precision': 0.9942689013584923, 'recall': 0.9851280071931319, 'f1': 0.9896365477738779}
Validation Metrics: {'accuracy': 0.9894213477203004, 'precision': 0.9845160060078442, 'recall': 0.9718175907772946, 'f1': 0.9780424157440131}
Epoch 17/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0311
Epoch 17/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.0368
Epoch 17/30, Step 40/1,Classification Loss: 0.3334, Contrastive Loss: 0.0331
Epoch 17/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0312
Epoch 17/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0300
Epoch 17/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0311
Epoch 17/30, Step 120/1,Classification Loss: 0.3273, Contrastive Loss: 0.0325
Epoch 17/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0299
Accuracy: 0.9955, Precision: 0.9944, Recall: 0.9865, F1: 0.9904
Accuracy: 0.9900, Precision: 0.9837, Recall: 0.9749, F1: 0.9792
Epoch 17/30
Training - Loss: 53.1382
Training Metrics: {'accuracy': 0.9955091411564626, 'precision': 0.9943997756436098, 'recall': 0.9865456646227023, 'f1': 0.9904272504741864}
Validation Metrics: {'accuracy': 0.9899502803342854, 'precision': 0.9836522481829968, 'recall': 0.9749166457287584, 'f1': 0.9792255912234551}
Epoch 18/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0283
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0280
Epoch 18/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0325
Epoch 18/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0271
Epoch 18/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0292
Epoch 18/30, Step 100/1,Classification Loss: 0.3527, Contrastive Loss: 0.0308
Epoch 18/30, Step 120/1,Classification Loss: 0.3236, Contrastive Loss: 0.0280
Epoch 18/30, Step 140/1,Classification Loss: 0.3411, Contrastive Loss: 0.0309
Accuracy: 0.9956, Precision: 0.9945, Recall: 0.9870, F1: 0.9907
Accuracy: 0.9907, Precision: 0.9844, Recall: 0.9772, F1: 0.9808
Epoch 18/30
Training - Loss: 53.0768
Training Metrics: {'accuracy': 0.9955888605442177, 'precision': 0.9944794757815565, 'recall': 0.9869569147068445, 'f1': 0.990676300398448}
Validation Metrics: {'accuracy': 0.9906907859938644, 'precision': 0.9844447762561193, 'recall': 0.9772087964890337, 'f1': 0.9807865143625808}
Epoch 19/30, Step 0/1,Classification Loss: 0.3696, Contrastive Loss: 0.0346
Epoch 19/30, Step 20/1,Classification Loss: 0.3447, Contrastive Loss: 0.0340
Epoch 19/30, Step 40/1,Classification Loss: 0.3558, Contrastive Loss: 0.0313
Epoch 19/30, Step 60/1,Classification Loss: 0.3444, Contrastive Loss: 0.0321
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0245
Epoch 19/30, Step 100/1,Classification Loss: 0.3446, Contrastive Loss: 0.0456
Epoch 19/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0308
Epoch 19/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0264
Accuracy: 0.9955, Precision: 0.9970, Recall: 0.9842, F1: 0.9905
Accuracy: 0.9906, Precision: 0.9887, Recall: 0.9725, F1: 0.9804
Epoch 19/30
Training - Loss: 52.9157
Training Metrics: {'accuracy': 0.9955091411564626, 'precision': 0.9969883883696222, 'recall': 0.9842050297070136, 'f1': 0.9904759356805245}
Validation Metrics: {'accuracy': 0.9905849994710674, 'precision': 0.9886840986144553, 'recall': 0.972495933155193, 'f1': 0.9803894996038935}
Epoch 20/30, Step 0/1,Classification Loss: 0.3288, Contrastive Loss: 0.0263
Epoch 20/30, Step 20/1,Classification Loss: 0.3462, Contrastive Loss: 0.0292
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0240
Epoch 20/30, Step 60/1,Classification Loss: 0.3291, Contrastive Loss: 0.0269
Epoch 20/30, Step 80/1,Classification Loss: 0.3441, Contrastive Loss: 0.0290
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0228
Epoch 20/30, Step 120/1,Classification Loss: 0.3346, Contrastive Loss: 0.0276
Epoch 20/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0293
Accuracy: 0.9953, Precision: 0.9969, Recall: 0.9833, F1: 0.9899
Accuracy: 0.9905, Precision: 0.9889, Recall: 0.9718, F1: 0.9802
Epoch 20/30
Training - Loss: 52.5844
Training Metrics: {'accuracy': 0.9952965561224489, 'precision': 0.9968646647501207, 'recall': 0.9832981972344335, 'f1': 0.9899458689232274}
Validation Metrics: {'accuracy': 0.9904792129482703, 'precision': 0.9889348932606927, 'recall': 0.971814106220301, 'f1': 0.9801502308141996}
Epoch 21/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0235
Epoch 21/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.0266
Epoch 21/30, Step 40/1,Classification Loss: 0.3396, Contrastive Loss: 0.0281
Epoch 21/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0259
Epoch 21/30, Step 80/1,Classification Loss: 0.3218, Contrastive Loss: 0.0243
Epoch 21/30, Step 100/1,Classification Loss: 0.3443, Contrastive Loss: 0.0283
Epoch 21/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0225
Epoch 21/30, Step 140/1,Classification Loss: 0.3136, Contrastive Loss: 0.0236
Accuracy: 0.9957, Precision: 0.9948, Recall: 0.9870, F1: 0.9908
Accuracy: 0.9900, Precision: 0.9843, Recall: 0.9743, F1: 0.9792
Epoch 21/30
Training - Loss: 52.5181
Training Metrics: {'accuracy': 0.9956685799319728, 'precision': 0.9947718195510187, 'recall': 0.9870055555319919, 'f1': 0.9908440544054302}
Validation Metrics: {'accuracy': 0.9899502803342854, 'precision': 0.984255254568115, 'recall': 0.9742964862827663, 'f1': 0.9791994379527318}
Epoch 22/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0238
Epoch 22/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0241
Epoch 22/30, Step 40/1,Classification Loss: 0.3330, Contrastive Loss: 0.0277
Epoch 22/30, Step 60/1,Classification Loss: 0.3191, Contrastive Loss: 0.0228
Epoch 22/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0225
Epoch 22/30, Step 100/1,Classification Loss: 0.3213, Contrastive Loss: 0.0232
Epoch 22/30, Step 120/1,Classification Loss: 0.3458, Contrastive Loss: 0.0268
Epoch 22/30, Step 140/1,Classification Loss: 0.3445, Contrastive Loss: 0.0249
Accuracy: 0.9957, Precision: 0.9945, Recall: 0.9873, F1: 0.9909
Accuracy: 0.9897, Precision: 0.9829, Recall: 0.9748, F1: 0.9788
Epoch 22/30
Training - Loss: 52.3024
Training Metrics: {'accuracy': 0.9956951530612245, 'precision': 0.9945384543257005, 'recall': 0.9873226656388516, 'f1': 0.9908920539730135}
Validation Metrics: {'accuracy': 0.9897387072886914, 'precision': 0.9829116119952285, 'recall': 0.9747933107509588, 'f1': 0.9788015561352533}
Epoch 23/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0226
Epoch 23/30, Step 20/1,Classification Loss: 0.3440, Contrastive Loss: 0.0270
Epoch 23/30, Step 40/1,Classification Loss: 0.3186, Contrastive Loss: 0.0236
Epoch 23/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0236
Epoch 23/30, Step 80/1,Classification Loss: 0.3430, Contrastive Loss: 0.0263
Epoch 23/30, Step 100/1,Classification Loss: 0.3389, Contrastive Loss: 0.0268
Epoch 23/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0210
Epoch 23/30, Step 140/1,Classification Loss: 0.3585, Contrastive Loss: 0.0273
Accuracy: 0.9952, Precision: 0.9946, Recall: 0.9851, F1: 0.9898
Accuracy: 0.9897, Precision: 0.9853, Recall: 0.9723, F1: 0.9787
Epoch 23/30
Training - Loss: 52.1126
Training Metrics: {'accuracy': 0.9951902636054422, 'precision': 0.9946421607514884, 'recall': 0.9850824272021983, 'f1': 0.9897946530730459}
Validation Metrics: {'accuracy': 0.9897387072886914, 'precision': 0.9853373847431572, 'recall': 0.9723126729669902, 'f1': 0.978694407326361}
Epoch 24/30, Step 0/1,Classification Loss: 0.3600, Contrastive Loss: 0.0244
Epoch 24/30, Step 20/1,Classification Loss: 0.3349, Contrastive Loss: 0.0257
Epoch 24/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 24/30, Step 60/1,Classification Loss: 0.3215, Contrastive Loss: 0.0230
Epoch 24/30, Step 80/1,Classification Loss: 0.3293, Contrastive Loss: 0.0258
Epoch 24/30, Step 100/1,Classification Loss: 0.3517, Contrastive Loss: 0.0270
Epoch 24/30, Step 120/1,Classification Loss: 0.3452, Contrastive Loss: 0.0256
Epoch 24/30, Step 140/1,Classification Loss: 0.3223, Contrastive Loss: 0.0214
Accuracy: 0.9952, Precision: 0.9941, Recall: 0.9855, F1: 0.9898
Accuracy: 0.9900, Precision: 0.9852, Recall: 0.9734, F1: 0.9792
Epoch 24/30
Training - Loss: 51.9991
Training Metrics: {'accuracy': 0.9951902636054422, 'precision': 0.9941399184223525, 'recall': 0.9855223114383693, 'f1': 0.9897762031291577}
Validation Metrics: {'accuracy': 0.9899502803342854, 'precision': 0.9851683019764508, 'recall': 0.9733662471137781, 'f1': 0.9791600553281288}
Epoch 25/30, Step 0/1,Classification Loss: 0.3636, Contrastive Loss: 0.0294
Epoch 25/30, Step 20/1,Classification Loss: 0.3184, Contrastive Loss: 0.0224
Epoch 25/30, Step 40/1,Classification Loss: 0.3195, Contrastive Loss: 0.0208
Epoch 25/30, Step 60/1,Classification Loss: 0.3211, Contrastive Loss: 0.0209
Epoch 25/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0216
Epoch 25/30, Step 100/1,Classification Loss: 0.3236, Contrastive Loss: 0.0207
Epoch 25/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0235
Epoch 25/30, Step 140/1,Classification Loss: 0.3616, Contrastive Loss: 0.0254
Accuracy: 0.9955, Precision: 0.9946, Recall: 0.9863, F1: 0.9904
Accuracy: 0.9904, Precision: 0.9858, Recall: 0.9745, F1: 0.9801
Epoch 25/30
Training - Loss: 52.1382
Training Metrics: {'accuracy': 0.9954825680272109, 'precision': 0.9946487920681469, 'recall': 0.9862828240955889, 'f1': 0.9904140815186182}
Validation Metrics: {'accuracy': 0.9903734264254734, 'precision': 0.9857501084134466, 'recall': 0.9745431562383657, 'f1': 0.9800501210492985}
Epoch 26/30, Step 0/1,Classification Loss: 0.3137, Contrastive Loss: 0.0196
Epoch 26/30, Step 20/1,Classification Loss: 0.3190, Contrastive Loss: 0.0230
Epoch 26/30, Step 40/1,Classification Loss: 0.3841, Contrastive Loss: 0.0301
Epoch 26/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0215
Epoch 26/30, Step 80/1,Classification Loss: 0.3287, Contrastive Loss: 0.0217
Epoch 26/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0197
Epoch 26/30, Step 120/1,Classification Loss: 0.3156, Contrastive Loss: 0.0198
Epoch 26/30, Step 140/1,Classification Loss: 0.3142, Contrastive Loss: 0.0193
Accuracy: 0.9953, Precision: 0.9947, Recall: 0.9858, F1: 0.9902
Accuracy: 0.9898, Precision: 0.9839, Recall: 0.9742, F1: 0.9790
Epoch 26/30
Training - Loss: 51.8393
Training Metrics: {'accuracy': 0.9953497023809523, 'precision': 0.9946660038082026, 'recall': 0.985790751536594, 'f1': 0.9901699970610447}
Validation Metrics: {'accuracy': 0.9898444938114884, 'precision': 0.9838829621007839, 'recall': 0.9742348187938664, 'f1': 0.9789870995061869}
Epoch 27/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0208
Epoch 27/30, Step 20/1,Classification Loss: 0.3402, Contrastive Loss: 0.0224
Epoch 27/30, Step 40/1,Classification Loss: 0.3311, Contrastive Loss: 0.0348
Epoch 27/30, Step 60/1,Classification Loss: 0.3243, Contrastive Loss: 0.0208
Epoch 27/30, Step 80/1,Classification Loss: 0.3285, Contrastive Loss: 0.0206
Epoch 27/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 27/30, Step 120/1,Classification Loss: 0.3594, Contrastive Loss: 0.0262
Epoch 27/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Accuracy: 0.9956, Precision: 0.9945, Recall: 0.9870, F1: 0.9907
Accuracy: 0.9904, Precision: 0.9858, Recall: 0.9745, F1: 0.9801
Epoch 27/30
Training - Loss: 51.8403
Training Metrics: {'accuracy': 0.9956154336734694, 'precision': 0.9944923359552162, 'recall': 0.9870411464460551, 'f1': 0.9907256600865372}
Validation Metrics: {'accuracy': 0.9903734264254734, 'precision': 0.9857501084134466, 'recall': 0.9745431562383657, 'f1': 0.9800501210492985}
Epoch 28/30, Step 0/1,Classification Loss: 0.3449, Contrastive Loss: 0.0213
Epoch 28/30, Step 20/1,Classification Loss: 0.3553, Contrastive Loss: 0.0361
Epoch 28/30, Step 40/1,Classification Loss: 0.3251, Contrastive Loss: 0.0213
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0176
Epoch 28/30, Step 80/1,Classification Loss: 0.3249, Contrastive Loss: 0.0207
Epoch 28/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 28/30, Step 120/1,Classification Loss: 0.3562, Contrastive Loss: 0.0237
Epoch 28/30, Step 140/1,Classification Loss: 0.3292, Contrastive Loss: 0.0209
Accuracy: 0.9952, Precision: 0.9947, Recall: 0.9851, F1: 0.9898
Accuracy: 0.9894, Precision: 0.9854, Recall: 0.9709, F1: 0.9780
Epoch 28/30
Training - Loss: 51.9359
Training Metrics: {'accuracy': 0.9951902636054422, 'precision': 0.9946522073203744, 'recall': 0.9851347761639662, 'f1': 0.9898263301555348}
Validation Metrics: {'accuracy': 0.9894213477203004, 'precision': 0.9854403321809146, 'recall': 0.9708873516083064, 'f1': 0.9780006687536049}
Epoch 29/30, Step 0/1,Classification Loss: 0.3346, Contrastive Loss: 0.0211
Epoch 29/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.0207
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 29/30, Step 60/1,Classification Loss: 0.3371, Contrastive Loss: 0.0209
Epoch 29/30, Step 80/1,Classification Loss: 0.3446, Contrastive Loss: 0.0215
Epoch 29/30, Step 100/1,Classification Loss: 0.3162, Contrastive Loss: 0.0202
Epoch 29/30, Step 120/1,Classification Loss: 0.3326, Contrastive Loss: 0.0209
Epoch 29/30, Step 140/1,Classification Loss: 0.3756, Contrastive Loss: 0.0237
Accuracy: 0.9953, Precision: 0.9945, Recall: 0.9858, F1: 0.9901
Accuracy: 0.9894, Precision: 0.9845, Recall: 0.9718, F1: 0.9780
Epoch 29/30
Training - Loss: 51.8227
Training Metrics: {'accuracy': 0.9953231292517006, 'precision': 0.9944747826051643, 'recall': 0.9858010711727613, 'f1': 0.9900822604181464}
Validation Metrics: {'accuracy': 0.9894213477203004, 'precision': 0.9845160060078442, 'recall': 0.9718175907772946, 'f1': 0.9780424157440131}
Epoch 30/30, Step 0/1,Classification Loss: 0.3343, Contrastive Loss: 0.0200
Epoch 30/30, Step 20/1,Classification Loss: 0.3288, Contrastive Loss: 0.0203
Epoch 30/30, Step 40/1,Classification Loss: 0.3223, Contrastive Loss: 0.0185
Epoch 30/30, Step 60/1,Classification Loss: 0.3323, Contrastive Loss: 0.0226
Epoch 30/30, Step 80/1,Classification Loss: 0.3148, Contrastive Loss: 0.0188
Epoch 30/30, Step 100/1,Classification Loss: 0.3350, Contrastive Loss: 0.0221
Epoch 30/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0196
Epoch 30/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0182
Accuracy: 0.9956, Precision: 0.9949, Recall: 0.9864, F1: 0.9906
Accuracy: 0.9901, Precision: 0.9834, Recall: 0.9756, F1: 0.9795
Epoch 30/30
Training - Loss: 51.6773
Training Metrics: {'accuracy': 0.9955888605442177, 'precision': 0.99486117188341, 'recall': 0.9864362274560305, 'f1': 0.9905964047346594}
Validation Metrics: {'accuracy': 0.9900560668570824, 'precision': 0.9834232257898546, 'recall': 0.9755984726636504, 'f1': 0.9794636250583795}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (871, 5814), y shape: (871,), y distribution: Counter({np.float64(0.0): 786, np.float64(1.0): 85}), env shape: (871,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9013, Precision: 0.4511, Recall: 0.4994, F1: 0.4740
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13215]))
original train data shape: torch.Size([47362]), new train data shape: torch.Size([100])
original test data shape: torch.Size([871, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([47362]), new train data shape: torch.Size([47362])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13215]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3444, Contrastive Loss: 1.5825
Epoch 1/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.9160
Epoch 1/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.4075
Epoch 1/30, Step 60/1,Classification Loss: 0.3182, Contrastive Loss: 0.2659
Epoch 1/30, Step 80/1,Classification Loss: 0.3365, Contrastive Loss: 0.2336
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1837
Epoch 1/30, Step 120/1,Classification Loss: 0.3207, Contrastive Loss: 0.1607
Epoch 1/30, Step 140/1,Classification Loss: 0.3685, Contrastive Loss: 0.1898
Accuracy: 0.9953, Precision: 0.9940, Recall: 0.9863, F1: 0.9901
Accuracy: 0.9908, Precision: 0.9837, Recall: 0.9786, F1: 0.9811
Epoch 1/30
Training - Loss: 113.2712
Training Metrics: {'accuracy': 0.9953283361486487, 'precision': 0.9940268934155558, 'recall': 0.9863420643181597, 'f1': 0.9901406624876042}
Validation Metrics: {'accuracy': 0.9908160033780218, 'precision': 0.9836586723892826, 'recall': 0.9785583200182606, 'f1': 0.981088472454108}
Epoch 2/30, Step 0/1,Classification Loss: 0.3472, Contrastive Loss: 0.1691
Epoch 2/30, Step 20/1,Classification Loss: 0.3192, Contrastive Loss: 0.1423
Epoch 2/30, Step 40/1,Classification Loss: 0.3328, Contrastive Loss: 0.1483
Epoch 2/30, Step 60/1,Classification Loss: 0.3183, Contrastive Loss: 0.1371
Epoch 2/30, Step 80/1,Classification Loss: 0.3448, Contrastive Loss: 0.1581
Epoch 2/30, Step 100/1,Classification Loss: 0.3136, Contrastive Loss: 0.1277
Epoch 2/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.1247
Epoch 2/30, Step 140/1,Classification Loss: 0.3202, Contrastive Loss: 0.1208
Accuracy: 0.9950, Precision: 0.9965, Recall: 0.9826, F1: 0.9894
Accuracy: 0.9903, Precision: 0.9882, Recall: 0.9718, F1: 0.9798
Epoch 2/30
Training - Loss: 70.4457
Training Metrics: {'accuracy': 0.9950380067567568, 'precision': 0.9964660107942196, 'recall': 0.9825898635597743, 'f1': 0.989385986328125}
Validation Metrics: {'accuracy': 0.9902881874802069, 'precision': 0.9881957752475381, 'recall': 0.9717536178954577, 'f1': 0.9797675542437815}
Epoch 3/30, Step 0/1,Classification Loss: 0.3201, Contrastive Loss: 0.1217
Epoch 3/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.1210
Epoch 3/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1211
Epoch 3/30, Step 60/1,Classification Loss: 0.3375, Contrastive Loss: 0.1198
Epoch 3/30, Step 80/1,Classification Loss: 0.3344, Contrastive Loss: 0.1268
Epoch 3/30, Step 100/1,Classification Loss: 0.3494, Contrastive Loss: 0.1145
Epoch 3/30, Step 120/1,Classification Loss: 0.3197, Contrastive Loss: 0.1066
Epoch 3/30, Step 140/1,Classification Loss: 0.3138, Contrastive Loss: 0.1022
Accuracy: 0.9951, Precision: 0.9941, Recall: 0.9853, F1: 0.9896
Accuracy: 0.9911, Precision: 0.9863, Recall: 0.9772, F1: 0.9817
Epoch 3/30
Training - Loss: 66.9145
Training Metrics: {'accuracy': 0.9951171875, 'precision': 0.9941239534946518, 'recall': 0.9852682367295165, 'f1': 0.989638032190987}
Validation Metrics: {'accuracy': 0.9911326929167107, 'precision': 0.9862624194174143, 'recall': 0.9771960283040402, 'f1': 0.9816662089355263}
Epoch 4/30, Step 0/1,Classification Loss: 0.3394, Contrastive Loss: 0.1158
Epoch 4/30, Step 20/1,Classification Loss: 0.3244, Contrastive Loss: 0.1029
Epoch 4/30, Step 40/1,Classification Loss: 0.3448, Contrastive Loss: 0.1135
Epoch 4/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1104
Epoch 4/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.1106
Epoch 4/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0927
Epoch 4/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.1085
Epoch 4/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0983
Accuracy: 0.9939, Precision: 0.9960, Recall: 0.9780, F1: 0.9868
Accuracy: 0.9878, Precision: 0.9876, Recall: 0.9619, F1: 0.9742
Epoch 4/30
Training - Loss: 64.4376
Training Metrics: {'accuracy': 0.9938502956081081, 'precision': 0.9960337611045533, 'recall': 0.9780382995764938, 'f1': 0.9867964006698522}
Validation Metrics: {'accuracy': 0.9877546711706957, 'precision': 0.9875800102079996, 'recall': 0.9619233964848208, 'f1': 0.9742439177873978}
Epoch 5/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1029
Epoch 5/30, Step 20/1,Classification Loss: 0.3436, Contrastive Loss: 0.0948
Epoch 5/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0849
Epoch 5/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0849
Epoch 5/30, Step 80/1,Classification Loss: 0.3526, Contrastive Loss: 0.0960
Epoch 5/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0830
Epoch 5/30, Step 120/1,Classification Loss: 0.3643, Contrastive Loss: 0.0953
Epoch 5/30, Step 140/1,Classification Loss: 0.3340, Contrastive Loss: 0.0832
Accuracy: 0.9950, Precision: 0.9968, Recall: 0.9820, F1: 0.9892
Accuracy: 0.9904, Precision: 0.9883, Recall: 0.9721, F1: 0.9800
Epoch 5/30
Training - Loss: 62.6723
Training Metrics: {'accuracy': 0.9949588260135135, 'precision': 0.9967568227784419, 'recall': 0.9819959815914093, 'f1': 0.9892157251565963}
Validation Metrics: {'accuracy': 0.9903937506597699, 'precision': 0.9882620383720897, 'recall': 0.9721245377767633, 'f1': 0.9799938169589153}
Epoch 6/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0796
Epoch 6/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0825
Epoch 6/30, Step 40/1,Classification Loss: 0.3327, Contrastive Loss: 0.0888
Epoch 6/30, Step 60/1,Classification Loss: 0.3243, Contrastive Loss: 0.0817
Epoch 6/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0840
Epoch 6/30, Step 100/1,Classification Loss: 0.3444, Contrastive Loss: 0.0921
Epoch 6/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0789
Epoch 6/30, Step 140/1,Classification Loss: 0.3196, Contrastive Loss: 0.0748
Accuracy: 0.9952, Precision: 0.9940, Recall: 0.9858, F1: 0.9899
Accuracy: 0.9910, Precision: 0.9859, Recall: 0.9771, F1: 0.9815
Epoch 6/30
Training - Loss: 61.1329
Training Metrics: {'accuracy': 0.9952227618243243, 'precision': 0.9940178660236885, 'recall': 0.9857834168037619, 'f1': 0.9898504971172233}
Validation Metrics: {'accuracy': 0.9910271297371477, 'precision': 0.9858906813365087, 'recall': 0.9771344898425016, 'f1': 0.98145376646397}
Epoch 7/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0755
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0712
Epoch 7/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0743
Epoch 7/30, Step 60/1,Classification Loss: 0.3284, Contrastive Loss: 0.0716
Epoch 7/30, Step 80/1,Classification Loss: 0.3291, Contrastive Loss: 0.0724
Epoch 7/30, Step 100/1,Classification Loss: 0.3135, Contrastive Loss: 0.0694
Epoch 7/30, Step 120/1,Classification Loss: 0.3135, Contrastive Loss: 0.0687
Epoch 7/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0644
Accuracy: 0.9952, Precision: 0.9942, Recall: 0.9856, F1: 0.9898
Accuracy: 0.9908, Precision: 0.9851, Recall: 0.9770, F1: 0.9810
Epoch 7/30
Training - Loss: 59.9418
Training Metrics: {'accuracy': 0.9951963682432432, 'precision': 0.9941831017632617, 'recall': 0.9856027159463467, 'f1': 0.9898383236780244}
Validation Metrics: {'accuracy': 0.9908160033780218, 'precision': 0.9851488913519734, 'recall': 0.9770114129194247, 'f1': 0.9810292783149388}
Epoch 8/30, Step 0/1,Classification Loss: 0.3138, Contrastive Loss: 0.0671
Epoch 8/30, Step 20/1,Classification Loss: 0.3291, Contrastive Loss: 0.0707
Epoch 8/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0643
Epoch 8/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0669
Epoch 8/30, Step 80/1,Classification Loss: 0.3448, Contrastive Loss: 0.0746
Epoch 8/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0664
Epoch 8/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0667
Epoch 8/30, Step 140/1,Classification Loss: 0.3445, Contrastive Loss: 0.0647
Accuracy: 0.9945, Precision: 0.9963, Recall: 0.9805, F1: 0.9882
Accuracy: 0.9886, Precision: 0.9875, Recall: 0.9655, F1: 0.9761
Epoch 8/30
Training - Loss: 59.3373
Training Metrics: {'accuracy': 0.994457347972973, 'precision': 0.9963000109325357, 'recall': 0.9805090490366124, 'f1': 0.9882195272198113}
Validation Metrics: {'accuracy': 0.9885991766071994, 'precision': 0.9874568951176036, 'recall': 0.9655095183748003, 'f1': 0.9761123136212981}
Epoch 9/30, Step 0/1,Classification Loss: 0.3329, Contrastive Loss: 0.0659
Epoch 9/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0650
Epoch 9/30, Step 40/1,Classification Loss: 0.3491, Contrastive Loss: 0.0682
Epoch 9/30, Step 60/1,Classification Loss: 0.3165, Contrastive Loss: 0.0571
Epoch 9/30, Step 80/1,Classification Loss: 0.3159, Contrastive Loss: 0.0584
Epoch 9/30, Step 100/1,Classification Loss: 0.3861, Contrastive Loss: 0.1110
Epoch 9/30, Step 120/1,Classification Loss: 0.3236, Contrastive Loss: 0.0590
Epoch 9/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0599
Accuracy: 0.9947, Precision: 0.9937, Recall: 0.9838, F1: 0.9887
Accuracy: 0.9897, Precision: 0.9850, Recall: 0.9723, F1: 0.9785
Epoch 9/30
Training - Loss: 58.4394
Training Metrics: {'accuracy': 0.9946684966216216, 'precision': 0.9936948431403236, 'recall': 0.9838197288147739, 'f1': 0.9886849296403672}
Validation Metrics: {'accuracy': 0.989654808402829, 'precision': 0.9849947056572308, 'recall': 0.9723125313855284, 'f1': 0.9785296910879093}
Epoch 10/30, Step 0/1,Classification Loss: 0.3380, Contrastive Loss: 0.0726
Epoch 10/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0529
Epoch 10/30, Step 40/1,Classification Loss: 0.3176, Contrastive Loss: 0.0571
Epoch 10/30, Step 60/1,Classification Loss: 0.3292, Contrastive Loss: 0.0572
Epoch 10/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0565
Epoch 10/30, Step 100/1,Classification Loss: 0.3447, Contrastive Loss: 0.0582
Epoch 10/30, Step 120/1,Classification Loss: 0.3231, Contrastive Loss: 0.0540
Epoch 10/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0495
Accuracy: 0.9952, Precision: 0.9939, Recall: 0.9859, F1: 0.9898
Accuracy: 0.9905, Precision: 0.9846, Recall: 0.9762, F1: 0.9804
Epoch 10/30
Training - Loss: 57.5970
Training Metrics: {'accuracy': 0.9951699746621622, 'precision': 0.9938528025762812, 'recall': 0.9858583072868787, 'f1': 0.9898080948193337}
Validation Metrics: {'accuracy': 0.9904993138393329, 'precision': 0.9846392757453104, 'recall': 0.9762080346952751, 'f1': 0.9803689659040734}
Epoch 11/30, Step 0/1,Classification Loss: 0.3140, Contrastive Loss: 0.0518
Epoch 11/30, Step 20/1,Classification Loss: 0.3347, Contrastive Loss: 0.0578
Epoch 11/30, Step 40/1,Classification Loss: 0.3444, Contrastive Loss: 0.0527
Epoch 11/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0498
Epoch 11/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0522
Epoch 11/30, Step 100/1,Classification Loss: 0.3348, Contrastive Loss: 0.0557
Epoch 11/30, Step 120/1,Classification Loss: 0.3449, Contrastive Loss: 0.0668
Epoch 11/30, Step 140/1,Classification Loss: 0.3388, Contrastive Loss: 0.0517
Accuracy: 0.9951, Precision: 0.9950, Recall: 0.9843, F1: 0.9896
Accuracy: 0.9895, Precision: 0.9834, Recall: 0.9735, F1: 0.9784
Epoch 11/30
Training - Loss: 56.9032
Training Metrics: {'accuracy': 0.995090793918919, 'precision': 0.9950093601724661, 'recall': 0.9843055680944892, 'f1': 0.989572676358061}
Validation Metrics: {'accuracy': 0.9895492452232661, 'precision': 0.9834073623875232, 'recall': 0.9734885186030586, 'f1': 0.97837196107185}
Epoch 12/30, Step 0/1,Classification Loss: 0.3292, Contrastive Loss: 0.0504
Epoch 12/30, Step 20/1,Classification Loss: 0.3291, Contrastive Loss: 0.0484
Epoch 12/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0474
Epoch 12/30, Step 60/1,Classification Loss: 0.3368, Contrastive Loss: 0.0498
Epoch 12/30, Step 80/1,Classification Loss: 0.3532, Contrastive Loss: 0.0524
Epoch 12/30, Step 100/1,Classification Loss: 0.3338, Contrastive Loss: 0.0481
Epoch 12/30, Step 120/1,Classification Loss: 0.3444, Contrastive Loss: 0.0481
Epoch 12/30, Step 140/1,Classification Loss: 0.3569, Contrastive Loss: 0.0517
Accuracy: 0.9952, Precision: 0.9945, Recall: 0.9852, F1: 0.9898
Accuracy: 0.9903, Precision: 0.9839, Recall: 0.9761, F1: 0.9799
Epoch 12/30
Training - Loss: 56.2987
Training Metrics: {'accuracy': 0.9951963682432432, 'precision': 0.9944953553391768, 'recall': 0.9852256060437066, 'f1': 0.9897969198772425}
Validation Metrics: {'accuracy': 0.9902881874802069, 'precision': 0.9838997229115869, 'recall': 0.9760849577721982, 'f1': 0.9799452883453315}
Epoch 13/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0484
Epoch 13/30, Step 20/1,Classification Loss: 0.3505, Contrastive Loss: 0.0465
Epoch 13/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0423
Epoch 13/30, Step 60/1,Classification Loss: 0.3284, Contrastive Loss: 0.0450
Epoch 13/30, Step 80/1,Classification Loss: 0.3268, Contrastive Loss: 0.0450
Epoch 13/30, Step 100/1,Classification Loss: 0.3321, Contrastive Loss: 0.0424
Epoch 13/30, Step 120/1,Classification Loss: 0.3433, Contrastive Loss: 0.0582
Epoch 13/30, Step 140/1,Classification Loss: 0.3303, Contrastive Loss: 0.0422
Accuracy: 0.9948, Precision: 0.9966, Recall: 0.9816, F1: 0.9889
Accuracy: 0.9893, Precision: 0.9873, Recall: 0.9687, F1: 0.9777
Epoch 13/30
Training - Loss: 55.8234
Training Metrics: {'accuracy': 0.994800464527027, 'precision': 0.9965814717738515, 'recall': 0.9815783245222194, 'f1': 0.988913470099755}
Validation Metrics: {'accuracy': 0.9893381188641401, 'precision': 0.9872825209375418, 'recall': 0.9687247203834741, 'f1': 0.9777388444742882}
Epoch 14/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0391
Epoch 14/30, Step 20/1,Classification Loss: 0.3363, Contrastive Loss: 0.0411
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0383
Epoch 14/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0409
Epoch 14/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0396
Epoch 14/30, Step 100/1,Classification Loss: 0.3331, Contrastive Loss: 0.0399
Epoch 14/30, Step 120/1,Classification Loss: 0.3504, Contrastive Loss: 0.0441
Epoch 14/30, Step 140/1,Classification Loss: 0.3207, Contrastive Loss: 0.0370
Accuracy: 0.9943, Precision: 0.9961, Recall: 0.9799, F1: 0.9878
Accuracy: 0.9878, Precision: 0.9860, Recall: 0.9635, F1: 0.9743
Epoch 14/30
Training - Loss: 55.1401
Training Metrics: {'accuracy': 0.9942989864864865, 'precision': 0.9961236982265881, 'recall': 0.9799081312835893, 'f1': 0.9878212271347997}
Validation Metrics: {'accuracy': 0.9877546711706957, 'precision': 0.9859648523205053, 'recall': 0.9634703035836567, 'f1': 0.9743264305891135}
Epoch 15/30, Step 0/1,Classification Loss: 0.3671, Contrastive Loss: 0.0471
Epoch 15/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0358
Epoch 15/30, Step 40/1,Classification Loss: 0.3638, Contrastive Loss: 0.0435
Epoch 15/30, Step 60/1,Classification Loss: 0.3341, Contrastive Loss: 0.0407
Epoch 15/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0365
Epoch 15/30, Step 100/1,Classification Loss: 0.3446, Contrastive Loss: 0.0464
Epoch 15/30, Step 120/1,Classification Loss: 0.3421, Contrastive Loss: 0.0390
Epoch 15/30, Step 140/1,Classification Loss: 0.3658, Contrastive Loss: 0.0453
Accuracy: 0.9954, Precision: 0.9940, Recall: 0.9868, F1: 0.9904
Accuracy: 0.9903, Precision: 0.9833, Recall: 0.9767, F1: 0.9800
Epoch 15/30
Training - Loss: 54.9204
Training Metrics: {'accuracy': 0.995433910472973, 'precision': 0.9940027001103398, 'recall': 0.9867766703266487, 'f1': 0.9903509929110059}
Validation Metrics: {'accuracy': 0.9902881874802069, 'precision': 0.9833041930692454, 'recall': 0.9767037206117324, 'f1': 0.9799703654184032}
Epoch 16/30, Step 0/1,Classification Loss: 0.3518, Contrastive Loss: 0.0455
Epoch 16/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.0403
Epoch 16/30, Step 40/1,Classification Loss: 0.3296, Contrastive Loss: 0.0352
Epoch 16/30, Step 60/1,Classification Loss: 0.3185, Contrastive Loss: 0.0322
Epoch 16/30, Step 80/1,Classification Loss: 0.3446, Contrastive Loss: 0.0400
Epoch 16/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0361
Epoch 16/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0342
Epoch 16/30, Step 140/1,Classification Loss: 0.3151, Contrastive Loss: 0.0336
Accuracy: 0.9950, Precision: 0.9935, Recall: 0.9854, F1: 0.9894
Accuracy: 0.9898, Precision: 0.9838, Recall: 0.9739, F1: 0.9788
Epoch 16/30
Training - Loss: 54.5185
Training Metrics: {'accuracy': 0.9950116131756757, 'precision': 0.9934898287074204, 'recall': 0.9854376692107805, 'f1': 0.9894157139404495}
Validation Metrics: {'accuracy': 0.989760371582392, 'precision': 0.9838488800561533, 'recall': 0.9739209769459027, 'f1': 0.9788088911512065}
Epoch 17/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0360
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0303
Epoch 17/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0361
Epoch 17/30, Step 60/1,Classification Loss: 0.3441, Contrastive Loss: 0.0375
Epoch 17/30, Step 80/1,Classification Loss: 0.3173, Contrastive Loss: 0.0300
Epoch 17/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0328
Epoch 17/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0391
Epoch 17/30, Step 140/1,Classification Loss: 0.3497, Contrastive Loss: 0.0378
Accuracy: 0.9951, Precision: 0.9943, Recall: 0.9852, F1: 0.9897
Accuracy: 0.9895, Precision: 0.9859, Recall: 0.9710, F1: 0.9783
Epoch 17/30
Training - Loss: 54.3382
Training Metrics: {'accuracy': 0.9951171875, 'precision': 0.9943098457912142, 'recall': 0.9852131740197416, 'f1': 0.9897000362291786}
Validation Metrics: {'accuracy': 0.9895492452232661, 'precision': 0.9858506656510353, 'recall': 0.9710134672449213, 'f1': 0.9782625883004774}
Epoch 18/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0295
Epoch 18/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0278
Epoch 18/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0322
Epoch 18/30, Step 60/1,Classification Loss: 0.3599, Contrastive Loss: 0.0352
Epoch 18/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0296
Epoch 18/30, Step 100/1,Classification Loss: 0.3434, Contrastive Loss: 0.0359
Epoch 18/30, Step 120/1,Classification Loss: 0.3258, Contrastive Loss: 0.0305
Epoch 18/30, Step 140/1,Classification Loss: 0.3155, Contrastive Loss: 0.0295
Accuracy: 0.9941, Precision: 0.9952, Recall: 0.9799, F1: 0.9874
Accuracy: 0.9879, Precision: 0.9873, Recall: 0.9626, F1: 0.9745
Epoch 18/30
Training - Loss: 53.7972
Training Metrics: {'accuracy': 0.9940614442567568, 'precision': 0.9952361448556393, 'recall': 0.9798690263599015, 'f1': 0.9873770343076846}
Validation Metrics: {'accuracy': 0.9878602343502586, 'precision': 0.9873199985919018, 'recall': 0.9626036977858936, 'f1': 0.9744905611247621}
Epoch 19/30, Step 0/1,Classification Loss: 0.3375, Contrastive Loss: 0.0329
Epoch 19/30, Step 20/1,Classification Loss: 0.3405, Contrastive Loss: 0.0314
Epoch 19/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0293
Epoch 19/30, Step 60/1,Classification Loss: 0.3158, Contrastive Loss: 0.0276
Epoch 19/30, Step 80/1,Classification Loss: 0.3343, Contrastive Loss: 0.0302
Epoch 19/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0301
Epoch 19/30, Step 120/1,Classification Loss: 0.3464, Contrastive Loss: 0.0342
Epoch 19/30, Step 140/1,Classification Loss: 0.3146, Contrastive Loss: 0.0287
Accuracy: 0.9954, Precision: 0.9941, Recall: 0.9867, F1: 0.9903
Accuracy: 0.9902, Precision: 0.9832, Recall: 0.9763, F1: 0.9797
Epoch 19/30
Training - Loss: 53.4214
Training Metrics: {'accuracy': 0.995433910472973, 'precision': 0.9940789859114927, 'recall': 0.9866821297601871, 'f1': 0.9903400408563814}
Validation Metrics: {'accuracy': 0.990182624300644, 'precision': 0.9832332972091774, 'recall': 0.9763328007304268, 'f1': 0.9797463219286691}
Epoch 20/30, Step 0/1,Classification Loss: 0.3443, Contrastive Loss: 0.0327
Epoch 20/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0356
Epoch 20/30, Step 40/1,Classification Loss: 0.3792, Contrastive Loss: 0.0478
Epoch 20/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0257
Epoch 20/30, Step 80/1,Classification Loss: 0.3184, Contrastive Loss: 0.0258
Epoch 20/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 20/30, Step 120/1,Classification Loss: 0.3724, Contrastive Loss: 0.0351
Epoch 20/30, Step 140/1,Classification Loss: 0.3305, Contrastive Loss: 0.0282
Accuracy: 0.9954, Precision: 0.9942, Recall: 0.9865, F1: 0.9903
Accuracy: 0.9899, Precision: 0.9830, Recall: 0.9752, F1: 0.9791
Epoch 20/30
Training - Loss: 53.3253
Training Metrics: {'accuracy': 0.995433910472973, 'precision': 0.994237048501559, 'recall': 0.9865094528402526, 'f1': 0.9903290583179654}
Validation Metrics: {'accuracy': 0.9898659347619551, 'precision': 0.9830206089263338, 'recall': 0.97522004108651, 'f1': 0.9790733443603459}
Epoch 21/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0306
Epoch 21/30, Step 20/1,Classification Loss: 0.3507, Contrastive Loss: 0.0285
Epoch 21/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0257
Epoch 21/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0235
Epoch 21/30, Step 80/1,Classification Loss: 0.3235, Contrastive Loss: 0.0248
Epoch 21/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0262
Epoch 21/30, Step 120/1,Classification Loss: 0.3448, Contrastive Loss: 0.0295
Epoch 21/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0234
Accuracy: 0.9954, Precision: 0.9944, Recall: 0.9862, F1: 0.9902
Accuracy: 0.9895, Precision: 0.9840, Recall: 0.9729, F1: 0.9783
Epoch 21/30
Training - Loss: 53.1809
Training Metrics: {'accuracy': 0.9953547297297297, 'precision': 0.9943746174186753, 'recall': 0.9861579101270358, 'f1': 0.9902161219315523}
Validation Metrics: {'accuracy': 0.9895492452232661, 'precision': 0.9840113184744246, 'recall': 0.9728697557635243, 'f1': 0.9783447451947465}
Epoch 22/30, Step 0/1,Classification Loss: 0.3306, Contrastive Loss: 0.0256
Epoch 22/30, Step 20/1,Classification Loss: 0.3257, Contrastive Loss: 0.0250
Epoch 22/30, Step 40/1,Classification Loss: 0.3628, Contrastive Loss: 0.0372
Epoch 22/30, Step 60/1,Classification Loss: 0.3338, Contrastive Loss: 0.0249
Epoch 22/30, Step 80/1,Classification Loss: 0.3176, Contrastive Loss: 0.0237
Epoch 22/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0333
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0218
Epoch 22/30, Step 140/1,Classification Loss: 0.3345, Contrastive Loss: 0.0269
Accuracy: 0.9952, Precision: 0.9939, Recall: 0.9859, F1: 0.9898
Accuracy: 0.9901, Precision: 0.9844, Recall: 0.9747, F1: 0.9795
Epoch 22/30
Training - Loss: 52.9565
Training Metrics: {'accuracy': 0.9951963682432432, 'precision': 0.9939436389329124, 'recall': 0.9858531712100891, 'f1': 0.9898498432069663}
Validation Metrics: {'accuracy': 0.990077061121081, 'precision': 0.9843601706330886, 'recall': 0.9747243551700524, 'f1': 0.9794707340924023}
Epoch 23/30, Step 0/1,Classification Loss: 0.3444, Contrastive Loss: 0.0256
Epoch 23/30, Step 20/1,Classification Loss: 0.3290, Contrastive Loss: 0.0252
Epoch 23/30, Step 40/1,Classification Loss: 0.3137, Contrastive Loss: 0.0226
Epoch 23/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 23/30, Step 80/1,Classification Loss: 0.3143, Contrastive Loss: 0.0219
Epoch 23/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0252
Epoch 23/30, Step 120/1,Classification Loss: 0.3481, Contrastive Loss: 0.0279
Epoch 23/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0258
Accuracy: 0.9945, Precision: 0.9962, Recall: 0.9808, F1: 0.9884
Accuracy: 0.9891, Precision: 0.9856, Recall: 0.9695, F1: 0.9774
Epoch 23/30
Training - Loss: 52.8686
Training Metrics: {'accuracy': 0.9945101351351351, 'precision': 0.9962478728731767, 'recall': 0.9808477623692686, 'f1': 0.988371564842153}
Validation Metrics: {'accuracy': 0.9891269925050142, 'precision': 0.9855785981978205, 'recall': 0.9695297877196987, 'f1': 0.9773556389754756}
Epoch 24/30, Step 0/1,Classification Loss: 0.3136, Contrastive Loss: 0.0212
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0220
Epoch 24/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0212
Epoch 24/30, Step 60/1,Classification Loss: 0.3717, Contrastive Loss: 0.0326
Epoch 24/30, Step 80/1,Classification Loss: 0.3727, Contrastive Loss: 0.0328
Epoch 24/30, Step 100/1,Classification Loss: 0.3294, Contrastive Loss: 0.0223
Epoch 24/30, Step 120/1,Classification Loss: 0.3502, Contrastive Loss: 0.0258
Epoch 24/30, Step 140/1,Classification Loss: 0.3333, Contrastive Loss: 0.0247
Accuracy: 0.9955, Precision: 0.9941, Recall: 0.9869, F1: 0.9905
Accuracy: 0.9903, Precision: 0.9821, Recall: 0.9779, F1: 0.9800
Epoch 24/30
Training - Loss: 52.7713
Training Metrics: {'accuracy': 0.9955130912162162, 'precision': 0.9941016568060341, 'recall': 0.9868833825655466, 'f1': 0.9904540726889901}
Validation Metrics: {'accuracy': 0.9902881874802069, 'precision': 0.9821263805988638, 'recall': 0.9779412462908011, 'f1': 0.9800202879189862}
Epoch 25/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 25/30, Step 20/1,Classification Loss: 0.3325, Contrastive Loss: 0.0242
Epoch 25/30, Step 40/1,Classification Loss: 0.3479, Contrastive Loss: 0.0284
Epoch 25/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0228
Epoch 25/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0201
Epoch 25/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 25/30, Step 120/1,Classification Loss: 0.3249, Contrastive Loss: 0.0201
Epoch 25/30, Step 140/1,Classification Loss: 0.3300, Contrastive Loss: 0.0238
Accuracy: 0.9949, Precision: 0.9965, Recall: 0.9820, F1: 0.9891
Accuracy: 0.9895, Precision: 0.9868, Recall: 0.9701, F1: 0.9782
Epoch 25/30
Training - Loss: 52.4189
Training Metrics: {'accuracy': 0.9948532516891891, 'precision': 0.9965292236024376, 'recall': 0.9819729370149892, 'f1': 0.9890939116759274}
Validation Metrics: {'accuracy': 0.9895492452232661, 'precision': 0.9867860512785603, 'recall': 0.9700853229856197, 'f1': 0.9782212210186336}
Epoch 26/30, Step 0/1,Classification Loss: 0.3601, Contrastive Loss: 0.0262
Epoch 26/30, Step 20/1,Classification Loss: 0.3601, Contrastive Loss: 0.0258
Epoch 26/30, Step 40/1,Classification Loss: 0.3499, Contrastive Loss: 0.0284
Epoch 26/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0211
Epoch 26/30, Step 80/1,Classification Loss: 0.3204, Contrastive Loss: 0.0205
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0203
Epoch 26/30, Step 120/1,Classification Loss: 0.3322, Contrastive Loss: 0.0229
Epoch 26/30, Step 140/1,Classification Loss: 0.3361, Contrastive Loss: 0.0234
Accuracy: 0.9947, Precision: 0.9940, Recall: 0.9837, F1: 0.9888
Accuracy: 0.9887, Precision: 0.9828, Recall: 0.9705, F1: 0.9766
Epoch 26/30
Training - Loss: 52.3691
Training Metrics: {'accuracy': 0.9946948902027027, 'precision': 0.9939672844796539, 'recall': 0.9837342099043184, 'f1': 0.9887729371499983}
Validation Metrics: {'accuracy': 0.9887047397867624, 'precision': 0.982844687351084, 'recall': 0.9705211595526135, 'f1': 0.9765653190137333}
Epoch 27/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0220
Epoch 27/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0210
Epoch 27/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0212
Epoch 27/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0218
Epoch 27/30, Step 80/1,Classification Loss: 0.3224, Contrastive Loss: 0.0189
Epoch 27/30, Step 100/1,Classification Loss: 0.3410, Contrastive Loss: 0.0225
Epoch 27/30, Step 120/1,Classification Loss: 0.3309, Contrastive Loss: 0.0229
Epoch 27/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0187
Accuracy: 0.9934, Precision: 0.9958, Recall: 0.9764, F1: 0.9858
Accuracy: 0.9875, Precision: 0.9881, Recall: 0.9606, F1: 0.9737
Epoch 27/30
Training - Loss: 52.4068
Training Metrics: {'accuracy': 0.9934016047297297, 'precision': 0.9957756953467811, 'recall': 0.9763794031467296, 'f1': 0.9857989143665841}
Validation Metrics: {'accuracy': 0.9875435448115697, 'precision': 0.988105727724789, 'recall': 0.9605627938826752, 'f1': 0.9737491674893923}
Epoch 28/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0206
Epoch 28/30, Step 20/1,Classification Loss: 0.3304, Contrastive Loss: 0.0225
Epoch 28/30, Step 40/1,Classification Loss: 0.3297, Contrastive Loss: 0.0212
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 28/30, Step 80/1,Classification Loss: 0.3292, Contrastive Loss: 0.0226
Epoch 28/30, Step 100/1,Classification Loss: 0.3359, Contrastive Loss: 0.0214
Epoch 28/30, Step 120/1,Classification Loss: 0.3309, Contrastive Loss: 0.0215
Epoch 28/30, Step 140/1,Classification Loss: 0.3363, Contrastive Loss: 0.0214
Accuracy: 0.9954, Precision: 0.9958, Recall: 0.9849, F1: 0.9903
Accuracy: 0.9905, Precision: 0.9868, Recall: 0.9740, F1: 0.9803
Epoch 28/30
Training - Loss: 52.4226
Training Metrics: {'accuracy': 0.9953811233108109, 'precision': 0.9957699261284974, 'recall': 0.9849275616131995, 'f1': 0.9902615090184523}
Validation Metrics: {'accuracy': 0.9904993138393329, 'precision': 0.9867709871891344, 'recall': 0.9740423647569048, 'f1': 0.9802823693664474}
Epoch 29/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0195
Epoch 29/30, Step 20/1,Classification Loss: 0.3217, Contrastive Loss: 0.0202
Epoch 29/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0199
Epoch 29/30, Step 60/1,Classification Loss: 0.3359, Contrastive Loss: 0.0345
Epoch 29/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0190
Epoch 29/30, Step 100/1,Classification Loss: 0.3637, Contrastive Loss: 0.0252
Epoch 29/30, Step 120/1,Classification Loss: 0.3340, Contrastive Loss: 0.0242
Epoch 29/30, Step 140/1,Classification Loss: 0.3442, Contrastive Loss: 0.0220
Accuracy: 0.9953, Precision: 0.9940, Recall: 0.9864, F1: 0.9902
Accuracy: 0.9907, Precision: 0.9845, Recall: 0.9773, F1: 0.9808
Epoch 29/30
Training - Loss: 52.3215
Training Metrics: {'accuracy': 0.9953283361486487, 'precision': 0.9940371948806404, 'recall': 0.9863789411114847, 'f1': 0.9901644937908469}
Validation Metrics: {'accuracy': 0.9907104401984588, 'precision': 0.9844794034372649, 'recall': 0.9772592558776535, 'f1': 0.980829234979715}
Epoch 30/30, Step 0/1,Classification Loss: 0.3293, Contrastive Loss: 0.0223
Epoch 30/30, Step 20/1,Classification Loss: 0.3758, Contrastive Loss: 0.0372
Epoch 30/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0205
Epoch 30/30, Step 60/1,Classification Loss: 0.3308, Contrastive Loss: 0.0234
Epoch 30/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0215
Epoch 30/30, Step 100/1,Classification Loss: 0.3430, Contrastive Loss: 0.0228
Epoch 30/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.0223
Epoch 30/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0319
Accuracy: 0.9952, Precision: 0.9958, Recall: 0.9840, F1: 0.9898
Accuracy: 0.9903, Precision: 0.9866, Recall: 0.9733, F1: 0.9798
Epoch 30/30
Training - Loss: 52.2613
Training Metrics: {'accuracy': 0.9952491554054054, 'precision': 0.9958334021468465, 'recall': 0.984036769732842, 'f1': 0.98983261934085}
Validation Metrics: {'accuracy': 0.9902881874802069, 'precision': 0.9866354698707593, 'recall': 0.9733005249942935, 'f1': 0.9798314752249437}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (663, 5814), y shape: (663,), y distribution: Counter({np.float64(0.0): 591, np.float64(1.0): 72}), env shape: (663,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8884, Precision: 0.4455, Recall: 0.4983, F1: 0.4704
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13315]))
original train data shape: torch.Size([47462]), new train data shape: torch.Size([100])
original test data shape: torch.Size([663, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([47462]), new train data shape: torch.Size([47462])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13315]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 1.5044
Epoch 1/30, Step 20/1,Classification Loss: 0.3377, Contrastive Loss: 0.7344
Epoch 1/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.3608
Epoch 1/30, Step 60/1,Classification Loss: 0.3292, Contrastive Loss: 0.2484
Epoch 1/30, Step 80/1,Classification Loss: 0.3307, Contrastive Loss: 0.2072
Epoch 1/30, Step 100/1,Classification Loss: 0.3656, Contrastive Loss: 0.2011
Epoch 1/30, Step 120/1,Classification Loss: 0.3344, Contrastive Loss: 0.1666
Epoch 1/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.1503
Accuracy: 0.9947, Precision: 0.9935, Recall: 0.9843, F1: 0.9889
Accuracy: 0.9908, Precision: 0.9867, Recall: 0.9755, F1: 0.9810
Epoch 1/30
Training - Loss: 105.0536
Training Metrics: {'accuracy': 0.9947476773648649, 'precision': 0.9934991637580216, 'recall': 0.9843474120285005, 'f1': 0.9888611410561455}
Validation Metrics: {'accuracy': 0.9908353523649005, 'precision': 0.9866900861611457, 'recall': 0.9755019762486299, 'f1': 0.9810000881334975}
Epoch 2/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1493
Epoch 2/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.1375
Epoch 2/30, Step 40/1,Classification Loss: 0.3353, Contrastive Loss: 0.1410
Epoch 2/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.1351
Epoch 2/30, Step 80/1,Classification Loss: 0.3536, Contrastive Loss: 0.1346
Epoch 2/30, Step 100/1,Classification Loss: 0.3202, Contrastive Loss: 0.1191
Epoch 2/30, Step 120/1,Classification Loss: 0.3600, Contrastive Loss: 0.1289
Epoch 2/30, Step 140/1,Classification Loss: 0.3362, Contrastive Loss: 0.1195
Accuracy: 0.9951, Precision: 0.9942, Recall: 0.9854, F1: 0.9897
Accuracy: 0.9909, Precision: 0.9858, Recall: 0.9768, F1: 0.9813
Epoch 2/30
Training - Loss: 69.1046
Training Metrics: {'accuracy': 0.995143581081081, 'precision': 0.9941532043668981, 'recall': 0.9854199168302717, 'f1': 0.9897299876690178}
Validation Metrics: {'accuracy': 0.9909406931423154, 'precision': 0.9858456707043517, 'recall': 0.9767992504355024, 'f1': 0.9812596812209793}
Epoch 3/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1199
Epoch 3/30, Step 20/1,Classification Loss: 0.3357, Contrastive Loss: 0.1135
Epoch 3/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.1045
Epoch 3/30, Step 60/1,Classification Loss: 0.3178, Contrastive Loss: 0.1072
Epoch 3/30, Step 80/1,Classification Loss: 0.3366, Contrastive Loss: 0.1079
Epoch 3/30, Step 100/1,Classification Loss: 0.3503, Contrastive Loss: 0.1162
Epoch 3/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.1056
Epoch 3/30, Step 140/1,Classification Loss: 0.3233, Contrastive Loss: 0.1007
Accuracy: 0.9951, Precision: 0.9936, Recall: 0.9857, F1: 0.9896
Accuracy: 0.9908, Precision: 0.9858, Recall: 0.9764, F1: 0.9810
Epoch 3/30
Training - Loss: 65.6068
Training Metrics: {'accuracy': 0.995090793918919, 'precision': 0.9936330339027626, 'recall': 0.9856938379167485, 'f1': 0.9896166739504888}
Validation Metrics: {'accuracy': 0.9908353523649005, 'precision': 0.9857768942483546, 'recall': 0.9764288800651321, 'f1': 0.9810358297218009}
Epoch 4/30, Step 0/1,Classification Loss: 0.3419, Contrastive Loss: 0.1122
Epoch 4/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0986
Epoch 4/30, Step 40/1,Classification Loss: 0.3365, Contrastive Loss: 0.1069
Epoch 4/30, Step 60/1,Classification Loss: 0.3347, Contrastive Loss: 0.0955
Epoch 4/30, Step 80/1,Classification Loss: 0.3757, Contrastive Loss: 0.1047
Epoch 4/30, Step 100/1,Classification Loss: 0.3446, Contrastive Loss: 0.0952
Epoch 4/30, Step 120/1,Classification Loss: 0.3198, Contrastive Loss: 0.0890
Epoch 4/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0859
Accuracy: 0.9952, Precision: 0.9938, Recall: 0.9858, F1: 0.9898
Accuracy: 0.9902, Precision: 0.9845, Recall: 0.9751, F1: 0.9797
Epoch 4/30
Training - Loss: 63.4366
Training Metrics: {'accuracy': 0.9951699746621622, 'precision': 0.9938300614374366, 'recall': 0.985776112924369, 'f1': 0.9897550601414711}
Validation Metrics: {'accuracy': 0.9902033077004109, 'precision': 0.984456160391693, 'recall': 0.9751335616594121, 'f1': 0.9797279559095113}
Epoch 5/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0874
Epoch 5/30, Step 20/1,Classification Loss: 0.3268, Contrastive Loss: 0.0883
Epoch 5/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0889
Epoch 5/30, Step 60/1,Classification Loss: 0.3446, Contrastive Loss: 0.0949
Epoch 5/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0791
Epoch 5/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0776
Epoch 5/30, Step 120/1,Classification Loss: 0.3250, Contrastive Loss: 0.0816
Epoch 5/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0842
Accuracy: 0.9951, Precision: 0.9938, Recall: 0.9856, F1: 0.9896
Accuracy: 0.9904, Precision: 0.9843, Recall: 0.9762, F1: 0.9802
Epoch 5/30
Training - Loss: 61.9223
Training Metrics: {'accuracy': 0.995090793918919, 'precision': 0.9938048655788498, 'recall': 0.9855728105225088, 'f1': 0.9896385029099013}
Validation Metrics: {'accuracy': 0.9904139892552407, 'precision': 0.9842955025067283, 'recall': 0.9761832703389869, 'f1': 0.9801887408840282}
Epoch 6/30, Step 0/1,Classification Loss: 0.3385, Contrastive Loss: 0.0821
Epoch 6/30, Step 20/1,Classification Loss: 0.3190, Contrastive Loss: 0.0744
Epoch 6/30, Step 40/1,Classification Loss: 0.3314, Contrastive Loss: 0.0750
Epoch 6/30, Step 60/1,Classification Loss: 0.3393, Contrastive Loss: 0.0800
Epoch 6/30, Step 80/1,Classification Loss: 0.3450, Contrastive Loss: 0.0825
Epoch 6/30, Step 100/1,Classification Loss: 0.3608, Contrastive Loss: 0.0802
Epoch 6/30, Step 120/1,Classification Loss: 0.3359, Contrastive Loss: 0.0807
Epoch 6/30, Step 140/1,Classification Loss: 0.3333, Contrastive Loss: 0.0751
Accuracy: 0.9945, Precision: 0.9938, Recall: 0.9832, F1: 0.9884
Accuracy: 0.9893, Precision: 0.9838, Recall: 0.9718, F1: 0.9777
Epoch 6/30
Training - Loss: 60.6331
Training Metrics: {'accuracy': 0.9945365287162162, 'precision': 0.9937776060937633, 'recall': 0.983178042341608, 'f1': 0.9883944512692582}
Validation Metrics: {'accuracy': 0.9892552407036764, 'precision': 0.9838296766802895, 'recall': 0.9718002283260787, 'f1': 0.9777032161439984}
Epoch 7/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0678
Epoch 7/30, Step 20/1,Classification Loss: 0.3313, Contrastive Loss: 0.0714
Epoch 7/30, Step 40/1,Classification Loss: 0.3181, Contrastive Loss: 0.0665
Epoch 7/30, Step 60/1,Classification Loss: 0.3444, Contrastive Loss: 0.0696
Epoch 7/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0627
Epoch 7/30, Step 100/1,Classification Loss: 0.3134, Contrastive Loss: 0.0670
Epoch 7/30, Step 120/1,Classification Loss: 0.3366, Contrastive Loss: 0.0711
Epoch 7/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0703
Accuracy: 0.9951, Precision: 0.9941, Recall: 0.9851, F1: 0.9896
Accuracy: 0.9902, Precision: 0.9842, Recall: 0.9754, F1: 0.9797
Epoch 7/30
Training - Loss: 59.5005
Training Metrics: {'accuracy': 0.995090793918919, 'precision': 0.9940965193748873, 'recall': 0.9851235281072526, 'f1': 0.9895505060180652}
Validation Metrics: {'accuracy': 0.9902033077004109, 'precision': 0.9841557071783305, 'recall': 0.9754425295982461, 'f1': 0.9797406520564059}
Epoch 8/30, Step 0/1,Classification Loss: 0.3291, Contrastive Loss: 0.0661
Epoch 8/30, Step 20/1,Classification Loss: 0.3324, Contrastive Loss: 0.0635
Epoch 8/30, Step 40/1,Classification Loss: 0.3219, Contrastive Loss: 0.0638
Epoch 8/30, Step 60/1,Classification Loss: 0.3218, Contrastive Loss: 0.0647
Epoch 8/30, Step 80/1,Classification Loss: 0.3351, Contrastive Loss: 0.0625
Epoch 8/30, Step 100/1,Classification Loss: 0.3365, Contrastive Loss: 0.0645
Epoch 8/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0585
Epoch 8/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0584
Accuracy: 0.9939, Precision: 0.9932, Recall: 0.9811, F1: 0.9870
Accuracy: 0.9885, Precision: 0.9852, Recall: 0.9674, F1: 0.9760
Epoch 8/30
Training - Loss: 58.7042
Training Metrics: {'accuracy': 0.9938766891891891, 'precision': 0.9931525684517963, 'recall': 0.9811188075743493, 'f1': 0.9870277145541122}
Validation Metrics: {'accuracy': 0.9885178552617718, 'precision': 0.9851968810010443, 'recall': 0.9673538281004816, 'f1': 0.9760295243060434}
Epoch 9/30, Step 0/1,Classification Loss: 0.3500, Contrastive Loss: 0.0614
Epoch 9/30, Step 20/1,Classification Loss: 0.3644, Contrastive Loss: 0.0618
Epoch 9/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0542
Epoch 9/30, Step 60/1,Classification Loss: 0.3149, Contrastive Loss: 0.0554
Epoch 9/30, Step 80/1,Classification Loss: 0.3205, Contrastive Loss: 0.0547
Epoch 9/30, Step 100/1,Classification Loss: 0.3307, Contrastive Loss: 0.0591
Epoch 9/30, Step 120/1,Classification Loss: 0.3286, Contrastive Loss: 0.0558
Epoch 9/30, Step 140/1,Classification Loss: 0.3445, Contrastive Loss: 0.0637
Accuracy: 0.9939, Precision: 0.9932, Recall: 0.9811, F1: 0.9870
Accuracy: 0.9891, Precision: 0.9850, Recall: 0.9702, F1: 0.9774
Epoch 9/30
Training - Loss: 57.8339
Training Metrics: {'accuracy': 0.9939030827702703, 'precision': 0.9931507435544669, 'recall': 0.9811240810664575, 'f1': 0.98702982973864}
Validation Metrics: {'accuracy': 0.9891498999262615, 'precision': 0.9849846947660453, 'recall': 0.9701939862003721, 'f1': 0.9774206290237977}
Epoch 10/30, Step 0/1,Classification Loss: 0.3451, Contrastive Loss: 0.0582
Epoch 10/30, Step 20/1,Classification Loss: 0.3748, Contrastive Loss: 0.0648
Epoch 10/30, Step 40/1,Classification Loss: 0.3369, Contrastive Loss: 0.0554
Epoch 10/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0527
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0493
Epoch 10/30, Step 100/1,Classification Loss: 0.3163, Contrastive Loss: 0.0491
Epoch 10/30, Step 120/1,Classification Loss: 0.3370, Contrastive Loss: 0.0528
Epoch 10/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0545
Accuracy: 0.9952, Precision: 0.9939, Recall: 0.9862, F1: 0.9900
Accuracy: 0.9902, Precision: 0.9860, Recall: 0.9736, F1: 0.9797
Epoch 10/30
Training - Loss: 57.0704
Training Metrics: {'accuracy': 0.9952491554054054, 'precision': 0.9939028626604527, 'recall': 0.9861512950999103, 'f1': 0.9899824580205202}
Validation Metrics: {'accuracy': 0.9902033077004109, 'precision': 0.9859754018909617, 'recall': 0.9735887219652417, 'f1': 0.9796641795213299}
Epoch 11/30, Step 0/1,Classification Loss: 0.3236, Contrastive Loss: 0.0498
Epoch 11/30, Step 20/1,Classification Loss: 0.3302, Contrastive Loss: 0.0478
Epoch 11/30, Step 40/1,Classification Loss: 0.3306, Contrastive Loss: 0.0485
Epoch 11/30, Step 60/1,Classification Loss: 0.3496, Contrastive Loss: 0.0541
Epoch 11/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0473
Epoch 11/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0510
Epoch 11/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0472
Epoch 11/30, Step 140/1,Classification Loss: 0.3446, Contrastive Loss: 0.0474
Accuracy: 0.9951, Precision: 0.9938, Recall: 0.9854, F1: 0.9895
Accuracy: 0.9898, Precision: 0.9857, Recall: 0.9721, F1: 0.9788
Epoch 11/30
Training - Loss: 56.5855
Training Metrics: {'accuracy': 0.9950644003378378, 'precision': 0.9937554077386197, 'recall': 0.9853531351980576, 'f1': 0.989502054649477}
Validation Metrics: {'accuracy': 0.9897819445907511, 'precision': 0.985702701083915, 'recall': 0.9721072404837602, 'f1': 0.9787627680237037}
Epoch 12/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0447
Epoch 12/30, Step 20/1,Classification Loss: 0.3456, Contrastive Loss: 0.0501
Epoch 12/30, Step 40/1,Classification Loss: 0.3385, Contrastive Loss: 0.0501
Epoch 12/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0471
Epoch 12/30, Step 80/1,Classification Loss: 0.3364, Contrastive Loss: 0.0451
Epoch 12/30, Step 100/1,Classification Loss: 0.3348, Contrastive Loss: 0.0454
Epoch 12/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0427
Epoch 12/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0443
Accuracy: 0.9951, Precision: 0.9941, Recall: 0.9852, F1: 0.9896
Accuracy: 0.9901, Precision: 0.9853, Recall: 0.9738, F1: 0.9795
Epoch 12/30
Training - Loss: 55.9298
Training Metrics: {'accuracy': 0.995090793918919, 'precision': 0.994108697964522, 'recall': 0.9851752366892466, 'f1': 0.9895828701021344}
Validation Metrics: {'accuracy': 0.9900979669229959, 'precision': 0.9852955315856788, 'recall': 0.9738362874725395, 'f1': 0.9794649059033902}
Epoch 13/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0396
Epoch 13/30, Step 20/1,Classification Loss: 0.3446, Contrastive Loss: 0.0443
Epoch 13/30, Step 40/1,Classification Loss: 0.3598, Contrastive Loss: 0.0512
Epoch 13/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0402
Epoch 13/30, Step 80/1,Classification Loss: 0.3197, Contrastive Loss: 0.0398
Epoch 13/30, Step 100/1,Classification Loss: 0.3311, Contrastive Loss: 0.0403
Epoch 13/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0398
Epoch 13/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0390
Accuracy: 0.9952, Precision: 0.9941, Recall: 0.9859, F1: 0.9900
Accuracy: 0.9900, Precision: 0.9855, Recall: 0.9732, F1: 0.9792
Epoch 13/30
Training - Loss: 55.3659
Training Metrics: {'accuracy': 0.9952491554054054, 'precision': 0.9941445442845838, 'recall': 0.9859144805918381, 'f1': 0.9899792228269467}
Validation Metrics: {'accuracy': 0.9899926261455809, 'precision': 0.9855323361015961, 'recall': 0.973156949163335, 'f1': 0.9792268500486704}
Epoch 14/30, Step 0/1,Classification Loss: 0.3135, Contrastive Loss: 0.0366
Epoch 14/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0366
Epoch 14/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0389
Epoch 14/30, Step 80/1,Classification Loss: 0.3339, Contrastive Loss: 0.0433
Epoch 14/30, Step 100/1,Classification Loss: 0.3602, Contrastive Loss: 0.0438
Epoch 14/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0349
Epoch 14/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0337
Accuracy: 0.9948, Precision: 0.9938, Recall: 0.9841, F1: 0.9889
Accuracy: 0.9899, Precision: 0.9849, Recall: 0.9734, F1: 0.9790
Epoch 14/30
Training - Loss: 55.0010
Training Metrics: {'accuracy': 0.9947740709459459, 'precision': 0.9938424447370361, 'recall': 0.9841334646172293, 'f1': 0.9889180170768175}
Validation Metrics: {'accuracy': 0.9898872853681661, 'precision': 0.9848533168018698, 'recall': 0.9734045146706328, 'f1': 0.9790279890077177}
Epoch 15/30, Step 0/1,Classification Loss: 0.3515, Contrastive Loss: 0.0432
Epoch 15/30, Step 20/1,Classification Loss: 0.3136, Contrastive Loss: 0.0343
Epoch 15/30, Step 40/1,Classification Loss: 0.3870, Contrastive Loss: 0.0515
Epoch 15/30, Step 60/1,Classification Loss: 0.3349, Contrastive Loss: 0.0365
Epoch 15/30, Step 80/1,Classification Loss: 0.3210, Contrastive Loss: 0.0335
Epoch 15/30, Step 100/1,Classification Loss: 0.3219, Contrastive Loss: 0.0333
Epoch 15/30, Step 120/1,Classification Loss: 0.3319, Contrastive Loss: 0.0354
Epoch 15/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0310
Accuracy: 0.9947, Precision: 0.9936, Recall: 0.9841, F1: 0.9888
Accuracy: 0.9894, Precision: 0.9830, Recall: 0.9731, F1: 0.9780
Epoch 15/30
Training - Loss: 54.8082
Training Metrics: {'accuracy': 0.9947476773648649, 'precision': 0.9936327757305456, 'recall': 0.9840674894268966, 'f1': 0.9887825091415665}
Validation Metrics: {'accuracy': 0.9893605814810913, 'precision': 0.9829945173532326, 'recall': 0.9730975025129514, 'f1': 0.9779703145293615}
Epoch 16/30, Step 0/1,Classification Loss: 0.3328, Contrastive Loss: 0.0500
Epoch 16/30, Step 20/1,Classification Loss: 0.3351, Contrastive Loss: 0.0381
Epoch 16/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0343
Epoch 16/30, Step 60/1,Classification Loss: 0.3150, Contrastive Loss: 0.0322
Epoch 16/30, Step 80/1,Classification Loss: 0.3501, Contrastive Loss: 0.0405
Epoch 16/30, Step 100/1,Classification Loss: 0.3666, Contrastive Loss: 0.0361
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0301
Epoch 16/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0300
Accuracy: 0.9946, Precision: 0.9937, Recall: 0.9837, F1: 0.9886
Accuracy: 0.9898, Precision: 0.9851, Recall: 0.9727, F1: 0.9788
Epoch 16/30
Training - Loss: 54.4584
Training Metrics: {'accuracy': 0.9946157094594594, 'precision': 0.9936730388751737, 'recall': 0.9836733624672983, 'f1': 0.9885988931529281}
Validation Metrics: {'accuracy': 0.9897819445907511, 'precision': 0.9850892703122305, 'recall': 0.9727251763614284, 'f1': 0.9787895205760109}
Epoch 17/30, Step 0/1,Classification Loss: 0.3341, Contrastive Loss: 0.0353
Epoch 17/30, Step 20/1,Classification Loss: 0.3371, Contrastive Loss: 0.0332
Epoch 17/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0314
Epoch 17/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0350
Epoch 17/30, Step 80/1,Classification Loss: 0.3440, Contrastive Loss: 0.0342
Epoch 17/30, Step 100/1,Classification Loss: 0.3189, Contrastive Loss: 0.0317
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Epoch 17/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0296
Accuracy: 0.9946, Precision: 0.9934, Recall: 0.9840, F1: 0.9886
Accuracy: 0.9904, Precision: 0.9867, Recall: 0.9737, F1: 0.9801
Epoch 17/30
Training - Loss: 54.0739
Training Metrics: {'accuracy': 0.9946157094594594, 'precision': 0.993362644860301, 'recall': 0.9840455373048165, 'f1': 0.9886394497478052}
Validation Metrics: {'accuracy': 0.9904139892552407, 'precision': 0.9867263159095034, 'recall': 0.9737115268283143, 'f1': 0.9800889698609601}
Epoch 18/30, Step 0/1,Classification Loss: 0.3419, Contrastive Loss: 0.0313
Epoch 18/30, Step 20/1,Classification Loss: 0.3273, Contrastive Loss: 0.0290
Epoch 18/30, Step 40/1,Classification Loss: 0.3290, Contrastive Loss: 0.0304
Epoch 18/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0300
Epoch 18/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0343
Epoch 18/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0310
Epoch 18/30, Step 120/1,Classification Loss: 0.3269, Contrastive Loss: 0.0293
Epoch 18/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0258
Accuracy: 0.9952, Precision: 0.9939, Recall: 0.9859, F1: 0.9898
Accuracy: 0.9904, Precision: 0.9840, Recall: 0.9765, F1: 0.9802
Epoch 18/30
Training - Loss: 53.7840
Training Metrics: {'accuracy': 0.9951699746621622, 'precision': 0.9938506838939577, 'recall': 0.9858506444921011, 'f1': 0.9898031513737005}
Validation Metrics: {'accuracy': 0.9904139892552407, 'precision': 0.9839967290669525, 'recall': 0.976492238277821, 'f1': 0.9802011256665848}
Epoch 19/30, Step 0/1,Classification Loss: 0.3515, Contrastive Loss: 0.0311
Epoch 19/30, Step 20/1,Classification Loss: 0.3358, Contrastive Loss: 0.0284
Epoch 19/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0297
Epoch 19/30, Step 60/1,Classification Loss: 0.3191, Contrastive Loss: 0.0272
Epoch 19/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 19/30, Step 100/1,Classification Loss: 0.3204, Contrastive Loss: 0.0272
Epoch 19/30, Step 120/1,Classification Loss: 0.3343, Contrastive Loss: 0.0288
Epoch 19/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0281
Accuracy: 0.9947, Precision: 0.9939, Recall: 0.9837, F1: 0.9887
Accuracy: 0.9901, Precision: 0.9853, Recall: 0.9738, F1: 0.9795
Epoch 19/30
Training - Loss: 53.4519
Training Metrics: {'accuracy': 0.9946948902027027, 'precision': 0.9938709989193146, 'recall': 0.9837428156692316, 'f1': 0.9887308439860912}
Validation Metrics: {'accuracy': 0.9900979669229959, 'precision': 0.9852955315856788, 'recall': 0.9738362874725395, 'f1': 0.9794649059033902}
Epoch 20/30, Step 0/1,Classification Loss: 0.3193, Contrastive Loss: 0.0261
Epoch 20/30, Step 20/1,Classification Loss: 0.3450, Contrastive Loss: 0.0301
Epoch 20/30, Step 40/1,Classification Loss: 0.3446, Contrastive Loss: 0.0288
Epoch 20/30, Step 60/1,Classification Loss: 0.3673, Contrastive Loss: 0.0410
Epoch 20/30, Step 80/1,Classification Loss: 0.3158, Contrastive Loss: 0.0273
Epoch 20/30, Step 100/1,Classification Loss: 0.3391, Contrastive Loss: 0.0284
Epoch 20/30, Step 120/1,Classification Loss: 0.3342, Contrastive Loss: 0.0293
Epoch 20/30, Step 140/1,Classification Loss: 0.3277, Contrastive Loss: 0.0244
Accuracy: 0.9949, Precision: 0.9935, Recall: 0.9851, F1: 0.9892
Accuracy: 0.9902, Precision: 0.9854, Recall: 0.9742, F1: 0.9797
Epoch 20/30
Training - Loss: 53.1885
Training Metrics: {'accuracy': 0.9949324324324325, 'precision': 0.993524967888959, 'recall': 0.9850779701070801, 'f1': 0.9892485849714157}
Validation Metrics: {'accuracy': 0.9902033077004109, 'precision': 0.985364290143515, 'recall': 0.9742066578429098, 'f1': 0.9796897493840835}
Epoch 21/30, Step 0/1,Classification Loss: 0.3465, Contrastive Loss: 0.0302
Epoch 21/30, Step 20/1,Classification Loss: 0.3221, Contrastive Loss: 0.0257
Epoch 21/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 21/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0255
Epoch 21/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0284
Epoch 21/30, Step 100/1,Classification Loss: 0.3348, Contrastive Loss: 0.0265
Epoch 21/30, Step 120/1,Classification Loss: 0.3542, Contrastive Loss: 0.0356
Epoch 21/30, Step 140/1,Classification Loss: 0.3446, Contrastive Loss: 0.0289
Accuracy: 0.9945, Precision: 0.9942, Recall: 0.9827, F1: 0.9883
Accuracy: 0.9895, Precision: 0.9852, Recall: 0.9713, F1: 0.9781
Epoch 21/30
Training - Loss: 52.9397
Training Metrics: {'accuracy': 0.9945101351351351, 'precision': 0.9941675827152125, 'recall': 0.9826616246201592, 'f1': 0.9883164560641003}
Validation Metrics: {'accuracy': 0.9894659222585063, 'precision': 0.985190040582646, 'recall': 0.9713050973114832, 'f1': 0.9780990380279878}
Epoch 22/30, Step 0/1,Classification Loss: 0.3648, Contrastive Loss: 0.0308
Epoch 22/30, Step 20/1,Classification Loss: 0.3489, Contrastive Loss: 0.0258
Epoch 22/30, Step 40/1,Classification Loss: 0.3236, Contrastive Loss: 0.0231
Epoch 22/30, Step 60/1,Classification Loss: 0.3382, Contrastive Loss: 0.0264
Epoch 22/30, Step 80/1,Classification Loss: 0.3174, Contrastive Loss: 0.0224
Epoch 22/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0242
Epoch 22/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 22/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0244
Accuracy: 0.9937, Precision: 0.9958, Recall: 0.9775, F1: 0.9864
Accuracy: 0.9881, Precision: 0.9865, Recall: 0.9643, F1: 0.9750
Epoch 22/30
Training - Loss: 53.0173
Training Metrics: {'accuracy': 0.9936655405405406, 'precision': 0.9958423379911443, 'recall': 0.9774814934449642, 'f1': 0.9864121052333819}
Validation Metrics: {'accuracy': 0.988096492152112, 'precision': 0.9865094580241087, 'recall': 0.9643275069248298, 'f1': 0.9750388207420517}
Epoch 23/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 23/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0217
Epoch 23/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0238
Epoch 23/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0220
Epoch 23/30, Step 80/1,Classification Loss: 0.3439, Contrastive Loss: 0.0250
Epoch 23/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0266
Epoch 23/30, Step 120/1,Classification Loss: 0.3541, Contrastive Loss: 0.0416
Epoch 23/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0210
Accuracy: 0.9946, Precision: 0.9935, Recall: 0.9838, F1: 0.9886
Accuracy: 0.9895, Precision: 0.9849, Recall: 0.9716, F1: 0.9781
Epoch 23/30
Training - Loss: 52.8727
Training Metrics: {'accuracy': 0.9946157094594594, 'precision': 0.9935082048675798, 'recall': 0.9838216034726279, 'f1': 0.9885951885951886}
Validation Metrics: {'accuracy': 0.9894659222585063, 'precision': 0.9848830299258657, 'recall': 0.9716140652503172, 'f1': 0.978112849438169}
Epoch 24/30, Step 0/1,Classification Loss: 0.3384, Contrastive Loss: 0.0240
Epoch 24/30, Step 20/1,Classification Loss: 0.3160, Contrastive Loss: 0.0229
Epoch 24/30, Step 40/1,Classification Loss: 0.3446, Contrastive Loss: 0.0293
Epoch 24/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0237
Epoch 24/30, Step 80/1,Classification Loss: 0.3182, Contrastive Loss: 0.0228
Epoch 24/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0243
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 24/30, Step 140/1,Classification Loss: 0.3288, Contrastive Loss: 0.0227
Accuracy: 0.9944, Precision: 0.9934, Recall: 0.9830, F1: 0.9881
Accuracy: 0.9894, Precision: 0.9848, Recall: 0.9712, F1: 0.9779
Epoch 24/30
Training - Loss: 52.7348
Training Metrics: {'accuracy': 0.9944045608108109, 'precision': 0.9933634920667931, 'recall': 0.9829838030604277, 'f1': 0.9880937202115323}
Validation Metrics: {'accuracy': 0.9893605814810913, 'precision': 0.9848142876127479, 'recall': 0.9712436948799469, 'f1': 0.9778870058803512}
Epoch 25/30, Step 0/1,Classification Loss: 0.3180, Contrastive Loss: 0.0212
Epoch 25/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0202
Epoch 25/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0208
Epoch 25/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0199
Epoch 25/30, Step 80/1,Classification Loss: 0.3446, Contrastive Loss: 0.0254
Epoch 25/30, Step 100/1,Classification Loss: 0.3443, Contrastive Loss: 0.0260
Epoch 25/30, Step 120/1,Classification Loss: 0.3372, Contrastive Loss: 0.0234
Epoch 25/30, Step 140/1,Classification Loss: 0.3358, Contrastive Loss: 0.0250
Accuracy: 0.9950, Precision: 0.9934, Recall: 0.9857, F1: 0.9895
Accuracy: 0.9906, Precision: 0.9850, Recall: 0.9763, F1: 0.9806
Epoch 25/30
Training - Loss: 52.6471
Training Metrics: {'accuracy': 0.9950380067567568, 'precision': 0.993443932438806, 'recall': 0.985676116178685, 'f1': 0.9895152226533499}
Validation Metrics: {'accuracy': 0.9906246708100706, 'precision': 0.9850350785144377, 'recall': 0.9763060752020595, 'f1': 0.9806120218604315}
Epoch 26/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0236
Epoch 26/30, Step 20/1,Classification Loss: 0.3155, Contrastive Loss: 0.0224
Epoch 26/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0211
Epoch 26/30, Step 60/1,Classification Loss: 0.3305, Contrastive Loss: 0.0240
Epoch 26/30, Step 80/1,Classification Loss: 0.3454, Contrastive Loss: 0.0238
Epoch 26/30, Step 100/1,Classification Loss: 0.3452, Contrastive Loss: 0.0233
Epoch 26/30, Step 120/1,Classification Loss: 0.3351, Contrastive Loss: 0.0228
Epoch 26/30, Step 140/1,Classification Loss: 0.3502, Contrastive Loss: 0.0227
Accuracy: 0.9953, Precision: 0.9938, Recall: 0.9862, F1: 0.9900
Accuracy: 0.9902, Precision: 0.9836, Recall: 0.9761, F1: 0.9798
Epoch 26/30
Training - Loss: 52.6568
Training Metrics: {'accuracy': 0.9952755489864865, 'precision': 0.9938153404962637, 'recall': 0.9862470228447182, 'f1': 0.989988770205082}
Validation Metrics: {'accuracy': 0.9902033077004109, 'precision': 0.9835581560807939, 'recall': 0.9760604654759144, 'f1': 0.9797659855713449}
Epoch 27/30, Step 0/1,Classification Loss: 0.3184, Contrastive Loss: 0.0210
Epoch 27/30, Step 20/1,Classification Loss: 0.3508, Contrastive Loss: 0.0259
Epoch 27/30, Step 40/1,Classification Loss: 0.3342, Contrastive Loss: 0.0213
Epoch 27/30, Step 60/1,Classification Loss: 0.3352, Contrastive Loss: 0.0216
Epoch 27/30, Step 80/1,Classification Loss: 0.3954, Contrastive Loss: 0.0472
Epoch 27/30, Step 100/1,Classification Loss: 0.3140, Contrastive Loss: 0.0194
Epoch 27/30, Step 120/1,Classification Loss: 0.3342, Contrastive Loss: 0.0212
Epoch 27/30, Step 140/1,Classification Loss: 0.3212, Contrastive Loss: 0.0215
Accuracy: 0.9947, Precision: 0.9960, Recall: 0.9821, F1: 0.9889
Accuracy: 0.9897, Precision: 0.9888, Recall: 0.9686, F1: 0.9784
Epoch 27/30
Training - Loss: 52.4317
Training Metrics: {'accuracy': 0.9947476773648649, 'precision': 0.9959701449608835, 'recall': 0.982050558988034, 'f1': 0.9888665768107999}
Validation Metrics: {'accuracy': 0.9896766038133361, 'precision': 0.9887749521932656, 'recall': 0.968647190725049, 'f1': 0.9784005393120521}
Epoch 28/30, Step 0/1,Classification Loss: 0.3282, Contrastive Loss: 0.0214
Epoch 28/30, Step 20/1,Classification Loss: 0.3215, Contrastive Loss: 0.0215
Epoch 28/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 28/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 28/30, Step 80/1,Classification Loss: 0.3375, Contrastive Loss: 0.0215
Epoch 28/30, Step 100/1,Classification Loss: 0.3447, Contrastive Loss: 0.0232
Epoch 28/30, Step 120/1,Classification Loss: 0.3294, Contrastive Loss: 0.0209
Epoch 28/30, Step 140/1,Classification Loss: 0.3261, Contrastive Loss: 0.0217
Accuracy: 0.9951, Precision: 0.9933, Recall: 0.9860, F1: 0.9896
Accuracy: 0.9909, Precision: 0.9861, Recall: 0.9765, F1: 0.9812
Epoch 28/30
Training - Loss: 52.4832
Training Metrics: {'accuracy': 0.995090793918919, 'precision': 0.9932999671715128, 'recall': 0.9859790960815297, 'f1': 0.9895998056339002}
Validation Metrics: {'accuracy': 0.9909406931423154, 'precision': 0.986148645199612, 'recall': 0.9764902824966684, 'f1': 0.9812479316169835}
Epoch 29/30, Step 0/1,Classification Loss: 0.3243, Contrastive Loss: 0.0211
Epoch 29/30, Step 20/1,Classification Loss: 0.3326, Contrastive Loss: 0.0229
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Epoch 29/30, Step 60/1,Classification Loss: 0.3292, Contrastive Loss: 0.0222
Epoch 29/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0275
Epoch 29/30, Step 100/1,Classification Loss: 0.3321, Contrastive Loss: 0.0224
Epoch 29/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0230
Epoch 29/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0185
Accuracy: 0.9952, Precision: 0.9938, Recall: 0.9858, F1: 0.9898
Accuracy: 0.9909, Precision: 0.9861, Recall: 0.9765, F1: 0.9812
Epoch 29/30
Training - Loss: 52.4770
Training Metrics: {'accuracy': 0.9951963682432432, 'precision': 0.9938273224353453, 'recall': 0.9858048059444309, 'f1': 0.9897685286773605}
Validation Metrics: {'accuracy': 0.9909406931423154, 'precision': 0.986148645199612, 'recall': 0.9764902824966684, 'f1': 0.9812479316169835}
Epoch 30/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0235
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 30/30, Step 40/1,Classification Loss: 0.3135, Contrastive Loss: 0.0194
Epoch 30/30, Step 60/1,Classification Loss: 0.3182, Contrastive Loss: 0.0200
Epoch 30/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0198
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0193
Epoch 30/30, Step 120/1,Classification Loss: 0.3206, Contrastive Loss: 0.0200
Epoch 30/30, Step 140/1,Classification Loss: 0.3355, Contrastive Loss: 0.0212
Accuracy: 0.9942, Precision: 0.9935, Recall: 0.9821, F1: 0.9877
Accuracy: 0.9898, Precision: 0.9873, Recall: 0.9706, F1: 0.9787
Epoch 30/30
Training - Loss: 52.2425
Training Metrics: {'accuracy': 0.9942461993243243, 'precision': 0.9935080998980379, 'recall': 0.9821407984169837, 'f1': 0.9877286376913226}
Validation Metrics: {'accuracy': 0.9897819445907511, 'precision': 0.9872566149950879, 'recall': 0.9705624007895898, 'f1': 0.9786955214532802}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (615, 5814), y shape: (615,), y distribution: Counter({np.float64(0.0): 550, np.float64(1.0): 65}), env shape: (615,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.8927, Precision: 0.4471, Recall: 0.4991, F1: 0.4716
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13415]))
original train data shape: torch.Size([47562]), new train data shape: torch.Size([100])
original test data shape: torch.Size([615, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([47562]), new train data shape: torch.Size([47562])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13415]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 1.6214
Epoch 1/30, Step 20/1,Classification Loss: 0.3550, Contrastive Loss: 1.1010
Epoch 1/30, Step 40/1,Classification Loss: 0.3190, Contrastive Loss: 0.4958
Epoch 1/30, Step 60/1,Classification Loss: 0.3391, Contrastive Loss: 0.2846
Epoch 1/30, Step 80/1,Classification Loss: 0.3372, Contrastive Loss: 0.2238
Epoch 1/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.1628
Epoch 1/30, Step 120/1,Classification Loss: 0.3560, Contrastive Loss: 0.2177
Epoch 1/30, Step 140/1,Classification Loss: 0.3601, Contrastive Loss: 0.1990
Accuracy: 0.9949, Precision: 0.9939, Recall: 0.9847, F1: 0.9893
Accuracy: 0.9897, Precision: 0.9847, Recall: 0.9727, F1: 0.9786
Epoch 1/30
Training - Loss: 117.3307
Training Metrics: {'accuracy': 0.9949324324324325, 'precision': 0.9939457254433749, 'recall': 0.9847400780327336, 'f1': 0.9892799898141795}
Validation Metrics: {'accuracy': 0.9896983075791023, 'precision': 0.9847492708933182, 'recall': 0.9727241478631363, 'f1': 0.9786252950768255}
Epoch 2/30, Step 0/1,Classification Loss: 0.3726, Contrastive Loss: 0.1961
Epoch 2/30, Step 20/1,Classification Loss: 0.3164, Contrastive Loss: 0.1369
Epoch 2/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.1356
Epoch 2/30, Step 60/1,Classification Loss: 0.3601, Contrastive Loss: 0.1689
Epoch 2/30, Step 80/1,Classification Loss: 0.3449, Contrastive Loss: 0.1427
Epoch 2/30, Step 100/1,Classification Loss: 0.3310, Contrastive Loss: 0.1236
Epoch 2/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.1115
Epoch 2/30, Step 140/1,Classification Loss: 0.3484, Contrastive Loss: 0.1291
Accuracy: 0.9950, Precision: 0.9941, Recall: 0.9848, F1: 0.9894
Accuracy: 0.9894, Precision: 0.9839, Recall: 0.9722, F1: 0.9780
Epoch 2/30
Training - Loss: 69.7505
Training Metrics: {'accuracy': 0.9950116131756757, 'precision': 0.9941460829655526, 'recall': 0.9848244616786352, 'f1': 0.9894208827116155}
Validation Metrics: {'accuracy': 0.9893829496478503, 'precision': 0.9839351441121287, 'recall': 0.9722320496934915, 'f1': 0.977977881134563}
Epoch 3/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1221
Epoch 3/30, Step 20/1,Classification Loss: 0.3340, Contrastive Loss: 0.1263
Epoch 3/30, Step 40/1,Classification Loss: 0.3446, Contrastive Loss: 0.1423
Epoch 3/30, Step 60/1,Classification Loss: 0.3136, Contrastive Loss: 0.1073
Epoch 3/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1261
Epoch 3/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.1205
Epoch 3/30, Step 120/1,Classification Loss: 0.3306, Contrastive Loss: 0.1085
Epoch 3/30, Step 140/1,Classification Loss: 0.3780, Contrastive Loss: 0.1149
Accuracy: 0.9952, Precision: 0.9943, Recall: 0.9856, F1: 0.9899
Accuracy: 0.9899, Precision: 0.9846, Recall: 0.9738, F1: 0.9791
Epoch 3/30
Training - Loss: 66.2463
Training Metrics: {'accuracy': 0.9952227618243243, 'precision': 0.9942730882907047, 'recall': 0.9855891338254522, 'f1': 0.9898752668291539}
Validation Metrics: {'accuracy': 0.989908546199937, 'precision': 0.9845841240407288, 'recall': 0.9737715208034433, 'f1': 0.9790877690487771}
Epoch 4/30, Step 0/1,Classification Loss: 0.3149, Contrastive Loss: 0.0952
Epoch 4/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0990
Epoch 4/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0995
Epoch 4/30, Step 60/1,Classification Loss: 0.3179, Contrastive Loss: 0.0958
Epoch 4/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0907
Epoch 4/30, Step 100/1,Classification Loss: 0.3245, Contrastive Loss: 0.0947
Epoch 4/30, Step 120/1,Classification Loss: 0.3404, Contrastive Loss: 0.1082
Epoch 4/30, Step 140/1,Classification Loss: 0.3136, Contrastive Loss: 0.0844
Accuracy: 0.9949, Precision: 0.9941, Recall: 0.9843, F1: 0.9891
Accuracy: 0.9898, Precision: 0.9854, Recall: 0.9725, F1: 0.9788
Epoch 4/30
Training - Loss: 63.9250
Training Metrics: {'accuracy': 0.9948532516891891, 'precision': 0.9940520878222578, 'recall': 0.9842567322794523, 'f1': 0.9890832608064855}
Validation Metrics: {'accuracy': 0.9898034268895196, 'precision': 0.9854279248050192, 'recall': 0.9724771477327072, 'f1': 0.9788234535986952}
Epoch 5/30, Step 0/1,Classification Loss: 0.3218, Contrastive Loss: 0.0920
Epoch 5/30, Step 20/1,Classification Loss: 0.3446, Contrastive Loss: 0.1017
Epoch 5/30, Step 40/1,Classification Loss: 0.3444, Contrastive Loss: 0.0892
Epoch 5/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0828
Epoch 5/30, Step 80/1,Classification Loss: 0.3175, Contrastive Loss: 0.0803
Epoch 5/30, Step 100/1,Classification Loss: 0.3378, Contrastive Loss: 0.0866
Epoch 5/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0790
Epoch 5/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0773
Accuracy: 0.9927, Precision: 0.9926, Recall: 0.9765, F1: 0.9844
Accuracy: 0.9866, Precision: 0.9837, Recall: 0.9611, F1: 0.9720
Epoch 5/30
Training - Loss: 62.5687
Training Metrics: {'accuracy': 0.9927153716216216, 'precision': 0.9925777534853706, 'recall': 0.9765078023993456, 'f1': 0.9843506091098138}
Validation Metrics: {'accuracy': 0.9866498475769999, 'precision': 0.9836954941549724, 'recall': 0.9610823985913656, 'f1': 0.971991558179396}
Epoch 6/30, Step 0/1,Classification Loss: 0.3403, Contrastive Loss: 0.0820
Epoch 6/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.0886
Epoch 6/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0793
Epoch 6/30, Step 60/1,Classification Loss: 0.3595, Contrastive Loss: 0.0895
Epoch 6/30, Step 80/1,Classification Loss: 0.4013, Contrastive Loss: 0.1062
Epoch 6/30, Step 100/1,Classification Loss: 0.3474, Contrastive Loss: 0.0817
Epoch 6/30, Step 120/1,Classification Loss: 0.3369, Contrastive Loss: 0.0842
Epoch 6/30, Step 140/1,Classification Loss: 0.3389, Contrastive Loss: 0.0814
Accuracy: 0.9942, Precision: 0.9940, Recall: 0.9817, F1: 0.9877
Accuracy: 0.9890, Precision: 0.9852, Recall: 0.9692, F1: 0.9770
Epoch 6/30
Training - Loss: 61.2932
Training Metrics: {'accuracy': 0.9942198057432432, 'precision': 0.9940084480917518, 'recall': 0.9817002500736798, 'f1': 0.9877416577452054}
Validation Metrics: {'accuracy': 0.9889624724061811, 'precision': 0.9851905515645927, 'recall': 0.9692124798921786, 'f1': 0.9770045832905612}
Epoch 7/30, Step 0/1,Classification Loss: 0.3348, Contrastive Loss: 0.0779
Epoch 7/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0676
Epoch 7/30, Step 40/1,Classification Loss: 0.3182, Contrastive Loss: 0.0696
Epoch 7/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0795
Epoch 7/30, Step 80/1,Classification Loss: 0.3277, Contrastive Loss: 0.0664
Epoch 7/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0719
Epoch 7/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0657
Epoch 7/30, Step 140/1,Classification Loss: 0.3294, Contrastive Loss: 0.0786
Accuracy: 0.9952, Precision: 0.9941, Recall: 0.9855, F1: 0.9898
Accuracy: 0.9898, Precision: 0.9848, Recall: 0.9731, F1: 0.9789
Epoch 7/30
Training - Loss: 60.0549
Training Metrics: {'accuracy': 0.9951963682432432, 'precision': 0.9941497393127638, 'recall': 0.9854650446763874, 'f1': 0.9897517375933476}
Validation Metrics: {'accuracy': 0.9898034268895196, 'precision': 0.984818145213165, 'recall': 0.9730936970131734, 'f1': 0.9788500442579466}
Epoch 8/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0699
Epoch 8/30, Step 20/1,Classification Loss: 0.3262, Contrastive Loss: 0.0679
Epoch 8/30, Step 40/1,Classification Loss: 0.3602, Contrastive Loss: 0.0751
Epoch 8/30, Step 60/1,Classification Loss: 0.3221, Contrastive Loss: 0.0640
Epoch 8/30, Step 80/1,Classification Loss: 0.3400, Contrastive Loss: 0.0695
Epoch 8/30, Step 100/1,Classification Loss: 0.3362, Contrastive Loss: 0.0670
Epoch 8/30, Step 120/1,Classification Loss: 0.3170, Contrastive Loss: 0.0596
Epoch 8/30, Step 140/1,Classification Loss: 0.3374, Contrastive Loss: 0.0647
Accuracy: 0.9947, Precision: 0.9940, Recall: 0.9835, F1: 0.9887
Accuracy: 0.9893, Precision: 0.9857, Recall: 0.9700, F1: 0.9777
Epoch 8/30
Training - Loss: 59.1775
Training Metrics: {'accuracy': 0.9946684966216216, 'precision': 0.9940159991067546, 'recall': 0.9834742326516657, 'f1': 0.9886627530234254}
Validation Metrics: {'accuracy': 0.989277830337433, 'precision': 0.9857037450677717, 'recall': 0.9700128527020564, 'f1': 0.9776686481652742}
Epoch 9/30, Step 0/1,Classification Loss: 0.3245, Contrastive Loss: 0.0596
Epoch 9/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0606
Epoch 9/30, Step 40/1,Classification Loss: 0.3288, Contrastive Loss: 0.0593
Epoch 9/30, Step 60/1,Classification Loss: 0.3528, Contrastive Loss: 0.0728
Epoch 9/30, Step 80/1,Classification Loss: 0.3329, Contrastive Loss: 0.0609
Epoch 9/30, Step 100/1,Classification Loss: 0.3431, Contrastive Loss: 0.0728
Epoch 9/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0538
Epoch 9/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0684
Accuracy: 0.9948, Precision: 0.9939, Recall: 0.9842, F1: 0.9890
Accuracy: 0.9896, Precision: 0.9853, Recall: 0.9717, F1: 0.9784
Epoch 9/30
Training - Loss: 58.1801
Training Metrics: {'accuracy': 0.9948268581081081, 'precision': 0.9939376480253075, 'recall': 0.9841630978344904, 'f1': 0.9889796874068322}
Validation Metrics: {'accuracy': 0.9895931882686849, 'precision': 0.9852913305268101, 'recall': 0.9717380494326333, 'f1': 0.9783732227500395}
Epoch 10/30, Step 0/1,Classification Loss: 0.3614, Contrastive Loss: 0.0610
Epoch 10/30, Step 20/1,Classification Loss: 0.3397, Contrastive Loss: 0.0589
Epoch 10/30, Step 40/1,Classification Loss: 0.3301, Contrastive Loss: 0.0563
Epoch 10/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0485
Epoch 10/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0535
Epoch 10/30, Step 100/1,Classification Loss: 0.3234, Contrastive Loss: 0.0536
Epoch 10/30, Step 120/1,Classification Loss: 0.3220, Contrastive Loss: 0.0514
Epoch 10/30, Step 140/1,Classification Loss: 0.3397, Contrastive Loss: 0.0551
Accuracy: 0.9949, Precision: 0.9939, Recall: 0.9845, F1: 0.9891
Accuracy: 0.9895, Precision: 0.9852, Recall: 0.9714, F1: 0.9781
Epoch 10/30
Training - Loss: 57.6586
Training Metrics: {'accuracy': 0.9948532516891891, 'precision': 0.9939031756116441, 'recall': 0.9844767877967073, 'f1': 0.9891239515470875}
Validation Metrics: {'accuracy': 0.9894880689582677, 'precision': 0.9852230373916039, 'recall': 0.9713685002825965, 'f1': 0.9781478932575236}
Epoch 11/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0471
Epoch 11/30, Step 20/1,Classification Loss: 0.3352, Contrastive Loss: 0.0554
Epoch 11/30, Step 40/1,Classification Loss: 0.3294, Contrastive Loss: 0.0531
Epoch 11/30, Step 60/1,Classification Loss: 0.3308, Contrastive Loss: 0.0534
Epoch 11/30, Step 80/1,Classification Loss: 0.3273, Contrastive Loss: 0.0502
Epoch 11/30, Step 100/1,Classification Loss: 0.3406, Contrastive Loss: 0.0511
Epoch 11/30, Step 120/1,Classification Loss: 0.3423, Contrastive Loss: 0.0526
Epoch 11/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0488
Accuracy: 0.9945, Precision: 0.9937, Recall: 0.9831, F1: 0.9883
Accuracy: 0.9891, Precision: 0.9849, Recall: 0.9699, F1: 0.9772
Epoch 11/30
Training - Loss: 56.8584
Training Metrics: {'accuracy': 0.9945365287162162, 'precision': 0.9936543516602545, 'recall': 0.9830624016116435, 'f1': 0.9882755904826147}
Validation Metrics: {'accuracy': 0.9890675917165983, 'precision': 0.9849498907701986, 'recall': 0.9698903036824487, 'f1': 0.9772451442912762}
Epoch 12/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0564
Epoch 12/30, Step 20/1,Classification Loss: 0.3155, Contrastive Loss: 0.0459
Epoch 12/30, Step 40/1,Classification Loss: 0.3182, Contrastive Loss: 0.0451
Epoch 12/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0469
Epoch 12/30, Step 80/1,Classification Loss: 0.3446, Contrastive Loss: 0.0542
Epoch 12/30, Step 100/1,Classification Loss: 0.3177, Contrastive Loss: 0.0441
Epoch 12/30, Step 120/1,Classification Loss: 0.3333, Contrastive Loss: 0.0477
Epoch 12/30, Step 140/1,Classification Loss: 0.3342, Contrastive Loss: 0.0497
Accuracy: 0.9952, Precision: 0.9944, Recall: 0.9853, F1: 0.9898
Accuracy: 0.9894, Precision: 0.9842, Recall: 0.9719, F1: 0.9780
Epoch 12/30
Training - Loss: 56.3027
Training Metrics: {'accuracy': 0.9951699746621622, 'precision': 0.9944072856447823, 'recall': 0.9852536403958361, 'f1': 0.9897683820841128}
Validation Metrics: {'accuracy': 0.9893829496478503, 'precision': 0.9842383327732191, 'recall': 0.9719237750532586, 'f1': 0.977964048262393}
Epoch 13/30, Step 0/1,Classification Loss: 0.3601, Contrastive Loss: 0.0569
Epoch 13/30, Step 20/1,Classification Loss: 0.3139, Contrastive Loss: 0.0416
Epoch 13/30, Step 40/1,Classification Loss: 0.3258, Contrastive Loss: 0.0466
Epoch 13/30, Step 60/1,Classification Loss: 0.3461, Contrastive Loss: 0.0490
Epoch 13/30, Step 80/1,Classification Loss: 0.3601, Contrastive Loss: 0.0511
Epoch 13/30, Step 100/1,Classification Loss: 0.3491, Contrastive Loss: 0.0463
Epoch 13/30, Step 120/1,Classification Loss: 0.3603, Contrastive Loss: 0.0522
Epoch 13/30, Step 140/1,Classification Loss: 0.3439, Contrastive Loss: 0.0432
Accuracy: 0.9950, Precision: 0.9938, Recall: 0.9850, F1: 0.9893
Accuracy: 0.9892, Precision: 0.9844, Recall: 0.9709, F1: 0.9775
Epoch 13/30
Training - Loss: 55.9252
Training Metrics: {'accuracy': 0.9949588260135135, 'precision': 0.9938027783495345, 'recall': 0.9850062649730522, 'f1': 0.9893470499768908}
Validation Metrics: {'accuracy': 0.9891727110270156, 'precision': 0.9844049276285998, 'recall': 0.9708764021129517, 'f1': 0.9774994135682229}
Epoch 14/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0410
Epoch 14/30, Step 20/1,Classification Loss: 0.3441, Contrastive Loss: 0.0471
Epoch 14/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0388
Epoch 14/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0380
Epoch 14/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0493
Epoch 14/30, Step 100/1,Classification Loss: 0.3402, Contrastive Loss: 0.0440
Epoch 14/30, Step 120/1,Classification Loss: 0.3218, Contrastive Loss: 0.0377
Epoch 14/30, Step 140/1,Classification Loss: 0.3296, Contrastive Loss: 0.0405
Accuracy: 0.9952, Precision: 0.9941, Recall: 0.9854, F1: 0.9897
Accuracy: 0.9894, Precision: 0.9848, Recall: 0.9713, F1: 0.9779
Epoch 14/30
Training - Loss: 55.2169
Training Metrics: {'accuracy': 0.9951699746621622, 'precision': 0.994149337989402, 'recall': 0.985433033410057, 'f1': 0.9897349974646488}
Validation Metrics: {'accuracy': 0.9893829496478503, 'precision': 0.9848481290777049, 'recall': 0.9713072257727925, 'f1': 0.9779363181591312}
Epoch 15/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0351
Epoch 15/30, Step 20/1,Classification Loss: 0.3145, Contrastive Loss: 0.0363
Epoch 15/30, Step 40/1,Classification Loss: 0.3383, Contrastive Loss: 0.0400
Epoch 15/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0383
Epoch 15/30, Step 80/1,Classification Loss: 0.3357, Contrastive Loss: 0.0366
Epoch 15/30, Step 100/1,Classification Loss: 0.3184, Contrastive Loss: 0.0390
Epoch 15/30, Step 120/1,Classification Loss: 0.3666, Contrastive Loss: 0.0591
Epoch 15/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0326
Accuracy: 0.9952, Precision: 0.9942, Recall: 0.9854, F1: 0.9898
Accuracy: 0.9890, Precision: 0.9834, Recall: 0.9711, F1: 0.9771
Epoch 15/30
Training - Loss: 55.1933
Training Metrics: {'accuracy': 0.9951699746621622, 'precision': 0.9942468857343596, 'recall': 0.9854219469857523, 'f1': 0.9897766867995168}
Validation Metrics: {'accuracy': 0.9889624724061811, 'precision': 0.9833542013020422, 'recall': 0.9710621277335768, 'f1': 0.9770913373024879}
Epoch 16/30, Step 0/1,Classification Loss: 0.3444, Contrastive Loss: 0.0403
Epoch 16/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0321
Epoch 16/30, Step 40/1,Classification Loss: 0.3296, Contrastive Loss: 0.0351
Epoch 16/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.0367
Epoch 16/30, Step 80/1,Classification Loss: 0.3426, Contrastive Loss: 0.0385
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0314
Epoch 16/30, Step 120/1,Classification Loss: 0.3134, Contrastive Loss: 0.0310
Epoch 16/30, Step 140/1,Classification Loss: 0.3218, Contrastive Loss: 0.0341
Accuracy: 0.9950, Precision: 0.9944, Recall: 0.9844, F1: 0.9893
Accuracy: 0.9889, Precision: 0.9839, Recall: 0.9701, F1: 0.9768
Epoch 16/30
Training - Loss: 54.6568
Training Metrics: {'accuracy': 0.9949852195945946, 'precision': 0.9943564239752987, 'recall': 0.9843961855370603, 'f1': 0.9893030205967673}
Validation Metrics: {'accuracy': 0.9888573530957637, 'precision': 0.9838925779017387, 'recall': 0.9700760293030738, 'f1': 0.976836766852975}
Epoch 17/30, Step 0/1,Classification Loss: 0.3303, Contrastive Loss: 0.0349
Epoch 17/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0286
Epoch 17/30, Step 40/1,Classification Loss: 0.3275, Contrastive Loss: 0.0328
Epoch 17/30, Step 60/1,Classification Loss: 0.3290, Contrastive Loss: 0.0347
Epoch 17/30, Step 80/1,Classification Loss: 0.3264, Contrastive Loss: 0.0315
Epoch 17/30, Step 100/1,Classification Loss: 0.3510, Contrastive Loss: 0.0333
Epoch 17/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0353
Epoch 17/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0289
Accuracy: 0.9951, Precision: 0.9944, Recall: 0.9847, F1: 0.9895
Accuracy: 0.9889, Precision: 0.9839, Recall: 0.9701, F1: 0.9768
Epoch 17/30
Training - Loss: 54.2657
Training Metrics: {'accuracy': 0.9950644003378378, 'precision': 0.9944055476757373, 'recall': 0.9846931974892434, 'f1': 0.9894796892781816}
Validation Metrics: {'accuracy': 0.9888573530957637, 'precision': 0.9838925779017387, 'recall': 0.9700760293030738, 'f1': 0.976836766852975}
Epoch 18/30, Step 0/1,Classification Loss: 0.3325, Contrastive Loss: 0.0316
Epoch 18/30, Step 20/1,Classification Loss: 0.3214, Contrastive Loss: 0.0293
Epoch 18/30, Step 40/1,Classification Loss: 0.3284, Contrastive Loss: 0.0283
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0274
Epoch 18/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0277
Epoch 18/30, Step 100/1,Classification Loss: 0.3291, Contrastive Loss: 0.0321
Epoch 18/30, Step 120/1,Classification Loss: 0.3621, Contrastive Loss: 0.0369
Epoch 18/30, Step 140/1,Classification Loss: 0.3672, Contrastive Loss: 0.0373
Accuracy: 0.9948, Precision: 0.9948, Recall: 0.9831, F1: 0.9889
Accuracy: 0.9885, Precision: 0.9837, Recall: 0.9690, F1: 0.9762
Epoch 18/30
Training - Loss: 54.0323
Training Metrics: {'accuracy': 0.994800464527027, 'precision': 0.9948224820899366, 'recall': 0.9831473838406131, 'f1': 0.9888842791909198}
Validation Metrics: {'accuracy': 0.9885419951645117, 'precision': 0.9836851405796571, 'recall': 0.9689673818529629, 'f1': 0.9761586802927305}
Epoch 19/30, Step 0/1,Classification Loss: 0.3758, Contrastive Loss: 0.0655
Epoch 19/30, Step 20/1,Classification Loss: 0.3359, Contrastive Loss: 0.0279
Epoch 19/30, Step 40/1,Classification Loss: 0.3446, Contrastive Loss: 0.0324
Epoch 19/30, Step 60/1,Classification Loss: 0.3277, Contrastive Loss: 0.0285
Epoch 19/30, Step 80/1,Classification Loss: 0.3502, Contrastive Loss: 0.0369
Epoch 19/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0296
Epoch 19/30, Step 120/1,Classification Loss: 0.3675, Contrastive Loss: 0.0423
Epoch 19/30, Step 140/1,Classification Loss: 0.3445, Contrastive Loss: 0.0289
Accuracy: 0.9948, Precision: 0.9946, Recall: 0.9837, F1: 0.9891
Accuracy: 0.9884, Precision: 0.9827, Recall: 0.9695, F1: 0.9760
Epoch 19/30
Training - Loss: 53.7151
Training Metrics: {'accuracy': 0.9948268581081081, 'precision': 0.9946240203399446, 'recall': 0.9837020740593097, 'f1': 0.989074368085897}
Validation Metrics: {'accuracy': 0.9884368758540943, 'precision': 0.9827021252186882, 'recall': 0.969522656623625, 'f1': 0.9759778065537938}
Epoch 20/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0296
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0254
Epoch 20/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0253
Epoch 20/30, Step 60/1,Classification Loss: 0.3265, Contrastive Loss: 0.0257
Epoch 20/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0236
Epoch 20/30, Step 100/1,Classification Loss: 0.3318, Contrastive Loss: 0.0290
Epoch 20/30, Step 120/1,Classification Loss: 0.3186, Contrastive Loss: 0.0280
Epoch 20/30, Step 140/1,Classification Loss: 0.3290, Contrastive Loss: 0.0286
Accuracy: 0.9947, Precision: 0.9937, Recall: 0.9839, F1: 0.9887
Accuracy: 0.9890, Precision: 0.9837, Recall: 0.9708, F1: 0.9771
Epoch 20/30
Training - Loss: 53.6638
Training Metrics: {'accuracy': 0.9946948902027027, 'precision': 0.993697262522508, 'recall': 0.9838562433018557, 'f1': 0.9887050324597677}
Validation Metrics: {'accuracy': 0.9889624724061811, 'precision': 0.9836573940087084, 'recall': 0.9707538530933437, 'f1': 0.9770769343078658}
Epoch 21/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0280
Epoch 21/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0243
Epoch 21/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0260
Epoch 21/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0281
Epoch 21/30, Step 80/1,Classification Loss: 0.3592, Contrastive Loss: 0.0361
Epoch 21/30, Step 100/1,Classification Loss: 0.3317, Contrastive Loss: 0.0276
Epoch 21/30, Step 120/1,Classification Loss: 0.3137, Contrastive Loss: 0.0266
Epoch 21/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0253
Accuracy: 0.9952, Precision: 0.9945, Recall: 0.9853, F1: 0.9898
Accuracy: 0.9889, Precision: 0.9827, Recall: 0.9713, F1: 0.9769
Epoch 21/30
Training - Loss: 53.3500
Training Metrics: {'accuracy': 0.9952227618243243, 'precision': 0.9945049517646706, 'recall': 0.9852916182434572, 'f1': 0.9898355640138045}
Validation Metrics: {'accuracy': 0.9888573530957637, 'precision': 0.9826809283911406, 'recall': 0.9713091278640059, 'f1': 0.9768949276431598}
Epoch 22/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0262
Epoch 22/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0257
Epoch 22/30, Step 40/1,Classification Loss: 0.3522, Contrastive Loss: 0.0304
Epoch 22/30, Step 60/1,Classification Loss: 0.3831, Contrastive Loss: 0.0392
Epoch 22/30, Step 80/1,Classification Loss: 0.3599, Contrastive Loss: 0.0287
Epoch 22/30, Step 100/1,Classification Loss: 0.3351, Contrastive Loss: 0.0255
Epoch 22/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0349
Epoch 22/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0227
Accuracy: 0.9949, Precision: 0.9939, Recall: 0.9845, F1: 0.9891
Accuracy: 0.9883, Precision: 0.9829, Recall: 0.9688, F1: 0.9757
Epoch 22/30
Training - Loss: 53.0488
Training Metrics: {'accuracy': 0.9948532516891891, 'precision': 0.9938973375485711, 'recall': 0.9844513107641331, 'f1': 0.9891080733544759}
Validation Metrics: {'accuracy': 0.9883317565436771, 'precision': 0.9829358869123601, 'recall': 0.9688448328333551, 'f1': 0.9757365219041525}
Epoch 23/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0251
Epoch 23/30, Step 20/1,Classification Loss: 0.3209, Contrastive Loss: 0.0248
Epoch 23/30, Step 40/1,Classification Loss: 0.3287, Contrastive Loss: 0.0249
Epoch 23/30, Step 60/1,Classification Loss: 0.3137, Contrastive Loss: 0.0222
Epoch 23/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0260
Epoch 23/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 23/30, Step 120/1,Classification Loss: 0.3324, Contrastive Loss: 0.0247
Epoch 23/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0255
Accuracy: 0.9951, Precision: 0.9942, Recall: 0.9849, F1: 0.9895
Accuracy: 0.9884, Precision: 0.9821, Recall: 0.9701, F1: 0.9760
Epoch 23/30
Training - Loss: 53.0210
Training Metrics: {'accuracy': 0.9950644003378378, 'precision': 0.9942488986810103, 'recall': 0.9848882647912651, 'f1': 0.9895037702537022}
Validation Metrics: {'accuracy': 0.9884368758540943, 'precision': 0.9820985733657793, 'recall': 0.9701392059040912, 'f1': 0.9760079842699061}
Epoch 24/30, Step 0/1,Classification Loss: 0.3352, Contrastive Loss: 0.0257
Epoch 24/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0214
Epoch 24/30, Step 40/1,Classification Loss: 0.3395, Contrastive Loss: 0.0275
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0215
Epoch 24/30, Step 80/1,Classification Loss: 0.3275, Contrastive Loss: 0.0214
Epoch 24/30, Step 100/1,Classification Loss: 0.3375, Contrastive Loss: 0.0285
Epoch 24/30, Step 120/1,Classification Loss: 0.3326, Contrastive Loss: 0.0240
Epoch 24/30, Step 140/1,Classification Loss: 0.3170, Contrastive Loss: 0.0211
Accuracy: 0.9954, Precision: 0.9944, Recall: 0.9862, F1: 0.9902
Accuracy: 0.9896, Precision: 0.9844, Recall: 0.9727, F1: 0.9784
Epoch 24/30
Training - Loss: 52.8393
Training Metrics: {'accuracy': 0.9954075168918919, 'precision': 0.9943686690196762, 'recall': 0.9861953003486044, 'f1': 0.9902326565854531}
Validation Metrics: {'accuracy': 0.9895931882686849, 'precision': 0.9843766446626467, 'recall': 0.9726628733533325, 'f1': 0.9784139626962547}
Epoch 25/30, Step 0/1,Classification Loss: 0.3420, Contrastive Loss: 0.0247
Epoch 25/30, Step 20/1,Classification Loss: 0.3359, Contrastive Loss: 0.0234
Epoch 25/30, Step 40/1,Classification Loss: 0.3191, Contrastive Loss: 0.0226
Epoch 25/30, Step 60/1,Classification Loss: 0.3288, Contrastive Loss: 0.0217
Epoch 25/30, Step 80/1,Classification Loss: 0.3207, Contrastive Loss: 0.0228
Epoch 25/30, Step 100/1,Classification Loss: 0.3340, Contrastive Loss: 0.0248
Epoch 25/30, Step 120/1,Classification Loss: 0.3237, Contrastive Loss: 0.0239
Epoch 25/30, Step 140/1,Classification Loss: 0.3317, Contrastive Loss: 0.0241
Accuracy: 0.9951, Precision: 0.9941, Recall: 0.9853, F1: 0.9896
Accuracy: 0.9891, Precision: 0.9825, Recall: 0.9724, F1: 0.9774
Epoch 25/30
Training - Loss: 52.7645
Training Metrics: {'accuracy': 0.9951171875, 'precision': 0.9941252304612979, 'recall': 0.9852736231701884, 'f1': 0.9896414071260415}
Validation Metrics: {'accuracy': 0.9890675917165983, 'precision': 0.9825219751577691, 'recall': 0.9723565008043129, 'f1': 0.9773592719172148}
Epoch 26/30, Step 0/1,Classification Loss: 0.3216, Contrastive Loss: 0.0216
Epoch 26/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0228
Epoch 26/30, Step 40/1,Classification Loss: 0.3528, Contrastive Loss: 0.0233
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0211
Epoch 26/30, Step 80/1,Classification Loss: 0.3299, Contrastive Loss: 0.0229
Epoch 26/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0191
Epoch 26/30, Step 120/1,Classification Loss: 0.3295, Contrastive Loss: 0.0236
Epoch 26/30, Step 140/1,Classification Loss: 0.3531, Contrastive Loss: 0.0238
Accuracy: 0.9948, Precision: 0.9946, Recall: 0.9833, F1: 0.9889
Accuracy: 0.9888, Precision: 0.9841, Recall: 0.9694, F1: 0.9766
Epoch 26/30
Training - Loss: 52.6824
Training Metrics: {'accuracy': 0.9947740709459459, 'precision': 0.994564261209044, 'recall': 0.9833312651471138, 'f1': 0.9888544507471646}
Validation Metrics: {'accuracy': 0.9887522337853464, 'precision': 0.9841294849211586, 'recall': 0.9693982055128039, 'f1': 0.9765961357002033}
Epoch 27/30, Step 0/1,Classification Loss: 0.3446, Contrastive Loss: 0.0299
Epoch 27/30, Step 20/1,Classification Loss: 0.3274, Contrastive Loss: 0.0215
Epoch 27/30, Step 40/1,Classification Loss: 0.3176, Contrastive Loss: 0.0200
Epoch 27/30, Step 60/1,Classification Loss: 0.3315, Contrastive Loss: 0.0255
Epoch 27/30, Step 80/1,Classification Loss: 0.3444, Contrastive Loss: 0.0234
Epoch 27/30, Step 100/1,Classification Loss: 0.3295, Contrastive Loss: 0.0261
Epoch 27/30, Step 120/1,Classification Loss: 0.3261, Contrastive Loss: 0.0205
Epoch 27/30, Step 140/1,Classification Loss: 0.3443, Contrastive Loss: 0.0230
Accuracy: 0.9950, Precision: 0.9939, Recall: 0.9850, F1: 0.9894
Accuracy: 0.9892, Precision: 0.9841, Recall: 0.9712, F1: 0.9775
Epoch 27/30
Training - Loss: 52.6346
Training Metrics: {'accuracy': 0.9950116131756757, 'precision': 0.9938971863071686, 'recall': 0.9850434672976054, 'f1': 0.9894122646599384}
Validation Metrics: {'accuracy': 0.9891727110270156, 'precision': 0.9841000267077861, 'recall': 0.9711846767531847, 'f1': 0.9775135641305732}
Epoch 28/30, Step 0/1,Classification Loss: 0.3244, Contrastive Loss: 0.0197
Epoch 28/30, Step 20/1,Classification Loss: 0.3355, Contrastive Loss: 0.0228
Epoch 28/30, Step 40/1,Classification Loss: 0.3477, Contrastive Loss: 0.0243
Epoch 28/30, Step 60/1,Classification Loss: 0.3138, Contrastive Loss: 0.0201
Epoch 28/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0188
Epoch 28/30, Step 100/1,Classification Loss: 0.3365, Contrastive Loss: 0.0235
Epoch 28/30, Step 120/1,Classification Loss: 0.3601, Contrastive Loss: 0.0249
Epoch 28/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0189
Accuracy: 0.9946, Precision: 0.9940, Recall: 0.9832, F1: 0.9885
Accuracy: 0.9888, Precision: 0.9847, Recall: 0.9688, F1: 0.9766
Epoch 28/30
Training - Loss: 52.4399
Training Metrics: {'accuracy': 0.9945893158783784, 'precision': 0.9939738384328529, 'recall': 0.9832148440198014, 'f1': 0.9885084569221072}
Validation Metrics: {'accuracy': 0.9887522337853464, 'precision': 0.9847450570858582, 'recall': 0.9687816562323377, 'f1': 0.9765665753532387}
Epoch 29/30, Step 0/1,Classification Loss: 0.3287, Contrastive Loss: 0.0203
Epoch 29/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0222
Epoch 29/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0192
Epoch 29/30, Step 60/1,Classification Loss: 0.3325, Contrastive Loss: 0.0218
Epoch 29/30, Step 80/1,Classification Loss: 0.3446, Contrastive Loss: 0.0252
Epoch 29/30, Step 100/1,Classification Loss: 0.3138, Contrastive Loss: 0.0197
Epoch 29/30, Step 120/1,Classification Loss: 0.3603, Contrastive Loss: 0.0267
Epoch 29/30, Step 140/1,Classification Loss: 0.3134, Contrastive Loss: 0.0195
Accuracy: 0.9947, Precision: 0.9941, Recall: 0.9836, F1: 0.9888
Accuracy: 0.9879, Precision: 0.9824, Recall: 0.9677, F1: 0.9748
Epoch 29/30
Training - Loss: 52.4834
Training Metrics: {'accuracy': 0.9947212837837838, 'precision': 0.9941404296850637, 'recall': 0.983642605950277, 'f1': 0.9888097199018665}
Validation Metrics: {'accuracy': 0.9879112793020077, 'precision': 0.9823521075551522, 'recall': 0.9676749108734404, 'f1': 0.974846314070312}
Epoch 30/30, Step 0/1,Classification Loss: 0.3303, Contrastive Loss: 0.0249
Epoch 30/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0183
Epoch 30/30, Step 40/1,Classification Loss: 0.3498, Contrastive Loss: 0.0278
Epoch 30/30, Step 60/1,Classification Loss: 0.3362, Contrastive Loss: 0.0210
Epoch 30/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.0214
Epoch 30/30, Step 100/1,Classification Loss: 0.3270, Contrastive Loss: 0.0207
Epoch 30/30, Step 120/1,Classification Loss: 0.3444, Contrastive Loss: 0.0338
Epoch 30/30, Step 140/1,Classification Loss: 0.3135, Contrastive Loss: 0.0215
Accuracy: 0.9949, Precision: 0.9940, Recall: 0.9843, F1: 0.9890
Accuracy: 0.9881, Precision: 0.9822, Recall: 0.9687, F1: 0.9753
Epoch 30/30
Training - Loss: 52.5782
Training Metrics: {'accuracy': 0.9948532516891891, 'precision': 0.9939522475901708, 'recall': 0.9842533435254186, 'f1': 0.9890332184353312}
Validation Metrics: {'accuracy': 0.9881215179228424, 'precision': 0.9821889203830736, 'recall': 0.9687222838137473, 'f1': 0.9753148906136815}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
keys: dict_keys(['X', 'y', 't', 'env', 'y_family'])
X shape: (355, 5814), y shape: (355,), y distribution: Counter({np.float64(0.0): 326, np.float64(1.0): 29}), env shape: (355,)
load model from /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
Accuracy: 0.9127, Precision: 0.4589, Recall: 0.4969, F1: 0.4772
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375,  7415]))
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13515]))
original train data shape: torch.Size([47662]), new train data shape: torch.Size([100])
original test data shape: torch.Size([355, 5814]), selected test data shape: torch.Size([100, 5814])
original train data shape: torch.Size([47662]), new train data shape: torch.Size([47662])
env distribution: (array([0, 1, 2, 3]), array([ 7754, 12018, 14375, 13515]))
Epoch 1/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 1.6316
Epoch 1/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 1.0640
Epoch 1/30, Step 40/1,Classification Loss: 0.3508, Contrastive Loss: 0.5626
Epoch 1/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.3047
Epoch 1/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.2132
Epoch 1/30, Step 100/1,Classification Loss: 0.3601, Contrastive Loss: 0.2602
Epoch 1/30, Step 120/1,Classification Loss: 0.3445, Contrastive Loss: 0.1949
Epoch 1/30, Step 140/1,Classification Loss: 0.3147, Contrastive Loss: 0.1561
Accuracy: 0.9938, Precision: 0.9927, Recall: 0.9810, F1: 0.9868
Accuracy: 0.9888, Precision: 0.9839, Recall: 0.9698, F1: 0.9766
Epoch 1/30
Training - Loss: 120.5108
Training Metrics: {'accuracy': 0.993823902027027, 'precision': 0.9927474735025911, 'recall': 0.9810297542321985, 'f1': 0.986786762876551}
Validation Metrics: {'accuracy': 0.9887758313227735, 'precision': 0.9838512590279134, 'recall': 0.969752526578824, 'f1': 0.976648277591528}
Epoch 2/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.1811
Epoch 2/30, Step 20/1,Classification Loss: 0.3435, Contrastive Loss: 0.1651
Epoch 2/30, Step 40/1,Classification Loss: 0.3423, Contrastive Loss: 0.1524
Epoch 2/30, Step 60/1,Classification Loss: 0.3445, Contrastive Loss: 0.1492
Epoch 2/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.1458
Epoch 2/30, Step 100/1,Classification Loss: 0.3432, Contrastive Loss: 0.1387
Epoch 2/30, Step 120/1,Classification Loss: 0.3506, Contrastive Loss: 0.1468
Epoch 2/30, Step 140/1,Classification Loss: 0.3452, Contrastive Loss: 0.1713
Accuracy: 0.9943, Precision: 0.9937, Recall: 0.9821, F1: 0.9878
Accuracy: 0.9892, Precision: 0.9857, Recall: 0.9697, F1: 0.9775
Epoch 2/30
Training - Loss: 71.3316
Training Metrics: {'accuracy': 0.9942989864864865, 'precision': 0.9936949163580711, 'recall': 0.982121754472971, 'f1': 0.9878091934566223}
Validation Metrics: {'accuracy': 0.989195426413511, 'precision': 0.9856612006499724, 'recall': 0.9696892211035096, 'f1': 0.9774787159428306}
Epoch 3/30, Step 0/1,Classification Loss: 0.3299, Contrastive Loss: 0.1350
Epoch 3/30, Step 20/1,Classification Loss: 0.3447, Contrastive Loss: 0.1576
Epoch 3/30, Step 40/1,Classification Loss: 0.3376, Contrastive Loss: 0.1347
Epoch 3/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.1109
Epoch 3/30, Step 80/1,Classification Loss: 0.3351, Contrastive Loss: 0.1171
Epoch 3/30, Step 100/1,Classification Loss: 0.3211, Contrastive Loss: 0.1122
Epoch 3/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.1040
Epoch 3/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0971
Accuracy: 0.9949, Precision: 0.9940, Recall: 0.9844, F1: 0.9891
Accuracy: 0.9899, Precision: 0.9855, Recall: 0.9729, F1: 0.9791
Epoch 3/30
Training - Loss: 67.8648
Training Metrics: {'accuracy': 0.9948532516891891, 'precision': 0.9939802482349263, 'recall': 0.9843798571257771, 'f1': 0.989111606745632}
Validation Metrics: {'accuracy': 0.9899297178223014, 'precision': 0.9855211222975189, 'recall': 0.9728879750279528, 'f1': 0.9790818092600242}
Epoch 4/30, Step 0/1,Classification Loss: 0.3496, Contrastive Loss: 0.1258
Epoch 4/30, Step 20/1,Classification Loss: 0.3220, Contrastive Loss: 0.1026
Epoch 4/30, Step 40/1,Classification Loss: 0.3231, Contrastive Loss: 0.1026
Epoch 4/30, Step 60/1,Classification Loss: 0.3200, Contrastive Loss: 0.1082
Epoch 4/30, Step 80/1,Classification Loss: 0.3289, Contrastive Loss: 0.1010
Epoch 4/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.1127
Epoch 4/30, Step 120/1,Classification Loss: 0.3230, Contrastive Loss: 0.0972
Epoch 4/30, Step 140/1,Classification Loss: 0.3143, Contrastive Loss: 0.0951
Accuracy: 0.9951, Precision: 0.9940, Recall: 0.9853, F1: 0.9896
Accuracy: 0.9898, Precision: 0.9830, Recall: 0.9750, F1: 0.9790
Epoch 4/30
Training - Loss: 65.2286
Training Metrics: {'accuracy': 0.995090793918919, 'precision': 0.9940274787506429, 'recall': 0.9852556226284749, 'f1': 0.989584566691059}
Validation Metrics: {'accuracy': 0.9898248190496172, 'precision': 0.983044105122501, 'recall': 0.9749818837146551, 'f1': 0.9789628345100778}
Epoch 5/30, Step 0/1,Classification Loss: 0.3403, Contrastive Loss: 0.1001
Epoch 5/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0946
Epoch 5/30, Step 40/1,Classification Loss: 0.3334, Contrastive Loss: 0.0964
Epoch 5/30, Step 60/1,Classification Loss: 0.3197, Contrastive Loss: 0.0936
Epoch 5/30, Step 80/1,Classification Loss: 0.3345, Contrastive Loss: 0.0960
Epoch 5/30, Step 100/1,Classification Loss: 0.3339, Contrastive Loss: 0.0997
Epoch 5/30, Step 120/1,Classification Loss: 0.3586, Contrastive Loss: 0.1075
Epoch 5/30, Step 140/1,Classification Loss: 0.3289, Contrastive Loss: 0.0836
Accuracy: 0.9948, Precision: 0.9941, Recall: 0.9839, F1: 0.9889
Accuracy: 0.9894, Precision: 0.9852, Recall: 0.9710, F1: 0.9780
Epoch 5/30
Training - Loss: 63.6685
Training Metrics: {'accuracy': 0.9947740709459459, 'precision': 0.9940912938346758, 'recall': 0.9839164456246132, 'f1': 0.9889270257641771}
Validation Metrics: {'accuracy': 0.9894052239588796, 'precision': 0.9851804188394078, 'recall': 0.9710429565777683, 'f1': 0.9779577199695733}
Epoch 6/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0882
Epoch 6/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0884
Epoch 6/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0766
Epoch 6/30, Step 60/1,Classification Loss: 0.3371, Contrastive Loss: 0.0899
Epoch 6/30, Step 80/1,Classification Loss: 0.3195, Contrastive Loss: 0.0775
Epoch 6/30, Step 100/1,Classification Loss: 0.3447, Contrastive Loss: 0.1030
Epoch 6/30, Step 120/1,Classification Loss: 0.3601, Contrastive Loss: 0.0852
Epoch 6/30, Step 140/1,Classification Loss: 0.3307, Contrastive Loss: 0.0784
Accuracy: 0.9949, Precision: 0.9936, Recall: 0.9848, F1: 0.9891
Accuracy: 0.9901, Precision: 0.9857, Recall: 0.9736, F1: 0.9795
Epoch 6/30
Training - Loss: 62.0205
Training Metrics: {'accuracy': 0.9948796452702703, 'precision': 0.9935732489477587, 'recall': 0.984803318936882, 'f1': 0.989131280267636}
Validation Metrics: {'accuracy': 0.9901395153676702, 'precision': 0.9856574226843237, 'recall': 0.9736259824080266, 'f1': 0.979530450927558}
Epoch 7/30, Step 0/1,Classification Loss: 0.3540, Contrastive Loss: 0.0974
Epoch 7/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.0822
Epoch 7/30, Step 40/1,Classification Loss: 0.3467, Contrastive Loss: 0.0817
Epoch 7/30, Step 60/1,Classification Loss: 0.3140, Contrastive Loss: 0.0706
Epoch 7/30, Step 80/1,Classification Loss: 0.3357, Contrastive Loss: 0.0798
Epoch 7/30, Step 100/1,Classification Loss: 0.3289, Contrastive Loss: 0.0735
Epoch 7/30, Step 120/1,Classification Loss: 0.3457, Contrastive Loss: 0.0780
Epoch 7/30, Step 140/1,Classification Loss: 0.3568, Contrastive Loss: 0.0783
Accuracy: 0.9949, Precision: 0.9941, Recall: 0.9844, F1: 0.9891
Accuracy: 0.9899, Precision: 0.9858, Recall: 0.9726, F1: 0.9791
Epoch 7/30
Training - Loss: 60.9082
Training Metrics: {'accuracy': 0.9948796452702703, 'precision': 0.9940710318606618, 'recall': 0.984366605913787, 'f1': 0.989148958279197}
Validation Metrics: {'accuracy': 0.9899297178223014, 'precision': 0.985827033608367, 'recall': 0.9725801109808604, 'f1': 0.9790686696064259}
Epoch 8/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0642
Epoch 8/30, Step 20/1,Classification Loss: 0.3228, Contrastive Loss: 0.0698
Epoch 8/30, Step 40/1,Classification Loss: 0.3291, Contrastive Loss: 0.0733
Epoch 8/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0686
Epoch 8/30, Step 80/1,Classification Loss: 0.3392, Contrastive Loss: 0.0786
Epoch 8/30, Step 100/1,Classification Loss: 0.3601, Contrastive Loss: 0.0798
Epoch 8/30, Step 120/1,Classification Loss: 0.3446, Contrastive Loss: 0.0821
Epoch 8/30, Step 140/1,Classification Loss: 0.3541, Contrastive Loss: 0.0748
Accuracy: 0.9945, Precision: 0.9960, Recall: 0.9807, F1: 0.9882
Accuracy: 0.9894, Precision: 0.9870, Recall: 0.9692, F1: 0.9779
Epoch 8/30
Training - Loss: 59.6906
Training Metrics: {'accuracy': 0.9944837415540541, 'precision': 0.9959758703457728, 'recall': 0.980716097630655, 'f1': 0.9881740560220709}
Validation Metrics: {'accuracy': 0.9894052239588796, 'precision': 0.9870420112050864, 'recall': 0.9691957722952138, 'f1': 0.9778741302226426}
Epoch 9/30, Step 0/1,Classification Loss: 0.3243, Contrastive Loss: 0.0660
Epoch 9/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0609
Epoch 9/30, Step 40/1,Classification Loss: 0.3349, Contrastive Loss: 0.0647
Epoch 9/30, Step 60/1,Classification Loss: 0.3515, Contrastive Loss: 0.0687
Epoch 9/30, Step 80/1,Classification Loss: 0.3784, Contrastive Loss: 0.0837
Epoch 9/30, Step 100/1,Classification Loss: 0.3290, Contrastive Loss: 0.0625
Epoch 9/30, Step 120/1,Classification Loss: 0.3515, Contrastive Loss: 0.0711
Epoch 9/30, Step 140/1,Classification Loss: 0.3182, Contrastive Loss: 0.0588
Accuracy: 0.9948, Precision: 0.9937, Recall: 0.9842, F1: 0.9889
Accuracy: 0.9900, Precision: 0.9847, Recall: 0.9742, F1: 0.9793
Epoch 9/30
Training - Loss: 58.8493
Training Metrics: {'accuracy': 0.994800464527027, 'precision': 0.993660423618401, 'recall': 0.9842428041788563, 'f1': 0.9888861091184118}
Validation Metrics: {'accuracy': 0.9900346165949858, 'precision': 0.9846792225186235, 'recall': 0.9741805708592669, 'f1': 0.9793450588623687}
Epoch 10/30, Step 0/1,Classification Loss: 0.3133, Contrastive Loss: 0.0579
Epoch 10/30, Step 20/1,Classification Loss: 0.3490, Contrastive Loss: 0.0643
Epoch 10/30, Step 40/1,Classification Loss: 0.3203, Contrastive Loss: 0.0581
Epoch 10/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0591
Epoch 10/30, Step 80/1,Classification Loss: 0.3237, Contrastive Loss: 0.0581
Epoch 10/30, Step 100/1,Classification Loss: 0.3180, Contrastive Loss: 0.0533
Epoch 10/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0572
Epoch 10/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0486
Accuracy: 0.9950, Precision: 0.9938, Recall: 0.9849, F1: 0.9893
Accuracy: 0.9898, Precision: 0.9848, Recall: 0.9731, F1: 0.9789
Epoch 10/30
Training - Loss: 58.0157
Training Metrics: {'accuracy': 0.9949588260135135, 'precision': 0.9937715619165686, 'recall': 0.984882777690141, 'f1': 0.9892687276514653}
Validation Metrics: {'accuracy': 0.9898248190496172, 'precision': 0.9848439997440254, 'recall': 0.9731346994321007, 'f1': 0.9788837877698511}
Epoch 11/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0534
Epoch 11/30, Step 20/1,Classification Loss: 0.3226, Contrastive Loss: 0.0549
Epoch 11/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.0559
Epoch 11/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0531
Epoch 11/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0507
Epoch 11/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0484
Epoch 11/30, Step 120/1,Classification Loss: 0.3583, Contrastive Loss: 0.0745
Epoch 11/30, Step 140/1,Classification Loss: 0.3137, Contrastive Loss: 0.0508
Accuracy: 0.9942, Precision: 0.9934, Recall: 0.9823, F1: 0.9877
Accuracy: 0.9891, Precision: 0.9850, Recall: 0.9699, F1: 0.9773
Epoch 11/30
Training - Loss: 57.4085
Training Metrics: {'accuracy': 0.9942461993243243, 'precision': 0.9934320785925481, 'recall': 0.9822509565497126, 'f1': 0.9877487339918617}
Validation Metrics: {'accuracy': 0.9890905276408266, 'precision': 0.9849760280287663, 'recall': 0.9699359455076575, 'f1': 0.9772815557117833}
Epoch 12/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0537
Epoch 12/30, Step 20/1,Classification Loss: 0.3651, Contrastive Loss: 0.0618
Epoch 12/30, Step 40/1,Classification Loss: 0.3133, Contrastive Loss: 0.0450
Epoch 12/30, Step 60/1,Classification Loss: 0.3524, Contrastive Loss: 0.0620
Epoch 12/30, Step 80/1,Classification Loss: 0.3134, Contrastive Loss: 0.0441
Epoch 12/30, Step 100/1,Classification Loss: 0.3293, Contrastive Loss: 0.0518
Epoch 12/30, Step 120/1,Classification Loss: 0.3213, Contrastive Loss: 0.0467
Epoch 12/30, Step 140/1,Classification Loss: 0.3444, Contrastive Loss: 0.0546
Accuracy: 0.9942, Precision: 0.9938, Recall: 0.9820, F1: 0.9878
Accuracy: 0.9891, Precision: 0.9862, Recall: 0.9687, F1: 0.9772
Epoch 12/30
Training - Loss: 57.1849
Training Metrics: {'accuracy': 0.9942461993243243, 'precision': 0.9937809075037488, 'recall': 0.982045147962901, 'f1': 0.9878105248827433}
Validation Metrics: {'accuracy': 0.9890905276408266, 'precision': 0.9862159490856286, 'recall': 0.968704489319288, 'f1': 0.9772241295689714}
Epoch 13/30, Step 0/1,Classification Loss: 0.3146, Contrastive Loss: 0.0445
Epoch 13/30, Step 20/1,Classification Loss: 0.3186, Contrastive Loss: 0.0429
Epoch 13/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0478
Epoch 13/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0446
Epoch 13/30, Step 80/1,Classification Loss: 0.3602, Contrastive Loss: 0.0670
Epoch 13/30, Step 100/1,Classification Loss: 0.3443, Contrastive Loss: 0.0456
Epoch 13/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0465
Epoch 13/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0430
Accuracy: 0.9948, Precision: 0.9938, Recall: 0.9840, F1: 0.9889
Accuracy: 0.9892, Precision: 0.9838, Recall: 0.9715, F1: 0.9776
Epoch 13/30
Training - Loss: 56.3597
Training Metrics: {'accuracy': 0.994800464527027, 'precision': 0.9938159766135111, 'recall': 0.984042103891611, 'f1': 0.9888585828166292}
Validation Metrics: {'accuracy': 0.989195426413511, 'precision': 0.9838238624799833, 'recall': 0.9715364053860642, 'f1': 0.9775635652218957}
Epoch 14/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0414
Epoch 14/30, Step 20/1,Classification Loss: 0.3446, Contrastive Loss: 0.0498
Epoch 14/30, Step 40/1,Classification Loss: 0.3881, Contrastive Loss: 0.0597
Epoch 14/30, Step 60/1,Classification Loss: 0.4024, Contrastive Loss: 0.0587
Epoch 14/30, Step 80/1,Classification Loss: 0.3490, Contrastive Loss: 0.0464
Epoch 14/30, Step 100/1,Classification Loss: 0.3430, Contrastive Loss: 0.0437
Epoch 14/30, Step 120/1,Classification Loss: 0.3471, Contrastive Loss: 0.0438
Epoch 14/30, Step 140/1,Classification Loss: 0.3426, Contrastive Loss: 0.0457
Accuracy: 0.9942, Precision: 0.9933, Recall: 0.9822, F1: 0.9877
Accuracy: 0.9887, Precision: 0.9838, Recall: 0.9694, F1: 0.9764
Epoch 14/30
Training - Loss: 56.0193
Training Metrics: {'accuracy': 0.9942198057432432, 'precision': 0.9933336146303583, 'recall': 0.9822323829817625, 'f1': 0.9876915280171399}
Validation Metrics: {'accuracy': 0.9886709325500892, 'precision': 0.9837822709675834, 'recall': 0.9693835228887873, 'f1': 0.9764226203463962}
Epoch 15/30, Step 0/1,Classification Loss: 0.3243, Contrastive Loss: 0.0409
Epoch 15/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0390
Epoch 15/30, Step 40/1,Classification Loss: 0.3379, Contrastive Loss: 0.0413
Epoch 15/30, Step 60/1,Classification Loss: 0.3360, Contrastive Loss: 0.0429
Epoch 15/30, Step 80/1,Classification Loss: 0.3290, Contrastive Loss: 0.0397
Epoch 15/30, Step 100/1,Classification Loss: 0.3566, Contrastive Loss: 0.0425
Epoch 15/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0342
Epoch 15/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0345
Accuracy: 0.9947, Precision: 0.9938, Recall: 0.9840, F1: 0.9889
Accuracy: 0.9900, Precision: 0.9850, Recall: 0.9739, F1: 0.9793
Epoch 15/30
Training - Loss: 55.4336
Training Metrics: {'accuracy': 0.9947476773648649, 'precision': 0.9938245788467575, 'recall': 0.9840291682255132, 'f1': 0.9888556988050234}
Validation Metrics: {'accuracy': 0.9900346165949858, 'precision': 0.984981440552969, 'recall': 0.9738727068121745, 'f1': 0.9793321262173144}
Epoch 16/30, Step 0/1,Classification Loss: 0.3334, Contrastive Loss: 0.0378
Epoch 16/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0367
Epoch 16/30, Step 40/1,Classification Loss: 0.3500, Contrastive Loss: 0.0399
Epoch 16/30, Step 60/1,Classification Loss: 0.3341, Contrastive Loss: 0.0406
Epoch 16/30, Step 80/1,Classification Loss: 0.3189, Contrastive Loss: 0.0350
Epoch 16/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0320
Epoch 16/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0335
Epoch 16/30, Step 140/1,Classification Loss: 0.3542, Contrastive Loss: 0.0402
Accuracy: 0.9940, Precision: 0.9934, Recall: 0.9811, F1: 0.9871
Accuracy: 0.9888, Precision: 0.9860, Recall: 0.9676, F1: 0.9765
Epoch 16/30
Training - Loss: 55.1386
Training Metrics: {'accuracy': 0.9939558699324325, 'precision': 0.9934258608501636, 'recall': 0.9810604041533614, 'f1': 0.9871294973329909}
Validation Metrics: {'accuracy': 0.9887758313227735, 'precision': 0.9860151224066636, 'recall': 0.9675974782491772, 'f1': 0.9765448824293925}
Epoch 17/30, Step 0/1,Classification Loss: 0.3758, Contrastive Loss: 0.0439
Epoch 17/30, Step 20/1,Classification Loss: 0.3244, Contrastive Loss: 0.0387
Epoch 17/30, Step 40/1,Classification Loss: 0.3218, Contrastive Loss: 0.0350
Epoch 17/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0350
Epoch 17/30, Step 80/1,Classification Loss: 0.3288, Contrastive Loss: 0.0328
Epoch 17/30, Step 100/1,Classification Loss: 0.3191, Contrastive Loss: 0.0331
Epoch 17/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0311
Epoch 17/30, Step 140/1,Classification Loss: 0.3243, Contrastive Loss: 0.0341
Accuracy: 0.9944, Precision: 0.9938, Recall: 0.9823, F1: 0.9880
Accuracy: 0.9893, Precision: 0.9860, Recall: 0.9698, F1: 0.9777
Epoch 17/30
Training - Loss: 54.5849
Training Metrics: {'accuracy': 0.9943517736486487, 'precision': 0.9938277197779548, 'recall': 0.9823350389734693, 'f1': 0.9879833620908465}
Validation Metrics: {'accuracy': 0.9893003251861954, 'precision': 0.9860387165737053, 'recall': 0.9697503607464542, 'f1': 0.9776903317107553}
Epoch 18/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0361
Epoch 18/30, Step 20/1,Classification Loss: 0.3558, Contrastive Loss: 0.0359
Epoch 18/30, Step 40/1,Classification Loss: 0.3445, Contrastive Loss: 0.0359
Epoch 18/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0316
Epoch 18/30, Step 80/1,Classification Loss: 0.3442, Contrastive Loss: 0.0335
Epoch 18/30, Step 100/1,Classification Loss: 0.3762, Contrastive Loss: 0.0394
Epoch 18/30, Step 120/1,Classification Loss: 0.3178, Contrastive Loss: 0.0310
Epoch 18/30, Step 140/1,Classification Loss: 0.3163, Contrastive Loss: 0.0299
Accuracy: 0.9946, Precision: 0.9959, Recall: 0.9811, F1: 0.9883
Accuracy: 0.9891, Precision: 0.9859, Recall: 0.9690, F1: 0.9772
Epoch 18/30
Training - Loss: 54.4832
Training Metrics: {'accuracy': 0.9945629222972973, 'precision': 0.9958519447378611, 'recall': 0.9811303092938828, 'f1': 0.988331264187998}
Validation Metrics: {'accuracy': 0.9890905276408266, 'precision': 0.9859042184689069, 'recall': 0.9690123533663804, 'f1': 0.9772385195753434}
Epoch 19/30, Step 0/1,Classification Loss: 0.3289, Contrastive Loss: 0.0320
Epoch 19/30, Step 20/1,Classification Loss: 0.3313, Contrastive Loss: 0.0322
Epoch 19/30, Step 40/1,Classification Loss: 0.3659, Contrastive Loss: 0.0518
Epoch 19/30, Step 60/1,Classification Loss: 0.3303, Contrastive Loss: 0.0288
Epoch 19/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0347
Epoch 19/30, Step 100/1,Classification Loss: 0.3759, Contrastive Loss: 0.0427
Epoch 19/30, Step 120/1,Classification Loss: 0.3630, Contrastive Loss: 0.0368
Epoch 19/30, Step 140/1,Classification Loss: 0.3445, Contrastive Loss: 0.0324
Accuracy: 0.9946, Precision: 0.9938, Recall: 0.9833, F1: 0.9885
Accuracy: 0.9890, Precision: 0.9861, Recall: 0.9683, F1: 0.9770
Epoch 19/30
Training - Loss: 54.0581
Training Metrics: {'accuracy': 0.9945893158783784, 'precision': 0.9937985552751795, 'recall': 0.983317181355079, 'f1': 0.9884764842091356}
Validation Metrics: {'accuracy': 0.9889856288681422, 'precision': 0.9861490028432383, 'recall': 0.968335485629251, 'f1': 0.9769978581522522}
Epoch 20/30, Step 0/1,Classification Loss: 0.4011, Contrastive Loss: 0.0431
Epoch 20/30, Step 20/1,Classification Loss: 0.3133, Contrastive Loss: 0.0256
Epoch 20/30, Step 40/1,Classification Loss: 0.3339, Contrastive Loss: 0.0327
Epoch 20/30, Step 60/1,Classification Loss: 0.3134, Contrastive Loss: 0.0290
Epoch 20/30, Step 80/1,Classification Loss: 0.3214, Contrastive Loss: 0.0282
Epoch 20/30, Step 100/1,Classification Loss: 0.3482, Contrastive Loss: 0.0369
Epoch 20/30, Step 120/1,Classification Loss: 0.3381, Contrastive Loss: 0.0315
Epoch 20/30, Step 140/1,Classification Loss: 0.3371, Contrastive Loss: 0.0287
Accuracy: 0.9940, Precision: 0.9931, Recall: 0.9812, F1: 0.9870
Accuracy: 0.9878, Precision: 0.9848, Recall: 0.9649, F1: 0.9745
Epoch 20/30
Training - Loss: 53.6649
Training Metrics: {'accuracy': 0.9939822635135135, 'precision': 0.9931460873555954, 'recall': 0.9811507529359254, 'f1': 0.9870421464325007}
Validation Metrics: {'accuracy': 0.9878317423686143, 'precision': 0.9847833946704639, 'recall': 0.96489217313303, 'f1': 0.9745316925691543}
Epoch 21/30, Step 0/1,Classification Loss: 0.3587, Contrastive Loss: 0.0346
Epoch 21/30, Step 20/1,Classification Loss: 0.3521, Contrastive Loss: 0.0308
Epoch 21/30, Step 40/1,Classification Loss: 0.3372, Contrastive Loss: 0.0287
Epoch 21/30, Step 60/1,Classification Loss: 0.3599, Contrastive Loss: 0.0338
Epoch 21/30, Step 80/1,Classification Loss: 0.3350, Contrastive Loss: 0.0287
Epoch 21/30, Step 100/1,Classification Loss: 0.3371, Contrastive Loss: 0.0295
Epoch 21/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0269
Epoch 21/30, Step 140/1,Classification Loss: 0.3635, Contrastive Loss: 0.0329
Accuracy: 0.9943, Precision: 0.9937, Recall: 0.9821, F1: 0.9878
Accuracy: 0.9887, Precision: 0.9847, Recall: 0.9685, F1: 0.9764
Epoch 21/30
Training - Loss: 53.4538
Training Metrics: {'accuracy': 0.9942725929054054, 'precision': 0.9936920711357349, 'recall': 0.9820952992491712, 'f1': 0.9877939401055653}
Validation Metrics: {'accuracy': 0.9886709325500892, 'precision': 0.9847035415681591, 'recall': 0.9684599307475099, 'f1': 0.9763779982819762}
Epoch 22/30, Step 0/1,Classification Loss: 0.3134, Contrastive Loss: 0.0255
Epoch 22/30, Step 20/1,Classification Loss: 0.3289, Contrastive Loss: 0.0269
Epoch 22/30, Step 40/1,Classification Loss: 0.3228, Contrastive Loss: 0.0244
Epoch 22/30, Step 60/1,Classification Loss: 0.3285, Contrastive Loss: 0.0271
Epoch 22/30, Step 80/1,Classification Loss: 0.3702, Contrastive Loss: 0.0335
Epoch 22/30, Step 100/1,Classification Loss: 0.3207, Contrastive Loss: 0.0237
Epoch 22/30, Step 120/1,Classification Loss: 0.3288, Contrastive Loss: 0.0265
Epoch 22/30, Step 140/1,Classification Loss: 0.3444, Contrastive Loss: 0.0271
Accuracy: 0.9936, Precision: 0.9930, Recall: 0.9796, F1: 0.9862
Accuracy: 0.9883, Precision: 0.9844, Recall: 0.9670, F1: 0.9755
Epoch 22/30
Training - Loss: 53.4682
Training Metrics: {'accuracy': 0.9935599662162162, 'precision': 0.9929888334382748, 'recall': 0.9795933335064768, 'f1': 0.9861581448931097}
Validation Metrics: {'accuracy': 0.9882513374593517, 'precision': 0.9844310927110532, 'recall': 0.9669839159873623, 'f1': 0.9754721395358155}
Epoch 23/30, Step 0/1,Classification Loss: 0.3433, Contrastive Loss: 0.0272
Epoch 23/30, Step 20/1,Classification Loss: 0.3695, Contrastive Loss: 0.0347
Epoch 23/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0252
Epoch 23/30, Step 60/1,Classification Loss: 0.3449, Contrastive Loss: 0.0607
Epoch 23/30, Step 80/1,Classification Loss: 0.3135, Contrastive Loss: 0.0230
Epoch 23/30, Step 100/1,Classification Loss: 0.3197, Contrastive Loss: 0.0236
Epoch 23/30, Step 120/1,Classification Loss: 0.3289, Contrastive Loss: 0.0245
Epoch 23/30, Step 140/1,Classification Loss: 0.3444, Contrastive Loss: 0.0294
Accuracy: 0.9945, Precision: 0.9935, Recall: 0.9834, F1: 0.9884
Accuracy: 0.9896, Precision: 0.9847, Recall: 0.9724, F1: 0.9784
Epoch 23/30
Training - Loss: 53.4211
Training Metrics: {'accuracy': 0.9945101351351351, 'precision': 0.9935350589873893, 'recall': 0.9834023470605529, 'f1': 0.988392302328272}
Validation Metrics: {'accuracy': 0.9896150215042484, 'precision': 0.9847065667904287, 'recall': 0.972396692052027, 'f1': 0.9784348830773562}
Epoch 24/30, Step 0/1,Classification Loss: 0.3194, Contrastive Loss: 0.0239
Epoch 24/30, Step 20/1,Classification Loss: 0.3189, Contrastive Loss: 0.0216
Epoch 24/30, Step 40/1,Classification Loss: 0.3315, Contrastive Loss: 0.0253
Epoch 24/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0219
Epoch 24/30, Step 80/1,Classification Loss: 0.3542, Contrastive Loss: 0.0255
Epoch 24/30, Step 100/1,Classification Loss: 0.3365, Contrastive Loss: 0.0271
Epoch 24/30, Step 120/1,Classification Loss: 0.3133, Contrastive Loss: 0.0216
Epoch 24/30, Step 140/1,Classification Loss: 0.3346, Contrastive Loss: 0.0266
Accuracy: 0.9946, Precision: 0.9937, Recall: 0.9835, F1: 0.9885
Accuracy: 0.9890, Precision: 0.9834, Recall: 0.9711, F1: 0.9771
Epoch 24/30
Training - Loss: 53.1327
Training Metrics: {'accuracy': 0.9946421030405406, 'precision': 0.9937286293376338, 'recall': 0.9834985728201353, 'f1': 0.988536289639536}
Validation Metrics: {'accuracy': 0.9889856288681422, 'precision': 0.9833825103247608, 'recall': 0.9711062620530827, 'f1': 0.9771279062941656}
Epoch 25/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0236
Epoch 25/30, Step 20/1,Classification Loss: 0.3231, Contrastive Loss: 0.0218
Epoch 25/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0241
Epoch 25/30, Step 60/1,Classification Loss: 0.3289, Contrastive Loss: 0.0233
Epoch 25/30, Step 80/1,Classification Loss: 0.3445, Contrastive Loss: 0.0266
Epoch 25/30, Step 100/1,Classification Loss: 0.3445, Contrastive Loss: 0.0246
Epoch 25/30, Step 120/1,Classification Loss: 0.3491, Contrastive Loss: 0.0266
Epoch 25/30, Step 140/1,Classification Loss: 0.3195, Contrastive Loss: 0.0226
Accuracy: 0.9941, Precision: 0.9931, Recall: 0.9819, F1: 0.9874
Accuracy: 0.9889, Precision: 0.9842, Recall: 0.9698, F1: 0.9769
Epoch 25/30
Training - Loss: 52.8952
Training Metrics: {'accuracy': 0.994114231418919, 'precision': 0.9930915362905135, 'recall': 0.9819437287333144, 'f1': 0.9874255105186928}
Validation Metrics: {'accuracy': 0.9888807300954578, 'precision': 0.9842256093216668, 'recall': 0.9698136662217687, 'f1': 0.9768592384881296}
Epoch 26/30, Step 0/1,Classification Loss: 0.3145, Contrastive Loss: 0.0218
Epoch 26/30, Step 20/1,Classification Loss: 0.3594, Contrastive Loss: 0.0282
Epoch 26/30, Step 40/1,Classification Loss: 0.3602, Contrastive Loss: 0.0279
Epoch 26/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0207
Epoch 26/30, Step 80/1,Classification Loss: 0.3218, Contrastive Loss: 0.0208
Epoch 26/30, Step 100/1,Classification Loss: 0.3338, Contrastive Loss: 0.0250
Epoch 26/30, Step 120/1,Classification Loss: 0.3290, Contrastive Loss: 0.0238
Epoch 26/30, Step 140/1,Classification Loss: 0.3442, Contrastive Loss: 0.0266
Accuracy: 0.9951, Precision: 0.9943, Recall: 0.9852, F1: 0.9897
Accuracy: 0.9894, Precision: 0.9834, Recall: 0.9729, F1: 0.9780
Epoch 26/30
Training - Loss: 52.9092
Training Metrics: {'accuracy': 0.995143581081081, 'precision': 0.9943018755396071, 'recall': 0.9852004253343876, 'f1': 0.9896898431993042}
Validation Metrics: {'accuracy': 0.9894052239588796, 'precision': 0.9833602215999027, 'recall': 0.9728901408603228, 'f1': 0.9780405362642024}
Epoch 27/30, Step 0/1,Classification Loss: 0.3482, Contrastive Loss: 0.0363
Epoch 27/30, Step 20/1,Classification Loss: 0.3445, Contrastive Loss: 0.0224
Epoch 27/30, Step 40/1,Classification Loss: 0.3289, Contrastive Loss: 0.0204
Epoch 27/30, Step 60/1,Classification Loss: 0.3492, Contrastive Loss: 0.0269
Epoch 27/30, Step 80/1,Classification Loss: 0.3547, Contrastive Loss: 0.0285
Epoch 27/30, Step 100/1,Classification Loss: 0.3572, Contrastive Loss: 0.0396
Epoch 27/30, Step 120/1,Classification Loss: 0.3516, Contrastive Loss: 0.0376
Epoch 27/30, Step 140/1,Classification Loss: 0.3297, Contrastive Loss: 0.0221
Accuracy: 0.9949, Precision: 0.9962, Recall: 0.9824, F1: 0.9892
Accuracy: 0.9892, Precision: 0.9857, Recall: 0.9697, F1: 0.9775
Epoch 27/30
Training - Loss: 52.8846
Training Metrics: {'accuracy': 0.9949324324324325, 'precision': 0.996239389789523, 'recall': 0.9824406336224325, 'f1': 0.9891992829644332}
Validation Metrics: {'accuracy': 0.989195426413511, 'precision': 0.9856612006499724, 'recall': 0.9696892211035096, 'f1': 0.9774787159428306}
Epoch 28/30, Step 0/1,Classification Loss: 0.3445, Contrastive Loss: 0.0239
Epoch 28/30, Step 20/1,Classification Loss: 0.3502, Contrastive Loss: 0.0238
Epoch 28/30, Step 40/1,Classification Loss: 0.3134, Contrastive Loss: 0.0205
Epoch 28/30, Step 60/1,Classification Loss: 0.3216, Contrastive Loss: 0.0218
Epoch 28/30, Step 80/1,Classification Loss: 0.3280, Contrastive Loss: 0.0231
Epoch 28/30, Step 100/1,Classification Loss: 0.3716, Contrastive Loss: 0.0241
Epoch 28/30, Step 120/1,Classification Loss: 0.3657, Contrastive Loss: 0.0284
Epoch 28/30, Step 140/1,Classification Loss: 0.3452, Contrastive Loss: 0.0255
Accuracy: 0.9928, Precision: 0.9926, Recall: 0.9767, F1: 0.9844
Accuracy: 0.9873, Precision: 0.9854, Recall: 0.9621, F1: 0.9733
Epoch 28/30
Training - Loss: 52.6849
Training Metrics: {'accuracy': 0.9927681587837838, 'precision': 0.992604886408325, 'recall': 0.9766697973689873, 'f1': 0.9844485350513883}
Validation Metrics: {'accuracy': 0.9873072485051925, 'precision': 0.9853964354130706, 'recall': 0.9621235625415682, 'f1': 0.9733407916397694}
Epoch 29/30, Step 0/1,Classification Loss: 0.3290, Contrastive Loss: 0.0304
Epoch 29/30, Step 20/1,Classification Loss: 0.3631, Contrastive Loss: 0.0338
Epoch 29/30, Step 40/1,Classification Loss: 0.3474, Contrastive Loss: 0.0230
Epoch 29/30, Step 60/1,Classification Loss: 0.3443, Contrastive Loss: 0.0221
Epoch 29/30, Step 80/1,Classification Loss: 0.3431, Contrastive Loss: 0.0292
Epoch 29/30, Step 100/1,Classification Loss: 0.3187, Contrastive Loss: 0.0197
Epoch 29/30, Step 120/1,Classification Loss: 0.3603, Contrastive Loss: 0.0267
Epoch 29/30, Step 140/1,Classification Loss: 0.3150, Contrastive Loss: 0.0210
Accuracy: 0.9933, Precision: 0.9929, Recall: 0.9786, F1: 0.9856
Accuracy: 0.9877, Precision: 0.9844, Recall: 0.9648, F1: 0.9743
Epoch 29/30
Training - Loss: 52.7227
Training Metrics: {'accuracy': 0.9932960304054054, 'precision': 0.992926650294623, 'recall': 0.9786256306627265, 'f1': 0.985624234963518}
Validation Metrics: {'accuracy': 0.9877268435959299, 'precision': 0.9844026456086301, 'recall': 0.9648310334900855, 'f1': 0.9743202863132632}
Epoch 30/30, Step 0/1,Classification Loss: 0.3722, Contrastive Loss: 0.0269
Epoch 30/30, Step 20/1,Classification Loss: 0.3600, Contrastive Loss: 0.0282
Epoch 30/30, Step 40/1,Classification Loss: 0.3570, Contrastive Loss: 0.0238
Epoch 30/30, Step 60/1,Classification Loss: 0.3133, Contrastive Loss: 0.0180
Epoch 30/30, Step 80/1,Classification Loss: 0.3133, Contrastive Loss: 0.0194
Epoch 30/30, Step 100/1,Classification Loss: 0.3133, Contrastive Loss: 0.0186
Epoch 30/30, Step 120/1,Classification Loss: 0.3245, Contrastive Loss: 0.0206
Epoch 30/30, Step 140/1,Classification Loss: 0.3133, Contrastive Loss: 0.0184
Accuracy: 0.9944, Precision: 0.9936, Recall: 0.9826, F1: 0.9880
Accuracy: 0.9889, Precision: 0.9839, Recall: 0.9701, F1: 0.9769
Epoch 30/30
Training - Loss: 52.5308
Training Metrics: {'accuracy': 0.9943781672297297, 'precision': 0.9935836116873744, 'recall': 0.9826014727561978, 'f1': 0.9880031999755823}
Validation Metrics: {'accuracy': 0.9888807300954578, 'precision': 0.9839202483257188, 'recall': 0.970121530268861, 'f1': 0.976873791850624}
best model path: /scratch_NOT_BACKED_UP/NOT_BACKED_UP/xinran/ckpt/stage1_model_epoch29_lr0.0001_bs256.pt
